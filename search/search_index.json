{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Gi\u1edbi thi\u1ec7u","text":""},{"location":"#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>Xin ch\u00e0o, m\u00ecnh l\u00e0 farmerboy.</p> <p>\u0110\u00e2y l\u00e0 n\u01a1i m\u00ecnh l\u01b0u tr\u1eef nh\u1eefng blog hay ho v\u1ec1 Competitive Programming m\u00e0 m\u00ecnh \u0111\u00e3 h\u1ecdc (\u0111\u00e3 \u0111\u01b0\u1ee3c d\u1ecbch). M\u00ecnh s\u1ebd l\u00e0m b\u00e0i t\u1eadp song song v\u1edbi vi\u1ec7c d\u1ecbch c\u00e1c t\u00e0i li\u1ec7u m\u00e0 m\u00ecnh th\u00edch.</p> <p>D\u1ecbch thu\u1eadt l\u00e0 m\u1ed9t c\u00f4ng vi\u1ec7c r\u1ea5t kh\u00f3 kh\u0103n, n\u00ean n\u1ebfu c\u00e1c b\u1ea1n th\u1ea5y b\u1ea3n d\u1ecbch kh\u00f4ng th\u1ef1c s\u1ef1 t\u1ed1t, h\u00e3y \u0111\u1ec1 xu\u1ea5t ch\u1ec9nh s\u1eeda t\u1ea1i \u0111\u00e2y.</p> <p>L\u01b0u \u00fd, n\u1ebfu b\u1ea1n th\u1eafc m\u1eafc v\u00ec sao m\u00ecnh vi\u1ebft ti\u1ebfng Vi\u1ec7t m\u00e0 v\u1eabn d\u00f9ng UI ti\u1ebfng Anh cho trang n\u00e0y, \u0111\u00f3 l\u00e0 v\u00ec t\u00ednh n\u0103ng t\u00ecm ki\u1ebfm kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng khi ch\u1ecdn ng\u00f4n ng\u1eef ti\u1ebfng Vi\u1ec7t. Mong c\u00e1c b\u1ea1n th\u00f4ng c\u1ea3m.</p> <p>Hi\u1ec7n t\u1ea1i m\u00ecnh \u0111ang tham gia Competitive Programming v\u1edbi c\u00e1c t\u00e0i kho\u1ea3n nh\u01b0:</p> <ul> <li> farmerboy</li> <li> farmerboy</li> <li> farmerboy</li> <li> farmerboy</li> <li> farmerboy</li> <li> farmerboy</li> <li> farmerboy</li> <li> farmerboy</li> </ul> <p>Ngo\u00e0i ra, c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c c\u00e1c t\u00e0i kho\u1ea3n c\u1ee7a m\u00ecnh tr\u00ean c\u00e1c trang Competitive Programming t\u1ea1i clist.by.</p> <p>N\u1ebfu c\u00e1c b\u1ea1n th\u1ea5y website n\u00e0y h\u1eefu \u00edch, c\u00f3 th\u1ec3 \u1ee7ng h\u1ed9 m\u00ecnh th\u00f4ng qua Buy Me A Coffee \u1edf du\u1edbi \u0111\u00e2y ho\u1eb7c \u1edf g\u00f3c ph\u1ea3i d\u01b0\u1edbi m\u00e0n h\u00ecnh.</p>"},{"location":"navigation/","title":"C\u00e1c t\u00e0i li\u1ec7u","text":"<ul> <li>Trang ch\u1ee7<ul> <li>Gi\u1edbi thi\u1ec7u</li> <li>C\u00e1c t\u00e0i li\u1ec7u</li> </ul> </li> <li>Codeforces<ul> <li>\u0110\u1ed3 th\u1ecb<ul> <li>C\u00e2y DFS v\u00e0 \u1ee9ng d\u1ee5ng</li> </ul> </li> <li>X\u1eed l\u00fd bit<ul> <li>K\u0129 thu\u1eadt Vector c\u01a1 s\u1edf cho c\u00e1c b\u00e0i to\u00e1n XOR</li> </ul> </li> <li>To\u00e1n h\u1ecdc<ul> <li>Floor, ceiling v\u00e0 b\u1ea5t \u0111\u1eb3ng th\u1ee9c cho ng\u01b0\u1eddi m\u1edbi h\u1ecdc</li> <li>T\u1ed5ng v\u00e0 Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng</li> <li>Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb</li> <li>Ho\u00e1n v\u1ecb cho ng\u01b0\u1eddi m\u1edbi b\u1eaft \u0111\u1ea7u</li> </ul> </li> <li>Hashing<ul> <li>Gi\u1ea3i m\u00e3 v\u00e0 ch\u1ed1ng hack cho unordered-map trong C++</li> </ul> </li> <li>C++<ul> <li>Ng\u01b0ng x\u00e0i rand() - T\u1ed5ng quan v\u1ec1 c\u00e1c tr\u00ecnh sinh s\u1ed1 ng\u1eabu nhi\u00ean trong C++</li> </ul> </li> <li>C\u00e1c thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean v\u00e0 g\u1ea7n \u0111\u00fang<ul> <li>L\u00e0m sao hack c\u00e1c solution ng\u1eabu nhi\u00ean v\u00e0 c\u00e1ch ng\u0103n ch\u1eb7n n\u00f3</li> </ul> </li> </ul> </li> <li>cp-algorithms<ul> <li>\u0110\u1ea1i s\u1ed1<ul> <li>Lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n</li> </ul> </li> <li>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u<ul> <li>C\u01a1 b\u1ea3n<ul> <li>Minimum Stack / Minimum Queue</li> <li>Sparse Table</li> </ul> </li> <li>C\u00e2y<ul> <li>Sqrt Tree</li> <li>Disjoint Set Union</li> </ul> </li> </ul> </li> <li>\u0110\u1ed3 th\u1ecb<ul> <li>\u0110\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t m\u1ed9t ngu\u1ed3n<ul> <li>0-1 BFS</li> </ul> </li> </ul> </li> <li>X\u1eed l\u00fd x\u00e2u<ul> <li>C\u00e1c b\u00e0i to\u00e1n ti\u00eau bi\u1ec3u<ul> <li>Ph\u00e2n t\u00edch bi\u1ec3u th\u1ee9c</li> </ul> </li> </ul> </li> <li>Kh\u00e1c<ul> <li>Kh\u00e1c<ul> <li>Thu\u1eadt to\u00e1n Floyd t\u00ecm chu tr\u00ecnh trong Linked List</li> </ul> </li> </ul> </li> </ul> </li> <li>Codechef<ul> <li>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u<ul> <li>Disjoint Sparse Table</li> </ul> </li> </ul> </li> <li>AtCoder<ul> <li>L\u1eddi gi\u1ea3i AtCoder Education DP Contest</li> </ul> </li> <li>LeetCode<ul> <li>L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a (Reservoir Sampling)</li> <li>T\u00ecm ki\u1ebfm tr\u00ean m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp nh\u01b0ng \u0111\u00e3 xoay</li> <li>T\u00ednh to\u00e1n bi\u1ec3u th\u1ee9c t\u1eeb x\u00e2u</li> <li>L\u1edbp b\u00e0i t\u1eadp Two-Sum</li> </ul> </li> <li>Ngu\u1ed3n kh\u00e1c<ul> <li>Ph\u00e2n t\u00edch \u0110\u1ed9 ph\u1ee9c t\u1ea1p<ul> <li>C\u00e1c k\u00fd hi\u1ec7u ti\u1ec7m c\u1eadn</li> <li>Ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng</li> </ul> </li> <li>Thu\u1eadt to\u00e1n<ul> <li>T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n v\u00e0 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \"chia \u0111\u00f4i\" kh\u00e1c</li> </ul> </li> <li>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u<ul> <li>Splay Tree: M\u1ed9t m\u00ecnh anh ch\u1ea5p h\u1ebft</li> </ul> </li> <li>X\u00e1c su\u1ea5t<ul> <li>X\u00e1c su\u1ea5t</li> <li>Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng</li> <li>K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh</li> </ul> </li> <li>Kinh nghi\u1ec7m<ul> <li>L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 gi\u1ecfi h\u01a1n trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u?</li> <li>Chi\u1ebfn thu\u1eadt khi thi ICPC</li> </ul> </li> </ul> </li> </ul>"},{"location":"AtCoder/dp-contest/","title":"L\u1eddi gi\u1ea3i AtCoder Education DP Contest","text":""},{"location":"AtCoder/dp-contest/#loi-giai-atcoder-education-dp-contest","title":"L\u1eddi gi\u1ea3i AtCoder Education DP Contest","text":""},{"location":"AtCoder/dp-contest/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>AtCoder Education DP Contest l\u00e0 m\u1ed9t contest r\u1ea5t hay c\u1ee7a AtCoder v\u1ec1 quy ho\u1ea1ch \u0111\u1ed9ng (Dynamic Programming). Contest n\u00e0y g\u1ed3m 26 b\u00e0i, m\u1ed7i b\u00e0i l\u00e0 m\u1ed9t ki\u1ec3u b\u00e0i DP kh\u00e1c nhau. C\u00e1 nh\u00e2n m\u00ecnh th\u1ea5y contest n\u00e0y r\u1ea5t th\u00fa v\u1ecb v\u00e0 \u0111\u00e1ng \u0111\u1ec3 ghi l\u1ea1i l\u1eddi gi\u1ea3i.</p> <p>C\u00e1c b\u1ea1n c\u00f3 th\u1ec3 xem \u0111\u1ec1 b\u00e0i t\u1ea1i \u0111\u00e2y.</p>"},{"location":"AtCoder/dp-contest/#cac-bai-tap","title":"C\u00e1c b\u00e0i t\u1eadp","text":""},{"location":"AtCoder/dp-contest/#a-frog-1","title":"A - Frog 1","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) vi\u00ean \u0111\u00e1, m\u1ed7i vi\u00ean \u0111\u00e1 \\(i\\) c\u00f3 chi\u1ec1u cao \\(h[i]\\). C\u00f3 m\u1ed9t con \u1ebfch \u1edf vi\u00ean \u0111\u00e1 \\(1\\) v\u00e0 mu\u1ed1n nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(N\\). \u1ede vi\u00ean \u0111\u00e1 \\(i\\), con \u1ebfch ch\u1ec9 c\u00f3 th\u1ec3 nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i+1\\) ho\u1eb7c \\(i+2\\). Chi ph\u00ed \u0111\u1ec3 nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(i\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(j\\) l\u00e0 \\(|h[i] - h[j]|\\). H\u00e3y t\u00ecm chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u1ec3 con \u1ebfch nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(1\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(N\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(2 \\leq N \\leq 10^5\\)</p> <p>\\(1 \\leq h[i] \\leq 10^4\\)</p> L\u1eddi gi\u1ea3i <p>Ta g\u1ecdi dp[i] l\u00e0 chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u1ec3 con \u1ebfch nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(1\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i\\). V\u00ec ban \u0111\u1ea7u con \u1ebfch \u1edf vi\u00ean \u0111\u00e1 \\(1\\), n\u00ean \\(dp[1] = 0\\). Ta c\u00f3 th\u1ec3 nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i\\) t\u1eeb vi\u00ean \u0111\u00e1 \\(i-1\\) (khi \\(i &gt; 1\\)) ho\u1eb7c t\u1eeb vi\u00ean \u0111\u00e1 \\(i-2\\) (khi $i &gt; 2). V\u1eady ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i] = \\min(dp[i-1] + |h[i] - h[i-1]|, dp[i-2] + |h[i] - h[i-2]|), \\forall i, 3 \\leq i \\leq N\\] <p>C\u00f2n khi \\(i = 2\\), ta ch\u1ec9 c\u00f3 th\u1ec3 nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(1\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(2\\), n\u00ean \\(dp[2] = dp[1] + |h[2] - h[1]|\\).</p> <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[N]\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3 d\u00f9ng m\u1ea3ng \\(dp\\) \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(N)\\)), ho\u1eb7c \u0111\u1ec3 \u00fd r\u1eb1ng ta ch\u1ec9 c\u1ea7n l\u01b0u 2 gi\u00e1 tr\u1ecb \\(dp[i-1]\\) v\u00e0 \\(dp[i-2]\\) \u0111\u1ec3 c\u1eadp nh\u1eadt \\(dp[i]\\), ta c\u00f3 th\u1ec3 l\u01b0u ch\u00fang v\u00e0o c\u00e1c bi\u1ebfn <code>dp_1</code> v\u00e0 <code>dp_2</code> \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(1)\\), t\u1ea5t nhi\u00ean l\u00e0 khi kh\u00f4ng t\u00ednh m\u1ea3ng \u0111\u1ea7u v\u00e0o).</p>"},{"location":"AtCoder/dp-contest/#b-frog-2","title":"B - Frog 2","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) vi\u00ean \u0111\u00e1, m\u1ed7i vi\u00ean \u0111\u00e1 \\(i\\) c\u00f3 chi\u1ec1u cao \\(h[i]\\). C\u00f3 m\u1ed9t con \u1ebfch \u1edf vi\u00ean \u0111\u00e1 \\(1\\) v\u00e0 mu\u1ed1n nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(N\\). Ngo\u00e0i ra ta c\u00f2n c\u00f3 th\u00eam m\u1ed9t s\u1ed1 nguy\u00ean \\(K\\). \u1ede vi\u00ean \u0111\u00e1 \\(i\\), con \u1ebfch ch\u1ec9 c\u00f3 th\u1ec3 nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i+1, i+2, ..., i+K\\). Chi ph\u00ed \u0111\u1ec3 nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(i\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(j\\) l\u00e0 \\(|h[i] - h[j]|\\). H\u00e3y t\u00ecm chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u1ec3 con \u1ebfch nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(1\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(N\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(2 \\leq N \\leq 10^5\\)</p> <p>\\(1 \\leq K \\leq 100\\)</p> <p>\\(1 \\leq h[i] \\leq 10^4\\)</p> L\u1eddi gi\u1ea3i <p>B\u00e0i tr\u00ean ch\u00ednh l\u00e0 b\u00e0i n\u00e0y v\u1edbi \\(K = 2\\). Ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng c\u00f9ng m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 gi\u1ea3i b\u00e0i n\u00e0y.</p> <p>G\u1ecdi \\(dp[i]\\) l\u00e0 chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u1ec3 con \u1ebfch nh\u1ea3y t\u1eeb vi\u00ean \u0111\u00e1 \\(1\\) \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i\\). V\u00ec ban \u0111\u1ea7u con \u1ebfch \u1edf vi\u00ean \u0111\u00e1 \\(1\\), n\u00ean \\(dp[1] = 0\\). \u0110\u1ec3 \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i\\), ta c\u00f3 th\u1ec3 nh\u1ea3y t\u1eeb c\u00e1c vi\u00ean \u0111\u00e1 \\(i-j\\), \\(\\forall j, 1 \\leq j \\leq K, i-j &gt; 0\\). V\u1eady ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i] = \\min_{1 \\leq j \\leq K, i-j &gt; 0}(dp[i-j] + |h[i] - h[i-j]|)\\] <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[N]\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(NK)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#c-vacation","title":"C - Vacation","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) ng\u00e0y, m\u1ed7i ng\u00e0y \\(i\\) c\u00f3 3 c\u00f4ng vi\u1ec7c A, B, C v\u00e0 m\u1ed7i c\u00f4ng vi\u1ec7c s\u1ebd mang l\u1ea1i m\u1ed9t s\u1ed1 \u0111i\u1ec3m \\(a[i], b[i], c[i]\\). C\u00f3 m\u1ed9t ng\u01b0\u1eddi mu\u1ed1n ch\u1ecdn m\u1ed9t c\u00f4ng vi\u1ec7c m\u1ed7i ng\u00e0y sao cho kh\u00f4ng ch\u1ecdn 2 c\u00f4ng vi\u1ec7c c\u00f9ng m\u1ed9t lo\u1ea1i li\u00ean ti\u1ebfp. H\u00e3y t\u00ecm c\u00e1ch ch\u1ecdn sao cho t\u1ed5ng \u0111i\u1ec3m l\u00e0 l\u1edbn nh\u1ea5t.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 10^5\\)</p> <p>\\(1 \\leq a[i], b[i], c[i] \\leq 10^4\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 t\u1ed5ng \u0111i\u1ec3m l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c sau \\(i\\) ng\u00e0y n\u1ebfu ch\u1ecdn c\u00f4ng vi\u1ec7c \\(j\\) v\u00e0o ng\u00e0y \\(i\\). \u1ede ng\u00e0y \\(i\\), ta c\u00f3 th\u1ec3 ch\u1ecdn c\u00f4ng vi\u1ec7c \\(j\\) n\u1ebfu \\(j\\) kh\u00f4ng tr\u00f9ng v\u1edbi c\u00f4ng vi\u1ec7c \\(k\\) \u1edf ng\u00e0y \\(i-1\\). V\u1eady ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i][j] = \\max(dp[i-1][k] + x[i][j]), \\forall k \\neq j\\] <p>Trong \u0111\u00f3 \\(x[i][j]\\) l\u00e0 \u0111i\u1ec3m c\u1ee7a c\u00f4ng vi\u1ec7c \\(j\\) v\u00e0o ng\u00e0y \\(i\\), ngh\u0129a l\u00e0 \\(x[i][j] = a[i]\\) n\u1ebfu \\(j = 0\\), \\(x[i][j] = b[i]\\) n\u1ebfu \\(j = 1\\), \\(x[i][j] = c[i]\\) n\u1ebfu \\(j = 2\\). Ban \u0111\u1ea7u ta c\u00f3 \\(dp[1][j] = x[1][j], \\forall j, 0 \\leq j \\leq 2\\).</p> <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(\\max(dp[N][j]), \\forall j, 0 \\leq j \\leq 2\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta \u0111\u1ec3 \u00fd r\u1eb1ng \\(dp[i]\\) ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o \\(dp[i-1]\\) n\u00ean ta c\u00f3 th\u1ec3 l\u01b0u 2 d\u00f2ng \\(dp\\) \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(1)\\), t\u1ea5t nhi\u00ean l\u00e0 khi kh\u00f4ng t\u00ednh m\u1ea3ng \u0111\u1ea7u v\u00e0o).</p>"},{"location":"AtCoder/dp-contest/#d-knapsack-1","title":"D - Knapsack 1","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) m\u00f3n h\u00e0ng, m\u1ed7i m\u00f3n h\u00e0ng \\(i\\) c\u00f3 kh\u1ed1i l\u01b0\u1ee3ng \\(w[i]\\) v\u00e0 gi\u00e1 tr\u1ecb \\(v[i]\\). C\u00f3 m\u1ed9t c\u00e1i t\u00fai c\u00f3 th\u1ec3 ch\u1ee9a t\u1ed1i \u0111a \\(W\\) kg. H\u00e3y ch\u1ecdn m\u1ed9t s\u1ed1 m\u00f3n h\u00e0ng sao cho t\u1ed5ng kh\u1ed1i l\u01b0\u1ee3ng kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 \\(W\\) v\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb l\u00e0 l\u1edbn nh\u1ea5t.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 100\\)</p> <p>\\(1 \\leq W \\leq 10^5\\)</p> <p>\\(1 \\leq w[i] \\leq W\\)</p> <p>\\(1 \\leq v[i] \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c sau khi ch\u1ecdn m\u1ed9t s\u1ed1 m\u00f3n h\u00e0ng t\u1eeb \\(1\\) \u0111\u1ebfn \\(i\\) sao cho t\u1ed5ng kh\u1ed1i l\u01b0\u1ee3ng b\u1eb1ng \\(j\\). V\u1eady ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i][j] = \\max \\begin{cases} dp[i-1][j] &amp; \\text{kh\u00f4ng ch\u1ecdn m\u00f3n h\u00e0ng th\u1ee9 } i \\\\ dp[i-1][j-w[i]] + v[i] &amp; \\text{ch\u1ecdn m\u00f3n h\u00e0ng th\u1ee9 } i \\text{, v\u00e0 khi } j \\leq w[i] \\end{cases}\\] <p>Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0][0] = 0\\), \\(dp[0][j] = -\\infty, \\forall j &gt; 0\\) v\u00ec ban \u0111\u1ea7u ch\u01b0a ch\u1ecdn m\u00f3n h\u00e0ng n\u00e0o n\u00ean kh\u00f4ng c\u00f3 gi\u00e1 tr\u1ecb n\u00e0o c\u1ea3.</p> <p>V\u00ec ta c\u00e1c gi\u00e1 tr\u1ecb kh\u00f4ng h\u1ee3p l\u1ec7 qu\u00e1 nh\u1ecf n\u00ean gi\u00e1 tr\u1ecb h\u1ee3p l\u1ec7 s\u1ebd l\u1ea5p \u0111\u1ea7y m\u1ea3ng \\(dp\\), v\u00ec v\u1eady ta kh\u00f4ng c\u1ea7n ph\u1ea3i lo l\u1eafng v\u1ec1 c\u00e1c gi\u00e1 tr\u1ecb kh\u00f4ng h\u1ee3p l\u1ec7 trong qu\u00e1 tr\u00ecnh truy h\u1ed3i.</p> <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(\\max(dp[N][j]), \\forall j, 0 \\leq j \\leq W\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(NW)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3</p> <ul> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(NW)\\)).</li> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) 1 chi\u1ec1u \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 c\u1ee7a i hi\u1ec7n t\u1ea1i, v\u1edbi c\u00f4ng th\u1ee9c truy h\u1ed3i \\(dp[j] = \\max(dp[j], dp[j-w[i]] + v[i])\\), v\u1edbi \\(j \\geq w[i]\\). Tuy nhi\u00ean v\u00ec ta c\u1ea7n c\u1eadp nh\u1eadt \\(dp[j]\\) v\u1edbi \\(dp[j-w[i]] + v[i]\\), trong \u0111\u00f3 \\(j-w[i] &lt; j\\), n\u00ean ta c\u1ea7n ph\u1ea3i duy\u1ec7t t\u1eeb \\(W\\) \u0111\u1ebfn \\(0\\) \u0111\u1ec3 tr\u00e1nh t\u00ednh to\u00e1n tr\u00f9ng l\u1eb7p. V\u1eady \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a c\u00e1ch n\u00e0y l\u00e0 \\(O(W)\\).</li> </ul>"},{"location":"AtCoder/dp-contest/#e-knapsack-2","title":"E - Knapsack 2","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) m\u00f3n h\u00e0ng, m\u1ed7i m\u00f3n h\u00e0ng \\(i\\) c\u00f3 kh\u1ed1i l\u01b0\u1ee3ng \\(w[i]\\) v\u00e0 gi\u00e1 tr\u1ecb \\(v[i]\\). C\u00f3 m\u1ed9t c\u00e1i t\u00fai c\u00f3 th\u1ec3 ch\u1ee9a t\u1ed1i \u0111a \\(W\\) kg. H\u00e3y ch\u1ecdn m\u1ed9t s\u1ed1 m\u00f3n h\u00e0ng sao cho t\u1ed5ng kh\u1ed1i l\u01b0\u1ee3ng kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 \\(W\\) v\u00e0 t\u1ed5ng gi\u00e1 tr\u1ecb l\u00e0 l\u1edbn nh\u1ea5t.</p> <p>V\u1ec1 c\u01a1 b\u1ea3n, b\u00e0i n\u00e0y gi\u1ed1ng h\u1ec7t b\u00e0i D - Knapsack 1, tuy nhi\u00ean v\u1edbi gi\u1edbi h\u1ea1n \\(W\\) l\u1edbn h\u01a1n nhi\u1ec1u nh\u01b0ng \\(v[i]\\) c\u0169ng nh\u1ecf h\u01a1n.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 100\\)</p> <p>\\(1 \\leq W \\leq 10^9\\)</p> <p>\\(1 \\leq w[i] \\leq W\\)</p> <p>\\(1 \\leq v[i] \\leq 10^3\\)</p> L\u1eddi gi\u1ea3i <p>B\u1ea1n c\u00f3 th\u1ec3 h\u01a1i r\u1ed1i m\u1ed9t ch\u00fat khi xem gi\u1edbi h\u1ea1n b\u00e0i to\u00e1n, v\u00ec gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \\(W\\) l\u00e0 \\(10^9\\). Tuy nhi\u00ean b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \\(v[i]\\) l\u00e0 \\(10^3\\), n\u00ean t\u1ed5ng gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c l\u00e0 \\(10^5\\). Ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \\(V\\) l\u00e0m chi\u1ec1u th\u1ee9 hai c\u1ee7a m\u1ea3ng \\(dp\\) gi\u1ed1ng nh\u01b0 \\(W\\) trong b\u00e0i g\u1ed1c.</p> <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 kh\u1ed1i l\u01b0\u1ee3ng nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c v\u1edbi \\(i\\) m\u00f3n h\u00e0ng \u0111\u1ea7u ti\u00ean sao cho t\u1ed5ng gi\u00e1 tr\u1ecb l\u00e0 \\(j\\). Ta c\u00f3 th\u1ec3 t\u00ednh \\(dp[i][j]\\) nh\u01b0 sau:</p> \\[dp[i][j] = \\min \\begin{cases} dp[i-1][j] &amp; \\text{kh\u00f4ng ch\u1ecdn m\u00f3n h\u00e0ng th\u1ee9 } i \\\\ dp[i-1][j-v[i]] + w[i] &amp; \\text{ch\u1ecdn m\u00f3n h\u00e0ng th\u1ee9 } i \\text{, v\u00e0 } j \\geq v[i] \\end{cases}\\] <p>Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0][0] = 0\\), \\(dp[0][j] = \\infty, \\forall j &gt; 0\\) v\u00ec ban \u0111\u1ea7u ch\u01b0a ch\u1ecdn m\u00f3n h\u00e0ng n\u00e0o n\u00ean kh\u00f4ng c\u00f3 kh\u1ed1i l\u01b0\u1ee3ng n\u00e0o c\u1ea3.</p> <p>V\u00ec c\u00e1c gi\u00e1 tr\u1ecb kh\u00f4ng h\u1ee3p l\u1ec7 qu\u00e1 l\u1edbn n\u00ean gi\u00e1 tr\u1ecb h\u1ee3p l\u1ec7 s\u1ebd l\u1ea5p \u0111\u1ea7y m\u1ea3ng \\(dp\\), v\u00ec v\u1eady ta kh\u00f4ng c\u1ea7n ph\u1ea3i lo l\u1eafng v\u1ec1 c\u00e1c gi\u00e1 tr\u1ecb kh\u00f4ng h\u1ee3p l\u1ec7 trong qu\u00e1 tr\u00ecnh truy h\u1ed3i.</p> <p>K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \\(j\\) sao cho \\(dp[N][j] \\leq W\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N \\sum v[i])\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3</p> <ul> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(N \\sum v[i])\\)).</li> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) 1 chi\u1ec1u \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 c\u1ee7a i hi\u1ec7n t\u1ea1i, v\u1edbi c\u00f4ng th\u1ee9c truy h\u1ed3i \\(dp[j] = \\min(dp[j], dp[j-v[i]] + w[i])\\), v\u1edbi \\(j \\geq v[i]\\). Tuy nhi\u00ean v\u00ec ta c\u1ea7n c\u1eadp nh\u1eadt \\(dp[j]\\) v\u1edbi \\(dp[j-v[i]] + w[i]\\), trong \u0111\u00f3 \\(j-v[i] &lt; j\\), n\u00ean ta c\u1ea7n ph\u1ea3i duy\u1ec7t t\u1eeb \\(\\sum v[i]\\) \u0111\u1ebfn \\(0\\) \u0111\u1ec3 tr\u00e1nh t\u00ednh to\u00e1n tr\u00f9ng l\u1eb7p. V\u1eady \u0111\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a c\u00e1ch n\u00e0y l\u00e0 \\(O(\\sum v[i])\\).</li> </ul>"},{"location":"AtCoder/dp-contest/#f-lcs","title":"F - LCS","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho 2 x\u00e2u \\(s\\) v\u00e0 \\(t\\). H\u00e3y t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con chung d\u00e0i nh\u1ea5t c\u1ee7a 2 x\u00e2u.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq |s|, |t| \\leq 3000\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con chung d\u00e0i nh\u1ea5t c\u1ee7a \\(s[1..i]\\) v\u00e0 \\(t[1..j]\\). Ta c\u00f3 th\u1ec3 t\u00ednh \\(dp[i][j]\\) nh\u01b0 sau:</p> \\[dp[i][j] = \\begin{cases} dp[i-1][j-1] + 1 &amp; \\text{n\u1ebfu } s[i] = t[j] \\\\ \\max(dp[i-1][j], dp[i][j-1]) &amp; \\text{ng\u01b0\u1ee3c l\u1ea1i} \\end{cases}\\] <p>\u0110\u1ed9 d\u00e0i c\u1ee7a d\u00e3y con chung d\u00e0i nh\u1ea5t c\u1ee7a \\(s\\) v\u00e0 \\(t\\) s\u1ebd l\u00e0 \\(dp[|s|][|t|]\\). Tuy nhi\u00ean ta c\u1ea7n ph\u1ea3i truy v\u1ebft \u0111\u1ec3 t\u00ecm m\u1ed9t d\u00e3y con chung d\u00e0i nh\u1ea5t n\u00e0o \u0111\u00f3. Ta c\u00f3 th\u1ec3 truy v\u1ebft nh\u01b0 sau:</p> <ul> <li>\u0110\u1ea7u ti\u00ean, ta kh\u1edfi t\u1ea1o 2 bi\u1ebfn \\(i = |s|\\) v\u00e0 \\(j = |t|\\).</li> <li>N\u1ebfu \\(s[i] = t[j]\\), ta th\u00eam \\(s[i]\\) v\u00e0o d\u00e3y con chung v\u00e0 gi\u1ea3m \\(i\\) v\u00e0 \\(j\\) \u0111i \\(1\\).</li> <li>N\u1ebfu \\(dp[i-1][j] &gt; dp[i][j-1]\\), ta gi\u1ea3m \\(i\\) \u0111i \\(1\\).</li> <li>Ng\u01b0\u1ee3c l\u1ea1i, ta gi\u1ea3m \\(j\\) \u0111i \\(1\\).</li> </ul> <p>Nh\u1edb \u0111\u1ea3o ng\u01b0\u1ee3c d\u00e3y con chung \u0111\u1ec3 c\u00f3 k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(NM)\\), v\u1edbi \\(n = |s|\\) v\u00e0 \\(m = |t|\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(NM)\\).</p>"},{"location":"AtCoder/dp-contest/#g-longest-path","title":"G - Longest Path","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng chu tr\u00ecnh \\(G\\) v\u1edbi \\(N\\) \u0111\u1ec9nh v\u00e0 \\(M\\) c\u1ea1nh. H\u00e3y t\u00ecm \u0111\u1ed9 d\u00e0i c\u1ee7a \u0111\u01b0\u1eddng \u0111i d\u00e0i nh\u1ea5t trong \u0111\u1ed3 th\u1ecb.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(2 \\leq N \\leq 10^5\\)</p> <p>\\(1 \\leq M \\leq 10^5\\)</p> L\u1eddi gi\u1ea3i <p>V\u00ec \u0111\u1ed3 th\u1ecb \\(G\\) kh\u00f4ng ch\u1ee9a chu tr\u00ecnh, n\u00f3 l\u00e0 m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng chu tr\u00ecnh (directed acyclic graph - DAG), v\u00ec th\u1ebf ta c\u00f3 th\u1ec3 d\u00f9ng dp \u1edf \u0111\u00e2y.</p> <p>G\u1ecdi \\(dp[u]\\) l\u00e0 \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i d\u00e0i nh\u1ea5t b\u1eaft \u0111\u1ea7u t\u1eeb \u0111\u1ec9nh \\(u\\). Ban \u0111\u1ea7u ta c\u00f3 \\(dp[u] = 0\\) v\u1edbi m\u1ecdi \\(u\\).</p> <p>Ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \\(dp[u] = \\max(dp[v] + 1)\\) v\u1edbi m\u1ecdi \\(v\\) m\u00e0 c\u00f3 c\u1ea1nh t\u1eeb \\(u\\) \u0111\u1ebfn \\(v\\). Tuy nhi\u00ean ta c\u1ea7n ph\u1ea3i ch\u1eafc ch\u1eafn r\u1eb1ng ta \u0111\u00e3 t\u00ednh \\(dp[v]\\) tr\u01b0\u1edbc khi t\u00ednh \\(dp[u]\\). V\u00ec v\u1eady ta c\u1ea7n ph\u1ea3i s\u1eafp x\u1ebfp topo \u0111\u1ec3 ch\u1eafc ch\u1eafn r\u1eb1ng trong qu\u00e1 tr\u00ecnh t\u00ednh to\u00e1n, t\u1ea5t c\u1ea3 \\(dp[v]\\) \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh tr\u01b0\u1edbc khi t\u00ednh \\(dp[u]\\). Sau khi s\u1eafp x\u1ebfp topo, gi\u1ea3 s\u1eed r\u1eb1ng n\u00f3 \u0111ang x\u1ebfp \\(u\\) tr\u01b0\u1edbc \\(v\\) (v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh \\((u, v)\\)), ta duy\u1ec7t ng\u01b0\u1ee3c t\u1eeb cu\u1ed1i v\u1ec1 \u0111\u1ea7u, v\u1edbi m\u1ed7i c\u1ea1nh \\((i, j)\\) khi \u0111ang x\u00e9t \u0111\u1ec9nh \\(i\\), ta c\u1eadp nh\u1eadt \\(dp[i] = \\max(dp[i], dp[j] + 1)\\).</p> <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(\\max(dp[u])\\) v\u1edbi m\u1ecdi \\(u\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N+M)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#h-grid-1","title":"H - Grid 1","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho m\u1ed9t b\u1ea3ng \\(N \\times M\\) v\u1edbi m\u1ed7i \u00f4 \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u l\u00e0 c\u00f3 ho\u1eb7c kh\u00f4ng th\u1ec3 \u0111i v\u00e0o. H\u00e3y t\u00ecm s\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111i t\u1eeb \u00f4 \\((1, 1)\\) \u0111\u1ebfn \u00f4 \\((N, M)\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N, M \\leq 1000\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 s\u1ed1 c\u00e1ch \u0111\u1ec3 \u0111i t\u1eeb \u00f4 \\((1, 1)\\) \u0111\u1ebfn \u00f4 \\((i, j)\\). Ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \u00f4 \\((i, j)\\) ch\u1ec9 c\u00f3 th\u1ec3 \u0111i t\u1eeb \u00f4 \\((i-1, j)\\) ho\u1eb7c \\((i, j-1)\\). V\u1eady ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i][j] = \\begin{cases} dp[i-1][j] + dp[i][j-1] &amp; \\text{n\u1ebfu } \\text{grid}[i][j] = 1 \\\\ 0 &amp; \\text{ng\u01b0\u1ee3c l\u1ea1i} \\end{cases}\\] <p>Ban \u0111\u1ea7u ta c\u00f3 \\(dp[1][1] = 1\\) v\u00ec ch\u1ec9 c\u00f3 m\u1ed9t c\u00e1ch \u0111\u1ec3 \u0111i t\u1eeb \u00f4 \\((1, 1)\\) \u0111\u1ebfn \u00f4 \\((1, 1)\\). V\u1edbi tr\u1ea1ng th\u00e1i \u0111\u1ea7u ti\u00ean l\u00e0 \\(dp[1][1]\\), ta c\u00f3 th\u1ec3 \u0111\u1eb7t gi\u00e1 tr\u1ecb c\u00e1c \u00f4 \\(\\text{grid}[0][j]\\) v\u00e0 \\(\\text{grid}[i][0]\\) l\u00e0 0 v\u00ec c\u00e1c \u00f4 n\u00e0y kh\u00f4ng th\u1ec3 \u0111i v\u00e0o, t\u1eeb \u0111\u00f3 gi\u00fap t\u00ednh to\u00e1n d\u1ec5 d\u00e0ng h\u01a1n khi kh\u00f4ng ph\u1ea3i x\u00e9t nhi\u1ec1u \u0111i\u1ec1u ki\u1ec7n \u1edf bi\u00ean tr\u00ean v\u00e0 b\u00ean tr\u00e1i.</p> <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[N][M]\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(NM)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3</p> <ul> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(NM)\\)).</li> <li>Ta th\u1ea5y r\u1eb1ng \\(dp[i]\\) ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o \\(dp[i-1]\\). V\u1eady ta c\u00f3 th\u1ec3 l\u01b0u 2 d\u00f2ng \\(dp\\) \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(M)\\)).</li> </ul>"},{"location":"AtCoder/dp-contest/#i-coins","title":"I - Coins","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) \u0111\u1ed3ng xu (\\(N\\) l\u00e0 s\u1ed1 l\u1ebb), m\u1ed7i \u0111\u1ed3ng xu \\(i\\) c\u00f3 x\u00e1c su\u1ea5t \\(p[i]\\) \u0111\u1ec3 ra m\u1eb7t ng\u1eeda. H\u00e3y t\u00ednh x\u00e1c su\u1ea5t \u0111\u1ec3 c\u00f3 s\u1ed1 m\u1eb7t ng\u1eeda nhi\u1ec1u h\u01a1n s\u1ed1 m\u1eb7t s\u1ea5p.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 2999\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 c\u00f3 \\(j\\) m\u1eb7t ng\u1eeda sau khi tung \\(i\\) \u0111\u1ed3ng xu. Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0][0] = 1\\) v\u00ec ta b\u1eaft \u0111\u1ea7u t\u1eeb vi\u1ec7c tung \\(0\\) \u0111\u1ed3ng xu v\u00e0 c\u00f3 \\(0\\) m\u1eb7t ng\u1eeda. Ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i][j] = \\begin{cases} dp[i-1][j] \\cdot (1 - p[i]) &amp; \\text{n\u1ebfu } j = 0 \\\\ dp[i-1][j-1] \\cdot p[i] + dp[i-1][j] \\cdot (1 - p[i]) &amp; \\text{ng\u01b0\u1ee3c l\u1ea1i, l\u1ea7n l\u01b0\u1ee3t khi g\u1eb7p m\u1eb7t ng\u1eeda v\u00e0 m\u1eb7t s\u1ea5p} \\end{cases}\\] <p>K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 t\u1ed5ng c\u1ee7a \\(dp[N][j]\\) v\u1edbi \\(j\\) t\u1eeb \\(N/2+1\\) \u0111\u1ebfn \\(N\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3</p> <ul> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(N^2)\\)).</li> <li>Ta th\u1ea5y r\u1eb1ng \\(dp[i]\\) ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o \\(dp[i-1]\\). V\u1eady ta c\u00f3 th\u1ec3 l\u01b0u 2 d\u00f2ng \\(dp\\) \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(N)\\)).</li> </ul>"},{"location":"AtCoder/dp-contest/#j-sushi","title":"J - Sushi","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) d\u0129a sushi, d\u0129a th\u1ee9 \\(i\\) c\u00f3 \\(a[i]\\) mi\u1ebfng sushi. B\u1ea1n s\u1ebd th\u1ef1c hi\u1ec7n tung x\u00fac x\u1eafc c\u00f3 \\(N\\) m\u1eb7t, m\u1ed7i m\u1eb7t c\u00f3 m\u1ed9t s\u1ed1 t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\). N\u1ebfu tung m\u1eb7t \\(i\\), b\u1ea1n s\u1ebd \u0103n m\u1ed9t mi\u1ebfng sushi t\u1eeb d\u0129a \\(i\\), n\u1ebfu d\u0129a \\(i\\) kh\u00f4ng c\u00f3 mi\u1ebfng sushi n\u00e0o th\u00ec kh\u00f4ng \u0103n g\u00ec c\u1ea3. C\u1ee9 l\u00e0m nh\u01b0 v\u1eady cho \u0111\u1ebfn khi kh\u00f4ng c\u00f2n mi\u1ebfng sushi n\u00e0o. H\u00e3y t\u00ednh k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung x\u00fac x\u1eafc \u0111\u1ec3 \u0103n h\u1ebft sushi.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 300\\)</p> <p>\\(1 \\leq a[i] \\leq 3\\)</p> L\u1eddi gi\u1ea3i <p>B\u00e0i n\u00e0y c\u1ea7n m\u1ed9t \u00edt ki\u1ebfn th\u1ee9c v\u1ec1 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng \u0111\u1ec3 gi\u1ea3i, b\u1ea1n vui l\u00f2ng t\u00ecm hi\u1ec3u tr\u01b0\u1edbc qua c\u00e1c b\u00e0i d\u1ecbch c\u1ee7a m\u00ecnh tr\u00ean blog n\u00e0y nh\u00e9.</p> <p>G\u1ecdi \\(dp[i][j][k]\\) l\u00e0 s\u1ed1 l\u1ea7n tung x\u00fac x\u1eafc \u0111\u1ec3 \u0103n h\u1ebft sushi, trong \u0111\u00f3</p> <ul> <li>\\(i\\) l\u00e0 s\u1ed1 d\u0129a sushi c\u00f3 \\(1\\) mi\u1ebfng sushi</li> <li>\\(j\\) l\u00e0 s\u1ed1 d\u0129a sushi c\u00f3 \\(2\\) mi\u1ebfng sushi</li> <li>\\(k\\) l\u00e0 s\u1ed1 d\u0129a sushi c\u00f3 \\(3\\) mi\u1ebfng sushi</li> </ul> <p>Ta d\u1ec5 d\u00e0ng suy ra \u0111\u01b0\u1ee3c \\(x = N - i - j - k\\) l\u00e0 s\u1ed1 d\u0129a sushi kh\u00f4ng c\u00f2n mi\u1ebfng sushi n\u00e0o.</p> <p>Ta d\u00f9ng dp top-down \u0111\u1ec3 d\u1ec5 h\u00ecnh dung, b\u1eaft \u0111\u1ea7u t\u1eeb \\(dp[cnt[1]][cnt[2]][cnt[3]]\\), v\u1edbi \\(cnt[i]\\) l\u00e0 s\u1ed1 d\u0129a sushi c\u00f3 \\(i\\) mi\u1ebfng sushi.</p> <p>Tr\u01b0\u1eddng h\u1ee3p c\u01a1 b\u1ea3n l\u00e0 khi kh\u00f4ng c\u00f2n mi\u1ebfng sushi n\u00e0o, s\u1ed1 l\u1ea7n tung x\u00fac x\u1eafc s\u1ebd l\u00e0 \\(0\\). V\u1edbi m\u1ed7i l\u1ea7n tung x\u00fac x\u1eafc, ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[\\begin{align} dp[i][j][k] &amp;= \\frac{x}{n} \\cdot (dp[i][j][k] + 1) \\text{ (n\u1ebfu ch\u1ecdn d\u0129a sushi kh\u00f4ng c\u00f2n mi\u1ebfng sushi n\u00e0o)} \\\\ &amp;+ \\frac{i}{n} \\cdot (dp[i-1][j][k] + 1) \\text{ (n\u1ebfu } i &gt; 0 \\text{ v\u00e0 ch\u1ecdn d\u0129a sushi c\u00f3 } 1 \\text{ mi\u1ebfng sushi)} \\\\ &amp;+ \\frac{j}{n} \\cdot (dp[i+1][j-1][k] + 1) \\text{ (n\u1ebfu } j &gt; 0 \\text{ v\u00e0 ch\u1ecdn d\u0129a sushi c\u00f3 } 2 \\text{ mi\u1ebfng sushi)} \\\\ &amp;+ \\frac{k}{n} \\cdot (dp[i][j+1][k-1] + 1) \\text{ (n\u1ebfu } k &gt; 0 \\text{ v\u00e0 ch\u1ecdn d\u0129a sushi c\u00f3 } 3 \\text{ mi\u1ebfng sushi)} \\end{align}\\] <p>Chuy\u1ec3n v\u1ebf \\(dp[i][j][k]\\) sang tr\u00e1i v\u00e0 r\u00fat g\u1ecdn ph\u01b0\u01a1ng tr\u00ecnh, ta c\u00f3</p> \\[dp[i][j][k] = \\frac{x + i \\cdot (dp[i-1][j][k] + 1) + j \\cdot (dp[i+1][j-1][k] + 1) + k \\cdot (dp[i][j+1][k-1] + 1)}{n - x}\\] <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^3)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^3)\\).</p>"},{"location":"AtCoder/dp-contest/#k-stones","title":"K - Stones","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho t\u1eadp $A = {a_1, a_2, ..., a_N} g\u1ed3m \\(N\\) s\u1ed1 nguy\u00ean d\u01b0\u01a1ng. Taro v\u00e0 Jiro s\u1ebd ch\u01a1i m\u1ed9t tr\u00f2 ch\u01a1i nh\u01b0 sau. Ban \u0111\u1ea7u ta c\u00f3 m\u1ed9t \u0111\u1ed1ng \u0111\u00e1 g\u1ed3m \\(K\\) vi\u00ean \u0111\u00e1. Ng\u01b0\u1eddi \u0111\u1ebfn l\u01b0\u1ee3t ph\u1ea3i ch\u1ecdn m\u1ed9t ph\u1ea7n t\u1eed trong t\u1eadp \\(A\\), gi\u1ea3 s\u1eed l\u00e0 \\(x\\), v\u00e0 l\u1ea5y \u0111i \u0111\u00fang \\(x\\) vi\u00ean \u0111\u00e1 t\u1eeb \u0111\u1ed1ng \u0111\u00e1. Taro ch\u01a1i tr\u01b0\u1edbc. Ng\u01b0\u1eddi n\u00e0o kh\u00f4ng th\u1ec3 th\u1ef1c hi\u1ec7n \u0111\u00fang thao t\u00e1c \u0111\u00f3 s\u1ebd thua. Gi\u1ea3 s\u1eed c\u1ea3 hai \u0111\u1ec1u ch\u01a1i m\u1ed9t c\u00e1ch t\u1ed1i \u01b0u, h\u00e3y x\u00e1c \u0111\u1ecbnh ng\u01b0\u1eddi chi\u1ebfn th\u1eafng.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 100\\)</p> <p>\\(1 \\leq K \\leq 10^5\\)</p> <p>\\(1 \\leq a_1 &lt; a_2 &lt; ... &lt; a_N \\leq K\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i]\\) l\u00e0 k\u1ebft qu\u1ea3 c\u1ee7a tr\u00f2 ch\u01a1i n\u1ebfu c\u00f2n \\(i\\) vi\u00ean \u0111\u00e1. Ta s\u1ebd c\u00f3 \\(dp[i] = 1\\) n\u1ebfu ng\u01b0\u1eddi ch\u01a1i hi\u1ec7n t\u1ea1i th\u1eafng, ng\u01b0\u1ee3c l\u1ea1i th\u00ec \\(dp[i] = 0\\). Ta c\u00f3 th\u1ec3 d\u00f9ng dp top-down \u0111\u1ec3 d\u1ec5 h\u00ecnh dung, b\u1eaft \u0111\u1ea7u t\u1eeb \\(dp[K]\\).</p> <p>\u1ede m\u1ed7i tr\u1ea1ng th\u00e1i \\(i\\), ta c\u00f3 \\(N\\) l\u1ef1a ch\u1ecdn, n\u1ebfu c\u00f3 \u00edt nh\u1ea5t m\u1ed9t l\u1ef1a ch\u1ecdn d\u1eabn \u0111\u1ebfn tr\u1ea1ng th\u00e1i thua (t\u1ee9c l\u00e0 \\(dp[i - a[j]] = 0\\)), ta c\u00f3 th\u1ec3 ch\u1ecdn l\u1ef1a ch\u1ecdn \u0111\u00f3 \u0111\u1ec3 th\u1eafng, ng\u01b0\u1ee3c l\u1ea1i th\u00ec ta s\u1ebd thua.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(KN)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(K)\\).</p>"},{"location":"AtCoder/dp-contest/#l-deque","title":"L - Deque","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Taro v\u00e0 Jiro ch\u01a1i m\u1ed9t tr\u00f2 ch\u01a1i nh\u01b0 sau. Cho m\u1ed9t d\u00e3y s\u1ed1 \\(a\\) g\u1ed3m \\(N\\) ph\u1ea7n t\u1eed. Ng\u01b0\u1eddi \u0111\u1ebfn l\u01b0\u1ee3t ph\u1ea3i ch\u1ecdn m\u1ed9t \u0111\u1ea7u c\u1ee7a d\u00e3y s\u1ed1 v\u00e0 l\u1ea5y ph\u1ea7n t\u1eed \u0111\u00f3. Taro ch\u01a1i tr\u01b0\u1edbc. G\u1ecdi \\(X\\) v\u00e0 \\(Y\\) l\u1ea7n l\u01b0\u1ee3t l\u00e0 t\u1ed5ng s\u1ed1 \u0111i\u1ec3m c\u1ee7a Taro v\u00e0 Jiro. Taro mu\u1ed1n t\u1ed1i \u0111a h\u00f3a \\(X - Y\\), c\u00f2n Jiro mu\u1ed1n t\u1ed1i thi\u1ec3u h\u00f3a \\(X - Y\\). H\u00e3y x\u00e1c \u0111\u1ecbnh gi\u00e1 tr\u1ecb c\u1ee7a \\(X - Y\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 3000\\)</p> <p>\\(1 \\leq a[i] \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 \u0111i\u1ec3m c\u1ee7a tr\u00f2 ch\u01a1i n\u1ebfu ch\u00fang ta c\u00f2n l\u1ea1i d\u00e3y con t\u1eeb \\(i\\) \u0111\u1ebfn \\(j\\). Ta c\u00f3 th\u1ec3 d\u00f9ng dp top-down \u0111\u1ec3 d\u1ec5 h\u00ecnh dung, b\u1eaft \u0111\u1ea7u t\u1eeb \\(dp[1][n]\\) v\u00ec Taro b\u1eaft \u0111\u1ea7u ch\u01a1i c\u00f2n c\u1ea3 d\u00e3y.</p> <p>Do \u0111i\u1ec3m c\u1ee7a tr\u00f2 ch\u01a1i l\u00e0 \\(P = X - Y\\), trong \u0111\u00f3 \\(X\\) l\u00e0 \u0111i\u1ec3m c\u1ee7a Taro v\u00e0 \\(Y\\) l\u00e0 \u0111i\u1ec3m c\u1ee7a Jiro, n\u00ean n\u1ebfu l\u00e0 l\u01b0\u1ee3t c\u1ee7a Taro, ta c\u1ed9ng ph\u1ea7n t\u1eed \u0111\u00e3 ch\u1ecdn v\u00e0o \\(P\\), ng\u01b0\u1ee3c l\u1ea1i, ta tr\u1eeb ph\u1ea7n t\u1eed \u0111\u00e3 ch\u1ecdn kh\u1ecfi \\(P\\).</p> <p>Khoan \u0111\u00e3, l\u00e0m sao ta bi\u1ebft v\u1edbi tr\u1ea1ng th\u00e1i \\(i, j\\) hi\u1ec7n t\u1ea1i, \u0111\u00f3 l\u00e0 l\u01b0\u1ee3t c\u1ee7a ai?</p> <ul> <li>Ta c\u00f3 th\u1ec3 th\u00eam m\u1ed9t chi\u1ec1u n\u1eefa v\u00e0o m\u1ea3ng \\(dp\\) \u0111\u1ec3 l\u01b0u l\u01b0\u1ee3t ch\u01a1i, 0 cho Taro, 1 cho Jiro.</li> <li>Ho\u1eb7c c\u00f3 m\u1ed9t c\u00e1ch kh\u00e1c, \u0111\u1ec3 \u00fd r\u1eb1ng n\u1ebfu \u0111\u1ebfn l\u01b0\u1ee3t Taro, t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i d\u00e3y con hi\u1ec7n t\u1ea1i s\u1ebd b\u1eb1ng v\u1edbi t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i d\u00e3y ban \u0111\u1ea7u, n\u1ebfu kh\u00f4ng b\u1eb1ng th\u00ec l\u00e0 l\u01b0\u1ee3t c\u1ee7a Jiro.</li> </ul> <p>Tr\u1ea1ng th\u00e1i c\u01a1 b\u1ea3n l\u00e0 khi ta c\u00f2n l\u1ea1i m\u1ed9t ph\u1ea7n t\u1eed trong d\u00e3y con, hay \\(i = j\\), \u0111i\u1ec3m c\u1ee7a tr\u00f2 ch\u01a1i s\u1ebd l\u00e0 \\(a[i]\\) n\u1ebfu l\u00e0 l\u01b0\u1ee3t c\u1ee7a Taro, \\(-a[i]\\) n\u1ebfu l\u00e0 l\u01b0\u1ee3t c\u1ee7a Jiro.</p> <p>V\u1edbi c\u00f4ng th\u1ee9c truy h\u1ed3i th\u00ec, ta bi\u1ebft r\u1eb1ng Taro mu\u1ed1n t\u1ed1i \u0111a h\u00f3a \\(P\\), n\u00ean ta ch\u1ecdn ph\u1ea7n t\u1eed \u1edf \u0111\u1ea7u ho\u1eb7c cu\u1ed1i d\u00e3y con sao cho \\(P\\) l\u1edbn nh\u1ea5t. Ng\u01b0\u1ee3c l\u1ea1i, Jiro mu\u1ed1n t\u1ed1i thi\u1ec3u h\u00f3a \\(P\\), n\u00ean ta ch\u1ecdn ph\u1ea7n t\u1eed sao cho \\(P\\) nh\u1ecf nh\u1ea5t.</p> \\[dp[i][j] = \\begin{cases} \\max(dp[i+1][j] + a[i], dp[i][j-1] + a[j]) &amp; \\text{n\u1ebfu l\u00e0 l\u01b0\u1ee3t c\u1ee7a Taro} \\\\ \\min(dp[i+1][j] - a[i], dp[i][j-1] - a[j]) &amp; \\text{n\u1ebfu l\u00e0 l\u01b0\u1ee3t c\u1ee7a Jiro} \\end{cases}\\] <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\).</p>"},{"location":"AtCoder/dp-contest/#m-candies","title":"M - Candies","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) h\u1ecdc sinh v\u00e0 \\(K\\) vi\u00ean k\u1eb9o. Ta c\u1ea7n chia \\(K\\) vi\u00ean k\u1eb9o cho \\(N\\) h\u1ecdc sinh n\u00e0y sao cho m\u1ed7i h\u1ecdc sinh nh\u1eadn \u0111\u01b0\u1ee3c t\u1eeb \\(0\\) \u0111\u1ebfn \\(a[i]\\) vi\u00ean k\u1eb9o. Sau khi chia ta kh\u00f4ng c\u00f2n vi\u00ean k\u1eb9o n\u00e0o. H\u00e3y t\u00ednh s\u1ed1 c\u00e1ch chia k\u1eb9o mod \\(10^9 + 7\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 100\\)</p> <p>\\(0 \\leq a[i] \\leq K \\leq 10^5\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 s\u1ed1 c\u00e1ch chia k\u1eb9o cho \\(i\\) h\u1ecdc sinh sao cho t\u1ed5ng s\u1ed1 k\u1eb9o l\u00e0 \\(j\\). Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0][0] = 1\\).</p> <p>Ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[dp[i][j] = \\sum_{x=0, j-x \\geq 0}^{a[i]} dp[i-1][j-x]\\] <p>N\u1ebfu c\u00e0i \u0111\u00fang nh\u01b0 tr\u00ean th\u00ec \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 \\(O(NK^2)\\), qu\u00e1 ch\u1eadm. Ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng \\(dp[i][j]\\) c\u1ea7n t\u1ed5ng c\u1ee7a \\(dp[i-1]\\) t\u1eeb \\(j-a[i]\\) \u0111\u1ebfn \\(j\\), v\u1eady ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a \\(sum[i][j]\\) l\u00e0 t\u1ed5ng c\u1ee7a \\(dp[i]\\) t\u1eeb \\(dp[i][0]\\) \u0111\u1ebfn \\(dp[i][j]\\). Ta c\u00f3 th\u1ec3 t\u00ednh \\(sum[i]\\) c\u00f9ng v\u1edbi \\(dp[i]\\).</p> <p>V\u1eady ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i m\u1edbi:</p> \\[dp[i][j] = \\begin{cases} sum[i-1][j] - sum[i-1][j-a[i]-1] &amp; \\text{n\u1ebfu } j &gt; a[i] \\\\ sum[i-1][j] &amp; \\text{ng\u01b0\u1ee3c l\u1ea1i} \\end{cases}\\] <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(NK)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3</p> <ul> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) v\u00e0 \\(sum\\) \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(NK)\\)).</li> <li>Ta th\u1ea5y r\u1eb1ng \\(dp[i]\\) ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o \\(dp[i-1]\\). V\u1eady ta c\u00f3 th\u1ec3 l\u01b0u 2 d\u00f2ng \\(dp\\) v\u00e0 \\(sum\\) \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(K)\\)).</li> </ul>"},{"location":"AtCoder/dp-contest/#n-slimes","title":"N - Slimes","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) vi\u00ean slime, vi\u00ean slime th\u1ee9 \\(i\\) c\u00f3 k\u00edch th\u01b0\u1edbc \\(a[i]\\). Ta th\u1ef1c hi\u1ec7n thao t\u00e1c sau cho \u0111\u1ebfn khi ch\u1ec9 c\u00f2n m\u1ed9t vi\u00ean slime:</p> <ul> <li>Ch\u1ecdn hai vi\u00ean slime c\u1ea1nh nhau, tr\u1ed9n l\u1ea1i v\u1edbi nhau \u0111\u1ec3 t\u1ea1o ra m\u1ed9t vi\u00ean slime m\u1edbi. Vi\u00ean slime m\u1edbi c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng t\u1ed5ng k\u00edch th\u01b0\u1edbc c\u1ee7a hai vi\u00ean slime c\u0169. Thao t\u00e1c n\u00e0y c\u00f3 gi\u00e1 tr\u1ecb c\u0169ng b\u1eb1ng t\u1ed5ng k\u00edch th\u01b0\u1edbc c\u1ee7a hai vi\u00ean slime c\u0169.</li> </ul> <p>H\u00e3y t\u00ednh gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c khi th\u1ef1c hi\u1ec7n \u0111\u1ebfn khi ch\u1ec9 c\u00f2n m\u1ed9t vi\u00ean slime.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(2 \\leq N \\leq 400\\)</p> <p>\\(1 \\leq a[i] \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c khi tr\u1ed9n t\u1eeb vi\u00ean slime \\(i\\) \u0111\u1ebfn vi\u00ean slime \\(j\\) \u0111\u1ec3 c\u00f3 m\u1ed9t vi\u00ean slime duy nh\u1ea5t. K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[1][n]\\). Ban \u0111\u1ea7u ta c\u00f3 \\(dp[i][i] = 0\\) v\u00ec kh\u00f4ng c\u1ea7n ph\u1ea3i l\u00e0m g\u00ec c\u1ea3.</p> <p>V\u1edbi m\u1ed7i c\u1eb7p \\((i, j)\\) (v\u1edbi \\(i &lt; j\\)), ta c\u00f3 th\u1ec3 chia d\u00e3y th\u00e0nh 2 ph\u1ea7n t\u1ea1i v\u1ecb tr\u00ed \\(k\\) (\\(i \\leq k &lt; j\\)):</p> <ul> <li>Ta tr\u1ed9n ph\u1ea7n b\u00ean tr\u00e1i tr\u01b0\u1edbc, sau \u0111\u00f3 \u0111\u1ebfn ph\u1ea7n b\u00ean ph\u1ea3i.</li> <li>Gi\u00e1 tr\u1ecb \u0111\u1ec3 tr\u1ed9n ph\u1ea7n b\u00ean tr\u00e1i l\u00e0 \\(dp[i][k]\\), ph\u1ea7n b\u00ean ph\u1ea3i l\u00e0 \\(dp[k+1][j]\\).</li> <li>Gi\u00e1 tr\u1ecb \u0111\u1ec3 tr\u1ed9n c\u1ea3 d\u00e3y l\u00e0 \\(dp[i][k] + dp[k+1][j] + \\text{sum}[i][j]\\) (v\u1edbi \\(\\text{sum}[i][j]\\) l\u00e0 t\u1ed5ng c\u1ee7a d\u00e3y t\u1eeb \\(i\\) \u0111\u1ebfn \\(j\\)).</li> <li>V\u1eady ta c\u00f3 \\(dp[i][j] = \\min(dp[i][j], dp[i][k] + dp[k+1][j] + \\text{sum}[i][j])\\) (v\u1edbi \\(i \\leq k &lt; j\\)).</li> </ul> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^3)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\).</p>"},{"location":"AtCoder/dp-contest/#o-matching","title":"O - Matching","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng v\u00e0 \\(N\\) ng\u01b0\u1eddi ph\u1ee5 n\u1eef. Cho m\u1ed9t b\u1ea3ng \\(N \\times N\\) v\u1edbi m\u1ed7i \u00f4 \\((i, j)\\) l\u00e0 \\(a[i][j]\\). \\(a[i][j] = 1\\) khi ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng \\(i\\) v\u00e0 ng\u01b0\u1eddi ph\u1ee5 n\u1eef \\(j\\) h\u1ee3p nhau, ng\u01b0\u1ee3c l\u1ea1i th\u00ec \\(a[i][j] = 0\\). H\u00e3y t\u00ednh s\u1ed1 c\u00e1ch gh\u00e9p c\u1eb7p sao cho m\u1ed7i ng\u01b0\u1eddi \u0111\u1ec1u \u0111\u01b0\u1ee3c gh\u00e9p v\u1edbi m\u1ed9t ng\u01b0\u1eddi kh\u00e1c h\u1ee3p v\u1edbi m\u00ecnh.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 21\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 bitmask c\u1ee7a t\u1eadp nh\u1eefng ng\u01b0\u1eddi ph\u1ee5 n\u1eef \u0111\u00e3 \u0111\u01b0\u1ee3c gh\u00e9p. K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[n][(1 &lt;&lt; n) - 1]\\) (n\u1ebfu ch\u00fang ta \u0111\u00e1nh s\u1ed1 t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\)). Ban \u0111\u1ea7u, ta c\u00f3 \\(dp[0][0] = 1\\).</p> <p>V\u1edbi m\u1ed7i ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng \\(i\\) v\u00e0 bitmask \\(j\\), ta c\u1ed1 g\u1eafng t\u00ecm m\u1ed9t ng\u01b0\u1eddi ph\u1ee5 n\u1eef k ch\u01b0a \u0111\u01b0\u1ee3c gh\u00e9p v\u00e0 ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng i h\u1ee3p v\u1edbi c\u00f4 \u1ea5y, sau \u0111\u00f3 ta c\u1eadp nh\u1eadt \\(dp[i][j | (1 &lt;&lt; (k-1))] += dp[i-1][j]\\) (\\(k-1\\) v\u00ec ch\u00fang ta \u0111\u00e1nh s\u1ed1 t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\)). \u0110\u1ed9 ph\u1ee9c t\u1ea1p l\u00fac n\u00e0y s\u1ebd l\u00e0 \\(O(N^2 * 2^N)\\), kh\u00f4ng \u1ed5n \u0111\u1ec3 v\u01b0\u1ee3t qua c\u00e1c test cu\u1ed1i.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng khi x\u00e9t \u0111\u1ebfn ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng \\(i\\), mask \\(j\\) ph\u1ea3i c\u00f3 \u0111\u00fang \\(i-1\\) bit \u0111\u01b0\u1ee3c set, v\u00ec ch\u00fang ta \u0111\u00e3 gh\u00e9p \\(i-1\\) ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng v\u1edbi \\(i-1\\) ng\u01b0\u1eddi ph\u1ee5 n\u1eef, v\u1eady ta c\u00f3 th\u1ec3 b\u1ecf qua mask \\(j\\) c\u00f3 nhi\u1ec1u ho\u1eb7c \u00edt h\u01a1n \\(i-1\\) bit \u0111\u01b0\u1ee3c set. V\u1eady ph\u1ea7n \"v\u1edbi m\u1ed7i ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng \\(i\\) v\u00e0 bitmask \\(j\\)\" c\u00f3 th\u1ec3 ch\u1ea1y trong \\(O(2^N)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N * 2^N)\\).</p> <p>V\u1ec1 m\u1eb7t kh\u00f4ng gian, ta c\u00f3 th\u1ec3</p> <ul> <li>S\u1eed d\u1ee5ng m\u1ea3ng \\(dp\\) 2 chi\u1ec1u \u0111\u1ec3 l\u01b0u k\u1ebft qu\u1ea3 (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(N * 2^N)\\)).</li> <li>Ta th\u1ea5y r\u1eb1ng \\(dp[i]\\) ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o \\(dp[i-1]\\), v\u1eady ta c\u00f3 th\u1ec3 l\u01b0u 2 d\u00f2ng \\(dp\\) \u0111\u1ec3 ti\u1ebft ki\u1ec7m b\u1ed9 nh\u1edb (\u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(2^N)\\)). Th\u1eadm ch\u00ed, ta th\u1ea5y r\u1eb1ng m\u1ed7i ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng \\(i\\) s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t s\u1ed1 mask \\(j\\) c\u00f3 \u0111\u00fang \\(i-1\\) bit \u0111\u01b0\u1ee3c set, v\u1eady ta c\u00f3 th\u1ec3 l\u01b0u 1 d\u00f2ng \\(dp\\), v\u00ec c\u00e1c tr\u1ea1ng th\u00e1i c\u1ee7a nh\u1eefng ng\u01b0\u1eddi \u0111\u00e0n \u00f4ng kh\u00e1c nhau s\u1ebd kh\u00f4ng tr\u00f9ng v\u1edbi nhau.</li> </ul>"},{"location":"AtCoder/dp-contest/#p-independent-set","title":"P - Independent Set","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho m\u1ed9t c\u00e2y g\u1ed3m \\(N\\) \u0111\u1ec9nh. M\u1ed7i \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u \u0111en ho\u1eb7c tr\u1eafng. H\u00e3y t\u00ednh s\u1ed1 c\u00e1ch t\u00f4 m\u00e0u sao cho kh\u00f4ng c\u00f3 hai \u0111\u1ec9nh k\u1ec1 n\u00e0o c\u00f9ng c\u00f3 m\u00e0u \u0111en.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 10^5\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[u][col]\\) l\u00e0 s\u1ed1 c\u00e1ch t\u00f4 m\u00e0u cho c\u00e2y con c\u1ee7a \u0111\u1ec9nh \\(u\\) sao cho \u0111\u1ec9nh \\(u\\) c\u00f3 m\u00e0u \\(col\\). K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[1][0] + dp[1][1]\\).</p> <p>Ban \u0111\u1ea7u ta c\u00f3 \\(dp[u][0] = dp[u][1] = 1\\) v\u00ec ta c\u00f3 th\u1ec3 t\u00f4 m\u00e0u \u0111en ho\u1eb7c tr\u1eafng cho m\u1ecdi \u0111\u1ec9nh.</p> <p>V\u1edbi m\u1ed7i \u0111\u1ec9nh con \\(v\\) c\u1ee7a \u0111\u1ec9nh \\(u\\), ta c\u00f3 th\u1ec3 t\u00ednh \\(dp[v][0]\\) v\u00e0 \\(dp[v][1]\\) theo c\u00e1ch \u0111\u1ec7 quy. Sau \u0111\u00f3, ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[\\begin{align} dp[u][1] &amp;= dp[u][1] \\cdot dp[v][0] \\text{ (n\u1ebfu \u0111\u1ec9nh } u \\text{ m\u00e0u \u0111en, \u0111\u1ec9nh } v \\text{ ph\u1ea3i m\u00e0u tr\u1eafng)} \\\\ dp[u][0] &amp;= dp[u][0] \\cdot (dp[v][0] + dp[v][1]) \\text{ (n\u1ebfu \u0111\u1ec9nh } u \\text{ m\u00e0u tr\u1eafng, \u0111\u1ec9nh } v \\text{ c\u00f3 th\u1ec3 m\u00e0u tr\u1eafng ho\u1eb7c \u0111en)} \\end{align}\\] <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#q-flowers","title":"Q - Flowers","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) b\u00f4ng hoa x\u1ebfp th\u00e0nh h\u00e0ng. B\u00f4ng hoa th\u1ee9 \\(i\\) c\u00f3 chi\u1ec1u cao \\(h[i]\\) v\u00e0 s\u1eafc \u0111\u1eb9p \\(a[i]\\), \\(h[i]\\) \u0111\u00f4i m\u1ed9t kh\u00e1c nhau. Nh\u1ed5 b\u1ecf m\u1ed9t s\u1ed1 b\u00f4ng hoa sao cho chi\u1ec1u cao c\u1ee7a nh\u1eefng b\u00f4ng hoa c\u00f2n l\u1ea1i t\u0103ng d\u1ea7n. H\u00e3y t\u00ednh t\u1ed5ng s\u1eafc \u0111\u1eb9p l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c b\u00f4ng hoa c\u00f2n l\u1ea1i.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 2 \\times 10^5\\)</p> <p>\\(1 \\leq h[i] \\leq N\\)</p> <p>\\(1 \\leq a[i] \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i]\\) l\u00e0 t\u1ed5ng s\u1eafc \u0111\u1eb9p l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c b\u00f4ng hoa t\u1eeb \\(1\\) \u0111\u1ebfn \\(i\\) v\u00e0 b\u00f4ng hoa cu\u1ed1i c\u00f9ng \u0111\u01b0\u1ee3c gi\u1eef l\u1ea1i l\u00e0 b\u00f4ng hoa \\(i\\). K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(\\max(dp[1], dp[2], ..., dp[N])\\).</p> <p>Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0] = 0\\) v\u00ec kh\u00f4ng c\u00f3 b\u00f4ng hoa n\u00e0o.</p> <p>V\u1edbi m\u1ed7i b\u00f4ng hoa \\(i\\), ta c\u00f3 th\u1ec3 t\u00ednh \\(dp[i]\\) theo c\u00f4ng th\u1ee9c truy h\u1ed3i sau:</p> \\[dp[i] = \\max(dp[j]) + a[i] \\text{ v\u1edbi m\u1ecdi } j &lt; i \\text{ v\u00e0 } h[j] &lt; h[i]\\] <p>Tuy nhi\u00ean c\u00e1ch n\u00e0y s\u1ebd ch\u1ea1y trong \\(O(N^2)\\), qu\u00e1 ch\u1eadm.</p> <p>Nh\u01b0 v\u1eady ta t\u1ed1i \u01b0u b\u1eb1ng c\u00e1ch n\u00e0o? Ta c\u1ea7n bi\u1ebft gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \\(dp[j]\\) tr\u01b0\u1edbc \u0111\u00f3 v\u00e0 chi\u1ec1u cao c\u1ee7a n\u00f3 nh\u1ecf h\u01a1n \\(h[i]\\). Ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng c\u00e2y Fenwick (Binary Indexed Tree - BIT) \u0111\u1ec3 l\u01b0u gi\u00e1 tr\u1ecb \\(dp[j]\\) t\u1ea1i v\u1ecb tr\u00ed \\(h[j]\\) tr\u00ean c\u00e2y (v\u00ec \\(h[j]\\) l\u00e0 duy nh\u1ea5t), sau \u0111\u00f3 l\u1ea5y gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t t\u1eeb \\(1\\) \u0111\u1ebfn \\(h[i]-1\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N \\log N)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#r-walk","title":"R - Walk","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho \u0111\u1ed3 th\u1ecb \u0111\u01a1n \\(G\\) c\u00f3 \\(N\\) \u0111\u1ec9nh. V\u1edbi m\u1ed7i c\u1eb7p \\(i, j\\) (\\(1 \\leq i, j \\leq N\\)), gi\u00e1 tr\u1ecb \\(a[i][j] = 1\\) n\u1ebfu c\u00f3 c\u1ea1nh n\u1ed1i gi\u1eefa \\(i\\) v\u00e0 \\(j\\), ng\u01b0\u1ee3c l\u1ea1i th\u00ec \\(a[i][j] = 0\\). T\u00ednh s\u1ed1 \u0111\u01b0\u1eddng \u0111i c\u00f3 h\u01b0\u1edbng \u0111\u1ed9 d\u00e0i \\(K\\) trong \\(G\\). \u0110\u01b0\u1eddng \u0111i c\u00f3 th\u1ec3 \u0111i qua c\u00f9ng m\u1ed9t c\u1ea1nh nhi\u1ec1u l\u1ea7n.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 50\\)</p> <p>\\(1 \\leq K \\leq 10^{18}\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 s\u1ed1 c\u00e1ch \u0111i t\u1eeb \u0111\u1ec9nh \\(i\\) \u0111\u1ebfn \u0111\u1ec9nh \\(j\\) trong \\(i\\) b\u01b0\u1edbc. K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 t\u1ed5ng c\u1ee7a \\(dp[k][j]\\) v\u1edbi \\(j\\) t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\).</p> <p>Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0][i] = 1\\) v\u1edbi m\u1ecdi \\(i\\).</p> <p>Ta c\u00f3 c\u00f4ng th\u1ee9c truy h\u1ed3i nh\u01b0 sau:</p> \\[\\begin{align} dp[i][j] &amp;= \\sum_{k=1, a[k][j] = 1}^{N} dp[i-1][k] \\\\ &amp;= \\sum_{k=1}^{N} dp[i-1][k] \\cdot a[k][j] \\end{align}\\] <p>C\u00e1ch n\u00e0y s\u1ebd ch\u1ea1y trong \\(O(KN^2)\\), qu\u00e1 ch\u1eadm.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng ta c\u00f3 th\u1ec3 \u0111i t\u1eeb \\(dp[i-1]\\) \u0111\u1ebfn \\(dp[i]\\) b\u1eb1ng m\u1ed9t ma tr\u1eadn, v\u1eady ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng nh\u00e2n ma tr\u1eadn \u0111\u1ec3 t\u1ed1i \u01b0u. Ma tr\u1eadn \\(A\\) s\u1ebd l\u00e0 ma tr\u1eadn d\u1ea1ng \\(A[i][j] = a[j][i]\\).</p> <p>V\u1eady ta c\u00f3 \\(dp[k] = A^k \\cdot dp[0]\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^3 \\log K)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\).</p>"},{"location":"AtCoder/dp-contest/#s-digit-sum","title":"S - Digit Sum","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>T\u00ecm s\u1ed1 c\u00e1c s\u1ed1 n\u1eb1m trong kho\u1ea3ng \\([1, K]\\) sao cho t\u1ed5ng ch\u1eef s\u1ed1 c\u1ee7a s\u1ed1 \u0111\u00f3 chia h\u1ebft cho \\(D\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq K \\leq 10^{10000}\\)</p> <p>\\(1 \\leq D \\leq 100\\)</p> L\u1eddi gi\u1ea3i <p>Gi\u1edd ta \u0111\u1ebfn v\u1edbi m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a DP, c\u1ee5 th\u1ec3 \u1edf \u0111\u00e2y l\u00e0 Digit DP hay DP ch\u1eef s\u1ed1. Ta c\u1ea7n t\u00ednh s\u1ed1 l\u01b0\u1ee3ng s\u1ed1 nguy\u00ean n\u1eb1m trong kho\u1ea3ng t\u1eeb 0 \u0111\u1ebfn m\u1ed9t s\u1ed1 n\u00e0o \u0111\u00f3 (\\(K\\) ch\u1eb3ng han) v\u00e0 c\u00e1c s\u1ed1 \u0111\u00f3 c\u00f3 m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t nh\u1ea5t \u0111\u1ecbnh. Th\u00f4ng th\u01b0\u1eddng, ta c\u1ea7n x\u00e2y d\u1ef1ng s\u1ed1 t\u1eeb tr\u00e1i sang ph\u1ea3i, v\u00e0 xem x\u00e9t xem s\u1ed1 \u0111\u00f3 c\u00f3 nh\u1ecf h\u01a1n \\(n\\) hay kh\u00f4ng. Ta c\u1ea7n bi\u1ebft \u0111i\u1ec1u \u0111\u00f3 \u0111\u1ec3 bi\u1ebft ch\u1eef s\u1ed1 ti\u1ebfp theo c\u00f3 th\u1ec3 n\u1eb1m trong kho\u1ea3ng n\u00e0o.</p> <p>G\u1ecdi \\(dp[i][j][eq]\\) l\u00e0 s\u1ed1 c\u00e1ch x\u00e2y d\u1ef1ng m\u1ed9t s\u1ed1 c\u00f3 \u0111\u1ed9 d\u00e0i \\(i\\), t\u1ed5ng ch\u1eef s\u1ed1 chia d\u01b0 cho \\(d\\) \u0111\u01b0\u1ee3c \\(j\\), v\u00e0 s\u1ed1 \u0111\u00f3 nh\u1ecf h\u01a1n \\(K\\) n\u1ebfu \\(eq = 0\\), ng\u01b0\u1ee3c l\u1ea1i \\(eq = 1\\) khi s\u1ed1 \u0111\u00f3 \u0111ang c\u00f3 th\u1ec3 b\u1eb1ng \\(K\\). Ban \u0111\u1ea7u, ta ch\u01b0a c\u00f3 ch\u1eef s\u1ed1 n\u00e0o, t\u1ed5ng ch\u1eef s\u1ed1 chia d\u01b0 cho \\(d\\) l\u00e0 \\(0\\), v\u00e0 s\u1ed1 \u0111\u00f3 v\u1eabn c\u00f3 th\u1ec3 b\u1eb1ng \\(K\\), n\u00ean \\(dp[0][0][1] = 1\\).</p> <p>C\u00f4ng th\u1ee9c truy h\u1ed3i kh\u00e1 \u0111\u01a1n gi\u1ea3n, ta l\u1eb7p qua ch\u1eef s\u1ed1 ti\u1ebfp theo, c\u1eadp nh\u1eadt t\u1ed5ng ch\u1eef s\u1ed1 chia d\u01b0 cho \\(d\\), v\u00e0 xem x\u00e9t xem s\u1ed1 \u0111\u00f3 c\u00f3 nh\u1ecf h\u01a1n \\(K\\) hay kh\u00f4ng.</p> <p>K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[N][0][0] + dp[N][0][1] - 1\\), v\u00ec ta c\u1ea7n lo\u1ea1i b\u1ecf s\u1ed1 \\(0\\), v\u1edbi \\(N\\) l\u00e0 s\u1ed1 ch\u1eef s\u1ed1 c\u1ee7a \\(K\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(ND)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(ND)\\), b\u1ea1n c\u00f3 th\u1ec3 t\u1ed1i \u01b0u n\u00f3 xu\u1ed1ng \\(O(d)\\) b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng 2 d\u00f2ng.</p>"},{"location":"AtCoder/dp-contest/#t-permutation","title":"T - Permutation","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(N\\) v\u00e0 m\u1ed9t x\u00e2u \u0111\u1ed9 d\u00e0i \\(N-1\\) g\u1ed3m c\u00e1c k\u00fd t\u1ef1 <code>&gt;</code> v\u00e0 <code>&lt;</code>. T\u00ecm s\u1ed1 ho\u00e1n v\u1ecb \\(p_1, p_2, ..., p_N\\) sao cho th\u1ecfa m\u00e3n \u0111i\u1ec1u ki\u1ec7n \\(p_i &lt; p_{i+1}\\) n\u1ebfu k\u00fd t\u1ef1 th\u1ee9 \\(i\\) trong x\u00e2u l\u00e0 <code>&lt;</code> v\u00e0 \\(p_i &gt; p_{i+1}\\) n\u1ebfu k\u00fd t\u1ef1 th\u1ee9 \\(i\\) trong x\u00e2u l\u00e0 <code>&lt;</code>.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(2 \\leq N \\leq 3000\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i][j]\\) l\u00e0 s\u1ed1 ho\u00e1n v\u1ecb c\u00f3 \\(i\\) \u00f4 \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111i\u1ec1n, ta c\u00f2n \\(n-i\\) ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i, trong \u0111\u00f3 \\(j\\) ph\u1ea7n t\u1eed l\u1edbn h\u01a1n ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng ta \u0111\u00e3 \u0111i\u1ec1n. Ban \u0111\u1ea7u ta \u0111i\u1ec1n \u00f4 \u0111\u1ea7u ti\u00ean tr\u01b0\u1edbc, c\u00f3 \\(N\\) c\u00e1ch ch\u1ecdn, v\u00e0 ta c\u00f3 th\u1ec3 ch\u1ecdn b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o \u0111\u1ec3 l\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean. N\u1ebfu ch\u00fang ta ch\u1ecdn s\u1ed1 \\(j\\), c\u00f3 \\(N-j\\) ph\u1ea7n t\u1eed l\u1edbn h\u01a1n \\(j\\), v\u1eady \\(dp[1][N-j] = 1\\).</p> <p>Sau \u0111\u00f3, ta ti\u1ebfp t\u1ee5c \u0111i\u1ec1n v\u00e0o \u00f4 ti\u1ebfp theo v\u1edbi m\u1ed7i tr\u1ea1ng th\u00e1i c\u00f3 \u00edt nh\u1ea5t m\u1ed9t c\u00e1ch ch\u1ecdn (mod \\(10^9+7\\)):</p> <ul> <li>N\u1ebfu k\u00fd t\u1ef1 l\u00e0 <code>&lt;</code>, ta c\u1ea7n th\u00eam \\(dp[i][j]\\) v\u00e0o \\(dp[i+1][0]\\), \\(dp[i+1][1]\\), ..., \\(dp[i+1][j-1]\\), v\u00ec ta c\u1ea7n ch\u1ecdn m\u1ed9t ph\u1ea7n t\u1eed l\u1edbn h\u01a1n ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng hi\u1ec7n t\u1ea1i n\u00ean \\(j\\) b\u1ecb gi\u1ea3m \u0111i.</li> <li>N\u1ebfu k\u00fd t\u1ef1 l\u00e0 <code>&gt;</code>, ta c\u1ea7n th\u00eam \\(dp[i][j]\\) v\u00e0o \\(dp[i+1][j]\\), \\(dp[i+1][j+1]\\), ..., \\(dp[i+1][n-i-1]\\), v\u00ec ta c\u1ea7n ch\u1ecdn m\u1ed9t ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng hi\u1ec7n t\u1ea1i n\u00ean \\(j\\) \u0111\u01b0\u1ee3c gi\u1eef nguy\u00ean ho\u1eb7c t\u0103ng l\u00ean.</li> <li>C\u00e1ch n\u00e0y n\u1ebfu c\u00e0i l\u00ean s\u1ebd ch\u1ea1y trong \\(O(N^3)\\), nh\u01b0ng ta th\u1ea5y r\u1eb1ng ta c\u1ed9ng m\u1ed9t \u0111o\u1ea1n c\u1ee5 th\u1ec3, v\u1eady ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng prefix sum \u0111\u1ec3 t\u1ed1i \u01b0u n\u00f3 xu\u1ed1ng \\(O(N^2)\\).</li> </ul> <p>K\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng s\u1ebd l\u00e0 \\(dp[N][0]\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N^2)\\), ho\u1eb7c \\(O(N)\\) n\u1ebfu ta s\u1eed d\u1ee5ng 2 d\u00f2ng.</p>"},{"location":"AtCoder/dp-contest/#u-grouping","title":"U - Grouping","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho \\(N\\) con th\u1ecf. V\u1edbi m\u1ed7i c\u1eb7p th\u1ecf \\(i, j\\), ta c\u00f3 \\(a[i][j]\\) l\u00e0 m\u1ee9c \u0111\u1ed9 t\u01b0\u01a1ng h\u1ee3p gi\u1eefa ch\u00fang. Ta c\u1ea7n chia \\(N\\) con th\u1ecf th\u00e0nh c\u00e1c nh\u00f3m sao cho m\u1ed7i con th\u1ecf thu\u1ed9c v\u1ec1 \u0111\u00fang m\u1ed9t nh\u00f3m. N\u1ebfu hai con th\u1ecf \\(i, j\\) thu\u1ed9c c\u00f9ng nh\u00f3m th\u00ec b\u1ea1n s\u1ebd \u0111\u01b0\u1ee3c \\(a[i][j]\\) \u0111i\u1ec3m. H\u00e3y t\u00ednh t\u1ed5ng \u0111i\u1ec3m l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 16\\)</p> <p>\\(|a[i][j]| \\leq 10^9\\)</p> <p>\\(a[i][i] = 0\\)</p> <p>\\(a[i][j] = a[j][i]\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(sum[\\text{mask}]\\) l\u00e0 \u0111i\u1ec3m c\u1ee7a nh\u00f3m th\u1ecf \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi \\(\\text{mask}\\). Ta s\u1ebd m\u1ea5t \\(O(2^N \\cdot N^2)\\) \u0111\u1ec3 t\u00ednh to\u00e1n c\u00e1i n\u00e0y.</p> <p>Sau \u0111\u00f3, ta \u0111\u1ecbnh ngh\u0129a \\(dp[\\text{mask}]\\) l\u00e0 \u0111i\u1ec3m l\u1edbn nh\u1ea5t c\u1ee7a c\u00e1c nh\u00f3m th\u1ecf c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1edfi \\(\\text{mask}\\). Ta c\u00f3 th\u1ec3 t\u00ednh nh\u01b0 sau trong \\(O(3^N)\\):</p> \\[dp[\\text{mask}] = \\max(dp[\\text{mask}], dp[\\text{mask} \\oplus \\text{subMask}] + \\text{sum}[\\text{subMask}]) \\text{ v\u1edbi m\u1ecdi mask con c\u1ee7a mask}\\] <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(dp[2^N - 1]\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(3^N + 2^N \\cdot N^2)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(2^N)\\).</p>"},{"location":"AtCoder/dp-contest/#v-subtree","title":"V - Subtree","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho m\u1ed9t c\u00e2y \\(N\\) \u0111\u1ec9nh. Ta t\u00f4 m\u00e0u tr\u1eafng ho\u1eb7c \u0111en cho c\u00e1c \u0111\u1ec9nh sao cho m\u1ed9t \u0111\u1ec9nh \u0111en ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c m\u1ed9t \u0111\u1ec9nh \u0111en kh\u00e1c b\u1eb1ng c\u00e1ch \u0111i qua m\u1ed9t s\u1ed1 \u0111\u1ec9nh \u0111en kh\u00e1c n\u1eefa. T\u00ecm s\u1ed1 c\u00e1ch t\u00f4 mod \\(M\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 10^5\\)</p> <p>\\(1 \\leq M \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>Gi\u1ea3 s\u1eed g\u1ed1c c\u1ee7a c\u00e2y n\u1eb1m \u1edf node \\(1\\).</p> <p>G\u1ecdi \\(res[u]\\) l\u00e0 s\u1ed1 c\u00e1ch t\u00f4 m\u00e0u cho to\u00e0n b\u1ed9 c\u00e2y, trong \u0111\u00f3 c\u00f3 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a \\(u\\) l\u00e0 c\u00f3 m\u00e0u \u0111en.</p> <p>G\u1ecdi \\(subtree[u]\\) l\u00e0 s\u1ed1 c\u00e1ch t\u00f4 m\u00e0u cho c\u00e2y con g\u1ed1c \\(u\\), trong \u0111\u00f3 c\u00f3 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a \\(u\\) l\u00e0 c\u00f3 m\u00e0u \u0111en.</p> \\[subtree[u] = \\prod_{v \\in \\text{con c\u1ee7a } u} (subtree[v] + 1)\\] <p>R\u00f5 r\u00e0ng ban \u0111\u1ea7u \\(res[1] = subtree[1]\\).</p> <p>V\u1edbi \\(res[v]\\), g\u1ecdi \\(u\\) l\u00e0 cha c\u1ee7a \\(v\\), ta c\u00f3:</p> \\[res[v] = subtree[v] \\cdot \\left( \\frac{res[u]}{subtree[v] + 1} + 1 \\right)\\] <p>N\u1ebfu \\(M\\) l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1 ki\u1ec3u \\(10^9 + 7\\), ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \u0111\u1ecbnh l\u00fd Fermat nh\u1ecf \u0111\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o c\u1ee7a \\((subtree[v] + 1)\\) modulo \\(M\\), nh\u01b0ng v\u00ec \\(M\\) c\u00f3 th\u1ec3 l\u00e0 b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean d\u01b0\u01a1ng n\u00e0o, ta c\u1ea7n t\u00ecm c\u00e1ch \u0111\u1ec3 l\u1ea5y \\(res[u] / subtree[v]\\) modulo \\(M\\) m\u00e0 kh\u00f4ng c\u1ea7n ph\u1ea3i chia.</p> <p>G\u1ecdi \\(parTree[u]\\) l\u00e0 s\u1ed1 c\u00e1ch t\u00f4 m\u00e0u cho c\u1ea3 c\u00e2y m\u00e0 kh\u00f4ng c\u00f3 c\u00e2y con g\u1ed1c \\(u\\), trong \u0111\u00f3 c\u00f3 m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a cha c\u1ee7a \\(u\\) l\u00e0 c\u00f3 m\u00e0u \u0111en. V\u1edbi \\(v, v_1, v_2, \\ldots, v_k\\) l\u00e0 c\u00e1c con c\u1ee7a \\(u\\), ta c\u00f3:</p> \\[res[u] = (subtree[v] + 1) \\cdot (subtree[v_1] + 1) \\cdot (subtree[v_2] + 1) \\cdot \\ldots \\cdot (subtree[v_k] + 1) \\cdot (parTree[u] + 1)\\] \\[\\begin{align} parTree[v] &amp;= \\frac{(parTree[u] + 1) \\cdot (subtree[v_1] + 1) \\cdot (subtree[v_2] + 1) \\cdot \\ldots \\cdot (subtree[v_k] + 1)}{subtree[v] + 1} \\\\ &amp;= (parTree[u] + 1) \\cdot (subtree[v_1] + 1) \\cdot (subtree[v_2] + 1) \\cdot \\ldots \\cdot (subtree[v_k] + 1) \\\\ \\end{align}\\] <p>G\u1ecdi \\(subtreeOfParWithout[v]\\) l\u00e0 \\((subtree[v_1] + 1) \\cdot (subtree[v_2] + 1) \\cdot \\ldots \\cdot (subtree[v_k] + 1)\\).</p> <p>V\u1eady \\(parTree[v] = (parTree[u] + 1) \\cdot subtreeOfParWithout[v]\\).</p> <p>V\u00e0 \\(res[v] = subtree[v] \\cdot (parTree[v] + 1)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#w-intervals","title":"W - Intervals","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>X\u00e9t m\u1ed9t x\u00e2u \u0111\u1ed9 d\u00e0i \\(N\\) g\u1ed3m c\u00e1c k\u00fd t\u1ef1 <code>0</code> v\u00e0 <code>1</code>. \u0110i\u1ec3m c\u1ee7a x\u00e2u n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c t\u00ednh nh\u01b0 sau:</p> <ul> <li>V\u1edbi m\u1ed7i \\(i\\), \\(a[i]\\) \u0111\u01b0\u1ee3c c\u1ed9ng v\u00e0o t\u1ed5ng \u0111i\u1ec3m n\u1ebfu x\u00e2u con t\u1eeb \\(l[i]\\) \u0111\u1ebfn \\(r[i]\\) ch\u1ee9a \u00edt nh\u1ea5t m\u1ed9t k\u00fd t\u1ef1 <code>1</code>.</li> </ul> <p>H\u00e3y t\u00ednh t\u1ed5ng \u0111i\u1ec3m l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N, M \\leq 2 \\times 10^5\\)</p> <p>\\(1 \\leq l[i], r[i] \\leq N\\)</p> <p>\\(|a[i]| \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i]\\) l\u00e0 t\u1ed5ng \u0111i\u1ec3m l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c cho x\u00e2u con t\u1eeb \\(1\\) \u0111\u1ebfn \\(i\\) v\u00e0 bit \\(i\\) \u0111\u01b0\u1ee3c set (\u0111\u00e1nh s\u1ed1 t\u1eeb \\(1\\)).</p> <p>Ta c\u00f3 \\(dp[i] = \\max(dp[j] + \\text{cost}(i, j))\\) v\u1edbi \\(j &lt; i\\), v\u00e0 \\(\\text{cost}(i, j)\\) l\u00e0 t\u1ed5ng \u0111i\u1ec3m c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n \\(x\\) v\u1edbi \\(i\\) n\u1eb1m trong \\([l_x, r_x]\\) v\u00e0 \\(j\\) kh\u00f4ng n\u1eb1m trong \\([l_x, r_x]\\). K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(\\max(0, \\max(dp[i]))\\). C\u00e1i n\u00e0y s\u1ebd ch\u1ea1y trong \\(O(N^2)\\), qu\u00e1 ch\u1eadm.</p> <p>X\u00e9t m\u1ed9t bi\u1ebfn \u0111\u1ed5i t\u1eeb \\(\\text{cost}(i-1, j)\\) sang \\(\\text{cost}(i, j)\\) khi ta di chuy\u1ec3n t\u1eeb \\(i-1\\) sang \\(i\\):</p> <ul> <li>Khi ta c\u00f3 m\u1ed9t \u0111o\u1ea1n m\u00e0 \\(l_x = i\\), \\(\\text{cost}\\) s\u1ebd t\u0103ng th\u00eam \\(a_x\\).</li> <li>Khi ta c\u00f3 m\u1ed9t \u0111o\u1ea1n m\u00e0 \\(r_x = i-1\\), \\(\\text{cost}\\) s\u1ebd gi\u1ea3m \u0111i \\(a_x\\).</li> </ul> <p>V\u1eady ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t m\u1ea3ng \\(p\\), \u1edf m\u1ed7i b\u01b0\u1edbc \\(i\\) v\u00e0 \\(j &lt; i\\), \\(p[j] = \\text{cost}(i, j) + dp[j]\\). Khi ta di chuy\u1ec3n \u0111\u1ebfn \\(i\\) m\u1edbi, ta s\u1ebd t\u0103ng \\(p[j]\\) th\u00eam \\(a_x\\) n\u1ebfu c\u00f3 \u0111o\u1ea1n b\u1eaft \u0111\u1ea7u t\u1eeb \\(i\\), v\u00e0 gi\u1ea3m \\(p[j]\\) \u0111i \\(a_x\\) n\u1ebfu c\u00f3 \u0111o\u1ea1n k\u1ebft th\u00fac t\u1ea1i \\(i-1\\).</p> <p>Ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng segment tree \u0111\u1ec3 duy tr\u00ec p[j] v\u1edbi m\u1ecdi j &lt; i, sau \u0111\u00f3 c\u1eadp nh\u1eadt \\(p[i] = \\max(p[0], p[1], \\ldots, p[i-1])\\) (kh\u00f4ng c\u00f3 \\(\\text{cost}\\) \u1edf \u0111\u00e2y v\u00ec \\(\\text{cost}(i, i) = 0\\)).</p> <p>\\(p[i]\\) \u1edf m\u1ed7i b\u01b0\u1edbc \\(i\\) c\u0169ng ch\u00ednh l\u00e0 \\(dp[i]\\), ta c\u1eadp nh\u1eadt k\u1ebft qu\u1ea3 t\u01b0\u01a1ng \u1ee9ng.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N \\log N)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#x-tower","title":"X - Tower","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) phi\u1ebfn \u0111\u00e1. Phi\u1ebfn \u0111\u00e1 th\u1ee9 \\(i\\) n\u1eb7ng \\(w[i]\\), c\u00f3 \u0111\u1ed9 v\u1eefng ch\u1eafc \\(s[i]\\), v\u00e0 gi\u00e1 tr\u1ecb \\(v[i]\\). Ta c\u1ea7n x\u00e2y m\u1ed9t c\u00e1i th\u00e1p v\u1edbi m\u1ed9t s\u1ed1 phi\u1ebfn \u0111\u00e1 trong n\u00e0y v\u00e0 x\u1ebfp ch\u1ed3ng ch\u00fang l\u00ean nhau, sao cho v\u1edbi m\u1ed7i phi\u1ebfn \u0111\u00e1 trong th\u00e1p, t\u1ed5ng kh\u1ed1i l\u01b0\u1ee3ng c\u00e1c phi\u1ebfn \u0111\u00e1 n\u1eb1m tr\u00ean n\u00f3 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 \u0111\u1ed9 v\u1eefng ch\u1eafc c\u1ee7a n\u00f3. H\u00e3y t\u00ednh gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c c\u1ee7a th\u00e1p.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq N \\leq 10^3\\)</p> <p>\\(1 \\leq w[i], s[i] \\leq 10^4\\)</p> <p>\\(1 \\leq v[i] \\leq 10^9\\)</p> L\u1eddi gi\u1ea3i <p>Ta c\u1ea7n c\u00e1c kh\u1ed1i \u0111\u00e1 ph\u1ea3i \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 n\u00e0o \u0111\u00f3 \u0111\u1ec3 ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n DP, nh\u01b0ng th\u1ee9 t\u1ef1 n\u00e0o? H\u00f3a ra n\u00f3 s\u1ebd l\u00e0 th\u1ee9 t\u1ef1 \\(w + s\\) t\u0103ng d\u1ea7n.</p> <ul> <li>X\u00e9t th\u1ee9 t\u1ef1 c\u1ee7a hai kh\u1ed1i \u0111\u00e1 \\(a\\) v\u00e0 \\(b\\).</li> <li>N\u1ebfu kh\u1ed1i \u0111\u00e1 \\(a\\) n\u1eb1m d\u01b0\u1edbi kh\u1ed1i \u0111\u00e1 \\(b\\), th\u00ec \u0111\u1ed9 v\u1eefng ch\u1eafc c\u1ee7a th\u00e1p l\u00e0 \\(s[a] - w[b]\\) cho c\u00e1c kh\u1ed1i \u0111\u00e1 kh\u00e1c \u0111\u01b0\u1ee3c \u0111\u1eb7t l\u00ean tr\u00ean kh\u1ed1i \u0111\u00e1 \\(a\\).</li> <li>N\u1ebfu kh\u1ed1i \u0111\u00e1 \\(b\\) n\u1eb1m d\u01b0\u1edbi kh\u1ed1i \u0111\u00e1 \\(a\\), th\u00ec \u0111\u1ed9 v\u1eefng ch\u1eafc c\u1ee7a th\u00e1p l\u00e0 \\(s[b] - w[a]\\) cho c\u00e1c kh\u1ed1i \u0111\u00e1 kh\u00e1c \u0111\u01b0\u1ee3c \u0111\u1eb7t l\u00ean tr\u00ean kh\u1ed1i \u0111\u00e1 \\(b\\).</li> <li>\u0110\u1ec3 c\u00f3 \u0111\u1eb7t \u0111\u01b0\u1ee3c nhi\u1ec1u kh\u1ed1i l\u01b0\u1ee3ng h\u01a1n \u1edf tr\u00ean kh\u1ed1i \u0111\u00e1 n\u1eb1m d\u01b0\u1edbi, gi\u00e1 tr\u1ecb n\u00e0o l\u1edbn h\u01a1n th\u00ec s\u1ebd \u0111\u01b0\u1ee3c ch\u1ecdn. Ngh\u0129a l\u00e0, n\u1ebfu ta mu\u1ed1n \\(a\\) n\u1eb1m d\u01b0\u1edbi (ngh\u0129a l\u00e0 x\u1ebfp sau theo th\u1ee9 t\u1ef1), ta s\u1ebd mu\u1ed1n \\(s[a] - w[b] \\geq s[b] - w[a] \\Rightarrow s[a] + w[a] \\geq s[b] + w[b]\\). V\u1eady t\u1ed5ng nh\u1ecf h\u01a1n s\u1ebd \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp tr\u01b0\u1edbc.</li> </ul> <p>Sau khi s\u1eafp x\u1ebfp, g\u1ecdi \\(dp[i][j]\\) l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a th\u00e1p khi x\u00e9t \\(i\\) kh\u1ed1i \u0111\u00e1 \u0111\u1ea7u ti\u00ean v\u00e0 \u0111\u1ed9 v\u1eefng ch\u1eafc c\u1ee7a th\u00e1p l\u00e0 \\(j\\). Ta bi\u1ebft r\u1eb1ng kh\u1ed1i l\u01b0\u1ee3ng l\u1edbn nh\u1ea5t c\u1ee7a th\u00e1p l\u00e0 g\u1ea5p \u0111\u00f4i \\(w_{\\text{max}}\\).</p> <p>Ban \u0111\u1ea7u, \\(dp[0][0] = 0\\).</p> <p>V\u1edbi m\u1ed7i kh\u1ed1i \u0111\u00e1, ta c\u00f3 th\u1ec3 \u0111\u1eb7t n\u00f3 l\u00ean th\u00e1p ho\u1eb7c kh\u00f4ng (ngh\u0129a l\u00e0 \u0111\u1eb7t d\u01b0\u1edbi c\u00f9ng \u0111\u1ea5y). N\u1ebfu \u0111\u1eb7t n\u00f3 l\u00ean th\u00e1p, ta c\u1ea7n ki\u1ec3m tra xem kh\u1ed1i \u0111\u00e1 \u0111\u00f3 c\u00f3 ch\u1ecbu \u0111\u01b0\u1ee3c c\u00e1i th\u00e1p hi\u1ec7n t\u1ea1i kh\u00f4ng.</p> \\[dp[i][j + w[i]] = \\max(dp[i][j + w[i]], dp[i - 1][j] + v[i]), \\forall j \\leq s[i]\\] <p>Cu\u1ed1i c\u00f9ng, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(\\max(dp[n][j])\\) v\u1edbi m\u1ecdi \\(j\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(n \\cdot \\max(w))\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(\\max(w))\\) n\u1ebfu ta ch\u1ec9 l\u01b0u m\u1ed9t h\u00e0ng c\u1ee7a \\(dp\\), \\(dp[j]\\).</p>"},{"location":"AtCoder/dp-contest/#y-grid-2","title":"Y - Grid 2","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>Cho m\u1ed9t b\u1ea3ng \\(H \\times W\\). C\u00f3 \\(N\\) \u00f4 l\u00e0 t\u01b0\u1eddng v\u00e0 b\u1ea1n kh\u00f4ng \u0111i v\u00e0o \u0111\u01b0\u1ee3c. C\u00e1c \u00f4 \\((1, 1)\\) v\u00e0 \\((H, W)\\) l\u00e0 \u00f4 xu\u1ea5t ph\u00e1t v\u00e0 k\u1ebft th\u00fac, \u0111\u1ec1u l\u00e0 \u00f4 tr\u1ed1ng. Ta b\u1eaft \u0111\u1ea7u t\u1eeb \u00f4 \\((1, 1)\\) v\u00e0 c\u1ea7n \u0111i \u0111\u1ebfn \u00f4 \\((H, W)\\), m\u1ed7i b\u01b0\u1edbc ch\u1ec9 c\u00f3 th\u1ec3 \u0111i sang ph\u1ea3i ho\u1eb7c xu\u1ed1ng d\u01b0\u1edbi. H\u00e3y t\u00ednh s\u1ed1 c\u00e1ch \u0111i.</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(1 \\leq H, W \\leq 10^5\\)</p> <p>\\(1 \\leq N \\leq 3000\\)</p> L\u1eddi gi\u1ea3i <p>S\u1ed1 c\u00e1ch \u0111i t\u1eeb \u00f4 \\((x, y)\\) \u0111\u1ebfn \u00f4 \\((u, v)\\) l\u00e0 \\(\\binom{u-x+v-y}{u-x}\\) (v\u1edbi \\(x \\leq u, y \\leq v\\) v\u00e0 kh\u00f4ng c\u00f3 ch\u01b0\u1edbng ng\u1ea1i v\u1eadt tr\u00ean \u0111\u01b0\u1eddng \u0111i, ch\u1ec9 \u0111\u01b0\u1ee3c di chuy\u1ec3n sang ph\u1ea3i ho\u1eb7c xu\u1ed1ng d\u01b0\u1edbi trong b\u1ea3ng).</p> <p>G\u1ecdi \\(dp[i]\\) l\u00e0 s\u1ed1 c\u00e1ch \u0111i t\u1eeb \u00f4 \\((1, 1)\\) \u0111\u1ebfn \u00f4 \\((x[i], y[i])\\) m\u00e0 kh\u00f4ng \u0111i qua ch\u01b0\u1edbng ng\u1ea1i v\u1eadt n\u00e0o (ngh\u0129a l\u00e0 kh\u00f4ng qua \u00f4 ch\u01b0\u1edbng ng\u1ea1i n\u00e0o kh\u00e1c ngo\u00e0i \u00f4 th\u1ee9 \\(i\\)).</p> <p>S\u1ed1 c\u00e1ch \u0111i t\u1eeb \u00f4 \\((1, 1)\\) \u0111\u1ebfn \u00f4 \\((x[i], y[i])\\) l\u00e0 \\(\\binom{x[i]+y[i]-2}{x[i]-1}\\), nh\u01b0ng ta c\u1ea7n lo\u1ea1i b\u1ecf \u0111\u01b0\u1eddng \u0111i t\u1eeb \\((1, 1)\\) \u0111\u1ebfn ch\u01b0\u1edbng ng\u1ea1i v\u1eadt b\u00ean trong h\u00ecnh ch\u1eef nh\u1eadt \\((1, 1, x[i], y[i])\\), \u0111\u00f3 l\u00e0 \\(dp[j] \\cdot \\binom{x[i]-x[j]+y[i]-y[j]}{x[i]-x[j]}\\) v\u1edbi m\u1ecdi \\(j\\) sao cho \\(x[j] \\leq x[i]\\) v\u00e0 \\(y[j] \\leq y[i]\\). Ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp c\u00e1c \u00f4 ban \u0111\u1ea7u theo \\(x[i]\\) \u0111\u1ec3 c\u00e1c \u00f4 nh\u01b0 v\u1eady \u0111\u1ebfn tr\u01b0\u1edbc \u00f4 th\u1ee9 \\(i\\).</p> <p>Th\u00eam \u00f4 \\((H, W)\\) v\u00e0o cu\u1ed1i m\u1ea3ng v\u00e0 b\u1eaft \u0111\u1ea7u t\u00ednh DP, k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng c\u1ee7a m\u1ea3ng \\(dp\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(\\max(n^2, H+W))\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(\\max(n, H+W))\\).</p>"},{"location":"AtCoder/dp-contest/#z-frog-3","title":"Z - Frog 3","text":"<p>Link \u0111\u1ec1 b\u00e0i</p> <p>C\u00f3 \\(N\\) vi\u00ean \u0111\u00e1, m\u1ed7i vi\u00ean \u0111\u00e1 \\(i\\) c\u00f3 chi\u1ec1u cao \\(h[i]\\), d\u00e3y \\(h\\) t\u0103ng d\u1ea7n. C\u00f3 m\u1ed9t con \u1ebfch \u1edf vi\u00ean \u0111\u00e1 \\(1\\) v\u00e0 mu\u1ed1n nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(N\\). T\u1eeb vi\u00ean \u0111\u00e1 \\(i\\), con \u1ebfch c\u00f3 th\u1ec3 nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i+1, i+2, ..., N\\) v\u1edbi chi ph\u00ed l\u00e0 \\((h[j] - h[i])^2 + C\\), v\u1edbi \\(j\\) l\u00e0 vi\u00ean \u0111\u00e1 m\u00e0 con \u1ebfch nh\u1ea3y \u0111\u1ebfn. H\u00e3y t\u00ednh chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u1ec3 con \u1ebfch nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(N\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <p>\\(2 \\leq N \\leq 2 \\times 10^5\\)</p> <p>\\(1 \\leq C \\leq 10^{12}\\)</p> <p>\\(1 \\leq h[1] &lt; h[2] &lt; \\cdots &lt; h[N] \\leq 10^6\\)</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(dp[i]\\) l\u00e0 chi ph\u00ed nh\u1ecf nh\u1ea5t \u0111\u1ec3 nh\u1ea3y \u0111\u1ebfn vi\u00ean \u0111\u00e1 \\(i\\). Ban \u0111\u1ea7u, \\(dp[1] = 0\\).</p> \\[\\begin{align} dp[i] &amp;= \\min(dp[j] + C + (h[i] - h[j])^2), \\forall j &lt; i \\\\ &amp;= \\min(dp[j] + C + h[i]^2 - 2 \\cdot h[i] \\cdot h[j] + h[j]^2), \\forall j &lt; i \\\\ &amp;= C + h[i]^2 + \\min(dp[j] - 2 \\cdot h[j] \\cdot h[i] + h[j]^2), \\forall j &lt; i \\end{align}\\] <p>\\(dp[j] - 2 \\cdot h[j] \\cdot h[i] + h[j]^2\\) c\u00f3 th\u1ec3 vi\u1ebft l\u1ea1i d\u01b0\u1edbi d\u1ea1ng \\((-2 \\cdot h[j]) \\cdot x + (dp[j] + h[j]^2)\\) v\u1edbi \\(x = h[i]\\), t\u1ea1o th\u00e0nh m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng \\(y = mx + b\\), \\(m\\) c\u0169ng \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n, v\u1eady ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng Convex Hull Trick \u0111\u1ec3 gi\u1ea3i b\u00e0i to\u00e1n n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm hi\u1ec3u k\u1ef9 thu\u1eadt n\u00e0y t\u1ea1i \u0111\u00e2y.</p> <p>Khi \\(x = h[i]\\), v\u00ec \\(x\\) t\u0103ng d\u1ea7n, \u0111\u01b0\u1eddng th\u1eb3ng ta c\u1ea7n s\u1ebd c\u00f3 xu h\u01b0\u1edbng n\u1eb1m sau trong danh s\u00e1ch \u0111\u01b0\u1eddng th\u1eb3ng c\u1ee7a bao l\u1ed3i, v\u1eady ta ch\u1ec9 c\u1ea7n duy tr\u00ec m\u1ed9t con tr\u1ecf v\u00e0 di chuy\u1ec3n n\u00f3 v\u1ec1 ph\u00eda tr\u01b0\u1edbc cho \u0111\u1ebfn khi \u0111\u01b0\u1eddng th\u1eb3ng ti\u1ebfp theo kh\u00f4ng cho ra k\u1ebft qu\u1ea3 t\u1ed1t h\u01a1n \u0111\u01b0\u1eddng th\u1eb3ng hi\u1ec7n t\u1ea1i.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p kh\u00f4ng gian c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"AtCoder/dp-contest/#cai-at","title":"C\u00e0i \u0111\u1eb7t","text":"Problem Status Submission Code Date A - Frog 1 Submission Code 07/07/2024 B - Frog 2 Submission Code 07/07/2024 C - Vacation Submission Code 07/07/2024 D - Knapsack 1 Submission Code 20/07/2024 E - Knapsack 2 Submission Code 20/07/2024 F - LCS Submission Code 20/07/2024 G - Longest Path Submission Code 22/07/2024 H - Grid 1 Submission Code 23/07/2024 I - Coins Submission Code 23/07/2024 J - Sushi Submission Code 23/07/2024 K - Stones Submission Code 23/07/2024 L - Deque Submission Code 23/07/2024 M - Candies Submission Code 24/07/2024 N - Slimes Submission Code 24/07/2024 O - Matching Submission Code 24/07/2024 P - Independent Set Submission Code 25/07/2024 Q - Flowers Submission Code 25/07/2024 R - Walk Submission Code 25/07/2024 S - Digit Sum Submission Code 26/07/2024 T - Permutation Submission Code 26/07/2024 U - Grouping Submission Code 26/07/2024 V - Subtree Submission Code 27/07/2024 W - Intervals Submission Code 27/07/2024 X - Tower Submission Code 27/07/2024 Y - Grid 2 Submission Code 27/07/2024 Z - Frog 3 Submission Code 27/07/2024"},{"location":"Codechef/data-structures/disjoint-sparse-table/","title":"Disjoint Sparse Table","text":""},{"location":"Codechef/data-structures/disjoint-sparse-table/#disjoint-sparse-table","title":"Disjoint Sparse Table","text":""},{"location":"Codechef/data-structures/disjoint-sparse-table/#nguon","title":"Ngu\u1ed3n","text":"<p> [Tutorial] Disjoint Sparse Table</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>Tr\u01b0\u1edbc khi \u0111i v\u00e0o c\u1ea5u tr\u00fac c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y, ch\u00fang ta h\u00e3y xem n\u00f3 c\u00f3 th\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c g\u00ec.</p> <p>Cho m\u1ed9t d\u00e3y \\(A\\) c\u00f3 \u0111\u1ed9 d\u00e0i \\(N\\) v\u00e0 \\(Q\\) truy v\u1ea5n. M\u1ed7i truy v\u1ea5n y\u00eau c\u1ea7u b\u1ea1n th\u1ef1c hi\u1ec7n m\u1ed9t h\u00e0m \\(F\\) tr\u00ean \u0111o\u1ea1n con \\([L, R]\\), ngh\u0129a l\u00e0 \\(F(A_L, A_{L+1}, \\ldots, A_R)\\).</p> <p>V\u1edbi sparse table b\u00ecnh th\u01b0\u1eddng, b\u1ea1n c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong \\(O(\\log  N)\\) v\u1edbi \\(\\Theta(N \\log N)\\) ti\u1ec1n x\u1eed l\u00fd.</p> <p>G\u1ecdi \\(N' = 2 ^ {\\lceil\\log N\\rceil}\\), v\u1edbi Disjoint Sparse Table ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong \\(\\Theta(1)\\) v\u1edbi \\(\\Theta(N' \\log N')\\) ti\u1ec1n x\u1eed l\u00fd.</p> <p>L\u01b0u \u00fd:</p> <ul> <li>\\(\\log\\) l\u00e0 theo h\u1ec7 c\u01a1 s\u1ed1 2, hay c\u00f2n g\u1ecdi l\u00e0 logarit nh\u1ecb ph\u00e2n</li> <li>M\u1ea3ng \\(A\\) kh\u00f4ng thay \u0111\u1ed5i</li> <li>H\u00e0m \\(F\\) l\u00e0 c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p</li> <li>N\u1ebfu \\(F\\) l\u00e0 h\u00e0m idempotent, sparse table b\u00ecnh th\u01b0\u1eddng c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n trong \\(\\Theta(1)\\)</li> </ul> <p>Th\u1ef1c s\u1ef1 th\u00ec b\u1ea1n kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i d\u00f9ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y trong h\u1ea7u h\u1ebft c\u00e1c b\u00e0i to\u00e1n, v\u00ec c\u00e1c b\u00e0i v\u1edbi d\u1eef li\u1ec7u kh\u00f4ng \u0111\u1ed5i v\u00e0 time limit ch\u1eadt r\u1ea5t hi\u1ebfm.</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#cau-truc","title":"C\u1ea5u tr\u00fac","text":"<p>C\u1ea5u tr\u00fac c\u1ee7a n\u00f3 gi\u1ed1ng h\u1ec7t segment tree. M\u1ed7i node l\u01b0u th\u00f4ng tin li\u00ean quan \u0111\u1ebfn \u0111o\u1ea1n m\u00e0 n\u00f3 qu\u1ea3n l\u00fd \\([L, R)\\).</p> <p></p> <p>X\u00e9t m\u1ed9t node qu\u1ea3n l\u00fd \u0111o\u1ea1n \\([L, R)\\) v\u00e0 ch\u1ec9 s\u1ed1 \u1edf gi\u1eefa \\(M = \\frac{L + R}{2}\\).</p> <p>Node n\u00e0y l\u01b0u c\u00e1c gi\u00e1 tr\u1ecb ti\u1ec1n x\u1eed l\u00fd c\u1ee7a</p> \\[F(A[i \\ldots M]) \\text{ | } i \\in [L, M] \\text{ v\u00e0} \\] \\[F(A[M + 1 \\ldots i]) \\text{ | } i \\in [M + 1, R)\\] <p>N\u00ean k\u00edch th\u01b0\u1edbc node s\u1ebd l\u00e0 \\(R - L\\). N\u1ebfu k\u00edch th\u01b0\u1edbc \\(&gt; 1\\), n\u00f3 s\u1ebd c\u00f3 2 node con t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111o\u1ea1n \\([L, M)\\) v\u00e0 \\([M, R)\\).</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#cach-xay-dung","title":"C\u00e1ch x\u00e2y d\u1ef1ng","text":"<p>Gi\u1edd \u0111\u1ec3 t\u1ea1o node t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111o\u1ea1n \\([L, R)\\), \u0111\u1ea7u ti\u00ean ta c\u1ea7n t\u00ednh t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb ti\u1ec1n x\u1eed l\u00fd trong \\(\\Theta(R-L)\\) v\u00e0 t\u1ea1o c\u00e1c node con c\u1ee7a n\u00f3.</p> <p>G\u1ecdi \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e2y v\u1edbi node g\u1ed1c c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 \\(X\\) l\u00e0 \\(T(X)\\) th\u00ec ta c\u00f3</p> \\[T(X) = 2T(\\frac{X}{2}) + \\Theta(X)\\] \\[\\Rightarrow T(X) = \\Theta(X \\log X)\\] <p>V\u1eady th\u1eddi gian \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e2y DST l\u00e0 \\(\\Theta(N \\log N)\\).</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#truy-van","title":"Truy v\u1ea5n","text":"<p>Ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n m\u1ed9t c\u00e1ch \u0111\u1ec7 quy t\u01b0\u01a1ng t\u1ef1 nh\u01b0 khi l\u00e0m v\u1edbi segment tree. X\u00e9t tr\u01b0\u1eddng h\u1ee3p ta \u0111ang \u1edf node \\([L, R)\\) v\u00e0 ta c\u1ea7n tr\u1ea3 l\u1eddi truy v\u1ea5n \u1ee9ng v\u1edbi \u0111o\u1ea1n \\([X, Y]\\), th\u00ec</p> <p>N\u1ebfu \\(X \\leq M \\leq Y\\), ta c\u00f3 th\u00ea tr\u1ea3 l\u1eddi trong \\(\\Theta(1)\\) v\u00ec ta c\u00f3 th\u1ec3 ch\u1eadp k\u1ebft qu\u1ea3 c\u1ee7a \\([X, M]\\) v\u00e0 \\([M+1, Y]\\) trong \\(\\Theta(1)\\). Ng\u01b0\u1ee3c l\u1ea1i n\u1ebfu \u0111o\u1ea1n \\([X, Y]\\) n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed9t node con n\u00e0o \u0111\u00f3, ta di chuy\u1ec3n xu\u1ed1ng node \u0111\u00f3 \u0111\u1ec3 th\u1ef1c hi\u1ec7n truy v\u1ea5n.</p> <p>V\u1eady \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a vi\u1ec7c truy v\u1ea5n s\u1ebd l\u00e0 \\(O(\\log N)\\). L\u01b0u \u00fd l\u00e0 tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t x\u1ea3y ra c\u00f3 th\u1ec3 v\u00ed d\u1ee5 nh\u01b0 khi \\(X = Y = \\frac{N}{2} - 1\\).</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#cai-thien-o-phuc-tap","title":"C\u1ea3i thi\u1ec7n \u0111\u1ed9 ph\u1ee9c t\u1ea1p","text":"<p>Gi\u1edd ta h\u00e3y t\u0103ng k\u00edch th\u01b0\u1edbc m\u1ea3ng \\(A\\) l\u00ean th\u00e0nh \\(N' = 2 ^ {\\lceil\\log N\\rceil}\\), ngh\u0129a l\u00e0 k\u00edch th\u01b0\u1edbc m\u1ea3ng b\u00e2y gi\u1edd l\u00e0 m\u1ed9t lu\u1ef9 th\u1eeba c\u1ee7a \\(2\\). L\u01b0u \u00fd l\u00e0 \u0111i\u1ec1u n\u00e0y kh\u00f4ng l\u00e0m thay \u0111\u1ed5i k\u1ebft qu\u1ea3 c\u1ee7a b\u1ea5t k\u1ef3 truy v\u1ea5n n\u00e0o. G\u1ecdi \\(x = \\lceil\\log N\\rceil\\).</p> <p>X\u00e9t node th\u1ee9 \\(j\\) (\u0111\u00e1nh s\u1ed1 t\u1eeb 0, t\u1eeb tr\u00e1i sang) \u1edf \u0111\u1ed9 s\u00e2u \\(i\\). K\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3 l\u00e0 \\(\\frac{N'}{2 ^ i}\\). N\u00f3 s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111o\u1ea1n \\([\\frac{N'}{2 ^ i} \\times j, \\frac{N'}{2 ^ i} \\times (j + 1))\\), \\(M = j \\times \\frac{N'}{2 ^ i} + \\frac{N'}{2 ^ {i + 1}}\\)</p> <p>X\u00e9t bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a \\(M\\). N\u00f3 tr\u00f4ng s\u1ebd nh\u01b0 sau:</p> \\[\\underbrace{m_1m_2m_3m_4m_5 \\ldots m_k}_\\text{bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a j}\\underbrace{100000 \\ldots 00000}_\\text{x - i - 1 s\u1ed1 0}\\] <p>Gi\u1ea3 s\u1eed ta \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u tr\u1ea3 l\u1eddi truy v\u1ea5n \\([L, R]\\). \u1ede \u0111\u00e2y ta b\u1ecf qua tr\u01b0\u1eddng h\u1ee3p c\u01a1 b\u1ea3n l\u00e0 \\(L = R\\) v\u00e0 ch\u1ec9 x\u00e9t khi \\(L &lt; R\\) th\u00ec bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a \\(L\\) v\u00e0 \\(R\\) s\u1ebd nh\u01b0 sau:</p> \\[\\begin{array}{ccccccc} L &amp; = b_0b_1b_2b_3 \\ldots b_{k_{1}} &amp; 0 &amp; l_1 &amp; l_2 &amp; \\ldots &amp; l_{k_{2}} \\\\ R &amp; = b_0b_1b_2b_3 \\ldots b_{k_{1}} &amp; 1 &amp; r_1 &amp; r_2 &amp; \\ldots &amp; r_{k_{2}} \\\\ \\hline M &amp; = b_0b_1b_2b_3 \\ldots b_{k_{1}} &amp; 1 &amp;   0 &amp;   0 &amp; \\ldots &amp; 0         \\\\ \\end{array}\\] <p>L\u01b0u \u00fd l\u00e0 \\(k_2 = \\text{\u0111\u1ed9 d\u00e0i bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n} - \\text{s\u1ed1 s\u1ed1 0 ph\u00eda tr\u01b0\u1edbc c\u1ee7a } L \\oplus R - 1\\)</p> <p>D\u1ec5 th\u1ea5y l\u00e0 \\(L &lt; M \\leq R\\). H\u01a1n n\u1eefa c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng node \u1edf \u0111\u1ed9 s\u00e2u \\(x - k_2 - 1\\) nh\u1eadn \\(M\\) l\u00e0 ph\u1ea7n t\u1eed n\u1eb1m gi\u1eefa. Gi\u1edd ta c\u1ea7n x\u00e1c nh\u1eadn \\([L, R]\\) n\u1eb1m ho\u00e0n to\u00e0n trong \\([X, Y]\\).</p> <p>Bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a \\(X\\) v\u00e0 \\(Y\\) nh\u01b0 sau:</p> \\[\\begin{array}{ccccccc} M &amp; = b_0b_1b_2b_3 \\ldots b_{k_{1}} &amp; 1 &amp; 0 &amp; 0 &amp; \\ldots &amp; 0 \\\\ X &amp; = b_0b_1b_2b_3 \\ldots b_{k_{1}} &amp; 0 &amp; 0 &amp; 0 &amp; \\ldots &amp; 0 \\\\ Y &amp; = b_0b_1b_2b_3 \\ldots b_{k_{1}} &amp; 1 &amp; 1 &amp; 1 &amp; \\ldots &amp; 1 \\\\ \\end{array}\\] <p>Suy ra \\(X \\leq L &lt; R \\leq Y\\).</p> <p>Vi x\u1eed l\u00fd m\u00e1y t\u00ednh ch\u00fang ta c\u00f3 thao t\u00e1c BSR (Bit Scan Reverse) n\u00ean ta c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c node qu\u1ea3n l\u00fd \u0111o\u1ea1n \\([X, Y]\\) trong \\(\\Theta(1)\\).</p> <p>V\u1eady n\u00ean gi\u1edd m\u1ed7i truy v\u1ea5n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi trong \\(\\Theta(1)\\)</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#cai-at","title":"C\u00e0i \u0111\u1eb7t","text":"<p>Ta th\u1ea5y tr\u00ean m\u1ed7i \u0111\u1ed9 s\u00e2u th\u00ec t\u1ed5ng k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c node b\u1eb1ng \\(N\\), v\u00ec v\u1eady ta c\u00f3 th\u1ec3 d\u00f9ng m\u1ed9t m\u1ea3ng 2 chi\u1ec1u \u0111\u1ec3 l\u01b0u DST. V\u00ed d\u1ee5 v\u1edbi m\u1ed9t b\u00e0i to\u00e1n nh\u01b0 sau:</p>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#truy-van-tich-cua-oan","title":"Truy v\u1ea5n t\u00edch c\u1ee7a \u0111o\u1ea1n","text":"<p>Cho m\u1ed9t m\u1ea3ng \\(A\\) v\u00e0 m\u1ed9t s\u1ed1 \\(P\\), ta c\u1ea7n tr\u1ea3 l\u1eddi \\(Q\\) truy v\u1ea5n c\u00f3 d\u1ea1ng: cho \\(L\\) v\u00e0 \\(R\\), \\(0 \\leq L \\leq R &lt; N\\), t\u00ecm \\(\\prod_{i=L}^{R} A[i]\\text{ (mod P)}\\).</p> <p>Ta c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>struct DisjointSparseTable {\n    vi a;\n    int size, x;\n    ll p;\n    vector&lt;vi&gt; table;\n\n    DisjointSparseTable(vi &amp;a, int p) {\n        // t\u1ea5t c\u1ea3 ch\u1ec9 s\u1ed1 b\u1eaft \u0111\u1ea7u t\u1eeb 0\n        // \u0111\u1ea7u v\u00e0o l\u00e0 m\u1ea3ng A v\u00e0 s\u1ed1 P\n        this-&gt;a = a;\n        this-&gt;p = p;\n\n        // x =floor(log_2(n))\n        // size = 2^x = 2^floor(log_2(n))\n        size = SZ(a);\n        x = __builtin_clz(SZ(a)) ^ 31;\n        if( (1&lt;&lt;x) != SZ(a)) size = (1&lt;&lt;(++x));\n\n        // c\u1eadp nh\u1eadt \u0111\u1ed9 d\u00e0i m\u1ea3ng A\n        this-&gt;a.resize(size);\n\n        // t\u1ea1o sparse table, c\u00f3 x+1 level (t\u1eeb 0 \u0111\u1ebfn x nh\u01b0 h\u00ecnh tr\u00ean)\n        // m\u1ed7i level c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 size\n        table.resize(x+1, vi(size));\n\n        // fill v\u00e0o table n\u00e0y\n        build();\n    }\n\n    void build() {\n        int len = 1;\n        // fill b\u1ea3ng t\u1eeb level qu\u1ea3n l\u00fd node l\u00e1 l\u00ean\n        FORE(level,x,0) {\n            for (int l = 0; l &lt; size; l += len) {\n                // l\u01b0u \u00fd \u0111o\u1ea1n n\u00e0y l\u00e0 [l, r), kh\u00f4ng ph\u1ea3i [l, r]\n                int r = l + len;\n\n                // mid \u1edf \u0111\u00e2y s\u1ebd c\u00f3 d\u1ea1ng xxxxx01111\n                // t\u01b0\u01a1ng t\u1ef1 mid + 1 s\u1ebd l\u00e0 xxxxx10000\n                int mid = (l + r) &gt;&gt; 1;\n\n                // b\u1eaft \u0111\u1ea7u fill v\u00e0o 2 \u0111o\u1ea1n t\u1eeb mid v\u00e0 mid+1, theo 2 h\u01b0\u1edbng kh\u00e1c nhau\n                table[level][mid] = a[mid] % p;\n                FORE(i,mid-1,l) table[level][i] = (ll) table[level][i+1] * a[i] % p;\n\n                if (mid + 1 &lt; r) {\n                    table[level][mid+1] = a[mid+1] % p;\n                    FOR(i,mid+2,r-1) table[level][i] = (ll) table[level][i-1] * a[i] % p;\n                }\n            }\n            len &lt;&lt;= 1;\n        }\n    }\n\n    int query(int l, int r) {\n        // truy v\u1ea5n tr\u00ean \u0111o\u1ea1n [l, r]\n        if (l == r) {\n            // tr\u01b0\u1eddng h\u1ee3p c\u01a1 b\u1ea3n\n            return a[l] % p;\n        }\n\n        // l\u1ea5y \u0111\u1ed9 d\u00e0i k2 nh\u01b0 trong ph\u1ea7n ch\u1ee9ng minh\n        int k2 = __builtin_clz(l ^ r) ^ 31;\n        // l\u1ea5y level c\u1ee7a \u0111o\u1ea1n\n        int lev = x - 1 - k2;\n        // t\u00ednh k\u1ebft qu\u1ea3 \u0111o\u1ea1n b\u00ean tr\u00e1i\n        int ans = table[lev][l];\n        if (r &amp; ((1&lt;&lt;k2) - 1)) {\n            // n\u1ebfu y % (1&lt;&lt;k2), ngh\u0129a l\u00e0 c\u00f3 \u0111o\u1ea1n b\u00ean ph\u1ea3i, ta th\u00eam \u0111o\u1ea1n b\u00ean ph\u1ea3i v\u00e0o\n            ans = (ll) ans * table[lev][r] % p;\n        }\n        return ans;\n    }\n};\n</code></pre>"},{"location":"Codechef/data-structures/disjoint-sparse-table/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date Codechef - SEGPROD Submission Code 29/11/2022"},{"location":"Codeforces/bit-manipulation/xor-basis/","title":"K\u0129 thu\u1eadt Vector c\u01a1 s\u1edf cho c\u00e1c b\u00e0i to\u00e1n XOR","text":""},{"location":"Codeforces/bit-manipulation/xor-basis/#ki-thuat-vector-co-so-cho-cac-bai-toan-xor","title":"K\u0129 thu\u1eadt Vector c\u01a1 s\u1edf cho c\u00e1c b\u00e0i to\u00e1n XOR","text":""},{"location":"Codeforces/bit-manipulation/xor-basis/#nguon","title":"Ngu\u1ed3n","text":"<p> A Beautiful Technique for Some XOR Related Problems</p>"},{"location":"Codeforces/bit-manipulation/xor-basis/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>Vector c\u01a1 s\u1edf (hay kh\u1eed Gauss nh\u1ecb ph\u00e2n) l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt hay d\u00f9ng trong c\u00e1c b\u00e0i to\u00e1n ki\u1ec3u t\u1ed5ng XOR (XOR-sum). M\u1ed9t c\u00e1ch t\u1ed5ng qu\u00e1t h\u01a1n, d\u1ea1ng b\u00e0i n\u00e0y nh\u01b0 sau: cho m\u1ed9t d\u00e3y c\u00e1c s\u1ed1, b\u00e0i to\u00e1n s\u1ebd y\u00eau c\u1ea7u t\u00ednh t\u1ed5ng XOR c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n con c\u1ee7a d\u00e3y s\u1ed1 \u0111\u00f3. K\u1ef9 thu\u1eadt n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\u00e1c b\u00e0i x\u1eed l\u00fd online (x\u1eed l\u00fd tr\u1ef1c ti\u1ebfp truy v\u1ea5n ngay sau khi nh\u1eadn, kh\u00e1c v\u1edbi x\u1eed l\u00fd offline l\u00e0 khi ta nh\u1eadn t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n r\u1ed3i x\u1eed l\u00fd): b\u00e0i to\u00e1n c\u00f3 th\u1ec3 cho c\u00e1c truy v\u1ea5n \u0111\u1ec3 th\u00eam s\u1ed1 vo m\u1ea3ng (kh\u00f4ng xo\u00e1 s\u1ed1) v\u00e0 gi\u1eefa c\u00e1c truy v\u1ea5n \u0111\u00f3, s\u1ebd c\u00f3 c\u00e1c truy v\u1ea5n t\u00ecm gi\u00e1 tr\u1ecb gi\u1ed1ng nh\u01b0 b\u00e0i to\u00e1n tr\u01b0\u1edbc.</p> <p>K\u1ef9 thu\u1eadt n\u00e0y \u0111\u01b0\u1ee3c chia l\u00e0m 2 ph\u1ea7n trong b\u00e0i vi\u1ebft n\u00e0y, v\u00e0 m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i ch\u1ec9 v\u1edbi ph\u1ea7n \u0111\u1ea7u ti\u00ean.</p> <ol> <li>Bi\u1ec3u di\u1ec5n m\u1ed7i s\u1ed1 theo d\u1ea1ng nh\u1ecb ph\u00e2n v\u00e0 cho n\u00f3 l\u00e0 m\u1ed9t vector tr\u00ean m\u1ed9t kh\u00f4ng gian vector \\(\\mathbb{Z}_2^d\\), v\u1edbi \\(d\\) l\u00e0 s\u1ed1 l\u01b0\u1ee3ng t\u1ed1i \u0111a c\u00e1c bit trong m\u1ed9t s\u1ed1. Sau \u0111\u00f3, XOR c\u1ee7a m\u1ed9t s\u1ed1 s\u1ed1 trong n\u00e0y s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1ed5ng c\u1ee7a c\u00e1c vector t\u01b0\u01a1ng \u1ee9ng trong kh\u00f4ng gian vector.</li> <li>B\u1eb1ng m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3, li\u00ean h\u1ec7 k\u1ebft qu\u1ea3 \u0111\u00f3 v\u1edbi c\u00e1c truy v\u1ea5n t\u1ed5ng XOR v\u1edbi c\u01a1 s\u1edf c\u1ee7a c\u00e1c vector trong ph\u1ea7n 1.</li> </ol>"},{"location":"Codeforces/bit-manipulation/xor-basis/#phan-1-lien-he-giua-xor-va-phep-cong-vector-trong-mathbbz_2d","title":"Ph\u1ea7n 1: Li\u00ean h\u1ec7 gi\u1eefa XOR v\u00e0 ph\u00e9p c\u1ed9ng vector trong \\(\\mathbb{Z}_2^d\\)","text":"<p>Gi\u1ea3 s\u1eed ta XOR s\u1ed1 \\(2\\) v\u00e0 s\u1ed1 \\(3\\), n\u00f3 tr\u00f4ng s\u1ebd nh\u01b0 sau:</p> \\[\\begin{equation*}\\begin{array}{r} (10)_2\\\\ \\underline{\\oplus\\;(11)_2}\\\\ (01)_2 \\end{array}\\end{equation*}\\] <p>Gi\u1edd v\u1edbi m\u1ed7i c\u1eb7p bit t\u01b0\u01a1ng \u1ee9ng c\u1ee7a hai s\u1ed1 tr\u00ean, so s\u00e1nh k\u1ebft qu\u1ea3 XOR v\u1edbi k\u1ebft qu\u1ea3 t\u1ed5ng modulo \\(2\\):</p> Bit th\u1ee9 S\u1ed1 \u0111\u1ea7u ti\u00ean S\u1ed1 th\u1ee9 hai \\(\\oplus\\) T\u1ed5ng T\u1ed5ng modulo \\(2\\) 1 0 1 1 1 1 2 1 1 0 2 0 <p>\u0110\u1ec3 \u00fd r\u1eb1ng c\u1ed9t 4 v\u00e0 6 tr\u00f4ng c\u00f3 v\u1ebb gi\u1ed1ng nhau, n\u00ean ta th\u1ea5y r\u1eb1ng XOR c\u1ee7a hai s\u1ed1 th\u1ef1c ra c\u0169ng gi\u1ed1ng nh\u01b0, v\u1edbi m\u1ed7i bit, t\u1ed5ng m\u1ed7i bit ri\u00eang bi\u1ec7t modulo \\(2\\).</p> <p>X\u00e9t m\u1ed9t m\u1eb7t ph\u1eb3ng to\u1ea1 \u0111\u1ed9 v\u1edbi c\u00e1c to\u1ea1 \u0111\u1ed9 l\u00e0 s\u1ed1 nguy\u00ean, ch\u1ec9 bao g\u1ed3m \\(0\\) v\u00e0 \\(1\\). N\u1ebfu b\u1ea5t k\u00ec to\u1ea1 \u0111\u1ed9 n\u00e0o l\u1edbn h\u01a1n \\(1\\) ho\u1eb7c nh\u1ecf h\u01a1n \\(0\\), ta s\u1ebd l\u1ea5y modulo \\(2\\) c\u1ee7a n\u00f3.</p> <p>B\u1eb1ng c\u00e1ch n\u00e0y, s\u1ebd ch\u1ec9 c\u00f3 b\u1ed1n \u0111i\u1ec3m tr\u00ean m\u1eb7t ph\u1eb3ng to\u1ea1 \u0111\u1ed9 n\u00e0y: \\((0, 0), (0, 1), (1, 0), (1, 1)\\). B\u1ea5t c\u1ee9 c\u1eb7p to\u1ea1 \u0111\u1ed9 n\u00e0o kh\u00e1c \u0111\u1ec1u s\u1ebd li\u00ean h\u1ec7 \u0111\u1ebfn ch\u00fang, v\u00ed d\u1ee5, \u0111i\u1ec3m \\((3, 2)\\) tr\u00f9ng v\u1edbi \u0111i\u1ec3m \\((1, 0)\\) v\u00ec \\(3 \\equiv 1\\) v\u00e0 \\(2 \\equiv 0\\) modulo \\(2\\).</p> <p>V\u1edbi h\u1ec7 to\u1ea1 \u0111\u1ed9 n\u00e0y, ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n s\u1ed1 \\(2 = (10)_2\\) th\u00e0nh \u0111i\u1ec3m \\((0, 1)\\) b\u1eb1ng c\u00e1ch \u0111\u1eb7t bit \u0111\u1ea7u ti\u00ean c\u1ee7a \\(2\\) l\u00e0 \\(x\\) v\u00e0 bit th\u1ee9 hai l\u00e0 \\(y\\) tr\u00ean m\u1eb7t ph\u1eb3ng to\u1ea1 \u0111\u1ed9. \u0110\u1eb7t \u0111i\u1ec3m n\u00e0y l\u00e0 \\(P\\). Ta s\u1ebd c\u00f3 vector v\u1ecb tr\u00ed c\u1ee7a \\(2\\) s\u1ebd l\u00e0 \\(\\overrightarrow{OP}\\) v\u1edbi \\(O(0, 0)\\) l\u00e0 g\u1ed1c to\u1ea1 \u0111\u1ed9. T\u01b0\u01a1ng t\u1ef1, vector v\u1ecb tr\u00ed c\u1ee7a \\(3\\) l\u00e0 \\(\\overrightarrow{OQ}\\) v\u1edbi \\(Q = (1, 1)\\).</p> <p>C\u00f3 m\u1ed9t \u0111i\u1ec1u th\u00fa v\u1ecb \u1edf \u0111\u00e2y, n\u1ebfu ta c\u1ed9ng hai vector v\u1ecb tr\u00ed n\u00e0y v\u1edbi nhau, m\u1ed7i to\u1ea1 \u0111\u1ed9 sau khi l\u1ea5y t\u1ed5ng th\u00ec modulo \\(2\\), k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 vector v\u1ecb tr\u00ed c\u1ee7a XOR c\u1ee7a hai vector v\u1ecb tr\u00ed ban \u0111\u1ea7u. V\u00ed d\u1ee5, c\u1ed9ng hai vector \\overrightarrow{OP} v\u00e0 \\overrightarrow{OQ} ta s\u1ebd \u0111\u01b0\u1ee3c \\overrightarrow{OR} v\u1edbi \\(R(1, 0)\\) l\u00e0 \u0111i\u1ec3m t\u01b0\u01a1ng \u1ee9ng v\u1edbi XOR c\u1ee7a \\(2\\) v\u00e0 \\(3\\).</p> <p>Tr\u01b0\u1edbc khi \u0111i v\u00e0o b\u00e0i t\u1eadp c\u1ee7a ph\u1ea7n n\u00e0y, m\u00ecnh s\u1ebd gi\u1ea3i th\u00edch kh\u00f4ng gian vector v\u00e0 \\(\\mathbb{Z}_2^d\\) l\u00e0 g\u00ec.</p> <ul> <li>Kh\u00f4ng gian vector: Ch\u1ec9 l\u00e0 m\u1ed9t b\u1ed9 c\u00e1c vector.</li> <li>\\(\\underline{\\mathbb{Z_2}}\\): \\(\\mathbb{Z_m}\\) l\u00e0 b\u1ed9 s\u1ed1 d\u01b0 khi chia cho \\(m\\). V\u1eady \\(\\mathbb{Z_2}\\) \u0111\u01a1n gi\u1ea3n l\u00e0 b\u1ed9 \\(\\{0, 1\\}\\), v\u00ec \u0111\u00e2y l\u00e0 c\u00e1c s\u1ed1 d\u01b0 c\u00f3 th\u1ec3 c\u00f3 khi chia l\u1ea5y d\u01b0 v\u1edbi \\(2\\).</li> <li>\\(\\underline{\\mathbb{Z_2^d}}\\): M\u1ed9t kh\u00f4ng gian vector \\(d\\) chi\u1ec1u bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c vector v\u1ecb tr\u00ed ch\u1ee9a \\(d\\) ch\u1ec9 s\u1ed1 to\u1ea1 \u0111\u1ed9, t\u1ea5t c\u1ea3 c\u00e1c to\u1ea1 \u0111\u1ed9 n\u00e0y l\u00e0 ph\u1ea7n t\u1eed c\u1ee7a \\(\\mathbb{Z_2}\\). V\u00ed d\u1ee5, h\u1ec7 to\u1ea1 \u0111\u1ed9 ban \u0111\u1ea7u l\u00e0 m\u1ed9t h\u1ec7 to\u1ea1 \u0111\u1ed9 hai chi\u1ec1u, n\u00ean n\u00f3 l\u00e0 \\(\\mathbb{Z_2^2}\\). \\(\\mathbb{Z_2^3}\\) s\u1ebd l\u00e0 m\u1ed9t h\u1ec7 to\u1ea1 \u0111\u1ed9 3 chi\u1ec1u v\u1edbi \\(2^3 = 8\\) \u0111i\u1ec3m, t\u1ea5t c\u1ea3 c\u00e1c ch\u1ec9 s\u1ed1 to\u1ea1 \u0111\u1ed9 modulo \\(2\\).</li> </ul> <p>V\u1eady n\u00ean, to\u00e1n t\u1eed XOR c\u1ee7a ch\u00fang ta t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ph\u00e9p c\u1ed9ng vector trong kh\u00f4ng gian vector \\(\\mathbb{Z_2^d}\\)</p>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-1","title":"B\u00e0i t\u1eadp 1","text":"<p>CF 895C - Square Subsets</p> <p>T\u00ecm s\u1ed1 c\u00e1c t\u1eadp con kh\u00f4ng r\u1ed7ng (kh\u00f4ng nh\u1ea5t thi\u1ebft li\u00ean ti\u1ebfp), modulo \\(10^9+7\\) c\u1ee7a m\u1ea3ng \\(a\\) c\u00f3 \u0111\u1ed9 d\u00e0i \\(n\\) (\\(1 \\le n \\le 10^5\\)) v\u1edbi \\(1 \\leq a_i \\leq 70\\), m\u00e0 t\u00edch c\u00e1c ph\u1ea7n t\u1eed trong t\u1eadp con \u0111\u00f3 l\u00e0 m\u1ed9t s\u1ed1 ch\u00ednh ph\u01b0\u01a1ng.</p> L\u1eddi gi\u1ea3i <p>R\u00f5 r\u00e0ng l\u00e0 c\u00e1ch gi\u1ea3i c\u1ee7a ch\u00fang ta s\u1ebd xoay quanh \\(a_i\\) v\u00ec gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a n\u00f3 ch\u1ec9 l\u00e0 \\(70\\).</p> <p>\u0110\u1ec3 m\u1ed9t s\u1ed1 l\u00e0 ch\u00ednh ph\u01b0\u01a1ng, m\u1ed7i th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 c\u1ee7a n\u00f3 ph\u1ea3i c\u00f3 s\u1ed1 m\u0169 ch\u1eb5n. Ch\u1ec9 c\u00f3 \\(19\\) s\u1ed1 nguy\u00ean t\u1ed1 d\u01b0\u1edbi \\(70\\), n\u00ean ta c\u00f3 th\u1ec3 d\u00f9ng s\u1ed1 19 bit \u0111\u1ec3 bi\u1ec3u di\u1ec5n m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng, v\u1edbi bit th\u1ee9 \\(i\\) l\u00e0 \\(0\\) khi s\u1ed1 m\u0169 c\u1ee7a s\u1ed1 nguy\u00ean t\u1ed1 th\u1ee9 \\(i\\) ch\u1eb5n, ng\u01b0\u1ee3c l\u1ea1i l\u00e0 \\(1\\) v\u1edbi tr\u01b0\u1eddng h\u1ee3p l\u1ebb.</p> <p>B\u00e0i to\u00e1n l\u00fac n\u00e0y thu l\u1ea1i th\u00e0nh t\u00ecm s\u1ed1 t\u1eadp con kh\u00f4ng r\u1ed7ng c\u1ee7a m\u1ea3ng m\u00e0 t\u1ed5ng XOR c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong t\u1eadp l\u00e0 \\(0\\).</p> <p>Ta c\u00f3 th\u1ec3 d\u00f9ng quy ho\u1ea1ch \u0111\u1ed9ng \u0111\u1ec3 gi\u1ea3i. G\u1ecdi \\(dp[at][msk]\\) l\u00e0 s\u1ed1 t\u1eadp con trong \u0111o\u1ea1n \\(\\{a_1, a_2, \\ldots, a_{\\text{at} }\\}\\) m\u00e0 t\u1ed5ng XOR c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong c\u00e1c t\u1eadp con \u0111\u00f3 b\u1eb1ng \\(msk\\). Th\u00ec c\u00f4ng th\u1ee9c s\u1ebd nh\u01b0 sau</p> \\[\\text{dp[at][msk] = dp[at - 1][msk] + dp[at - 1][msk ^ mask[at]]}\\] <p>v\u1edbi gi\u00e1 tr\u1ecb ban \u0111\u1ea7u \\(dp[0][0] = 1\\). K\u1ebft qu\u1ea3 b\u00e0i to\u00e1n s\u1ebd l\u00e0 \\(dp[n][0]\\).</p> <p>Nh\u01b0ng l\u00fac n\u00e0y \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u00e0 \\(O(n \\cdot 2^{19})\\), qu\u00e1 l\u1edbn.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng ngay c\u1ea3 khi \\(n \\leq 10^5\\), s\u1ed1 c\u00e1c ph\u1ea7n t\u1eed kh\u00e1c nhau v\u1eabn ch\u1ec9 l\u00e0 \\(70\\). Cho n\u00ean, n\u1ebfu ta t\u00ecm DP cho \\(70\\) mask kh\u00e1c nhau n\u00e0y, v\u00e0 n\u1ebfu v\u1edbi m\u1ed7i \\(1 \\leq at \\leq 70\\) ta bi\u1ebft s\u1ed1 c\u00e1ch \u0111\u1ec3 ch\u1ecdn s\u1ed1 ch\u1eb5n / l\u1ebb c\u00e1c s\u1ed1 trong m\u1ea3ng v\u1edbi gi\u00e1 tr\u1ecb l\u00e0 \\(at\\), ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng t\u00ednh k\u1ebft qu\u1ea3 v\u1edbi c\u00f4ng th\u1ee9c nh\u01b0 sau:</p> \\[\\text{dp[at][msk] = dp[at - 1][msk] * poss[at][0] + dp[at - 1][msk ^ mask[at]] * poss[at][1]}\\] <p>v\u1edbi \\(poss[at][0]\\) l\u00e0 s\u1ed1 c\u00e1ch ch\u1ecdn ch\u1eb5n c\u00e1c s\u1ed1 \\(at\\) trong m\u1ea3ng, v\u00e0 \\(poss[at][1]\\) l\u00e0 s\u1ed1 c\u00e1ch ch\u1ecdn l\u1ebb c\u00e1c s\u1ed1 \\(at\\) trong m\u1ea3ng.</p> <p>Code m\u1eabu:</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\nconst int N = 1e5 + 10;\nconst int MAX_A = 70;\nconst int TOTAL_PRIMES = 19;\nconst int MOD = 1e9 + 7;\n\nint n;\nint poss[MAX_A + 1][2];\nconst int primes[] = {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67};\nint mask[MAX_A + 1];\nint dp[MAX_A + 1][1 &lt;&lt; TOTAL_PRIMES];\n\nint main() {\n    cin &gt;&gt; n;\n\n    for (int i = 1; i &lt;= MAX_A; i++) poss[i][0] = 1;\n\n    for (int i = 1; i &lt;= n; i++) {\n        int a;\n        scanf(\"%d\", &amp;a);\n\n        int tmp = poss[a][0];\n        poss[a][0] = (poss[a][0] + poss[a][1]) % MOD;\n        poss[a][1] = (poss[a][1] + tmp) % MOD;\n    }\n\n    for (int i = 1; i &lt;= MAX_A; i++) {\n        for (int p = 0; p &lt; TOTAL_PRIMES; p++) {\n            int cnt = 0;\n            int at = i;\n\n            while (at % primes[p] == 0) {\n                at /= primes[p];\n                cnt++;\n            }\n\n            if (cnt &amp; 1) mask[i] |= (1 &lt;&lt; p);\n        }\n    }\n\n    int max_mask = 1 &lt;&lt; TOTAL_PRIMES;\n    dp[0][0] = 1;\n\n    for (int at = 1; at &lt;= MAX_A; at++)\n        for (int msk = 0; msk &lt; max_mask; msk++) {\n            dp[at][msk] = dp[at - 1][msk] * 1LL * poss[at][0] % MOD;\n\n            dp[at][msk] += dp[at - 1][msk ^ mask[at]] * 1LL * poss[at][1] % MOD;\n            dp[at][msk] %= MOD;\n        }\n\n    cout &lt;&lt; (dp[MAX_A][0] + MOD - 1) % MOD &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre> <p>V\u00ec s\u1ed1 c\u00e1c mask ch\u1ec9 l\u00e0 \\(70\\) trong b\u00e0i tr\u00ean, ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng DP \u0111\u1ec3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb XOR. Nh\u01b0ng n\u1ebfu gi\u1edbi h\u1ea1n l\u1edbn h\u01a1n th\u00ec sao, v\u00ed d\u1ee5 nh\u01b0 \\(10^5\\). \u0110\u00f3 l\u00e0 l\u00fac ta c\u1ea7n d\u00f9ng ph\u1ea7n hai c\u1ee7a k\u0129 thu\u1eadt n\u00e0y, \u0111\u00f4i khi n\u00f3 c\u0169ng d\u00f9ng \u0111\u01b0\u1ee3c v\u1edbi truy v\u1ea5n online.</p>"},{"location":"Codeforces/bit-manipulation/xor-basis/#phan-2-gioi-thieu-vector-co-so","title":"Ph\u1ea7n 2: Gi\u1edbi thi\u1ec7u Vector c\u01a1 s\u1edf","text":"<p>Ta c\u1ea7n \u0111\u1ecbnh ngh\u0129a v\u00e0i th\u1ee9 \u1edf \u0111\u00e2y \u0111\u1ec3 \u0111i ti\u1ebfp. T\u1ea5t c\u1ea3 c\u00e1c vector \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp \u1edf d\u01b0\u1edbi, ngo\u1ea1i tr\u1eeb c\u00e1c vector null.</p> <ul> <li>C\u00e1c vector \u0111\u1ed9c l\u1eadp: M\u1ed9t t\u1eadp c\u00e1c vector \\(\\vec{v_1}, \\vec{v_2}, \\ldots, \\vec{v_n}\\) \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u1ed9c l\u1eadp khi kh\u00f4ng c\u00f3 vector n\u00e0o l\u00e0 t\u1ed5ng c\u1ee7a b\u1ea5t k\u1ef3 t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh n\u00e0o c\u1ee7a c\u00e1c vector c\u00f2n l\u1ea1i.</li> <li>C\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector: M\u1ed9t t\u1eadp c\u00e1c vector \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector khi t\u1ea5t c\u1ea3 c\u00e1c vector th\u00e0nh ph\u1ea7n c\u1ee7a kh\u00f4ng gian vector \u0111\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n duy nh\u1ea5t b\u1eb1ng t\u1ed5ng c\u1ee7a m\u1ed9t t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n c\u1ee7a c\u01a1 s\u1edf \u0111\u00f3.</li> </ul> <p>M\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t c\u1ee7a c\u00e1c vector \u0111\u1ed9c l\u1eadp v\u00e0 vector c\u01a1 s\u1edf m\u00e0 ta c\u1ea7n nh\u01b0 sau:</p> <ol> <li>Trong m\u1ed9t t\u1eadp c\u00e1c vector \u0111\u1ed9c l\u1eadp, ta c\u00f3 th\u1ec3 thay \u0111\u1ed5i b\u1ea5t c\u1ee9 vector n\u00e0o b\u1eb1ng c\u00e1ch c\u1ed9ng v\u00e0o n\u00f3 b\u1ea5t k\u1ef3 t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh n\u00e0o c\u1ee7a t\u1eadp \u0111\u00f3, v\u00e0 c\u00e1c vector v\u1eabn \u0111\u1ed9c l\u1eadp v\u1edbi nhau. \u0110i\u1ec1u th\u00fa v\u1ecb \u1edf \u0111\u00e2y l\u00e0, t\u1eadp vector trong kh\u00f4ng gian \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng m\u1ed9t s\u1ed1 t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh th\u00ec gi\u1eef nguy\u00ean sau khi ta thay \u0111\u1ed5i m\u1ed9t hay m\u1ed9t v\u00e0i vector tr\u01b0\u1edbc \u0111\u00f3.</li> <li>\u0110\u1ec3 \u00fd r\u1eb1ng, trong tr\u01b0\u1eddng h\u1ee3p kh\u00f4ng gian vector \\(\\mathbb{Z}_2^d\\), h\u1ec7 s\u1ed1 c\u1ee7a t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u00e1c vector c\u0169ng ph\u1ea3i n\u1eb1m trong \\(\\mathbb{Z}_2\\). Ngh\u0129a l\u00e0, m\u1ed9t vector th\u00e0nh ph\u1ea7n ch\u1ec9 c\u00f3 th\u1ec3 n\u1eb1m trong ho\u1eb7c kh\u00f4ng n\u1eb1m trong t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh.</li> <li>C\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector th\u1ef1c ra l\u00e0 m\u1ed9t t\u1eadp b\u00e9 nh\u1ea5t c\u00e1c vector sao cho t\u1ea5t c\u1ea3 c\u00e1c vector kh\u00e1c trong kh\u00f4ng gian vector \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng m\u1ed9t t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a nh\u1eefng vector n\u1eb1m trong t\u1eadp n\u00e0y.</li> <li>C\u00e1c vector c\u01a1 s\u1edf \u0111\u1ed9c l\u1eadp v\u1edbi nhau.</li> <li>V\u1edbi m\u1ecdi t\u1eadp vector \u0111\u1ed9c l\u1eadp m\u00e0 s\u1ed1 vector \u00edt h\u01a1n s\u1ed1 vector trong c\u01a1 s\u1edf, s\u1ebd c\u00f3 c\u00e1c vector trong kh\u00f4ng gian vector kh\u00f4ng bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c.</li> <li>T\u01b0\u01a1ng t\u1ef1, n\u1ebfu s\u1ed1 vector trong t\u1eadp nhi\u1ec1u h\u01a1n s\u1ed1 vector trong c\u01a1 s\u1edf, s\u1ebd c\u00f3 m\u1ed9t s\u1ed1 vector kh\u00f4ng c\u1ea7n thi\u1ebft. N\u1ebfu \\(d\\) l\u00e0 s\u1ed1 vector c\u1ee7a c\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector, khi ta t\u00ecm \u0111\u01b0\u1ee3c t\u1eadp \\(d\\) vector \u0111\u1ed9c l\u1eadp, n\u00f3 ch\u00ednh l\u00e0 c\u01a1 s\u1edf. Ta kh\u00f4ng th\u1ec3 th\u00eam vector v\u00e0o t\u1eadp n\u00e0y, v\u00ec vector m\u1edbi s\u1ebd \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng t\u1eadp vector c\u0169.</li> <li>V\u1edbi kh\u00f4ng gian vector \\(d\\) chi\u1ec1u, c\u01a1 s\u1edf c\u1ee7a n\u00f3 ch\u1ec9 c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u nh\u1ea5t \\(d\\) vector th\u00e0nh ph\u1ea7n.</li> </ol> <p>V\u1edbi nh\u1eefng t\u00ednh ch\u1ea5t n\u00e0y, ta c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 b\u00e0i kh\u00f3 v\u1edbi nh\u1eefng c\u00e1ch r\u1ea5t hay. Nh\u01b0ng khoan, ta c\u1ea7n xem l\u00e0m th\u1ebf n\u00e0o ta c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c c\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector ch\u1ee9a \\(n\\) vector, c\u00e1c vector n\u00e0y l\u00e0 th\u00e0nh ph\u1ea7n c\u1ee7a \\(\\mathbb{Z}_2^d\\). Thu\u1eadt to\u00e1n sau \u0111\u00e2y ch\u1ea1y trong \\(O(n \\cdot d)\\).</p>"},{"location":"Codeforces/bit-manipulation/xor-basis/#thuat-toan","title":"Thu\u1eadt to\u00e1n","text":"<p>T\u1ea5t c\u1ea3 c\u00e1c vector \u1edf \u0111\u00e2y n\u1eb1m trong \\(\\mathbb{Z}_2^d\\), n\u00ean ch\u00fang c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng s\u1ed1 nh\u1ecb ph\u00e2n \u0111\u1ed9 d\u00e0i \\(d\\).</p> <p>Gi\u1ea3 s\u1eed r\u1eb1ng t\u1ea1i m\u1ed7i b\u01b0\u1edbc, ta c\u00f3 m\u1ed9t vector \u0111\u1ea7u v\u00e0o \\(\\vec{v_i}\\) v\u00e0 ta \u0111\u00e3 c\u00f3 c\u01a1 s\u1edf c\u1ee7a c\u00e1c vector \u0111\u1ea7u v\u00e0o tr\u01b0\u1edbc \u0111\u00f3 \\(\\vec{v_1}, \\vec{v_2}, \\ldots, \\vec{v_{i - 1}}\\), v\u00e0 gi\u1edd ta c\u1ea7n c\u1eadp nh\u1eadt c\u01a1 s\u1edf sao cho n\u00f3 c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n vector m\u1edbi \\(\\vec{v_i}\\) n\u00e0y.</p> <p>\u0110\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u \u0111\u00f3, \u0111\u1ea7u ti\u00ean ta c\u1ea7n ki\u1ec3m tra xem \\(\\vec{v_i}\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng c\u01a1 s\u1edf hi\u1ec7n t\u1ea1i hay kh\u00f4ng.</p> <p>N\u1ebfu bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c, c\u01a1 s\u1edf hi\u1ec7n t\u1ea1i kh\u00f4ng c\u1ea7n ph\u1ea3i c\u1eadp nh\u1eadt th\u00eam g\u00ec c\u1ea3. Nh\u01b0ng n\u1ebfu kh\u00f4ng bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c, ta c\u1ea7n th\u00eam vector \\(\\vec{v_i}\\) n\u00e0y v\u00e0o trong c\u01a1 s\u1edf.</p> <p>Vi\u1ec7c ta c\u1ea7n l\u00e0m duy nh\u1ea5t \u1edf \u0111\u00e2y ch\u00ednh l\u00e0, l\u00e0m sao \u0111\u1ec3 ki\u1ec3m tra m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 vector m\u1edbi c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi c\u01a1 s\u1edf hay kh\u00f4ng. Tr\u01b0\u1edbc h\u1ebft ta c\u1ea7n d\u00f9ng t\u00ednh ch\u1ea5t 1 \u0111\u1ec3 s\u1eeda l\u1ea1i b\u1ea5t k\u1ef3 vector m\u1edbi n\u00e0o tr\u01b0\u1edbc khi \u0111\u01b0a v\u00e0o c\u01a1 s\u1edf, m\u00e0 kh\u00f4ng ph\u00e1 v\u1ee1 c\u01a1 s\u1edf n\u00e0y. B\u1eb1ng c\u00e1ch n\u00e0y, ta c\u00f3 th\u1ec3 ki\u1ec3m so\u00e1t t\u1ed1t h\u01a1n tr\u1ea1ng th\u00e1i c\u1ee7a c\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector. Ta l\u00e0m nh\u01b0 sau:</p> <ul> <li>G\u1ecdi \\(f(\\vec{v})\\) l\u00e0 bit 1 \u0111\u1ea7u ti\u00ean c\u1ee7a bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a vector. Ta c\u1ea7n \u0111\u1ea3m b\u1ea3o m\u1ed7i vector trong c\u01a1 s\u1edf c\u00f3 \\(f\\) kh\u00e1c nhau.</li> <li>\u0110\u1ea7u ti\u00ean, kh\u00f4ng c\u00f3 vector n\u00e0o trong c\u01a1 s\u1edf, n\u00ean kh\u00f4ng c\u00f3 \\(f\\) n\u00e0o gi\u1ed1ng nhau \u0111\u01b0\u1ee3c. Gi\u1ea3 s\u1eed ta \u0111ang \u1edf b\u01b0\u1edbc th\u1ee9 \\(i\\), ta \u0111ang ki\u1ec3m tra xem vector \\(\\vec{v_i}\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng c\u01a1 s\u1edf hay kh\u00f4ng. B\u1edfi v\u00ec t\u1ea5t c\u1ea3 c\u00e1c \\(f\\) c\u1ee7a c\u00e1c vector trong c\u01a1 s\u1edf \u0111\u00e3 kh\u00e1c nhau r\u1ed3i, ta l\u1ea5y vector c\u00f3 gi\u00e1 tr\u1ecb \\(f\\) b\u00e9 nh\u1ea5t, g\u1ecdi vector n\u00e0y l\u00e0 \\(\\vec{b_1}\\).</li> <li>N\u1ebfu \\(f(\\vec{v_i}) &lt; f(\\vec{b_1})\\), ta s\u1ebd kh\u00f4ng th\u1ec3 bi\u1ec3u di\u1ec5n vector \\(\\vec{v_i}\\) b\u1eb1ng b\u1ea5t c\u1ee9 t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh n\u00e0o c\u1ee7a c\u01a1 s\u1edf, v\u00ec kh\u00f4ng c\u00f3 vector n\u00e0o c\u00f3 bit 1 t\u1ea1i v\u1ecb tr\u00ed \\(f(\\vec{v_i})\\), theo t\u00ednh ch\u1ea5t 2. N\u00ean \\(\\vec{v_i}\\) s\u1ebd l\u00e0 m\u1ed9t vector trong c\u01a1 s\u1edf, v\u00e0 v\u00ec \\(f\\) c\u1ee7a vector n\u00e0y kh\u00e1c v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c vector \u0111ang t\u1ed3n t\u1ea1i trong c\u01a1 s\u1edf, ta c\u00f3 th\u1ec3 th\u00eam n\u00f3 v\u00e0o t\u1eadp vector c\u01a1 s\u1edf, v\u00e0 l\u01b0u gi\u00e1 tr\u1ecb \\(f\\) c\u1ee7a n\u00f3.</li> <li>Nh\u01b0ng n\u1ebfu \\(f(\\vec{v_i}) == f(\\vec{b_1})\\), ta c\u1ea7n ph\u1ea3i tr\u1eeb \\(\\vec{b_1}\\) ra kh\u1ecfi \\(\\vec{v_i}\\) n\u1ebfu ta mu\u1ed1n bi\u1ec3u di\u1ec5n \\(\\vec{v_i}\\) l\u00e0 m\u1ed9t t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a t\u1eadp vector c\u1ee7a c\u01a1 s\u1edf, v\u00ec kh\u00f4ng c\u00f3 vector n\u00e0o trong c\u01a1 s\u1edf c\u00f3 bit 1 t\u1ea1i v\u1ecb tr\u00ed \\(f(\\vec{v_i}) = f(\\vec{b_1})\\). N\u00ean ta tr\u1eeb \\(\\vec{b_1}\\) kh\u1ecfi \\(\\vec{v_i}\\) v\u00e0 ti\u1ebfp t\u1ee5c \u0111\u1ebfn \\(\\vec{b_2}\\).</li> <li>L\u01b0u \u00fd, thay \u0111\u1ed5i gi\u00e1 tr\u1ecb \\(\\vec{v_i}\\) kh\u00f4ng g\u00e2y ra b\u1ea5t c\u1ee9 v\u1ea5n \u0111\u1ec1 g\u00ec theo t\u00ednh ch\u1ea5t 1. \\(\\vec{v_i}\\) v\u00e0 \\(\\vec{v_i} - \\vec{b_1}\\) l\u00e0 nh\u01b0 nhau trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y. N\u1ebfu trong nh\u1eefng b\u01b0\u1edbc ti\u1ebfp theo ta th\u1ea5y \\(\\vec{v_i}\\) kh\u00f4ng bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c b\u1eb1ng t\u1eadp c\u00e1c vector c\u01a1 s\u1edf, ta v\u1eabn c\u00f3 th\u1ec3 th\u00eam vector \u0111\u00e3 \u0111\u01b0\u1ee3c thay \u0111\u1ed5i n\u00e0y (nhi\u1ec1u l\u1ea7n tr\u1eeb) v\u00e0o trong c\u01a1 s\u1edf, v\u00ec t\u1eadp vector trong kh\u00f4ng gian \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi c\u01a1 s\u1edf m\u1edbi v\u1eabn nh\u01b0 kh\u00f4ng \u0111\u1ed5i ngay c\u1ea3 khi ta th\u00eam \\(\\vec{v_i}\\) ban \u0111\u1ea7u v\u00e0o.</li> <li>N\u1ebfu sau khi duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c vector c\u01a1 s\u1edf trong \\(\\vec{b}\\) v\u00e0 tr\u1eeb ch\u00fang ra kh\u1ecfi \\(\\vec{v_i}\\) (n\u1ebfu c\u1ea7n) r\u1ed3i, \\(\\vec{v_i}\\) v\u1eabn kh\u00f4ng ph\u1ea3i vector null, ngh\u0129a l\u00e0 \\(\\vec{v_i}\\) m\u1edbi c\u00f3 \\(f\\) l\u1edbn h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c vector trong c\u01a1 s\u1edf, ta c\u1ea7n th\u00eam vector n\u00e0y v\u00e0o c\u01a1 s\u1edf v\u00e0 l\u01b0u gi\u00e1 tr\u1ecb \\(f\\) c\u1ee7a n\u00f3.</li> </ul> <p>\u0110\u00e2y l\u00e0 c\u00e1ch c\u00e0i \u0111\u1eb7t h\u00e0m th\u00eam vector v\u00e0o c\u01a1 s\u1edf, c\u00e1c vector \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng s\u1ed1 nh\u1ecb ph\u00e2n \u0111\u1ed9 d\u00e0i \\(d\\).</p> <pre><code>int basis[d]; // basis[i] l\u01b0u bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n (mask) c\u1ee7a vector c\u00f3 gi\u00e1 tr\u1ecb f l\u00e0 i, ta l\u01b0u d\u01b0\u1edbi d\u1ea1ng s\u1ed1 nguy\u00ean\nint sz; // K\u00edch th\u01b0\u1edbc hi\u1ec7n t\u1ea1i c\u1ee7a c\u01a1 s\u1edf\n\nvoid insertVector(int mask) {\n    for (int i = 0; i &lt; d; i++) {\n        if ((mask &amp; (1 &lt;&lt; i)) == 0) continue; // ti\u1ebfp t\u1ee5c n\u1ebfu i != f(mask)\n\n        if (!basis[i]) { // N\u1ebfu kh\u00f4ng c\u00f3 vector n\u00e0o trong c\u01a1 s\u1edf c\u00f3 bit 1 \u1edf v\u1ecb tr\u00ed i, ta th\u00eam vector \u0111ang x\u00e9t v\u00e0o c\u01a1 s\u1edf\n            basis[i] = mask;\n            ++sz;\n            return;\n        }\n\n        mask ^= basis[i]; // Ng\u01b0\u1ee3c l\u1ea1i ta tr\u1eeb vector trong c\u01a1 s\u1edf kh\u1ecfi vector \u0111ang x\u00e9t\n    }\n}\n</code></pre> <p>Ta x\u00e9t m\u1ed9t s\u1ed1 b\u00e0i t\u1eadp.</p>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-2a","title":"B\u00e0i t\u1eadp 2a","text":"<p>Ngu\u1ed3n b\u00e0i - Problem 2, V\u00ed d\u1ee5 1</p> <p>Cho m\u1ed9t t\u1eadp \\(S\\) k\u00edch th\u01b0\u1edbc \\(1 \\le n \\le 10^5\\) v\u1edbi c\u00e1c ph\u1ea7n t\u1eed \\(0 \\le a_i \\lt 2^{20}\\). T\u00ecm s\u1ed1 c\u00e1c s\u1ed1 kh\u00e1c nhau c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi t\u1ed5ng XOR c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong set.</p> L\u1eddi gi\u1ea3i <p>M\u1ed7i ph\u1ea7n t\u1eed l\u00e0 m\u1ed9t vector trong kh\u00f4ng gian vector nh\u1ecb ph\u00e2n 20 chi\u1ec1u, t\u1ee9c l\u00e0 \\(\\mathbb{Z}_2^{20}\\). Ta c\u00f3 th\u1ec3 t\u00ecm c\u01a1 s\u1edf c\u1ee7a n\u00f3 trong \\(O(d \\cdot n)\\). V\u1edbi m\u1ed7i t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a c\u01a1 s\u1edf, ta c\u00f3 m\u1ed9t t\u1ed5ng XOR kh\u00e1c nhau. Cho n\u00ean \u0111\u00e1p \u00e1n s\u1ebd l\u00e0 \\(2^\\text{k\u00edch th\u01b0\u1edbc c\u1ee7a c\u01a1 s\u1edf}\\). Ki\u1ec3u s\u1ed1 nguy\u00ean s\u1ebd th\u00edch h\u1ee3p v\u1edbi b\u00e0i n\u00e0y v\u00ec k\u00edch th\u01b0\u1edbc c\u1ee7a c\u01a1 s\u1edf \\(\\leq d = 20\\) theo t\u00ednh ch\u1ea5t 7.</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;    \nconst int N = 1e5 + 10, LOG_A = 20;\nint basis[LOG_A];\nint sz;\n\nvoid insertVector(int mask) {\n    for (int i = 0; i &lt; LOG_A; i++) {\n        if ((mask &amp; 1 &lt;&lt; i) == 0) continue;\n\n        if (!basis[i]) {\n            basis[i] = mask;\n            ++sz;\n\n            return;\n        }\n\n        mask ^= basis[i];\n    }\n}\n\nint main() {\n    int n;\n    cin &gt;&gt; n;\n\n    while (n--) {\n        int a;\n        scanf(\"%d\", &amp;a);\n\n        insertVector(a);\n    }\n\n    cout &lt;&lt; (1 &lt;&lt; sz) &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-2b","title":"B\u00e0i t\u1eadp 2b","text":"<p>Codechef - XORCMPNT</p> <p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 \\(2^k\\) node \u0111\u00e1nh s\u1ed1 t\u1eeb \\(0\\) \u0111\u1ebfn \\(2^k - 1\\), \\(1 \\leq k \\leq 30\\). Ngo\u00e0i ra ta c\u00f2n \u0111\u01b0\u1ee3c cho th\u00eam \\(1 \\leq M \\leq 10^5\\) s\u1ed1 nguy\u00ean \\(x_1, x_2, \\ldots, x_M\\) n\u1eb1m trong kho\u1ea3ng \\(0 \\le x_i \\le 2^{k} - 1\\). Trong \u0111\u1ed3 th\u1ecb, hai \u0111\u1ec9nh \\(u\\) v\u00e0 \\(v\\) c\u00f3 c\u1ea1nh khi v\u00e0 ch\u1ec9 khi \\(u \\oplus v = x_i\\) v\u1edbi m\u1ed9t \\(x_i\\) n\u00e0o \u0111\u00f3. T\u00ecm s\u1ed1 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb.</p> L\u1eddi gi\u1ea3i <p>L\u1eddi gi\u1ea3i ch\u00ednh th\u1ee9c c\u1ee7a b\u00e0i n\u00e0y c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc \u1edf \u0111\u00e2y. T\u1eeb m\u1ed9t \u0111\u1ec9nh \\(u\\), m\u1ed9t \u0111\u1ec9nh \\(v\\) c\u00f3 th\u1ec3 t\u1edbi \u0111\u01b0\u1ee3c t\u1eeb \\(u\\) khi v\u00e0 ch\u1ec9 khi t\u1ed3n t\u1ea1i m\u1ed9t t\u1eadp con \\(S\\) c\u1ee7a m\u1ea3ng \\(M\\) ph\u1ea7n t\u1eed ban \u0111\u1ea7u sao cho XOR c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong \\(S\\) b\u1eb1ng \\(u \\oplus v\\). L\u01b0u \u00fd r\u1eb1ng \\(u\\) lu\u00f4n \u0111\u1ebfn \u0111\u01b0\u1ee3c \\(u\\) theo t\u00ednh ch\u1ea5t n\u00e0y v\u00ec \\(u \\oplus u = 0\\) v\u1edbi t\u1eadp \\(S\\) r\u1ed7ng.</p> <p>Sau khi c\u00f3 \u0111\u01b0\u1ee3c c\u01a1 s\u1edf c\u1ee7a m\u1ea3ng \\(M\\) ph\u1ea7n t\u1eed ban \u0111\u1ea7u (kh\u00f4ng gian vector \\(\\mathbb{Z}_2^{k}\\)), ta bi\u1ebft \u0111\u01b0\u1ee3c s\u1ed1 bit m\u00e0 c\u01a1 s\u1edf c\u00f3 th\u1ec3 thay \u0111\u1ed5i \u0111\u01b0\u1ee3c, d\u1ef1a v\u00e0o m\u1ea3ng \\(basis[i]\\), v\u00e0 s\u1ed1 c\u00e1c s\u1ed1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o ra t\u1eeb c\u01a1 s\u1edf l\u00e0 \\(2^p\\) v\u1edbi \\(p\\) l\u00e0 s\u1ed1 \\(basis[i]\\) c\u00f3 vector, gi\u1ed1ng b\u00e0i tr\u01b0\u1edbc. X\u00e9t m\u1ed9t \u0111\u1ec9nh \\(u\\), th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a \\(u\\) s\u1ebd l\u00e0 \\(2^p\\) v\u00ec ch\u1ec9 c\u00f3 th\u1ec3 thay \u0111\u1ed5i \u0111\u01b0\u1ee3c \\(p\\) bit. Nh\u01b0 v\u1eady c\u00e1c s\u1ed1 gi\u1ed1ng nhau \u1edf c\u00e1c bit kh\u00f4ng n\u1eb1m trong \\(p\\) s\u1ebd c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng. T\u1eeb \u0111\u00f3 \u0111\u00e1p \u00e1n s\u1ebd l\u00e0 \\(2^{k - p}\\).</p>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-3","title":"B\u00e0i t\u1eadp 3","text":"<p>Ngu\u1ed3n b\u00e0i - Problem 2, V\u00ed d\u1ee5 3</p> <p>Cho m\u1ed9t t\u1eadp \\(S\\) k\u00edch th\u01b0\u1edbc \\(1 \\le n \\le 10^5\\) v\u1edbi c\u00e1c ph\u1ea7n t\u1eed \\(0 \\le a_i \\lt 2^{20}\\). T\u1ed5ng XOR l\u1edbn nh\u1ea5t c\u1ee7a m\u1ed9t t\u1eadp con c\u1ee7a t\u1eadp S ban \u0111\u1ea7u l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Trong b\u00e0i n\u00e0y, ta c\u1ea7n ch\u1ec9nh s\u1eeda m\u1ed9t ch\u00fat \u1edf \u0111\u1ecbnh ngh\u0129a c\u1ee7a \\(f(\\vec{b})\\). Thay v\u00ec \\(f\\) l\u00e0 bit 1 \u0111\u1ea7u ti\u00ean, ta s\u1ebd cho \\(f\\) l\u00e0 bit 1 cu\u1ed1i c\u00f9ng.</p> <p>\u0110\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t, ta kh\u1edfi t\u1ea1o \u0111\u00e1p \u00e1n l\u00e0 \\(0\\) v\u00e0 duy\u1ec7t c\u00e1c vector c\u01a1 s\u1edf b\u1eaft \u0111\u1ea7u v\u1edbi vector c\u00f3 \\(f\\) l\u1edbn nh\u1ea5t.</p> <p>Gi\u1ea3 s\u1eed ta \u0111ang x\u00e9t vector c\u01a1 s\u1edf \\(\\vec{b}\\) v\u00e0 ta th\u1ea5y \u0111\u00e1p \u00e1n hi\u1ec7n t\u1ea1i bit th\u1ee9 \\(f(\\vec{b})\\) kh\u00f4ng ph\u1ea3i l\u00e0 bit \\(1\\), ta s\u1ebd th\u00eam \\(\\vec{b}\\) v\u00e0o \u0111\u00e1p \u00e1n. C\u00e1ch tham lam n\u00e0y ch\u00ednh x\u00e1c v\u00ec v\u1ecb tr\u00ed \\(f(\\vec{b})\\) l\u00e0 v\u1ecb tr\u00ed l\u1edbn nh\u1ea5t c\u00f3 bit \\(1\\), v\u00e0 ta ph\u1ea3i cho n\u00f3 b\u1eb1ng \\(1\\) m\u00e0 kh\u00f4ng quan t\u00e2m \u0111\u1ebfn c\u00e1c bit ti\u1ebfp theo c\u00f3 v\u1ec1 \\(0\\) hay kh\u00f4ng.</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int N = 1e5 + 10, LOG_A = 20;\nint basis[LOG_A];\n\nvoid insertVector(int mask) {\n    for (int i = LOG_A - 1; i &gt;= 0; i--) {\n        if ((mask &amp; 1 &lt;&lt; i) == 0) continue;\n\n        if (!basis[i]) {\n            basis[i] = mask;\n            return;\n        }\n\n        mask ^= basis[i];\n    }\n}\n\nint main() {\n    int n;\n    cin &gt;&gt; n;\n\n    while (n--) {\n        int a;\n        scanf(\"%d\", &amp;a);\n\n        insertVector(a);\n    }\n\n    int ans = 0;\n\n    for (int i = LOG_A - 1; i &gt;= 0; i--) {\n        if (!basis[i]) continue;\n\n        if (ans &amp; 1 &lt;&lt; i) continue;\n\n        ans ^= basis[i];\n    }\n\n    cout &lt;&lt; ans &lt;&lt; endl;\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-4","title":"B\u00e0i t\u1eadp 4","text":"<p>CF 203881 - Godzilla and Pretty XOR</p> <p>Cho m\u1ed9t t\u1eadp \\(S\\) ban \u0111\u1ea7u r\u1ed7ng, c\u00f3 \\(1 \\leq n \\leq 10^6\\) truy v\u1ea5n tr\u00ean t\u1eadp n\u00e0y. G\u1ecdi \\(X\\) l\u00e0 t\u1eadp g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c t\u1ed5ng XOR c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed thu\u1ed9c \\(S\\). C\u00f3 2 lo\u1ea1i truy v\u1ea5n nh\u01b0 sau:</p> <ul> <li>Truy v\u1ea5n d\u1ea1ng 1: Th\u00eam m\u1ed9t ph\u1ea7n t\u1eed \\(1 \\leq k \\leq 10^5\\) v\u00e0o t\u1eadp \\(S\\), n\u1ebfu \u0111\u00e3 t\u1ed3n t\u1ea1i th\u00ec b\u1ecf qua.</li> <li>Truy v\u1ea5n d\u1ea1ng 2: Cho \\(k\\), in ra s\u1ed1 nh\u1ecf th\u1ee9 \\(k\\) c\u1ee7a \\(X\\), \u0111\u1ea3m b\u1ea3o r\u1eb1ng \\(k \\leq |X|\\).</li> </ul> L\u1eddi gi\u1ea3i <p>Kh\u00e1 gi\u1ed1ng v\u1edbi b\u00e0i tr\u01b0\u1edbc. V\u1edbi truy v\u1ea5n d\u1ea1ng 2, ta duy\u1ec7t c\u00e1c vector c\u01a1 s\u1edf theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n c\u1ee7a gi\u00e1 tr\u1ecb \\(f\\).</p> <p>Gi\u00e1 s\u1eed \\(\\vec{b_h}\\) c\u00f3 gi\u00e1 tr\u1ecb \\(f\\) l\u1edbn nh\u1ea5t. Ban \u0111\u1ea7u ta bi\u1ebft r\u1eb1ng c\u00f3 \\(2^\\text{k\u00edch th\u01b0\u1edbc c\u01a1 s\u1edf}\\) ph\u1ea7n t\u1eed trong \\(X\\). V\u1eady n\u00ean, n\u1ebfu \\(k &lt;= 2^\\text{k\u00edch th\u01b0\u1edbc c\u01a1 s\u1edf - 1}\\), ta c\u00f3 th\u1ec3 set bit th\u1ee9 \\(f(\\vec{b_h})\\) l\u00e0 \\(0\\). Ng\u01b0\u1ee3c l\u1ea1i ta set n\u00f3 l\u00e0 \\(1\\) v\u00e0 tr\u1eeb \\(2^\\text{k\u00edch th\u01b0\u1edbc c\u01a1 s\u1edf - 1}\\) ra kh\u1ecfi \\(k\\). Sau \u0111\u00f3 ta ti\u1ebfp t\u1ee5c v\u1edbi vector c\u01a1 s\u1edf ti\u1ebfp theo. \u0110\u1ebfn cu\u1ed1i c\u00f9ng \\(k\\) s\u1ebd l\u00e0 \\(1\\) v\u00e0 ta s\u1ebd l\u1ea5y \u0111\u01b0\u1ee3c \u0111\u00e1p \u00e1n b\u1eb1ng c\u00e1ch set 0 v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c bit t\u1eeb \\(f(\\vec{b_i})\\) tr\u1edf \u0111i.</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int N = 1e6 + 10, LOG_K = 30;\nint basis[LOG_K], sz;\n\nvoid insertVector(int mask) {\n    for (int i = LOG_K - 1; i &gt;= 0; i--) {\n        if ((mask &amp; 1 &lt;&lt; i) == 0) continue;\n\n        if (!basis[i]) {\n            basis[i] = mask;\n            sz++;\n\n            return;\n        }\n\n        mask ^= basis[i];\n    }\n}\n\nint query(int k) {\n    int mask = 0;\n\n    int tot = 1 &lt;&lt; sz;\n    for (int i = LOG_K - 1; i &gt;= 0; i--)\n        if (basis[i]) {\n            int low = tot / 2;\n\n            if ((low &lt; k &amp;&amp; (mask &amp; 1 &lt;&lt; i) == 0) ||\n                (low &gt;= k &amp;&amp; (mask &amp; 1 &lt;&lt; i) &gt; 0)) mask ^= basis[i];\n\n            if (low &lt; k) k -= low;\n\n            tot /= 2;\n        }\n\n    return mask;\n}\n\nint main() {\n    int n;\n    cin &gt;&gt; n;\n\n    while (n--) {\n        int t, k;\n        scanf(\"%d %d\", &amp;t, &amp;k);\n\n        if (t == 1) insertVector(k);\n        else printf(\"%d\\n\", query(k));\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-5","title":"B\u00e0i t\u1eadp 5","text":"<p>CF 959F - Mahmoud and Ehab and yet another xor task</p> <p>Cho m\u1ea3ng \u0111\u1ed9 d\u00e0i \\(1 \\le n \\le 10^5\\) v\u1edbi c\u00e1c ph\u1ea7n t\u1eed \\(0 \\le a_i \\lt 2^{20}\\). Ta c\u1ea7n tr\u1ea3 l\u1eddi \\(1 \\le q \\le 10^5\\) truy v\u1ea5n.</p> <p>Trong m\u1ed7i truy v\u1ea5n ta c\u00f3 hai s\u1ed1 nguy\u00ean \\(1 \\le l \\le n\\) v\u00e0 \\(0 \\le x \\lt 2^{20}\\). T\u00ecm s\u1ed1 t\u1eadp con c\u1ee7a \\(l\\) ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng, l\u1ea5y modulo \\(10^9+7\\), sao cho t\u1ed5ng XOR c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong t\u1eadp l\u00e0 \\(x\\).</p> L\u1eddi gi\u1ea3i <p>Ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n m\u1ed9t c\u00e1ch offline. Ban \u0111\u1ea7u ta l\u01b0u c\u00e1c truy v\u1ea5n theo \\(l\\), t\u1ee9c l\u00e0 v\u1edbi m\u1ed7i \\(l\\) ta c\u00f3 m\u1ed9t s\u1ed1 truy v\u1ea5n \\(x_1, x_2, \\ldots, x_m\\). Sau \u0111\u00f3 duy\u1ec7t t\u1eebng \\(l\\) t\u1eeb nh\u1ecf \u0111\u1ebfn l\u1edbn, v\u1edbi m\u1ed7i \\(l\\) ta duy tr\u00ec c\u01a1 s\u1edf c\u1ee7a kh\u00f4ng gian vector c\u1ee7a ti\u1ec1n t\u1ed1 \u0111\u00f3. Ti\u1ebfp \u0111\u1ebfn ta l\u1ea7n l\u01b0\u1ee3t tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u1ee7a \\(l\\) n\u00e0y. \u0110\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n, ta ki\u1ec3m tra xem \\(x\\) c\u00f3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng c\u01a1 s\u1edf hi\u1ec7n t\u1ea1i hay kh\u00f4ng (m\u00e0 kh\u00f4ng c\u1ea7n th\u00eam \\(x\\) v\u00e0o c\u01a1 s\u1edf, \u1edf \u0111\u00e2y ta ch\u1ec9 c\u1ea7n s\u1eeda h\u00e0m <code>insertVector</code> l\u1ea1i m\u1ed9t ch\u00fat).</p> <p>N\u1ebfu kh\u00f4ng bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c, \u0111\u00e1p \u00e1n cho truy v\u1ea5n n\u00e0y l\u00e0 \\(0\\). N\u1ebfu bi\u1ec3u di\u1ec5n \u0111\u01b0\u1ee3c, \u0111\u00e1p \u00e1n s\u1ebd l\u00e0 \\(2^{l - b}\\), v\u1edbi \\(b\\) l\u00e0 k\u00edch th\u01b0\u1edbc c\u01a1 s\u1edf c\u1ee7a ti\u1ec1n t\u1ed1 \\(l\\) ph\u1ea7n t\u1eed, b\u1edfi v\u00ec t\u1eadp n\u00e0y bao g\u1ed3m \\(l - b\\) vector kh\u00f4ng n\u1eb1m trong c\u01a1 s\u1edf, n\u00ean b\u1ea5t c\u1ee9 t\u1eadp con n\u00e0o trong t\u1eadp c\u00e1c vector n\u00e0y \u0111\u1ec1u c\u00f3 th\u1ec3 k\u1ebft h\u1ee3p v\u1edbi m\u1ed9t t\u1eadp con c\u1ee7a c\u01a1 s\u1edf \u0111\u1ec3 t\u1ea1o th\u00e0nh \\(x\\).</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\ntypedef pair&lt;int, int&gt; ii; \n#define x first\n#define y second\n\nconst int N = 1e5 + 10;\nconst int LOG_A = 20;\nconst int MOD = 1e9 + 7;\n\nint n;\nint a[N];\n\nint q;\nii q_data[N];\nvector&lt;int&gt; q_at[N];\nint powers[N];\nint ans[N];\n\nint base[LOG_A], sz;\n\nbool checkXor(int mask) {\n    for (int i = 0; i &lt; LOG_A; i++) {\n        if ((mask &amp; 1 &lt;&lt; i) == 0) continue;\n\n        if (!base[i]) return false;\n\n        mask ^= base[i];\n    }\n\n    return true;\n}\n\nvoid insertVector(int mask) {\n    for (int i = 0; i &lt; LOG_A; i++) {\n        if ((mask &amp; 1 &lt;&lt; i) == 0) continue;\n\n        if (!base[i]) {\n            base[i] = mask;\n            sz++;\n\n            return;\n        }\n\n        mask ^= base[i];\n    }\n}\n\nint main() {\n    cin &gt;&gt; n &gt;&gt; q;\n\n    for (int i = 1; i &lt;= n; i++) scanf(\"%d\", &amp;a[i]);\n\n    for (int i = 1; i &lt;= q; i++) {\n        scanf(\"%d %d\", &amp;q_data[i].x, &amp;q_data[i].y);\n        q_at[q_data[i].x].push_back(i);\n    }\n\n    powers[0] = 1;\n    for (int i = 1; i &lt; N; i++)\n        powers[i] = powers[i - 1] * 2LL % MOD;\n\n    for (int at = 1; at &lt;= n; at++) {\n        insertVector(a[at]);\n\n        for (int at_q : q_at[at])\n            if (checkXor(q_data[at_q].y)) {\n                ans[at_q] = powers[at - sz];\n            }\n    }\n\n    for (int i = 1; i &lt;= q; i++) printf(\"%d\\n\", ans[i]);\n\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/bit-manipulation/xor-basis/#bai-tap-6","title":"B\u00e0i t\u1eadp 6","text":"<p>CF 1101G - (Zero XOR Subset)-less</p> <p>Cho m\u1ea3ng \u0111\u1ed9 d\u00e0i \\(1 \\le n \\le 2 \\cdot 10^5\\) v\u1edbi c\u00e1c ph\u1ea7n t\u1eed \\(0 \\le a_i \\le 10^9\\). Ta c\u1ea7n t\u00ecm s\u1ed1 \u0111o\u1ea1n l\u1edbn nh\u1ea5t m\u00e0 m\u1ea3ng n\u00e0y c\u00f3 th\u1ec3 ph\u00e2n ra, tho\u1ea3 m\u00e3n c\u00e1c \u0111i\u1ec1u ki\u1ec7n sau:</p> <ol> <li>M\u1ed7i ph\u1ea7n t\u1eed n\u1eb1m trong \u0111\u00fang m\u1ed9t \u0111o\u1ea1n.</li> <li>M\u1ed7i \u0111o\u1ea1n c\u00f3 \u00edt nh\u1ea5t m\u1ed9t ph\u1ea7n t\u1eed.</li> <li>Kh\u00f4ng t\u1ed3n t\u1ea1i m\u1ed9t t\u1eadp con c\u00e1c \u0111o\u1ea1n m\u00e0 t\u1ed5ng XOR c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong c\u00e1c \u0111o\u1ea1n c\u1ee7a t\u1eadp con \u0111\u00f3 b\u1eb1ng 0.</li> </ol> <p>In ra \\(-1\\) n\u1ebfu kh\u00f4ng ph\u00e2n ra \u0111\u01b0\u1ee3c nh\u01b0 v\u1eady.</p> L\u1eddi gi\u1ea3i <p>\u0110\u1ec3 \u00fd r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con c\u1ee7a m\u1ed9t t\u1eadp \u0111\u1ec1u c\u00f3 t\u1ed5ng XOR kh\u00e1c \\(0\\) t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c n\u00f3i t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con c\u1ee7a t\u1eadp \u0111\u00f3 c\u00f3 t\u1ed5ng XOR \u0111\u00f4i m\u1ed9t kh\u00e1c nhau. V\u00ec v\u1eady t\u1ed5ng XOR c\u1ee7a c\u00e1c \u0111o\u1ea1n trong \u0111\u00e1p \u00e1n ph\u1ea3i l\u00e0 c\u00e1c vector \u0111\u1ed9c l\u1eadp. \u0110\u00e2y l\u00e0 observation \u0111\u1ea7u ti\u00ean trong hai observation quan tr\u1ecdng.</p> <p>Observation th\u1ee9 hai l\u00e0, gi\u1ea3 s\u1eed ta ch\u1ecdn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 \u0111o\u1ea1n \\([l_1 = 1, r_1], [l_2 = r_1 + 1, r_2], \\ldots, [l_k = r_{k - 1} + 1, r_k]\\). G\u1ecdi \\(p_i\\) l\u00e0 XOR c\u1ee7a t\u1ed5ng XOR c\u1ee7a \\(i\\) \u0111o\u1ea1n \u0111\u1ea7u ti\u00ean. Sau \u0111\u00f3, \u0111\u1ec3 \u00fd r\u0103ng m\u1ecdi XOR c\u00f3 th\u1ec3 c\u00f3 t\u1eeb m\u1ed9t t\u1eadp con n\u00e0o \u0111\u00f3 c\u1ee7a c\u00e1c \u0111o\u1ea1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1eb1ng c\u00e1ch XOR m\u1ed9t t\u1eadp con trong t\u1eadp \\(\\{p_1, p_2, \\ldots, p_k\\}\\) v\u00e0 ng\u01b0\u1ee3c l\u1ea1i. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 t\u1eadp c\u00e1c t\u1ed5ng XOR c\u1ee7a c\u00e1c \u0111o\u1ea1n n\u00e0y v\u00e0 t\u1eadp c\u00e1c XOR ti\u1ec1n t\u1ed1 c\u1ee7a c\u00e1c \u0111o\u1ea1n n\u00e0y l\u00e0 nh\u01b0 nhau trong kh\u00f4ng gian vector \\(\\mathbb{Z}_2^{31}\\). V\u00ec v\u1eady, n\u1ebfu t\u1ed5ng XOR c\u1ee7a c\u00e1c \u0111o\u1ea1n n\u00e0y ph\u1ea3i \u0111\u1ed9c l\u1eadp, th\u00ec XOR ti\u1ec1n t\u1ed1 c\u1ee7a c\u00e1c \u0111o\u1ea1n n\u00e0y c\u0169ng ph\u1ea3i \u0111\u1ed9c l\u1eadp. Suy ra, \u0111\u00e1p \u00e1n \u0111\u01a1n gi\u1ea3n l\u00e0 k\u00edch th\u01b0\u1edbc c\u01a1 s\u1edf c\u1ee7a \\(n\\) XOR ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ea3ng.</p> <p>Ngo\u1ea1i l\u1ec7 duy nh\u1ea5t \u1edf \u0111\u00e2y l\u00e0 khi \u0111\u00e1p \u00e1n l\u00e0 \\(-1\\), khi t\u1ed5ng XOR c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng b\u1eb1ng \\(0\\).</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int N = 2e5 + 10, LOG_PREF = 31;\n\nint n;\nint basis[LOG_PREF];\n\nvoid insertVector(int mask) {\n    for (int i = 0; i &lt; LOG_PREF; i++) {\n        if ((mask &amp; 1 &lt;&lt; i) == 0) continue;\n\n        if (!basis[i]) {\n            basis[i] = mask;\n            return;\n        }\n\n        mask ^= basis[i];\n    }\n}\n\nint main() {\n    cin &gt;&gt; n;\n\n    int pref = 0;\n\n    for (int i = 1; i &lt;= n; i++) {\n        int a;\n        scanf(\"%d\", &amp;a);\n\n        pref ^= a;\n        insertVector(pref);\n    }\n\n    if (pref == 0) {\n        cout &lt;&lt; -1 &lt;&lt; endl;\n        return 0;\n    }\n\n    int ans = 0;\n\n    for (int i = 0; i &lt; LOG_PREF; i++) {\n        ans += (basis[i] &gt; 0);\n    }\n\n    cout &lt;&lt; ans &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/bit-manipulation/xor-basis/#template","title":"Template","text":"<pre><code>struct VectorBasis {\n    vi basis;\n    int d, sz;\n    int numVectors;\n\n    VectorBasis(int d) {\n        this-&gt;d = d;\n        this-&gt;sz = 0;\n\n        // numVectors l\u00e0 s\u1ed1 vector \u0111\u00e3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o basis \n        // (v\u1edbi h\u00e0m insertVector, c\u00f3 th\u1ec3 kh\u00f4ng t\u0103ng sz)\n        this-&gt;numVectors = 0;\n        basis.resize(d);\n        FOR(i,0,d-1) basis[i] = 0;\n    }\n\n    void insertVector(int mask, bool incCnt = true) {\n        // th\u00eam mask v\u00e0o basis\n        if (incCnt) numVectors++;\n        FOR(i,0,d-1) {\n            if (!(mask &amp; (1 &lt;&lt; i))) continue;\n\n            if (!basis[i]) {\n                basis[i] = mask;\n                sz++;\n                return;\n            }\n\n            mask ^= basis[i];\n        }\n    }\n\n    bool checkXor(int mask) {\n        // x\u00e9t xem mask c\u00f3 cho \u0111\u01b0\u1ee3c v\u00e0o basis hay kh\u00f4ng\n        FOR(i,0,d-1) {\n            if (!(mask &amp; (1&lt;&lt;i))) continue;\n            if (!basis[i]) return false;\n            mask ^= basis[i];\n        }\n        return true;\n    }\n\n    void merge(VectorBasis &amp;v) {\n        // ch\u1eadp 2 basis v\u1edbi c\u00f9ng s\u1ed1 chi\u1ec1u\n        // d\u00f9ng \u0111\u1ec3 k\u1ebft h\u1ee3p v\u1edbi segment tree\n        numVectors += v.numVectors;\n        FOR(i,0,d-1) {\n            if (v.basis[i]) {\n                insertVector(v.basis[i], false);\n            }\n        }\n    }\n};\n</code></pre>"},{"location":"Codeforces/bit-manipulation/xor-basis/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date CF 895C - Square Subsets Submission Code 16/09/2019 Codechef - XORCMPNT Submission Code 10/10/2020 CF 203881S - Godzilla and Pretty XOR Unavailable public link Code 12/10/2020 CF 959F - Mahmoud and Ehab and yet another xor task Submission Code 13/10/2020 CF 1101G - (Zero XOR Subset)-less Submission Code 14/10/2020 HackerEarth - Chef &amp; Chutneys Unavailable public link Code 12/12/2022 AtCoder AGC 045A - Xor Battle Submission Code 13/12/2022 AtCoder ABC 141F - Xor Sum 3 Submission Code 13/12/2022 CSAcademy 6F - Xor Cycle Submission Code 13/12/2022 IZhO 19 - Lyuboyn Submission Code 23/10/2020 XX Open Cup - GP Nanjing 2020 - A Unavailable public link Code 27/10/2020"},{"location":"Codeforces/c%2B%2B/no-rand/","title":"Ng\u01b0ng x\u00e0i rand() - T\u1ed5ng quan v\u1ec1 c\u00e1c tr\u00ecnh sinh s\u1ed1 ng\u1eabu nhi\u00ean trong C++","text":""},{"location":"Codeforces/c%2B%2B/no-rand/#ngung-xai-rand-tong-quan-ve-cac-trinh-sinh-so-ngau-nhien-trong-c","title":"Ng\u01b0ng x\u00e0i rand() - T\u1ed5ng quan v\u1ec1 c\u00e1c tr\u00ecnh sinh s\u1ed1 ng\u1eabu nhi\u00ean trong C++","text":""},{"location":"Codeforces/c%2B%2B/no-rand/#nguon","title":"Ngu\u1ed3n","text":"<p> Don't use rand(): a guide to random number generators in C++</p>"},{"location":"Codeforces/c%2B%2B/no-rand/#tinh-huong","title":"T\u00ecnh hu\u1ed1ng","text":"<p>N\u00f3i chung c\u1ea3 b\u00e0i n\u00e0y s\u1ebd t\u1ef1u chung l\u1ea1i th\u00e0nh m\u1ed9t c\u00e2u: \u0110\u1eebng d\u00f9ng <code>rand</code> trong C++. V\u00ec sao \u00e0? Ta x\u00e9t code sau.</p> <pre><code>#include &lt;cstdlib&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nconst int ITERATIONS = 1e7;\n\nint main() {\n    double sum = 0;\n\n    for (int i = 0; i &lt; ITERATIONS; i++)\n        sum += rand() % 1000000;\n\n    cout &lt;&lt; \"Average value: \" &lt;&lt; sum / ITERATIONS &lt;&lt; '\\n';\n}\n</code></pre> <p>Gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c in ra m\u00e0 b\u1ea1n c\u00f3 th\u1ec3 \u0111o\u00e1n l\u00e0 x\u1ea5p x\u1ec9 bao nhi\u00eau?</p> <p>Ch\u1eafc n\u00f3 ph\u1ea3i n\u1eb1m quanh 500000 nh\u1ec9? Nh\u01b0ng kh\u00f4ng, ho\u00e1 ra n\u00f3 l\u1ea1i tu\u1ef3 v\u00e0o tr\u00ecnh bi\u00ean d\u1ecbch, v\u00e0 tr\u00ean Codeforces n\u00f3 in ra 16382, qu\u00e1 xa so v\u1edbi gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng. B\u1ea1n c\u00f3 th\u1ec3 t\u1ef1 th\u1eed tr\u00ean Codeforces v\u1edbi Custom Invocation.</p>"},{"location":"Codeforces/c%2B%2B/no-rand/#cai-quai-gi-ang-xay-ra-vay","title":"C\u00e1i qu\u00e1i g\u00ec \u0111ang x\u1ea3y ra v\u1eady?","text":"<p>N\u1ebfu b\u1ea1n \u0111\u00e3 \u0111\u1ecdc v\u1ec1 rand() tr\u00ean cppreference, b\u1ea1n s\u1ebd th\u1ea5y n\u00f3 tr\u1ea3 v\u1ec1 \"m\u1ed9t gi\u00e1 tr\u1ecb t\u00edch ph\u00e2n gi\u1ea3 ng\u1eabu nhi\u00ean gi\u1eefa <code>0</code> v\u00e0 <code>RAND_MAX</code>\". Xem th\u1eed <code>RAND_MAX</code> tr\u00ean cppreference n\u00e0o, n\u00f3 ghi l\u00e0 \"Gi\u00e1 tr\u1ecb n\u00e0y tu\u1ef3 v\u00e0o c\u00e0i \u0111\u1eb7t. Nh\u01b0ng n\u00f3 \u0111\u01b0\u1ee3c \u0111\u1ea3m b\u1ea3o l\u00e0 \u00edt nh\u1ea5t <code>32767</code>\". Tr\u00ean Codeforces th\u00ec <code>RAND_MAX</code> l\u00e0 <code>32767</code> lu\u00f4n. Nh\u1ecf v\u00e3i!!!</p> <p>Ch\u01b0a d\u1eebng l\u1ea1i \u1edf \u0111\u00f3, <code>random_shuffle()</code> c\u0169ng d\u00f9ng <code>rand()</code> b\u00ean trong. Nh\u1edb l\u1ea1i r\u1eb1ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n x\u00e1o m\u1ea3ng ng\u1eabu nhi\u00ean, ta c\u1ea7n sinh c\u00e1c ch\u1ec9 s\u1ed1 ng\u1eabu nhi\u00ean \u0111\u1ebfn \\(n\\) - \u0111\u1ed9 d\u00e0i m\u1ea3ng. Nh\u01b0ng n\u1ebfu <code>rand()</code> ch\u1ec9 l\u00ean \u0111\u01b0\u1ee3c \u0111\u1ebfn <code>32767</code>, \u0111i\u1ec1u g\u00ec s\u1ebd x\u1ea3y ra n\u1ebfu ta g\u1ecdi <code>random_shuffle()</code> tr\u00ean m\u1ed9t m\u1ea3ng nhi\u1ec1u ph\u1ea7n t\u1eed h\u01a1n nh\u01b0 v\u1eady, th\u1eadm ch\u00ed h\u01a1n nh\u01b0 v\u1eady nhi\u1ec1u? X\u00e9t th\u1eed m\u1ed9t \u0111o\u1ea1n code n\u1eefa n\u00e0o. B\u1ea1n ngh\u0129 n\u00f3 s\u1ebd in ra g\u00ec?</p> <pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nconst int N = 3000000;\n\ndouble average_distance(const vector&lt;int&gt; &amp;permutation) {\n    double distance_sum = 0;\n\n    for (int i = 0; i &lt; N; i++)\n        distance_sum += abs(permutation[i] - i);\n\n    return distance_sum / N;\n}\n\nint main() {\n    vector&lt;int&gt; permutation(N);\n\n    for (int i = 0; i &lt; N; i++)\n        permutation[i] = i;\n\n    random_shuffle(permutation.begin(), permutation.end());\n    cout &lt;&lt; average_distance(permutation) &lt;&lt; '\\n';\n}\n</code></pre> <p>C\u00e1i code tr\u00ean t\u00ednh k\u1ef3 v\u1ecdng kho\u1ea3ng c\u00e1ch m\u00e0 m\u1ed7i gi\u00e1 tr\u1ecb s\u1ebd \u0111i xa kh\u1ecfi v\u1ecb tr\u00ed ban \u0111\u1ea7u c\u1ee7a n\u00f3 n\u1ebfu ta x\u00e1o m\u1ea3ng ng\u1eabu nhi\u00ean. N\u1ebfu b\u1ea1n t\u00ednh m\u1ed9t ch\u00fat th\u00ec s\u1ebd th\u1ea5y r\u1eb1ng k\u1ebft qu\u1ea3 cho m\u1ed9t l\u1ea7n x\u00e1o m\u1ea3ng ho\u00e0n h\u1ea3o s\u1ebd l\u00e0 \\(\\frac{N}{3} = 1000000\\). N\u1ebfu b\u1ea1n l\u01b0\u1eddi qu\u00e1 kh\u00f4ng mu\u1ed1n l\u00e0m to\u00e1n th\u00ec b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 th\u1ea5y k\u1ebft qu\u1ea3 s\u1ebd n\u1eb1m gi\u1eefa \\(\\frac{N}{2} = 1500000\\) (kho\u1ea3ng c\u00e1ch trung b\u00ecnh c\u1ee7a ch\u1ec9 s\u1ed1 \\(0\\)) v\u00e0 \\(\\frac{N}{4} = 750000\\) (kho\u1ea3ng c\u00e1ch trung b\u00ecnh c\u1ee7a ch\u1ec9 s\u1ed1 \\(\\frac{N}{2}\\)).</p> <p>V\u00e2ng, k\u1ebft qu\u1ea3 in ra l\u1ea1i l\u00e0m b\u1ea1n th\u1ea5t v\u1ecdng r\u1ed3i, n\u00f3 l\u00e0 64463. T\u1ef1 th\u1eed tr\u00ean Codeforces nh\u00e9. N\u00f3i c\u00e1ch kh\u00e1c, <code>random_shuffle()</code> ch\u1ec9 di chuy\u1ec3n m\u1ed7i ph\u1ea7n t\u1eed m\u1ed9t kho\u1ea3ng c\u00e1ch trung b\u00ecnh b\u1eb1ng t\u1ea7m kho\u1ea3ng 2% \u0111\u1ed9 d\u00e0i m\u1ea3ng. D\u1ef1a tr\u00ean nh\u1eefng l\u1ea7n test c\u1ee7a m\u00ecnh th\u00ec c\u00e0i \u0111\u1eb7t c\u1ee7a <code>random_shuffle()</code> tr\u00ean Codeforces v\u1ec1 c\u01a1 b\u1ea3n s\u1ebd y h\u1ec7t nh\u01b0 sau:</p> <pre><code>for (int i = 1; i &lt; N; i++)\n    swap(permutation[i], permutation[rand() % (i + 1)]);\n</code></pre> <p>N\u00f3i chung l\u00e0 n\u1ebfu <code>RAND_MAX</code> nh\u1ecf h\u01a1n nhi\u1ec1u so v\u1edbi \\(N\\), x\u00e1o m\u1ea3ng s\u1ebd kh\u00e1 l\u00e0 ch\u00e1n \u0111\u1ea5y.</p> <p><code>rand()</code> c\u0169ng c\u00f3 nhi\u1ec1u v\u1ea5n \u0111\u1ec1 v\u1ec1 ch\u1ea5t l\u01b0\u1ee3ng h\u01a1n l\u00e0 ch\u1ec9 c\u00f3 vi\u1ec7c <code>RAND_MAX</code> b\u1ecb nh\u1ecf. N\u00f3 th\u01b0\u1eddng \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 m\u1ed9t tr\u00ecnh sinh \u0111\u1ed3ng d\u01b0 tuy\u1ebfn t\u00ednh (linear congruential generator - LCG) \u0111\u01a1n gi\u1ea3n. Tr\u00ean tr\u00ecnh bi\u00ean d\u1ecbch Codeforces, n\u00f3 tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y:</p> <pre><code>static long holdrand = 1L;\n\nvoid srand(unsigned int seed) {\n    holdrand = (long) seed;\n}\n\nint rand() {\n    return (((holdrand = holdrand * 214013L + 2531011L) &gt;&gt; 16) &amp; 0x7fff);\n}\n</code></pre> <p>C\u1ee5 th\u1ec3, c\u00e1c tr\u00ecnh sinh \u0111\u1ed3ng d\u01b0 tuy\u1ebfn t\u00ednh c\u00f3 nh\u01b0\u1ee3c \u0111i\u1ec3m l\u00e0 c\u00e1c bit th\u1ea5p c\u00f3 kh\u1ea3 n\u0103ng d\u1ef1 \u0111o\u00e1n c\u1ef1c cao. Bit th\u1ee9 k (b\u1eaft \u0111\u1ea7u t\u1eeb k = 0, bit nh\u1ecf nh\u1ea5t) c\u00f3 chu k\u1ef3 t\u1ed1i \u0111a l\u00e0 \\(2^{k+1}\\) (t\u1ee9c l\u00e0 m\u1ea5t bao l\u00e2u cho \u0111\u1ebfn khi chu\u1ed7i l\u1eb7p l\u1ea1i). V\u1eady bit nh\u1ecf nh\u1ea5t c\u00f3 chu k\u1ef3 l\u00e0 2, bit th\u1ee9 hai c\u00f3 chu k\u1ef3 l\u00e0 4, v.v. \u0110\u00e2y l\u00e0 l\u00fd do t\u1ea1i sao h\u00e0m tr\u00ean b\u1ecf \u0111i 16 bit nh\u1ecf nh\u1ea5t, v\u00e0 k\u1ebft qu\u1ea3 thu \u0111\u01b0\u1ee3c t\u1ed1i \u0111a l\u00e0 32767 (ngh\u0129a l\u00e0 b\u1ecf 16 bit, ta c\u00f2n l\u1ea1i 16 bit).</p>"},{"location":"Codeforces/c%2B%2B/no-rand/#roi-giai-phap-la-sao","title":"R\u1ed3i gi\u1ea3i ph\u00e1p l\u00e0 sao?","text":"<p>\u0110\u1eebng lo, C++11 cho ta nh\u1eefng tr\u00ecnh sinh s\u1ed1 ng\u1eabu nhi\u00ean (RNG) t\u1ed1t h\u01a1n nhi\u1ec1u. \u0110i\u1ec1u duy nh\u1ea5t b\u1ea1n c\u1ea7n l\u00e0m l\u00e0 nh\u1edb d\u00f9ng <code>mt19937</code>, n\u1eb1m trong header <code>&lt;random&gt;</code>. \u0110\u00e2y l\u00e0 m\u1ed9t thu\u1eadt to\u00e1n Mersenne Twister d\u1ef1a tr\u00ean s\u1ed1 nguy\u00ean t\u1ed1 \\(2^{19937} - 1\\), c\u0169ng l\u00e0 chu k\u1ef3 c\u1ee7a n\u00f3 lu\u00f4n. \u0110\u00e2y l\u00e0 m\u1ed9t RNG t\u1ed1t h\u01a1n r\u1ea5t nhi\u1ec1u so v\u1edbi <code>rand()</code>, v\u00e0 c\u0169ng nhanh h\u01a1n nhi\u1ec1u n\u1eefa (389 ms \u0111\u1ec3 sinh v\u00e0 th\u00eam \\(10^8\\) s\u1ed1 t\u1eeb <code>mt19937</code> trong Custom Invocation, so v\u1edbi 1170 ms v\u1edbi <code>rand()</code>). N\u00f3 c\u0169ng sinh \u0111\u01b0\u1ee3c s\u1ed1 32-bit kh\u00f4ng d\u1ea5u n\u1eb1m gi\u1eefa \\(0\\) v\u00e0 \\(2^{32} - 1 = 4294967295\\), t\u1ed1t h\u01a1n nhi\u1ec1u so v\u1edbi \\(32767\\) c\u1ee7a <code>rand()</code>.</p> <p>\u0110\u1ec3 thay th\u1ebf <code>random_shuffle()</code>, ta c\u00f3 th\u1ec3 d\u00f9ng <code>shuffle()</code> v\u00e0 truy\u1ec1n <code>mt19937</code> c\u1ee7a b\u1ea1n v\u00e0o tham s\u1ed1 th\u1ee9 3, thu\u1eadt to\u00e1n x\u00e1o s\u1ebd d\u00f9ng tr\u00ecnh sinh c\u1ee7a b\u1ea1n \u0111\u1ec3 th\u1ef1c hi\u1ec7n x\u00e1o.</p> <p>C++11 c\u0169ng cho ta m\u1ed9t s\u1ed1 c\u00e1ch ph\u00e2n ph\u1ed1i ti\u1ec7n l\u1ee3i. <code>uniform_int_distribution</code> cho ta ph\u00e2n ph\u1ed1i \u0111\u1ec1u c\u00e1c s\u1ed1 nguy\u00ean trong m\u1ed9t kho\u1ea3ng, m\u00e0 kh\u00f4ng b\u1ecb sai l\u1ec7ch v\u1ec1 mod, v\u00ed d\u1ee5, <code>rand() % 10000</code> s\u1ebd c\u00f3 xu h\u01b0\u1edbng cho ra c\u00e1c s\u1ed1 n\u1eb1m gi\u1eefa 0 v\u00e0 999 h\u01a1n l\u00e0 c\u00e1c s\u1ed1 n\u1eb1m gi\u1eefa 9000 v\u00e0 9999, v\u00ec 32767 kh\u00f4ng ph\u1ea3i l\u00e0 b\u1ed9i c\u1ee7a 10000. C\u00f3 nhi\u1ec1u c\u00e1ch ph\u00e2n ph\u1ed1i hay ho kh\u00e1c, v\u00ed d\u1ee5 nh\u01b0 <code>normal_distribution</code> v\u00e0 <code>exponential_distribution</code>.</p> <p>\u0110\u1ec3 d\u1ec5 hi\u1ec3u h\u01a1n, b\u00ean d\u01b0\u1edbi s\u1ebd l\u00e0 code s\u1eed d\u1ee5ng m\u1ed9t s\u1ed1 th\u1ee9 \u0111\u01b0\u1ee3c n\u00f3i \u1edf tr\u00ean. L\u01b0u \u00fd r\u1eb1ng code kh\u1edfi t\u1ea1o RNG b\u1eb1ng c\u00e1ch d\u00f9ng clock c\u00f3 \u0111\u1ed9 ch\u00ednh x\u00e1c cao. \u0110i\u1ec1u n\u00e0y r\u1ea5t quan tr\u1ecdng \u0111\u1ec3 tr\u00e1nh hack \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf ri\u00eang cho code c\u1ee7a b\u1ea1n, v\u00ec vi\u1ec7c s\u1eed d\u1ee5ng seed c\u1ed1 \u0111\u1ecbnh c\u0169ng c\u00f3 ngh\u0129a l\u00e0 b\u1ea5t k\u1ef3 ai c\u0169ng c\u00f3 th\u1ec3 bi\u1ebft \u0111\u01b0\u1ee3c r\u1eb1ng RNG c\u1ee7a b\u1ea1n s\u1ebd xu\u1ea5t ra g\u00ec. \u0110\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc b\u00e0i L\u00e0m sao hack c\u00e1c solution ng\u1eabu nhi\u00ean v\u00e0 c\u00e1ch ng\u0103n ch\u1eb7n n\u00f3.</p> <p>Cu\u1ed1i c\u00f9ng, n\u1ebfu b\u1ea1n mu\u1ed1n sinh s\u1ed1 ng\u1eabu nhi\u00ean 64-bit, b\u1ea1n ch\u1ec9 c\u1ea7n d\u00f9ng <code>mt19937_64</code>.</p> <pre><code>#include &lt;algorithm&gt;\n#include &lt;chrono&gt;\n#include &lt;iostream&gt;\n#include &lt;random&gt;\n#include &lt;vector&gt;\nusing namespace std;\n\nconst int N = 3000000;\n\ndouble average_distance(const vector&lt;int&gt; &amp;permutation) {\n    double distance_sum = 0;\n\n    for (int i = 0; i &lt; N; i++)\n        distance_sum += abs(permutation[i] - i);\n\n    return distance_sum / N;\n}\n\nint main() {\n    mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\n    vector&lt;int&gt; permutation(N);\n\n    for (int i = 0; i &lt; N; i++)\n        permutation[i] = i;\n\n    shuffle(permutation.begin(), permutation.end(), rng);\n    cout &lt;&lt; average_distance(permutation) &lt;&lt; '\\n';\n\n    for (int i = 0; i &lt; N; i++)\n        permutation[i] = i;\n\n    for (int i = 1; i &lt; N; i++)\n        swap(permutation[i], permutation[uniform_int_distribution&lt;int&gt;(0, i)(rng)]);\n\n    cout &lt;&lt; average_distance(permutation) &lt;&lt; '\\n';\n}\n</code></pre> <p>K\u1ebft qu\u1ea3 c\u1ee7a c\u1ea3 hai ph\u00e9p x\u00e1o \u0111\u1ec1u g\u1ea7n kho\u1ea3ng c\u00e1ch k\u00ec v\u1ecdng \\(10^6\\), gi\u1ed1ng nh\u01b0 ta mu\u1ed1n.</p>"},{"location":"Codeforces/c%2B%2B/no-rand/#tham-khao","title":"Tham kh\u1ea3o","text":"<p>B\u00e0i n\u00e0y \u0111\u01b0\u1ee3c l\u1ea5y c\u1ea3m h\u1ee9ng t\u1eeb m\u1ed9t ph\u1ea7n t\u1eeb b\u00e0i n\u00f3i chuy\u1ec7n c\u1ee7a Stephan T. Lavavej.</p> <p>N\u1ebfu b\u1ea1n mu\u1ed1n m\u1ed9t tr\u00ecnh sinh s\u1ed1 ng\u1eabu nhi\u00ean nhanh v\u00e0 ch\u1ea5t l\u01b0\u1ee3ng cao, h\u00e3y gh\u00e9 qua trang n\u00e0y c\u1ee7a Sebastiano Vigna.</p>"},{"location":"Codeforces/graph/dfs-tree/","title":"C\u00e2y DFS v\u00e0 \u1ee9ng d\u1ee5ng","text":""},{"location":"Codeforces/graph/dfs-tree/#cay-dfs-va-ung-dung","title":"C\u00e2y DFS v\u00e0 \u1ee9ng d\u1ee5ng","text":""},{"location":"Codeforces/graph/dfs-tree/#nguon","title":"Ngu\u1ed3n","text":"<p> [Tutorial] The DFS tree and its applications: how I found out I really didn't understand bridges</p>"},{"location":"Codeforces/graph/dfs-tree/#cay-dfs","title":"C\u00e2y DFS","text":"<p>Cho m\u1ed9t \u0111\u1ed3 th\u1ecb \\(G\\) v\u00f4 h\u01b0\u1edbng li\u00ean th\u00f4ng. Ch\u1ea1y DFS tr\u00ean \u0111\u1ed3 th\u1ecb \u0111\u00f3 v\u1edbi \u0111i\u1ec3m g\u1ed1c b\u1ea5t k\u1ef3, c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>function visit(u):\n  mark u as visited\n  for each vertex v among the neighbors of u:\n    if v is not visited:\n      mark the edge uv\n      call visit(v)\n</code></pre> <p>N\u1ebfu ta <code>visit(1)</code> th\u00ec n\u00f3 s\u1ebd nh\u01b0 th\u1ebf n\u00e0y:</p> <p></p> <p>Nh\u00ecn v\u00e0o c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u tr\u00ean d\u00f2ng s\u1ed1 5. Ch\u00fang t\u1ea1o th\u00e0nh m\u1ed9t c\u00e2y khung c\u1ee7a \\(G\\) v\u1edbi g\u1ed1c l\u00e0 1. Ch\u00fang ta g\u1ecdi nh\u1eefng c\u1ea1nh n\u00e0y l\u00e0 c\u1ea1nh xu\u00f4i (span-edges). C\u00e1c c\u1ea1nh c\u00f2n l\u1ea1i l\u00e0 c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c (back-edges). C\u00e2y DFS cu\u1ed1i c\u00f9ng s\u1ebd nh\u01b0 sau:</p> <p></p>"},{"location":"Codeforces/graph/dfs-tree/#observation-1","title":"Observation 1","text":"<p>C\u00e1c c\u1ea1nh ng\u01b0\u1ee3c tr\u00ean \u0111\u1ed3 th\u1ecb k\u1ebft n\u1ed1i 1 node v\u1edbi con ch\u00e1u c\u1ee7a n\u00f3 tr\u00ean c\u00e2y khung. \u0110\u00f3 l\u00e0 l\u00fd do v\u00ec sao c\u00e2y DFS r\u1ea5t h\u1eefu d\u1ee5ng.</p> V\u00ec sao? <p>Gi\u1ea3 s\u1eed c\u00f3 c\u1ea1nh \\(uv\\), kh\u00f4ng m\u1ea5t \u0111i t\u00ednh t\u1ed5ng qu\u00e1t, ta gi\u1ea3 s\u1eed \\(u\\) \u0111\u01b0\u1ee3c th\u0103m tr\u01b0\u1edbc \\(v\\) (l\u00fac n\u00e0y \\(v\\) ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m). Ta c\u00f3:</p> <ul> <li> <p>N\u1ebfu DFS \u0111i \u0111\u1ebfn \\(v\\) t\u1eeb \\(u\\) d\u00f9ng c\u1ea1nh \\(uv\\), \\(uv\\) l\u00e0 c\u1ea1nh xu\u00f4i</p> </li> <li> <p>N\u1ebfu DFS kh\u00f4ng \u0111i \u0111\u1ebfn \\(v\\) t\u1eeb \\(u\\) d\u00f9ng c\u1ea1nh \\(uv\\), th\u00ec \\(v\\) \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m \u1edf tr\u01b0\u1edbc \u0111\u00f3 \u1edf line s\u1ed1 4 trong m\u00e3 gi\u1ea3. V\u00ec v\u1eady n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m tr\u00ean 1 \u0111\u1ec9nh con c\u1ee7a \\(u\\), n\u00ean \\(v\\) l\u00e0 con ch\u00e1u c\u1ee7a \\(u\\) tr\u00ean c\u00e2y DFS.</p> </li> </ul> <p>Tr\u1edf l\u1ea1i v\u1edbi v\u00ed d\u1ee5 tr\u00ean, \u0111\u1ec9nh 4 v\u00e0 8 kh\u00f4ng c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c k\u1ebft n\u1ed1i ch\u00fang v\u00ec \u0111\u1ec9nh n\u00e0y kh\u00f4ng ph\u1ea3i t\u1ed5 ti\u00ean c\u1ee7a \u0111\u1ec9nh kia v\u00e0 ng\u01b0\u1ee3c l\u1ea1i. N\u1ebfu c\u00f3 c\u1ea1nh n\u1ed1i 4 v\u00e0 8, DFS s\u1ebd \u0111i \u0111\u1ebfn 8 t\u1eeb 4 thay v\u00ec v\u1ec1 2.</p> <p>\u0110\u00e2y l\u00e0 Observation quan tr\u1ecdng nh\u1ea5t v\u1ec1 c\u00e2y DFS. C\u00e2y DFS r\u1ea5t m\u1ea1nh v\u00ec n\u00f3 \u0111\u01a1n gi\u1ea3n ho\u00e1 \u0111\u1ed3 th\u1ecb. Thay v\u00ec ph\u1ea3i quan t\u00e2m \u0111\u1ebfn qu\u00e1 nhi\u1ec1u lo\u1ea1i c\u1ea1nh, ta ch\u1ec9 c\u1ea7n bi\u1ebft \u0111\u1ebfn 1 c\u00e1i c\u00e2y v\u00e0 v\u00e0i c\u1ea1nh n\u1ed1i cha-con \u0111\u01a1n thu\u1ea7n. \u0110i\u1ec1u n\u00e0y l\u00e0m n\u00f3 d\u1ec5 c\u00e0i \u0111\u1eb7t v\u00e0 suy ngh\u0129.</p>"},{"location":"Codeforces/graph/dfs-tree/#tim-cau","title":"T\u00ecm c\u1ea7u","text":"<p>C\u00e2y DFS v\u00e0 Observation 1 \u1edf tr\u00ean l\u00e0 c\u1ed1t l\u00f5i c\u1ee7a thu\u1eadt t\u00ecm c\u1ea7u Tarjan. M\u1ed9t s\u1ed1 h\u01b0\u1edbng d\u1eabn t\u00ecm c\u1ea7u tr\u00ean m\u1ea1ng ch\u1ec9 n\u00f3i v\u1ec1 c\u00e2y DFS s\u01b0\u01a1ng s\u01b0\u01a1ng v\u00e0 \u0111\u1ecbnh ngh\u0129a nh\u1eefng th\u1ee9 m\u01a1 h\u1ed3 nh\u01b0 \\(dfs[u]\\) v\u00e0 \\(low[u]\\). Qu\u00ean h\u1ebft ch\u00fang \u0111i. \u0110\u00f3 kh\u00f4ng ph\u1ea3i c\u00e1ch d\u1ec5 hi\u1ec3u \u0111\u1ec3 t\u00ecm c\u1ea7u, \\(dfs[u]\\) ch\u1ec9 l\u00e0 1 c\u00e1ch l\u1ed9n x\u1ed9n \u0111\u1ec3 ki\u1ec3m tra xem 1 node c\u00f3 ph\u1ea3i cha c\u1ee7a 1 node kh\u00e1c hay kh\u00f4ng. Trong khi \u0111\u00f3, \\(low[u]\\) th\u00ec c\u00f2n kh\u00f3 gi\u1ea3i th\u00edch h\u01a1n n\u1eefa.</p> <p>Gi\u1edd ch\u00fang ta s\u1ebd t\u00ecm c\u1ea7u tr\u00ean 1 \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng li\u00ean th\u00f4ng \\(G\\). X\u00e9t c\u00e2y DFS c\u1ee7a \\(G\\).</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-2","title":"Observation 2","text":"<p>M\u1ed9t c\u1ea1nh xu\u00f4i \\(uv\\) l\u00e0 c\u1ea7u khi v\u00e0 ch\u1ec9 khi kh\u00f4ng t\u1ed3n t\u1ea1i c\u1ea1nh ng\u01b0\u1ee3c k\u1ebft n\u1ed1i con ch\u00e1u c\u1ee7a \\(uv\\) v\u1edbi t\u1ed5 ti\u00ean c\u1ee7a \\(uv\\). N\u00f3i c\u00e1ch kh\u00e1c, c\u1ea1nh xu\u00f4i \\(uv\\) l\u00e0 c\u1ea7u khi v\u00e0 ch\u1ec9 khi kh\u00f4ng c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c \"ch\u1ea1y qua\" \\(uv\\).</p> V\u00ec sao? <p>X\u00f3a c\u1ea1nh \\(uv\\) chia c\u00e2y khung ra th\u00e0nh 2 ph\u1ea7n t\u00e1ch nhau: c\u00e2y con g\u1ed1c \\(uv\\) v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i. N\u1ebfu c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c n\u1ed1i 2 ph\u1ea7n n\u00e0y, \u0111\u1ed3 th\u1ecb v\u1eabn \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i, ng\u01b0\u1ee3c l\u1ea1i \\(uv\\) l\u00e0 c\u1ea7u. C\u00e1ch duy nh\u1ea5t 1 c\u1ea1nh ng\u01b0\u1ee3c c\u00f3 th\u1ec3 k\u1ebft n\u1ed1i 2 ph\u1ea7n n\u00e0y l\u00e0 khi n\u00f3 k\u1ebft n\u1ed1i con ch\u00e1u c\u1ee7a \\(uv\\) v\u1edbi t\u1ed5 ti\u00ean c\u1ee7a \\(uv\\).</p> <p>V\u00ed d\u1ee5, x\u00e9t c\u00e2y \u1edf h\u00ecnh tr\u00ean, c\u1ea1nh 6-2 kh\u00f4ng ph\u1ea3i c\u1ea7u, v\u00ec khi x\u00f3a n\u00f3, c\u1ea1nh ng\u01b0\u1ee3c 3-8 v\u1eabn k\u1ebft n\u1ed1i 2 ph\u1ea7n. Ng\u01b0\u1ee3c l\u1ea1i, c\u1ea1nh 2-4 l\u00e0 c\u1ea7u v\u00ec kh\u00f4ng c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c n\u00e0o t\u01b0\u01a1ng t\u1ef1.</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-3","title":"Observation 3","text":"<p>C\u1ea1nh ng\u01b0\u1ee3c ch\u1eafc ch\u1eafn kh\u00f4ng ph\u1ea3i c\u1ea7u  \u0110i\u1ec1u n\u00e0y d\u1eabn v\u1ec1 thu\u1eadt t\u00ecm c\u1ea7u c\u01a1 b\u1ea3n. Cho \u0111\u1ed3 th\u1ecb \\(G\\):</p> <ol> <li>T\u00ecm c\u00e2y DFS c\u1ee7a n\u00f3.</li> <li>V\u1edbi m\u1ed7i c\u1ea1nh xu\u00f4i \\(uv\\), n\u1ebfu c\u00f3 kh\u00f4ng c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c \u201cch\u1ea1y qua\u201d \\(uv\\), n\u00f3 l\u00e0 c\u1ea7u.</li> </ol> <p>V\u00ec c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n c\u1ee7a c\u00e2y DFS, step 2 r\u1ea5t d\u1ec5 c\u00e0i. V\u00ed d\u1ee5, b\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng c\u00e1ch \\(low[u]\\). Ho\u1eb7c b\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng prefix sum. G\u1ecdi \\(dp[u]\\) l\u00e0 s\u1ed1 c\u1ea1nh ng\u01b0\u1ee3c \u201cch\u1ea1y qua\u201d c\u1ea1nh n\u1ed1i \\(u\\) v\u00e0 \\(parent[u]\\). Khi \u0111\u00f3,</p> \\[dp[u] = (\\text{s\u1ed1 c\u1ea1nh ng\u01b0\u1ee3c \u0111i l\u00ean t\u1eeb u}) + \\sum_{\\text{v l\u00e0 con u} }^{} dp[v] - (\\text{s\u1ed1 c\u1ea1nh ng\u01b0\u1ee3c \u0111i xu\u1ed1ng t\u1eeb u}) \\] <p>C\u1ea1nh xu\u00f4i n\u1ed1i u v\u00e0 \\(parent[u]\\) l\u00e0 c\u1ea7u khi v\u00e0 ch\u1ec9 khi \\(dp[u] = 0\\)</p>"},{"location":"Codeforces/graph/dfs-tree/#chon-huong-canh-e-tao-o-thi-lien-thong-manh","title":"Ch\u1ecdn h\u01b0\u1edbng c\u1ea1nh \u0111\u1ec3 t\u1ea1o \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng m\u1ea1nh","text":"<p>Cho b\u00e0i t\u1eadp nh\u01b0 sau, t\u1eeb 118E - Bertown Roads.</p>"},{"location":"Codeforces/graph/dfs-tree/#problem-1","title":"Problem 1","text":"<p>Cho \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng li\u00ean th\u00f4ng \\(G\\). Ch\u1ec9 h\u01b0\u1edbng cho t\u1eebng c\u1ea1nh \u0111\u1ec3 t\u1ea1o th\u00e0nh \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng m\u1ea1nh ho\u1eb7c tr\u1ea3 v\u1ec1 impossible.</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-4","title":"Observation 4","text":"<p>N\u1ebfu \\(G\\) c\u00f3 c\u1ea7u, tr\u1ea3 v\u1ec1 impossible.</p> V\u00ec sao? <p>\u0110\u01a1n gi\u1ea3n v\u00ec n\u1ebfu \\(uv\\) l\u00e0 c\u1ea7u v\u00e0 ta ch\u1ecdn h\u01b0\u1edbng \\(u \\to v\\), s\u1ebd kh\u00f4ng c\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb \\(v\\) \u0111\u1ebfn \\(u\\)</p> <p>Gi\u1ea3 s\u1eed \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 c\u1ea7u, x\u00e9t c\u00e2y DFS c\u1ee7a n\u00f3. Ch\u1ec9 h\u01b0\u1edbng c\u1ea1nh xu\u00f4i h\u01b0\u1edbng xu\u1ed1ng v\u00e0 c\u1ea1nh ng\u01b0\u1ee3c h\u01b0\u1edbng l\u00ean, ta c\u00f3:</p> <p></p>"},{"location":"Codeforces/graph/dfs-tree/#observation-5","title":"Observation 5","text":"<p>C\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c node kh\u00e1c.</p> V\u00ec sao? <p>\u0110\u01a1n gi\u1ea3n v\u00ec b\u1ea1n c\u00f3 th\u1ec3 \u0111i xu\u1ed1ng nh\u1edd c\u1ea1nh xu\u00f4i.</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-6","title":"Observation 6","text":"<p>C\u00f3 \u0111\u01b0\u1eddng \u0111i t\u1eeb t\u1ea5t c\u1ea3 v\u1ec1 g\u1ed1c</p> V\u00ec sao? <p>X\u00e9t 1 node \\(v\\) kh\u00f4ng ph\u1ea3i g\u1ed1c. G\u1ecdi \\(u\\) l\u00e0 cha c\u1ee7a n\u00f3 tr\u00ean c\u00e2y khung. V\u00ec \u0111\u1ed3 th\u1ecb kh\u00f4ng c\u00f3 c\u1ea7u, s\u1ebd ph\u1ea3i c\u00f3 1 c\u1ea1nh ng\u01b0\u1ee3c \u201cch\u1ea1y qua\u201d \\(uv\\): n\u00f3 k\u1ebft n\u1ed1i con ch\u00e1u c\u1ee7a \\(v\\) v\u00e0 t\u1ed5 ti\u00ean c\u1ee7a \\(u\\). Ta c\u00f3 th\u1ec3 \u0111i xu\u1ed1ng t\u1eeb \\(v\\) t\u1edbi c\u1ea1nh ng\u01b0\u1ee3c \u0111\u00f3, sau \u0111\u00f3 d\u00f9ng n\u00f3 \u0111\u1ec3 v\u1ec1 \u0111\u1ebfn t\u1ed5 ti\u00ean c\u1ee7a \\(u\\). D\u00f9ng c\u00e1ch n\u00e0y ta \u0111\u1ebfn g\u1ea7n node g\u1ed1c h\u01a1n. L\u1eb7p l\u1ea1i \u0111\u1ebfn khi v\u1ec1 g\u1ed1c.</p> <p>V\u00ec v\u1eady, \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng.</p>"},{"location":"Codeforces/graph/dfs-tree/#cai-at-cacti-rung-xuong-rong","title":"C\u00e0i \u0111\u1eb7t cacti (r\u1eebng x\u01b0\u01a1ng r\u1ed3ng)","text":"<p>\u0110\u00f4i khi c\u00e2y DFS ch\u1ec9 l\u00e0 1 c\u00e1ch \u0111\u1ec3 bi\u1ec3u di\u1ec5n \u0111\u1ed3 th\u1ecb theo ki\u1ec3u l\u00e0m cho n\u00f3 d\u1ec5 c\u00e0i \u0111\u1eb7t h\u01a1n, gi\u1ed1ng danh s\u00e1ch k\u1ec1 nh\u01b0ng \u1edf \u0111\u1eb3ng c\u1ea5p cao h\u01a1n. Ph\u1ea7n n\u00e0y \u0111\u01a1n thu\u1ea7n ch\u1ec9 l\u00e0 1 trick c\u00e0i \u0111\u1eb7t.</p> <p>1 cactus (c\u00e2y x\u01b0\u01a1ng r\u1ed3ng) l\u00e0 1 \u0111\u1ed3 th\u1ecb m\u00e0 m\u1ed7i c\u1ea1nh (ho\u1eb7c \u0111\u00f4i khi, \u0111\u1ec9nh) thu\u1ed9c v\u1ec1 nhi\u1ec1u nh\u1ea5t 1 chu tr\u00ecnh \u0111\u01a1n. Tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u g\u1ecdi l\u00e0 c\u1ea1nh x\u01b0\u01a1ng r\u1ed3ng, tr\u01b0\u1eddng h\u1ee3p sau g\u1ecdi l\u00e0 \u0111\u1ec9nh x\u01b0\u01a1ng r\u1ed3ng. R\u1eebng x\u01b0\u01a1ng r\u1ed3ng c\u00f3 c\u1ea5u tr\u00fac \u0111\u01a1n gi\u1ea3n h\u01a1n \u0111\u1ed3 th\u1ecb th\u00f4ng th\u01b0\u1eddng, n\u00ean ng\u01b0\u1eddi ta c\u00f3 th\u1ec3 gi\u1ea3i b\u00e0i tr\u00ean n\u00f3 d\u1ec5 h\u01a1n tr\u00ean \u0111\u1ed3 th\u1ecb truy\u1ec1n th\u1ed1ng. Nh\u01b0ng d\u1ec5 h\u01a1n \u1edf tr\u00ean gi\u1ea5y th\u00f4i: c\u00e1c thu\u1eadt x\u01b0\u01a1ng r\u1ed3ng khi c\u00e0i th\u01b0\u1eddng r\u1ea5t kh\u00f3 ch\u1ecbu n\u1ebfu b\u1ea1n kh\u00f4ng bi\u1ebft m\u00ecnh \u0111ang l\u00e0m g\u00ec.</p> <p>Tr\u00ean c\u00e2y DFS c\u1ee7a x\u01b0\u01a1ng r\u1ed3ng, v\u1edbi m\u1ed7i c\u1ea1nh xu\u00f4i, c\u00f3 nhi\u1ec1u nh\u1ea5t 1 c\u1ea1nh ng\u01b0\u1ee3c \u201cch\u1ea1y qua\u201d n\u00f3. Nh\u01b0 v\u1eady c\u00e1c chu tr\u00ecnh trong c\u00e2y n\u00e0y t\u01b0\u01a1ng t\u1ef1 nh\u01b0 1 chu tr\u00ecnh \u0111\u01a1n: M\u1ed7i c\u1ea1nh ng\u01b0\u1ee3c t\u1ea1o 1 chu tr\u00ecnh \u0111\u01a1n v\u1edbi c\u00e1c c\u1ea1nh xu\u00f4i n\u00f3 \u201cch\u1ea1y qua\u201d. Kh\u00f4ng c\u00f3 chu tr\u00ecnh \u0111\u01a1n n\u00e0o kh\u00e1c.</p> <p>\u0110\u00f3 g\u1ea7n nh\u01b0 l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a c\u00e2y x\u01b0\u01a1ng r\u1ed3ng.</p> <p>V\u00ed d\u1ee5, x\u00e9t \u0111\u1ec1 b\u00e0i sau:</p>"},{"location":"Codeforces/graph/dfs-tree/#problem-2","title":"Problem 2","text":"<p>Cho 1 \u0111\u1ed3 th\u1ecb x\u01b0\u01a1ng r\u1ed3ng li\u00ean th\u00f4ng \\(N\\) \u0111\u1ec9nh. Tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n c\u00f3 d\u1ea1ng: C\u00f3 bao nhi\u00eau \u0111\u01b0\u1eddng \u0111i \u0111\u01a1n kh\u00e1c nhau t\u1eeb \\(p\\) \u0111\u1ebfn \\(q\\)?</p> <p>\u0110\u00e2y l\u00e0 b\u00e0i 231E - Cactus. L\u1eddi gi\u1ea3i ch\u00ednh th\u1ee9c nh\u00ecn nh\u01b0 th\u1ebf n\u00e0y:</p> <ol> <li>B\u00f3p m\u1ed7i chu tr\u00ecnh th\u00e0nh 1 \u0111\u1ec9nh, t\u00f4 \u0111\u1ec9nh n\u00e0y m\u00e0u \u0111en</li> <li>Nh\u01b0 v\u1eady \u0111\u1ed3 th\u1ecb s\u1ebd th\u00e0nh 1 c\u00e2y, ch\u1ecdn g\u1ed1c c\u1ee7a c\u00e2y</li> <li>V\u1edbi m\u1ed7i \u0111\u1ec9nh \\(u\\), \u0111\u1ebfm s\u1ed1 \u0111\u1ec9nh \u0111en tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c \u0111\u1ebfn \\(u\\), g\u1ecdi n\u00f3 l\u00e0 \\(cnt[u]\\)</li> <li>\u0110\u00e1p \u00e1n c\u1ee7a query \\((p, q)\\) s\u1ebd l\u00e0 \\(2 ^ {cnt[p] + cnt[q] - 2 * cnt[lca(p, q)]}\\) ho\u1eb7c \\(2 ^ {cnt[p] + cnt[q] - 2 * cnt[lca(p, q)] + 1}\\) tu\u1ef3 v\u00e0o m\u00e0u c\u1ee7a \\(lca(p, q)\\)</li> </ol> <p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 hi\u1ec3u l\u1eddi gi\u1ea3i n\u00e0y, nh\u01b0ng \u0111i\u1ec1u th\u00fa v\u1ecb l\u1ea1i n\u1eb1m \u1edf c\u00e1ch c\u00e0i step 1.</p> <p></p> <p>Sau 1 h\u1ed3i suy ngh\u0129, b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c c\u00e1ch c\u00e0i cho step 1 \u1edf tr\u00ean, nh\u01b0ng c\u00f3 1 c\u00e1ch d\u1ec5 h\u01a1n d\u00f9ng c\u00e2y DFS:</p> <ol> <li>G\u00e1n cho m\u1ed7i c\u1ea1nh ng\u01b0\u1ee3c 1 index b\u1eaft \u0111\u1ea7u t\u1eeb \\(N + 1\\)</li> <li>V\u1edbi m\u1ed7i \u0111\u1ec9nh \\(u\\), t\u00ecm index c\u1ee7a c\u1ea1nh ng\u01b0\u1ee3c ch\u1ee9a \\(u\\) (\u0111i l\u00ean), g\u1ecdi \u0111\u00f3 l\u00e0 \\(cycleId[u]\\), n\u1ebfu \\(u\\) kh\u00f4ng n\u1eb1m trong chu tr\u00ecnh th\u00ec \\(cycleId[u] = u\\)</li> <li>T\u1ea1o m\u1ed9t danh s\u00e1ch k\u1ec1 m\u1edbi m\u00e0 v\u1edbi m\u1ed7i \\(u\\), m\u1ed7i instance c\u1ee7a \\(u\\) s\u1ebd \u0111\u01b0\u1ee3c thay b\u1eb1ng \\(cycleId[u]\\)</li> </ol> <p>Step 2 s\u1ebd tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y:</p> <pre><code>function visit(u):\n  for each vertex v among the children of u:\n    visit(v)\n\n  if there is a back-edge going up from u:\n    cycleId[u] = the index of that back-edge\n  else:\n    cycleId[u] = u\n    for each vertex v among the children of u:\n      if cycleId[v] != v and there is no back-edge going down from v:\n        cycleId[u] = cycleId[v]\n</code></pre>"},{"location":"Codeforces/graph/dfs-tree/#xoa-canh-e-tao-o-thi-hai-phia","title":"X\u00f3a c\u1ea1nh \u0111\u1ec3 t\u1ea1o \u0111\u1ed3 th\u1ecb hai ph\u00eda","text":""},{"location":"Codeforces/graph/dfs-tree/#problem-3","title":"Problem 3","text":"<p>X\u00e9t m\u1ed9t \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. T\u00ecm s\u1ed1 c\u00e1ch xo\u00e1 1 c\u1ea1nh \u0111\u1ec3 t\u1ea1o ra \u0111\u1ed3 th\u1ecb hai ph\u00eda.</p> <p>\u0110\u00e2y l\u00e0 b\u00e0i 19E - Fairy. B\u00e0i n\u00e0y kh\u00f4ng c\u00f3 l\u1eddi gi\u1ea3i ch\u00ednh th\u1ee9c, nh\u01b0ng l\u1eddi gi\u1ea3i kh\u00f4ng ch\u00ednh th\u1ee9c d\u00f9ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ph\u1ee9c t\u1ea1p nh\u01b0 l\u00e0 Link cut tree. Ch\u00fang ta s\u1ebd gi\u1ea3i quy\u1ebft n\u00f3 b\u1eb1ng c\u00e2y DFS.</p> <p>Trong \u0111\u1ec1 b\u00e0i, \u0111\u1ed3 th\u1ecb kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i li\u00ean th\u00f4ng. Tuy nhi\u00ean, ta th\u1ea5y:</p> <ul> <li>N\u1ebfu \u0111\u1ed3 th\u1ecb g\u1ed3m to\u00e0n th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng 2 ph\u00eda, x\u00f3a b\u1ea5t k\u1ef3 c\u1ea1nh n\u00e0o c\u0169ng t\u1ea1o th\u00e0nh \u0111\u1ed3 th\u1ecb 2 ph\u00eda.</li> <li>N\u1ebfu \u0111\u1ed3 th\u1ecb g\u1ed3m nhi\u1ec1u th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng kh\u00f4ng ph\u1ea3i 2 ph\u00eda, th\u00ec ta kh\u00f4ng th\u1ec3 t\u1ea1o \u0111\u1ed3 th\u1ecb 2 ph\u00eda b\u1eb1ng c\u00e1ch xo\u00e1 1 c\u1ea1nh.</li> </ul> <p>V\u00ec v\u1eady, tr\u01b0\u1eddng h\u1ee3p ta c\u1ea7n x\u00e9t \u1edf \u0111\u00e2y l\u00e0 tr\u01b0\u1eddng h\u1ee3p c\u00f3 1 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng kh\u00f4ng ph\u1ea3i 2 ph\u00eda. R\u00f5 r\u00e0ng c\u1ea1nh c\u1ea7n xo\u00e1 l\u00e0 c\u1ea1nh t\u1eeb th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng \u0111\u00f3, ta c\u00f3 th\u1ec3 gi\u1ea3 s\u1eed r\u1eb1ng n\u00f3 l\u00e0 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng duy nh\u1ea5t trong \u0111\u1ed3 th\u1ecb. T\u1eeb gi\u1edd, ta gi\u1ea3 s\u1eed r\u1eb1ng ta c\u00f3 1 \u0111\u1ed3 th\u1ecb li\u00ean th\u00f4ng, kh\u00f4ng ph\u1ea3i 2 ph\u00eda.</p> <p>X\u00e9t c\u00e2y DFS c\u1ee7a \u0111\u1ed3 th\u1ecb n\u00e0y. Ta t\u00f4 m\u00e0u c\u00e2y n\u00e0y sao cho c\u1ea1nh xu\u00f4i n\u1ed1i node \u0111en v\u00e0 node tr\u1eafng. M\u1ed9t s\u1ed1 c\u1ea1nh ng\u01b0\u1ee3c c\u00f3 th\u1ec3 k\u1ebft n\u1ed1i 2 node c\u00f9ng m\u00e0u. G\u1ecdi c\u00e1c c\u1ea1nh n\u00e0y l\u00e0 c\u00e1c c\u1ea1nh \u201cm\u00e2u thu\u1eabn\", ng\u01b0\u1ee3c l\u1ea1i, c\u1ea1nh ng\u01b0\u1ee3c n\u1ed1i 2 node kh\u00e1c m\u00e0u g\u1ecdi l\u00e0 \u201ckh\u00f4ng m\u00e2u thu\u1eabn\u201d.</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-7","title":"Observation 7","text":"<p>M\u1ed9t c\u1ea1nh ng\u01b0\u1ee3c \\(uv\\) l\u00e0 \u0111\u00e1p \u00e1n khi v\u00e0 ch\u1ec9 khi \\(uv\\) l\u00e0 c\u1ea1nh m\u00e2u thu\u1eabn duy nh\u1ea5t</p> V\u00ec sao? <p>N\u1ebfu ta xo\u00e1 c\u1ea1nh ng\u01b0\u1ee3c m\u00e2u thu\u1eabn duy nh\u1ea5t trong \u0111\u1ed3 th\u1ecb, \u0111\u1ed3 th\u1ecb b\u00e2y gi\u1edd \u0111\u01b0\u1ee3c t\u00f4 2 m\u00e0u, n\u00ean n\u00f3 l\u00e0 \u0111\u1ed3 th\u1ecb 2 ph\u00eda</p> <p>N\u1ebfu \u0111\u1ed3 th\u1ecb c\u00f3 nh\u1eefng c\u1ea1nh m\u00e2u thu\u1eabn kh\u00e1c ho\u1eb7c ta xo\u00e1 c\u1ea1nh ng\u01b0\u1ee3c kh\u00f4ng m\u00e2u thu\u1eabn, nh\u1eefng c\u1ea1nh m\u00e2u thu\u1eabn c\u00f2n l\u1ea1i ti\u1ebfp t\u1ee5c t\u1ea1o ra chu tr\u00ecnh l\u1ebb v\u00e0 \u0111\u1ed3 th\u1ecb s\u1ebd kh\u00f4ng th\u1ec3 l\u00e0 \u0111\u1ed3 th\u1ecb 2 ph\u00eda.</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-8","title":"Observation 8","text":"<p>M\u1ed9t c\u1ea1nh xu\u00f4i \\(uv\\) l\u00e0 \u0111\u00e1p \u00e1n khi v\u00e0 ch\u1ec9 khi c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c \u201cch\u1ea1y qua\u201d n\u00f3 \u0111\u1ec1u l\u00e0 c\u1ea1nh m\u00e2u thu\u1eabn.</p> V\u00ec sao? <p>N\u1ebfu ta xo\u00e1 c\u1ea1nh xu\u00f4i \\(uv\\), c\u00e2y khung s\u1ebd b\u1ecb chia l\u00e0m 2 ph\u1ea7n: c\u00e2y con c\u1ee7a \\(uv\\) v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i. C\u00e1c c\u1ea1nh xu\u00f4i kh\u00e1c v\u1eabn s\u1ebd ph\u1ea3i n\u1ed1i node \u0111en v\u00e0 node tr\u1eafng. V\u00ec v\u1eady c\u00e1ch duy nh\u1ea5t \u0111\u1ec3 t\u00f4 m\u00e0u \u0111\u1ed3 th\u1ecb l\u00e0 \u0111\u1ea3o ng\u01b0\u1ee3c m\u00e0u cho c\u00e2y con \\(uv\\).</p> <p>C\u1ea1nh xu\u00f4i \\(uv\\) s\u1ebd l\u00e0 \u0111\u00e1p \u00e1n khi v\u00e0 ch\u1ec9 khi \u0111\u1ea3o m\u00e0u l\u00e0m ti\u00eau bi\u1ebfn h\u1ebft c\u00e1c c\u1ea1nh m\u00e2u thu\u1eabn v\u00e0 kh\u00f4ng t\u1ea1o ra c\u1ea1nh m\u00e2u thu\u1eabn m\u1edbi. \u0110i\u1ec1u n\u00e0y x\u1ea3y ra khi v\u00e0 ch\u1ec9 khi c\u00e1c c\u1ea1nh m\u00e2u thu\u1eabn n\u00e0y n\u1ed1i c\u00e2y con \\(uv\\) v\u1edbi ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a \u0111\u1ed3 th\u1ecb.</p> <p>V\u1eady ta gi\u1ea3i b\u00e0i nh\u01b0 sau:</p> <ol> <li>T\u00ecm c\u00e2y DFS c\u1ee7a \u0111\u1ed3 th\u1ecb v\u00e0 t\u00f4 m\u00e0u cho n\u00f3.</li> <li>N\u1ebfu ch\u1ec9 c\u00f3 1 c\u1ea1nh ng\u01b0\u1ee3c m\u00e2u thu\u1eabn, th\u00eam n\u00f3 v\u00e0o \u0111\u00e1p \u00e1n.</li> <li>D\u00f9ng DP \u0111\u1ec3 t\u00ednh, v\u1edbi m\u1ed7i c\u1ea1nh xu\u00f4i, c\u00f3 bao nhi\u00eau c\u1ea1nh ng\u01b0\u1ee3c m\u00e2u thu\u1eabn v\u00e0 kh\u00f4ng m\u00e2u thu\u1eabn \u201cch\u1ea1y qua\u201d n\u00f3.</li> <li>N\u1ebfu 1 c\u1ea1nh xu\u00f4i g\u1ed3m to\u00e0n c\u1ea1nh m\u00e2u thu\u1eabn ch\u1ea1y qua, th\u00eam n\u00f3 v\u00e0o \u0111\u00e1p \u00e1n.</li> </ol>"},{"location":"Codeforces/graph/dfs-tree/#voi-o-thi-co-huong","title":"V\u1edbi \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng","text":"<p>N\u1ebfu ta duy\u1ec7t c\u00e2y DFS c\u1ee7a \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng th\u00ec sao:</p> <p></p><pre><code>function visit(u):\n  mark u as visited\n  for each vertex v among the neighbors of u:\n    if v is not visited:\n      mark the edge u-&gt;v\n      call visit(v)\n</code></pre> D\u00f2ng s\u1ed1 3 ch\u1ec9 nh\u1eefng \\(v\\) m\u00e0 c\u00f3 cung t\u1eeb \\(u\\) t\u1edbi \\(v\\)<p></p> <p>S\u1ebd c\u00f3 m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p duy\u1ec7t kh\u00f4ng \u0111\u1ebfn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 node. \u0110\u1ec3 \u0111\u01a1n gi\u1ea3n th\u00ec gi\u1ea3 s\u1eed r\u1eb1ng:</p> <ul> <li>Ta b\u1eaft \u0111\u1ea7u t\u1eeb node 1</li> <li>C\u00f3 th\u1ec3 th\u0103m t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh t\u1eeb \u0111\u1ec9nh 1</li> </ul> <p>G\u1ecdi c\u00e1c cung \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u \u1edf d\u00f2ng 5 l\u00e0 cung xu\u00f4i</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-9","title":"Observation 9","text":"<p>C\u00e1c cung xu\u00f4i t\u1ea1o m\u1ed9t c\u00e2y khung c\u00f3 g\u1ed1c, c\u00f3 h\u01b0\u1edbng xa ra kh\u1ecfi node g\u1ed1c.</p> <p>C\u00e1c cung kh\u00e1c s\u1ebd r\u01a1i v\u00e0o c\u00e1c tr\u01b0\u1eddng h\u1ee3p sau:</p> <ul> <li>Cung n\u1ed1i con ch\u00e1u v\u00e0 t\u1ed5 ti\u00ean: cung ng\u01b0\u1ee3c</li> <li>Cung kh\u00f4ng nh\u01b0 v\u1eady: cung ch\u00e9o</li> </ul> <p>C\u00f3 th\u1ec3 chia c\u00e1c cung ng\u01b0\u1ee3c th\u00e0nh cung l\u00ean ho\u1eb7c cung xu\u1ed1ng tu\u1ef3 v\u00e0o h\u01b0\u1edbng c\u1ee7a ch\u00fang.</p>"},{"location":"Codeforces/graph/dfs-tree/#observation-10","title":"Observation 10","text":"<p>C\u00e1c cung ch\u00e9o lu\u00f4n h\u01b0\u1edbng t\u1eeb \u0111\u1ec9nh th\u0103m sau v\u1ec1 \u0111\u1ec9nh th\u0103m tr\u01b0\u1edbc</p> V\u00ec sao? <p>Gi\u1ea3 s\u1eed c\u00f3 cung \\(u \\to v\\), v\u00e0 DFS \u0111\u1ebfn \\(u\\) nh\u01b0ng ch\u01b0a \u0111\u1ebfn \\(v\\). Ta c\u00f3:</p> <ul> <li>N\u1ebfu DFS kh\u00f4ng \u0111i t\u1eeb \\(u\\) \u0111\u1ebfn \\(v\\), ngh\u0129a l\u00e0 ph\u00e9p duy\u1ec7t \u0111\u00e3 th\u0103m \\(v\\) khi th\u0103m m\u1ed9t con kh\u00e1c c\u1ee7a \\(u\\) r\u1ed3i n\u00ean \\(u \\to v\\) l\u00e0 cung ng\u01b0\u1ee3c</li> <li>N\u1ebfu ph\u00e9p duy\u1ec7t \u0111i t\u1eeb \\(u\\) \u0111\u1ebfn \\(v\\), cung \\(u \\to v\\) l\u00e0 cung xu\u00f4i</li> </ul> <p>V\u00ec v\u1eady \\(u \\to v\\) l\u00e0 cung ch\u00e9o khi ph\u00e9p duy\u1ec7t \u0111\u1ebfn \\(v\\) tr\u01b0\u1edbc \\(u\\)</p> <p>Bi\u1ebfn th\u1ec3 c\u00f3 h\u01b0\u1edbng c\u1ee7a c\u00e2y DFS \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 t\u1ea1o dominator tree c\u1ee7a \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng, nh\u01b0ng \u0111\u00f3 l\u1ea1i n\u1eb1m ngo\u00e0i ph\u1ea1m vi b\u00e0i vi\u1ebft n\u00e0y v\u00e0 x\u1ee9ng \u0111\u00e1ng c\u00f3 1 b\u00e0i ri\u00eang.</p>"},{"location":"Codeforces/graph/dfs-tree/#nhan-xet-ve-phuong-phap-dp","title":"Nh\u1eadn x\u00e9t v\u1ec1 ph\u01b0\u01a1ng ph\u00e1p DP","text":"<p>L\u01b0u \u00fd: Ph\u1ea7n n\u00e0y kh\u00f4ng c\u00f3 trong b\u00e0i g\u1ed1c c\u1ee7a t\u00e1c gi\u1ea3 m\u00e0 l\u00e0 c\u1ea3m nh\u1eadn c\u1ee7a c\u00e1 nh\u00e2n m\u00ecnh khi luy\u1ec7n t\u1eadp c\u00e1c b\u00e0i trong ch\u1ee7 \u0111\u1ec1 n\u00e0y.</p>"},{"location":"Codeforces/graph/dfs-tree/#uu-iem","title":"\u01afu \u0111i\u1ec3m","text":"<p>Th\u1ee9 nh\u1ea5t, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y kh\u00e1 d\u1ec5 hi\u1ec3u v\u1edbi m\u00ecnh. M\u00ecnh th\u1ea5y n\u00f3 gi\u00fap gi\u1ea3i quy\u1ebft ph\u1ea7n l\u1edbn c\u00e1c b\u00e0i trong 8 b\u00e0i \u0111\u1ea7u ti\u00ean c\u1ee7a ph\u1ea7n luy\u1ec7n t\u1eadp m\u1ed9t c\u00e1ch c\u1ef1c k\u1ef3 d\u1ec5 d\u00e0ng (C\u00e1c b\u00e0i ch\u1ecdn h\u01b0\u1edbng cho c\u1ea1nh).</p> <p>Th\u1ee9 hai, c\u00e1c Observation trong b\u00e0i vi\u1ebft c\u00f9ng v\u1edbi c\u00e1c ph\u1ea7n ch\u1ee9ng minh r\u00f5 r\u00e0ng \u0111\u00e3 gi\u00fap m\u00ecnh r\u1ea5t nhi\u1ec1u trong vi\u1ec7c hi\u1ec3u \u0111\u01b0\u1ee3c t\u00ednh ch\u1ea5t c\u1ee7a c\u00e2y DFS. M\u00ecnh th\u1ea5y n\u00f3 gi\u1ea3i \u0111\u00e1p r\u1ea5t t\u1ed1t c\u00e1c th\u1eafc m\u1eafc m\u00e0 c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 c\u00f3 trong cu\u1ed1n Gi\u1ea3i thu\u1eadt v\u00e0 L\u1eadp tr\u00ecnh c\u1ee7a th\u1ea7y L\u00ea Minh Ho\u00e0ng (s\u00e1ch n\u00e0y tr\u00ecnh b\u00e0y c\u00e1ch d\u00f9ng \\(num[u]\\) v\u00e0 \\(low[u]\\), l\u1ea7n \u0111\u1ea7u m\u00ecnh \u0111\u1ecdc n\u00f3 th\u1ea5y kh\u00e1 l\u00e0 r\u1eafc r\u1ed1i)</p>"},{"location":"Codeforces/graph/dfs-tree/#nhuoc-iem","title":"Nh\u01b0\u1ee3c \u0111i\u1ec3m","text":"<p>Tuy nhi\u00ean, ph\u01b0\u01a1ng ph\u00e1p n\u00e0y t\u1ed3n t\u1ea1i m\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m r\u1ea5t l\u1edbn. \u0110\u00f3 ch\u00ednh l\u00e0 s\u1ef1 kh\u00f3 kh\u0103n trong vi\u1ec7c t\u00ecm kh\u1edbp (articulation point) c\u1ee7a \u0111\u1ed3 th\u1ecb. Khi m\u00ecnh \u0111\u1ecdc b\u00ecnh lu\u1eadn c\u1ee7a b\u00e0i vi\u1ebft g\u1ed1c tr\u00ean Codeforces, m\u00ecnh kh\u00f4ng th\u1ef1c s\u1ef1 th\u1ea5y ai c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c kh\u1edbp c\u1ee7a \u0111\u1ed3 th\u1ecb b\u1eb1ng c\u00e1ch n\u00e0y m\u00e0 h\u1ea7u nh\u01b0 to\u00e0n \u0111o\u00e1n ho\u1eb7c tr\u1ea3 l\u1eddi sai (ngay ch\u00ednh t\u00e1c gi\u1ea3 c\u0169ng c\u00f3 tr\u1ea3 l\u1eddi sai). V\u00ec sao n\u00f3 l\u1ea1i kh\u00f3 kh\u0103n \u0111\u1ebfn nh\u01b0 v\u1eady?</p> <p>X\u00e9t m\u1ed9t \u0111\u1ec9nh \\(u\\) tr\u00ean c\u00e2y DFS. \u0110\u1ec3 \\(u\\) l\u00e0 m\u1ed9t kh\u1edbp c\u1ee7a \u0111\u1ed3 th\u1ecb, ta c\u1ea7n c\u00f3 nh\u1eefng \u0111i\u1ec1u ki\u1ec7n sau \u0111\u00e2y:</p> <ol> <li>Gi\u1ea3 s\u1eed \\(u\\) kh\u00f4ng ph\u1ea3i g\u1ed1c c\u1ee7a c\u00e2y DFS. \\(u\\) l\u00e0 kh\u1edbp c\u1ee7a \u0111\u1ed3 th\u1ecb khi v\u00e0 ch\u1ec9 khi t\u1ed3n t\u1ea1i m\u1ed9t nh\u00e1nh con c\u1ee7a \\(u\\) (g\u1ecdi l\u00e0 \\(v\\)) kh\u00f4ng c\u00f3 c\u1ea1nh ng\u01b0\u1ee3c \"\u0111i qua\" c\u1ea1nh n\u1ed1i gi\u1eefa \\(u\\) v\u00e0 cha c\u1ee7a \\(u\\). Nh\u01b0 v\u1eady l\u00e0 v\u1edbi m\u1ed7i \u0111\u1ec9nh con \\(v\\) th\u00ec b\u1ea1n ph\u1ea3i ki\u1ec3m tra xem c\u00e1c c\u1ea1nh ng\u01b0\u1ee3c trong \\(dp[v]\\) c\u00f3 v\u01b0\u1ee3t qua \u0111\u1ec9nh \\(u\\) hay kh\u00f4ng. N\u1ebfu t\u1ea5t c\u1ea3 \u0111\u1ec1u kh\u00f4ng qua th\u00ec \\(u\\) m\u1edbi l\u00e0 kh\u1edbp. Ngh\u0129 th\u00f4i \u0111\u00e3 th\u1ea5y l\u00e0m ki\u1ec3u n\u00e0y r\u1ea5t m\u1ec7t n\u00e3o khi b\u1ea1n c\u1ea7n th\u00f4ng tin c\u1ee7a \\(u\\) v\u1edbi m\u1ed7i \\(v\\) trong khi b\u1ea1n ch\u1ec9 c\u00f3 th\u00f4ng tin to \u0111\u00f9ng c\u1ee7a \\(dp[u]\\) v\u00e0 c\u00e1c \\(dp[v]\\).</li> <li>Khi \\(u\\) l\u00e0 g\u1ed1c c\u1ee7a c\u00e2y DFS, \\(u\\) l\u00e0 kh\u1edbp c\u1ee7a \u0111\u1ed3 th\u1ecb khi v\u00e0 ch\u1ec9 khi n\u00f3 c\u00f3 nhi\u1ec1u h\u01a1n 1 nh\u00e1nh con. Tr\u01b0\u1eddng h\u1ee3p n\u00e0y th\u00ec d\u1ec5 x\u1eed l\u00fd h\u01a1n nhi\u1ec1u.</li> </ol> <p>\u0110\u1ebfn \u0111\u00e2y th\u00ec m\u00ecnh r\u1ebd h\u01b0\u1edbng sang vi\u1ec7c t\u00ecm hi\u1ec3u l\u1ea1i c\u00e1ch d\u00f9ng \\(num[u]\\) v\u00e0 \\(low[u]\\) v\u00e0 m\u00ecnh th\u1ea5y r\u1ea5t d\u1ec5 hi\u1ec3u. Ch\u1ec9 v\u1edbi m\u1ed9t \u0111i\u1ec1u ki\u1ec7n, b\u1ea1n \u0111\u00e3 c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft tr\u01b0\u1eddng h\u1ee3p kh\u00f3 nh\u1eb1n \u1edf tr\u00ean. M\u00ecnh kh\u1edfi \u0111\u1ed9ng ph\u01b0\u01a1ng ph\u00e1p n\u00e0y v\u1edbi b\u00e0i VN SPOJ - GRAPH_.</p> <p>\u0110\u1ea1i kh\u00e1i th\u00ec \\(num[u]\\) l\u00e0 s\u1ed1 th\u1ee9 t\u1ef1 c\u1ee7a \u0111\u1ec9nh \u0111\u01b0\u1ee3c th\u0103m \u0111\u1ea7u ti\u00ean \u0111\u1ebfn \u0111\u1ec9nh th\u0103m sau c\u00f9ng, c\u1ee9 \u0111\u1ebfn \u0111\u00e2u th\u00ec \u0111\u00e1nh s\u1ed1 cho \u0111\u1ec9nh \u0111\u00f3 theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n c\u1ee7a s\u1ed1. C\u00f2n \\(low[u]\\) l\u00e0 gi\u00e1 tr\u1ecb numbering nh\u1ecf nh\u1ea5t trong c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb m\u1ed9t \u0111\u1ec9nh \\(v\\) n\u00e0o \u0111\u00f3 c\u1ee7a nh\u00e1nh DFS g\u1ed1c \\(u\\) b\u1eb1ng m\u1ed9t cung (v\u1edbi gi\u1ea3 thi\u1ebft r\u1eb1ng \\(u\\) c\u00f3 m\u1ed9t cung gi\u1ea3 n\u1ed1i v\u1edbi ch\u00ednh \\(u\\)). \u0110\u1ecbnh ngh\u0129a ph\u1ee9c t\u1ea1p nh\u01b0 v\u1eady nh\u01b0ng n\u1ebfu b\u1ea1n \u0111\u00e3 \u0111\u1ecdc b\u00e0i vi\u1ebft n\u00e0y th\u00ec th\u1ea5y n\u00f3 c\u0169ng b\u00ecnh th\u01b0\u1eddng th\u00f4i.</p> <p>Nh\u01b0 v\u1eady ban \u0111\u1ea7u khi th\u0103m \\(u\\), ta \u0111\u00e1nh s\u1ed1 th\u1ee9 t\u1ef1 th\u0103m cho \u0111\u1ec9nh \\(u\\) v\u00e0 kh\u1edfi g\u00e1n</p> \\[low[u] = num[u]\\] <p>Sau \u0111\u00f3 x\u00e9t t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh \\(v\\) n\u1ed1i t\u1eeb \\(u\\)</p> <ul> <li>N\u1ebfu \\(v\\) \u0111\u00e3 \u0111\u01b0\u1ee3c th\u0103m th\u00ec ta c\u1ef1c ti\u1ec3u ho\u00e1 \\(low[u]\\) nh\u01b0 sau (l\u01b0u \u00fd l\u00e0 n\u00f3 l\u00e0 num nh\u1ecf nh\u1ea5t trong c\u00e1c \u0111\u1ec9nh c\u00f3 th\u1ec3 \u0111\u1ebfn \u0111\u01b0\u1ee3c t\u1eeb m\u1ed9t \u0111\u1ec9nh \\(v\\) n\u00e0o \u0111\u00f3 c\u1ee7a nh\u00e1nh DFS g\u1ed1c \\(u\\) b\u1eb1ng m\u1ed9t cung):</li> </ul> \\[low[u] = min(low[u], num[v])\\] <ul> <li>N\u1ebfu \\(v\\) ch\u01b0a \u0111\u01b0\u1ee3c th\u0103m th\u00ec ta th\u0103m \\(v\\) sau \u0111\u00f3 c\u1ef1c ti\u1ec3u ho\u00e1 \\(low[u]\\) nh\u01b0 sau (c\u00f9ng l\u01b0u \u00fd nh\u01b0 tr\u00ean):</li> </ul> \\[low[u] = min(low[u], low[v])\\] <p>V\u1eady n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u1ec9nh \\(v\\) m\u00e0 \\(low[v] \\ge num[u]\\) (\\(u\\) l\u00e0 cha c\u1ee7a \\(v\\) trong c\u00e2y DFS) th\u00ec \\(u\\) l\u00e0 kh\u1edbp (n\u1ebfu \\(u\\) l\u00e0 g\u1ed1c c\u1ee7a c\u00e2y DFS th\u00ec n\u00f3 c\u1ea7n nhi\u1ec1u h\u01a1n 1 nh\u00e1nh con \u0111\u1ec3 th\u00e0nh \u0111i\u1ec1u ki\u1ec7n \u0111\u1ee7). C\u00f2n n\u1ebfu \\(low[v] &gt; num[u]\\) th\u00ec c\u1ea1nh \\(uv\\) l\u00e0 c\u1ea7u. R\u1ea5t \u0111\u01a1n gi\u1ea3n.</p>"},{"location":"Codeforces/graph/dfs-tree/#ve-bai-coi-2006-policija","title":"V\u1ec1 b\u00e0i COI 2006 - Policija","text":"<p>C\u00e1 nh\u00e2n m\u00ecnh th\u1ea5y b\u00e0i n\u00e0y th\u1ef1c s\u1ef1 th\u00e1ch th\u1ee9c v\u1edbi ng\u01b0\u1eddi kh\u00f4ng quen l\u00e0m c\u00e1c b\u00e0i kh\u1edbp c\u1ea7u nh\u01b0 th\u1ebf n\u00e0y. V\u1ec1 c\u01a1 b\u1ea3n, \u0111\u1ec1 b\u00e0i cho m\u1ed9t \u0111\u01a1n \u0111\u1ed3 th\u1ecb v\u00f4 h\u01b0\u1edbng. Ta c\u00f3 th\u00eam \\(Q\\) truy v\u1ea5n bao g\u1ed3m 2 lo\u1ea1i truy v\u1ea5n.</p> <ol> <li>Truy v\u1ea5n 1: cho 2 \u0111\u1ec9nh \\(u\\) v\u00e0 \\(v\\), h\u1ecfi xem n\u1ebfu ta c\u1eaft 1 c\u1ea1nh \\(xy\\) tr\u00ean \u0111\u1ed3 th\u1ecb th\u00ec \\(u\\) v\u00e0 \\(v\\) c\u00f3 c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng hay kh\u00f4ng.</li> <li>Truy v\u1ea5n 2: cho 2 \u0111\u1ec9nh \\(u\\) v\u00e0 \\(v\\), h\u1ecfi xem n\u1ebfu ta b\u1ecf 1 \u0111\u1ec9nh \\(x\\) tr\u00ean \u0111\u1ed3 th\u1ecb th\u00ec \\(u\\) v\u00e0 \\(v\\) c\u00f3 c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng hay kh\u00f4ng.</li> </ol> <p>D\u1ec5 d\u00e0ng th\u1ea5y \u0111\u01b0\u1ee3c l\u00e0 c\u1ea1nh \\(xy\\) trong truy v\u1ea5n 1 tr\u01b0\u1edbc h\u1ebft c\u1ea7n ph\u1ea3i l\u00e0 c\u1ea7u, c\u00f2n \u0111\u1ec9nh \\(x\\) trong truy v\u1ea5n 2 tr\u01b0\u1edbc h\u1ebft c\u1ea7n ph\u1ea3i l\u00e0 kh\u1edbp. Tr\u01b0\u1edbc khi \u0111i v\u00e0o gi\u1ea3i quy\u1ebft t\u1eebng lo\u1ea1i truy v\u1ea5n, ch\u00fang ta c\u1ea7n gi\u1ea3i quy\u1ebft m\u1ed9t v\u1ea5n \u0111\u1ec1, cho 2 \u0111\u1ec9nh \\(u\\) v\u00e0 \\(v\\), l\u00e0m sao bi\u1ebft \\(u\\) c\u00f3 ph\u1ea3i t\u1ed5 ti\u00ean c\u1ee7a \\(v\\) tr\u00ean c\u00e2y DFS hay kh\u00f4ng? V\u00ec ta \u0111\u00e3 c\u00f3 m\u1ed9t c\u00e1i c\u00e2y, ta c\u00f3 th\u1ec3 l\u00e0m ph\u1eb3ng n\u00f3 ra th\u00e0nh m\u1ed9t m\u1ea3ng \u0111\u1ec3 m\u1ed9t \u0111\u1ec9nh s\u1ebd ph\u1ee5 tr\u00e1ch m\u1ed9t \u0111o\u1ea1n tr\u00ean m\u1ea3ng. Sau \u0111\u00f3, \\(u\\) l\u00e0 t\u1ed5 ti\u00ean c\u1ee7a \\(v\\) khi \u0111o\u1ea1n c\u1ee7a \\(v\\) n\u1eb1m tr\u1ecdn trong \u0111o\u1ea1n c\u1ee7a \\(u\\).</p>"},{"location":"Codeforces/graph/dfs-tree/#truy-van-1","title":"Truy v\u1ea5n 1","text":"<p>Gi\u1ea3 s\u1eed \\(y\\) l\u00e0 con c\u1ee7a \\(x\\) tr\u00ean c\u00e2y DFS m\u00e0 kh\u00f4ng l\u00e0m m\u1ea5t \u0111i t\u00ednh t\u1ed5ng qu\u00e1t. Ta ki\u1ec3m tra xem \\(u\\) v\u00e0 \\(v\\) c\u00f3 ph\u1ea3i l\u00e0 con ch\u00e1u c\u1ee7a \\(y\\) tr\u00ean c\u00e2y DFS hay kh\u00f4ng. N\u1ebfu kh\u00f4ng \u0111\u1ec9nh n\u00e0o ho\u1eb7c c\u1ea3 2 \u0111\u1ec1u tho\u1ea3 m\u00e3n, r\u00f5 r\u00e0ng ch\u00fang c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng khi c\u1eaft c\u1ea1nh \\(xy\\), ng\u01b0\u1ee3c l\u1ea1i th\u00ec kh\u00f4ng c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng.</p>"},{"location":"Codeforces/graph/dfs-tree/#truy-van-2","title":"Truy v\u1ea5n 2","text":"<p>N\u1ebfu kh\u00f4ng \u0111\u1ec9nh n\u00e0o l\u00e0 con ch\u00e1u c\u1ee7a \\(x\\) tr\u00ean c\u00e2y DFS, ch\u00fang r\u00f5 r\u00e0ng c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng khi b\u1ecf \u0111\u1ec9nh \\(x\\)</p> <p>N\u1ebfu c\u00f3 m\u1ed9t \u0111\u1ec9nh l\u00e0 con ch\u00e1u c\u1ee7a \\(x\\), ta x\u00e9t xem n\u00f3 c\u00f3 ph\u1ea3i t\u00e1c nh\u00e2n l\u00e0m cho \\(x\\) l\u00e0 kh\u1edbp hay kh\u00f4ng, n\u1ebfu c\u00f3 th\u00ec \\(u\\) v\u00e0 \\(v\\) kh\u00f4ng c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng (b\u1edfi v\u00ec n\u1ebfu n\u00f3 kh\u00f4ng ph\u1ea3i t\u00e1c nh\u00e2n, b\u1ea1n v\u1eabn c\u00f3 th\u1ec3 \u0111i l\u00ean \u0111\u1ec9nh cha c\u1ee7a \\(x\\) v\u00e0 t\u1eeb \u0111\u00f3 \u0111i t\u1edbi \u0111\u1ec9nh c\u00f2n l\u1ea1i)</p> <p>N\u1ebfu c\u1ea3 2 \u0111\u1ec1u l\u00e0 con ch\u00e1u c\u1ee7a \\(x\\), \u0111\u1ea7u ti\u00ean ch\u00fang c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng n\u1ebfu ch\u00fang \u1edf chung nh\u00e1nh. N\u1ebfu kh\u00e1c nh\u00e1nh, ch\u00fang kh\u00f4ng c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng khi m\u1ed9t trong 2 \u1edf nh\u00e1nh t\u00e1c nh\u00e2n. C\u00f2n l\u1ea1i th\u00ec ch\u00fang c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng.</p> <p>Tuy nhi\u00ean l\u00e0m sao \u0111\u1ec3 ki\u1ec3m tra n\u00f3 c\u00f3 ph\u1ea3i l\u00e0 t\u00e1c nh\u00e2n kh\u00f4ng. Nh\u01b0 \u0111\u00e3 n\u00f3i, n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t \u0111\u1ec9nh \\(v\\) m\u00e0 \\(low[v] \\ge num[u]\\) (\\(u\\) l\u00e0 cha c\u1ee7a \\(v\\) trong c\u00e2y DFS) th\u00ec \\(u\\) l\u00e0 kh\u1edbp. L\u00e0m sao \u0111\u1ec3 l\u1ea5y \u0111\u01b0\u1ee3c \u0111\u1ec9nh con c\u1ee7a \\(x\\) m\u00e0 t\u1eeb \u0111\u00f3 n\u00f3 \u0111i xu\u1ed1ng \u0111\u01b0\u1ee3c \u0111\u1ec9nh con ch\u00e1u \u0111ang x\u00e9t? Ta d\u00f9ng binary lifting \u0111\u1ec3 t\u00ecm t\u1ed5 ti\u00ean th\u1ee9 \\(k\\) c\u1ee7a m\u1ed9t \u0111\u1ec9nh tr\u00ean c\u00e2y.</p>"},{"location":"Codeforces/graph/dfs-tree/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>T\u1ed5ng k\u1ebft l\u1ea1i th\u00ec m\u00ecnh th\u1ea5y b\u00e0i n\u00e0y s\u1eed d\u1ee5ng kh\u00e1 nhi\u1ec1u k\u1ef9 thu\u1eadt m\u00e0 n\u1ebfu b\u1ea1n l\u00e0m kh\u00f4ng quen, b\u1ea1n s\u1ebd m\u1ea5t r\u1ea5t nhi\u1ec1u th\u1eddi gian suy ngh\u0129 v\u00e0 \u0111\u00f4i khi c\u00e1ch l\u00e0m c\u1ee7a b\u1ea1n l\u1ea1i r\u1ea5t r\u1ea5t d\u00e0i. Mong l\u00e0 qua \u0111\u00e2y c\u00e1c b\u1ea1n s\u1ebd th\u1ea5y th\u00fa v\u1ecb v\u1edbi ph\u1ea7n nh\u1eadn x\u00e9t v\u00e0 b\u00e0i t\u1eadp n\u00e0y.</p>"},{"location":"Codeforces/graph/dfs-tree/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"<p>C\u00e1c b\u00e0i c\u1ea7n t\u00ecm block-cut tree</p> Problem Status Submission Code Date 118E - Bertown Roads Submission Code 24/06/2022 231E - Cactus Submission Code 24/06/2022 19E - Fairy Submission Code 26/06/2022 858F - Wizard's Tour Submission Code 20/09/2022 412D - Giving Awards Submission Code 21/09/2022 101612G - Grand Test Unavailable public link Code 22/09/2022 CEOI 2017 - One-Way Streets Submission Code 24/09/2022 732F - Tourist Reform Submission Code 24/09/2022 VN SPOJ - GRAPH_ Unavailable public link Code 26/09/2022 COI 2006 - Policija Unavailable public link Code 26/09/2022 1391E - Pairs of Pairs Submission Code 28/09/2022 1000E - We Need More Bosses Submission Code 29/09/2022 Codechef SROADS Submission Code 29/09/2022 406C - Graph Cutting Submission Code 29/09/2022 555E - Case of Computer Network Submission Code 01/10/2022 1277E - Two Fairs Submission Code 01/10/2022 962F - Simple Cycles Edges Submission Code 01/10/2022 1680F - Lenient Vertex Cover Submission Code 05/10/2022 1045C - Hyperspace Highways Submission Code 06/10/2022 1325F - Ehab's Last Theorem Submission Code 08/10/2022 1364D - Ehab's Last Corollary Submission Code 08/10/2022 AtCoder ARC 111D - Orientation Submission Code 08/10/2022"},{"location":"Codeforces/hashing/blowing-up-unordered-map/","title":"Gi\u1ea3i m\u00e3 v\u00e0 ch\u1ed1ng hack cho unordered-map trong C++","text":""},{"location":"Codeforces/hashing/blowing-up-unordered-map/#giai-ma-va-chong-hack-cho-unordered_map-trong-c","title":"Gi\u1ea3i m\u00e3 v\u00e0 ch\u1ed1ng hack cho unordered_map trong C++","text":""},{"location":"Codeforces/hashing/blowing-up-unordered-map/#nguon","title":"Ngu\u1ed3n","text":"<p> Blowing up unordered_map, and how to stop getting hacked on it</p>"},{"location":"Codeforces/hashing/blowing-up-unordered-map/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>C++ c\u00f3 nh\u1eefng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u r\u1ea5t ti\u1ec7n nh\u01b0 l\u00e0 <code>std::set</code> hay <code>std::map</code>. Ch\u00fang l\u00e0 c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u d\u1ea1ng c\u00e2y v\u00e0 t\u1ed1n \\(O(log n)\\) th\u1eddi gian. V\u1edbi C++11, ch\u00fang ta c\u00f3 th\u00eam hash set v\u00e0 hash map l\u1ea7n l\u01b0\u1ee3t trong <code>std::unordered_set</code> v\u00e0 <code>std::unordered_map</code>. Tuy nhi\u00ean, ta th\u1ea5y r\u1eb1ng r\u1ea5t nhi\u1ec1u b\u1ea1n tr\u00ean Codeforces \u0111\u00e3 b\u1ecb hack ho\u1eb7c t\u1ea1ch system test v\u1edbi c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u hash n\u00e0y. Trong b\u00e0i n\u00e0y ta s\u1ebd \u0111i v\u00e0o gi\u1ea3i m\u00e3 ch\u00fang v\u00e0 nh\u1eefng th\u1ee9 b\u1ea1n c\u00f3 th\u1ec3 l\u00e0m \u0111\u1ec3 ti\u1ebfp t\u1ee5c s\u1eed d\u1ee5ng ch\u00fang m\u00e0 kh\u00f4ng lo b\u1ecb hack.</p>"},{"location":"Codeforces/hashing/blowing-up-unordered-map/#giai-ma","title":"Gi\u1ea3i m\u00e3","text":"<p>Ta lu\u00f4n gi\u1ea3 s\u1eed r\u1eb1ng hash map c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(1)\\) trong m\u1ed7i thao t\u00e1c (ch\u00e8n, xo\u00e1, truy c\u1eadp...). Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y l\u1ea1i ph\u1ee5 thu\u1ed9c v\u00e0o m\u1ed9t gi\u1ea3 \u0111\u1ecbnh r\u1ea5t quan tr\u1ecdng, \u0111\u00f3 l\u00e0 m\u1ed7i item m\u1edbi b\u1ecb tr\u00f9ng trung b\u00ecnh <code>O(1)</code> l\u1ea7n v\u1edbi c\u00e1c item c\u0169. N\u1ebfu input c\u1ee7a ch\u00fang ta ho\u00e0n to\u00e0n ng\u1eabu nhi\u00ean, gi\u1ea3 \u0111\u1ecbnh ban \u0111\u1ea7u s\u1ebd h\u1ee3p l\u00fd. Ng\u01b0\u1ee3c l\u1ea1i, \u0111i\u1ec1u n\u00e0y s\u1ebd r\u1ea5t nguy hi\u1ec3m, \u0111\u1eb7c bi\u1ec7t l\u00e0 khi ai \u0111\u00f3 thi\u1ebft k\u1ebf input (nh\u01b0 trong hacking phase) \u0111\u1ec3 l\u00e0m cho gi\u1ea3 \u0111\u1ecbnh tr\u00ean sai l\u1ec7ch. C\u1ee5 th\u1ec3 l\u00e0, n\u1ebfu ng\u01b0\u1eddi ta bi\u1ebft h\u00e0m hash c\u1ee7a ch\u00fang ta, ng\u01b0\u1eddi \u0111\u00f3 c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng sinh ra m\u1ed9t lo\u1ea1t c\u00e1c input c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb hash, khi\u1ebfn cho th\u1eddi gian th\u1ef1c thi c\u1ee7a ch\u00fang ta t\u0103ng l\u00ean \\(O(n^2)\\).</p> <p>Ta s\u1ebd ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch t\u00ecm hi\u1ec3u code c\u1ee7a <code>unordered_map</code>. Ta c\u00f3 th\u1ec3 \u0111\u1ecdc code n\u00e0y tr\u00ean GitHub t\u1ea1i \u0111\u00e2y: https://github.com/gcc-mirror/gcc.</p> <p>Sau khi m\u00f2 m\u1eabm m\u1ed9t h\u1ed3i th\u00ec ta \u0111\u1ebfn file unordered_map.h. Trong file n\u00e0y th\u00ec ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng <code>unordered_map</code> d\u00f9ng <code>__detail::_Mod_range_hashing</code> v\u00e0 <code>__detail::_Prime_rehash_policy</code>. T\u1eeb \u0111\u00e2y ta c\u00f3 th\u1ec3 \u0111o\u00e1n \u0111\u01b0\u1ee3c map s\u1ebd hash gi\u00e1 tr\u1ecb \u0111\u1ea7u v\u00e0o r\u1ed3i mod n\u00f3 v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1, k\u1ebft qu\u1ea3 thu \u0111\u01b0\u1ee3c s\u1ebd \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 ch\u1ecdn v\u1ecb tr\u00ed th\u00edch h\u1ee3p tr\u00ean hash table.</p> <p>M\u00f2 ti\u1ebfp <code>_Prime_rehash_policy</code> th\u00ec ta \u0111\u1ebfn file hashtable_c++0x.cc. \u1ede \u0111\u00e2y ta c\u00f3 th\u1ec3 th\u1ea5y c\u00f3 m\u1ed9t m\u1ea3ng g\u1ecdi l\u00e0 <code>__prime_list</code>, v\u00e0 hash table c\u00f3 m\u1ed9t policy \u0111\u1ec3 t\u1ef1 \u0111i\u1ec1u ch\u1ec9nh k\u00edch th\u01b0\u1edbc khi n\u00f3 qu\u00e1 to. \u0110\u1ebfn \u0111\u00e2y ta ch\u1ec9 c\u1ea7n t\u00ecm danh s\u00e1ch c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 th\u00f4i. C\u00e1i danh s\u00e1ch \u0111\u00f3 s\u1ebd n\u1eb1m trong file hashtable-aux.cc.</p> <p>M\u1ed9t \u0111i\u1ec1u n\u1eefa, ta c\u1ea7n bi\u1ebft h\u00e0m hash m\u00e0 <code>unordered_map</code> d\u00f9ng tr\u01b0\u1edbc khi mod v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0y. Th\u1ef1c ra th\u00ec n\u00f3 kh\u00e1 \u0111\u01a1n gi\u1ea3n: c\u00e1i map s\u1ebd d\u00f9ng <code>std::hash</code>, v\u1edbi s\u1ed1 nguy\u00ean th\u00ec \u0111\u00e2y ch\u1ec9 l\u00e0 h\u00e0m nh\u1eadn d\u1ea1ng. V\u1edbi ki\u1ebfn th\u1ee9c n\u00e0y, ta c\u00f3 th\u1ec3 ch\u00e8n nhi\u1ec1u b\u1ed9i c\u1ee7a c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 tr\u00ean v\u00e0o map \u0111\u1ec3 t\u0103ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a n\u00f3 l\u00ean \\(O(n^2)\\). Tuy nhi\u00ean, kh\u00f4ng ph\u1ea3i s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0o c\u0169ng d\u00f9ng \u0111\u01b0\u1ee3c do c\u00e1i policy t\u1ef1 \u0111i\u1ec1u ch\u1ec9nh k\u00edch th\u01b0\u1edbc c\u1ee7a map (c\u00e1i m\u00e0 ta \u0111\u00e3 n\u00f3i \u1edf tr\u00ean). \u0110\u1ec3 m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 c\u00f3 th\u1ec3 ph\u00e1 \u0111\u01b0\u1ee3c c\u00e1i map n\u00e0y, ta c\u1ea7n n\u00f3 ph\u1ea3i t\u1ef1 \u0111i\u1ec1u ch\u1ec9nh k\u00edch th\u01b0\u1edbc v\u1ec1 ch\u00ednh s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u00f3 t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3 trong t\u1eadp c\u00e1c thao t\u00e1c c\u1ee7a ch\u00fang ta. Ho\u00e1 ra s\u1ed1 nguy\u00ean t\u1ed1 n\u00e0y ph\u1ee5 thu\u1ed9c v\u00e0o phi\u00ean b\u1ea3n c\u1ee7a compiler: v\u1edbi <code>gcc 6</code> tr\u1edf v\u1ec1 tr\u01b0\u1edbc, s\u1ed1 \u0111\u00f3 l\u00e0 <code>126271</code>, v\u1edbi <code>gcc 7</code> v\u1ec1 sau, s\u1ed1 \u0111\u00f3 s\u1ebd l\u00e0 <code>107897</code>. Ch\u1ea1y code sau trong Custom Invocation c\u1ee7a Codeforces v\u00e0 xem n\u00f3 s\u1ebd nh\u01b0 n\u00e0o.</p> <pre><code>#include &lt;ctime&gt;\n#include &lt;iostream&gt;\n#include &lt;unordered_map&gt;\nusing namespace std;\n\nconst int N = 2e5;\n\nvoid insert_numbers(long long x) {\n    clock_t begin = clock();\n    unordered_map&lt;long long, int&gt; numbers;\n\n    for (int i = 1; i &lt;= N; i++)\n        numbers[i * x] = i;\n\n    long long sum = 0;\n\n    for (auto &amp;entry : numbers)\n        sum += (entry.first / x) * entry.second;\n\n    printf(\"x = %lld: %.3lf seconds, sum = %lld\\n\", x, (double) (clock() - begin) / CLOCKS_PER_SEC, sum);\n}\n\nint main() {\n    insert_numbers(107897);\n    insert_numbers(126271);\n}\n</code></pre> <p>C\u1ee5 th\u1ec3, v\u1edbi <code>gcc 6</code> (GNU G++14 6.4.0) th\u00ec k\u1ebft qu\u1ea3 l\u00e0:</p> <pre><code>x = 107897: 0.032 seconds, sum = 2666686666700000\nx = 126271: 3.135 seconds, sum = 2666686666700000\n\n=====\nUsed: 3151 ms, 7724 KB\n</code></pre> <p>V\u1edbi <code>gcc 7</code> (GNU G++17 7.3.0) th\u00ec k\u1ebft qu\u1ea3 l\u00e0:</p> <pre><code>x = 107897: 3.330 seconds, sum = 2666686666700000\nx = 126271: 0.000 seconds, sum = 2666686666700000\n\n=====\nUsed: 3275 ms, 7564 KB\n</code></pre> <p>Ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng tu\u1ef3 v\u00e0o phi\u00ean b\u1ea3n compiler, m\u1ed9t trong hai s\u1ed1 n\u00e0y s\u1ebd l\u00e0m map ch\u1eadm \u0111i nhi\u1ec1u so v\u1edbi s\u1ed1 c\u00f2n l\u1ea1i. C\u00f3 m\u1ed9t s\u1ed1 s\u1ed1 nguy\u00ean t\u1ed1 n\u1eefa c\u0169ng l\u00e0m \u0111\u01b0\u1ee3c, b\u1ea1n c\u00f3 th\u1ec3 t\u1ef1 th\u1eed.</p> <p>Ch\u00fa \u00fd r\u1eb1ng v\u1edbi c\u00e1c hash table kh\u00e1c nh\u01b0 <code>cc_hash_table</code> v\u00e0 <code>gp_hash_table</code> (\u0111\u1ecdc post c\u1ee7a b\u1ea1n Chilli tr\u00ean Codeforces), vi\u1ec7c hack c\u00f2n d\u1ec5 h\u01a1n. C\u00e1c hash table n\u00e0y d\u00f9ng policy mod lu\u1ef9 th\u1eeba c\u1ee7a 2, cho n\u00ean l\u00e0 \u0111\u1ec3 t\u1ea1o ra nhi\u1ec1u gi\u00e1 tr\u1ecb tr\u00f9ng, b\u1ea1n c\u00f3 th\u1ec3 ch\u00e8n v\u00e0o nhi\u1ec1u gi\u00e1 tr\u1ecb t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, v\u1edbi mod \\(2^{16}\\).</p>"},{"location":"Codeforces/hashing/blowing-up-unordered-map/#cach-chong-hack","title":"C\u00e1ch ch\u1ed1ng hack","text":"<p>\u0110\u1ec3 ch\u1ed1ng vi\u1ec7c input c\u1ed1 \u00fd t\u1ea1o ra c\u00e1c gi\u00e1 tr\u1ecb hash tr\u00f9ng nhau, ta c\u00f3 th\u1ec3 t\u1ef1 vi\u1ebft m\u1ed9t h\u00e0m hash \u0111\u1ec3 th\u1ea3 v\u00e0o trong <code>unordered_map</code> (hay <code>gp_hash_table</code> g\u00ec \u0111\u00f3). H\u00e0m hash s\u1ebd tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0y:</p> <pre><code>struct custom_hash {\n    size_t operator()(uint64_t x) const {\n        return x;\n    }\n};\n</code></pre> <p>Tuy nhi\u00ean, nh\u01b0 \u0111\u00e3 n\u00f3i, b\u1ea5t c\u1ee9 m\u1ed9t h\u00e0m hash x\u00e1c \u0111\u1ecbnh ho\u1eb7c c\u00f3 th\u1ec3 \u0111o\u00e1n \u0111\u01b0\u1ee3c n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c reverse-engineered \u0111\u1ec3 t\u1ea1o ra m\u1ed9t l\u01b0\u1ee3ng l\u1edbn gi\u00e1 tr\u1ecb hash tr\u00f9ng, v\u00ec v\u1eady \u0111i\u1ec1u \u0111\u1ea7u ti\u00ean ta c\u1ea7n l\u00e0m l\u00e0 th\u00eam m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t kh\u00f4ng x\u00e1c \u0111\u1ecbnh (nh\u01b0 clock \u0111\u1ed9 ch\u00ednh x\u00e1c cao) \u0111\u1ec3 g\u00e2y kh\u00f3 cho vi\u1ec7c hack h\u01a1n:</p> <pre><code>struct custom_hash {\n    size_t operator()(uint64_t x) const {\n        static const uint64_t FIXED_RANDOM = chrono::steady_clock::now().time_since_epoch().count();\n        return x + FIXED_RANDOM;\n    }\n};\n</code></pre> <p>\u0110\u1ecdc b\u00e0i v\u1ec1 ch\u1ed1ng hack cho c\u00e1c solution random \u0111\u1ec3 c\u00f3 th\u00eam th\u00f4ng tin. Ok, gi\u1edd n\u00f3 an to\u00e0n r\u1ed3i \u0111\u00fang kh\u00f4ng? Kh\u00f4ng, t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 ta \u0111\u00e3 l\u00e0m l\u00e0 th\u00eam c\u00f9ng m\u1ed9t s\u1ed1 v\u00e0o m\u1ecdi input c\u1ee7a h\u00e0m. Nh\u01b0ng n\u1ebfu hai s\u1ed1 \\(a\\) v\u00e0 \\(b\\) tho\u1ea3 \\(a \\equiv b \\;(\\bmod\\; m)\\), th\u00ec \\(a + x \\equiv b + x \\;(\\bmod\\; m)\\) v\u1edbi m\u1ecdi \\(x\\). V\u1ea5n \u0111\u1ec1 t\u01b0\u01a1ng t\u1ef1 x\u1ea3y ra v\u1edbi m\u1ecdi h\u00e0m hash \u0111\u01a1n gi\u1ea3n kh\u00e1c: nh\u00e2n v\u1edbi m\u1ed9t s\u1ed1 l\u1ebb l\u1edbn ng\u1eabu nhi\u00ean (v\u00e0 tr\u00e0n, v\u1edbi mod \\(2^{64}\\)) c\u00f3 th\u1ec3 c\u00f3 hi\u1ec7u qu\u1ea3 v\u1edbi modulo \\(p\\), nh\u01b0ng s\u1ebd c\u00f3 v\u1ea5n \u0111\u1ec1 v\u1edbi policy lu\u1ef9 th\u1eeba 2 c\u1ee7a <code>gp_hash_table</code>. T\u00ecnh hu\u1ed1ng t\u01b0\u01a1ng t\u1ef1 c\u0169ng x\u1ea3y ra v\u1edbi vi\u1ec7c xor v\u1edbi m\u1ed9t s\u1ed1 ng\u1eabu nhi\u00ean n\u00e0o \u0111\u00f3.</p> <p>M\u1ed9t h\u00e0m hash t\u1ed1t h\u01a1n m\u1ed9t ch\u00fat c\u00f3 th\u1ec3 tr\u00f4ng h\u1ea5p d\u1eabn nh\u01b0 sau:</p> <pre><code>struct custom_hash {\n    size_t operator()(uint64_t x) const {\n        static const uint64_t FIXED_RANDOM = chrono::steady_clock::now().time_since_epoch().count();\n        x ^= FIXED_RANDOM;\n        return x ^ (x &gt;&gt; 16);\n    }\n};\n</code></pre> <p>Tuy nhi\u00ean, n\u1ebfu b\u1ea1n \u0111ang d\u00f9ng <code>gp_hash_table</code>, c\u00e1i n\u00e0y v\u1eabn c\u00f3 th\u1ec3 khi\u1ebfn b\u1ea1n b\u1ecb hack n\u1ebfu g\u1eb7p m\u1ed9t thanh ni\u00ean c\u1ee9ng c\u1ef1a. C\u1ee5 th\u1ec3, sau khi ch\u00e8n c\u00e1c s\u1ed1 <code>(1 &lt;&lt; 16) + 1</code>, <code>(2 &lt;&lt; 16) + 2</code>, <code>(3 &lt;&lt; 16) + 3</code>, ... v\u00e0o h\u00e0m hash n\u00e0y, t\u1ea5t c\u1ea3 c\u00e1c output \u0111\u1ec1u s\u1ebd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi nhau (khi mod \\(2^{16}\\)).</p> <p>V\u00ec th\u1ebf, ta c\u1ea7n m\u1ed9t h\u00e0m hash t\u1ed1t h\u01a1n, l\u00fd t\u01b0\u1edfng nh\u1ea5t l\u00e0 khi vi\u1ec7c thay \u0111\u1ed5i b\u1ea5t k\u1ef3 bit input n\u00e0o c\u0169ng d\u1eabn \u0111\u1ebfn c\u01a1 h\u1ed9i 50-50 thay \u0111\u1ed5i b\u1ea5t k\u1ef3 bit \u0111\u1ea7u ra n\u00e0o. V\u00ed d\u1ee5, trong h\u00e0m hash <code>x + FIXED_RANDOM</code>, t\u00ednh ch\u1ea5t n\u00e0y kh\u00f4ng \u0111\u01b0\u1ee3c tho\u1ea3 m\u00e3n, v\u00ec c\u00f3 kh\u1ea3 n\u0103ng thay \u0111\u1ed5i bit cao h\u01a1n trong <code>x</code> d\u1eabn \u0111\u1ebfn kh\u1ea3 n\u0103ng 0% thay \u0111\u1ed5i bit th\u1ea5p h\u01a1n c\u1ee7a output.</p> <p>C\u00e1 nh\u00e2n m\u00ecnh th\u00ec th\u00edch d\u00f9ng splitmix64, n\u00f3 nhanh v\u00e0 c\u00f3 ch\u1ea5t l\u01b0\u1ee3ng \u0111\u1ec9nh c\u1ee7a ch\u00f3p, c\u1ea3m \u01a1n b\u1ea1n Sebastiano Vigna \u0111\u00e3 thi\u1ebft k\u1ebf ra n\u00f3. G\u1ed9p h\u1ebft m\u1ecdi th\u1ee9 l\u1ea1i v\u1edbi nhau ta s\u1ebd c\u00f3 h\u00e0m hash an to\u00e0n:</p> <pre><code>struct custom_hash {\n    static uint64_t splitmix64(uint64_t x) {\n        // http://xorshift.di.unimi.it/splitmix64.c\n        x += 0x9e3779b97f4a7c15;\n        x = (x ^ (x &gt;&gt; 30)) * 0xbf58476d1ce4e5b9;\n        x = (x ^ (x &gt;&gt; 27)) * 0x94d049bb133111eb;\n        return x ^ (x &gt;&gt; 31);\n    }\n\n    size_t operator()(uint64_t x) const {\n        static const uint64_t FIXED_RANDOM = chrono::steady_clock::now().time_since_epoch().count();\n        return splitmix64(x + FIXED_RANDOM);\n    }\n};\n</code></pre> <p>Gi\u1edd ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a <code>unordered_map</code> hay <code>gp_hash_table</code> nh\u01b0 sau:</p> <pre><code>unordered_map&lt;long long, int, custom_hash&gt; safe_map;\ngp_hash_table&lt;long long, int, custom_hash&gt; safe_hash_table;\n</code></pre> <p>Khi d\u00f9ng nh\u1eefng th\u1ee9 \u0111\u00f3 cho ch\u01b0\u01a1ng tr\u00ecnh \u1edf tr\u00ean c\u00f9ng, n\u00f3 ch\u1ea1y kh\u00e1 nhanh:</p> <pre><code>x = 107897: 0.035 seconds, sum = 2666686666700000\nx = 126271: 0.031 seconds, sum = 2666686666700000\n\n=====\nUsed: 109 ms, 9204 KB\n</code></pre>"},{"location":"Codeforces/math/floors-ceilings-inequalities/","title":"Floor, ceiling v\u00e0 b\u1ea5t \u0111\u1eb3ng th\u1ee9c cho ng\u01b0\u1eddi m\u1edbi h\u1ecdc","text":""},{"location":"Codeforces/math/floors-ceilings-inequalities/#floor-ceiling-va-bat-ang-thuc-cho-nguoi-moi-hoc","title":"Floor, ceiling v\u00e0 b\u1ea5t \u0111\u1eb3ng th\u1ee9c cho ng\u01b0\u1eddi m\u1edbi h\u1ecdc","text":""},{"location":"Codeforces/math/floors-ceilings-inequalities/#nguon","title":"Ngu\u1ed3n","text":"<p> [Tutorial] Floors, ceilings and inequalities for beginners (with some programming tips)</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#co-ban-ve-bat-ang-thuc","title":"C\u01a1 b\u1ea3n v\u1ec1 b\u1ea5t \u0111\u1eb3ng th\u1ee9c","text":"<p>Tr\u01b0\u1edbc khi \u0111\u1ebfn v\u1edbi floor v\u00e0 ceiling, ta c\u1ea7n b\u00e0n v\u1ec1 b\u1ea5t \u0111\u1eb3ng th\u1ee9c. Gi\u1ea3 s\u1eed ta \u0111\u00e3 c\u00f3 m\u1ed9t s\u1ed1 ki\u1ebfn th\u1ee9c c\u01a1 b\u1ea3n v\u1ec1 tr\u1ee5c s\u1ed1, ta c\u00f9ng \u0111i qua m\u1ed9t s\u1ed1 kh\u00e1i ni\u1ec7m sau:</p> <ul> <li>Ta n\u00f3i \\(a &lt; b\\) khi v\u00e0 ch\u1ec9 khi \\(a\\) \u1edf tr\u01b0\u1edbc \\(b\\) tr\u00ean tr\u1ee5c s\u1ed1. S\u1ed1 \u1edf \u0111\u00e2y l\u00e0 s\u1ed1 th\u1ef1c.</li> <li>Ta n\u00f3i \\(a = b\\) khi v\u00e0 ch\u1ec9 khi \\(a\\) v\u00e0 \\(b\\) tr\u00f9ng nhau tr\u00ean tr\u1ee5c s\u1ed1.</li> <li>Ta n\u00f3i \\(a &gt; b\\) khi v\u00e0 ch\u1ec9 khi \\(b &lt; a\\), ngh\u0129a l\u00e0 \\(a\\) \u1edf sau \\(b\\) tr\u00ean tr\u1ee5c s\u1ed1.</li> <li>Ta n\u00f3i \\(a \\le b\\) khi v\u00e0 ch\u1ec9 khi \\(a &lt; b\\) ho\u1eb7c \\(a = b\\).</li> <li>Ta n\u00f3i \\(a \\ge b\\) khi v\u00e0 ch\u1ec9 khi \\(a &gt; b\\) ho\u1eb7c \\(a = b\\).</li> </ul> <p>Lu\u1eadt tam ph\u00e2n quy \u0111\u1ecbnh nh\u01b0 sau: </p> <ul> <li>Ch\u1ec9 c\u00f3 m\u1ed9t trong s\u1ed1 c\u00e1c quan h\u1ec7 n\u00e0y l\u00e0 \u0111\u00fang: \\(a &lt; b\\), \\(a = b\\), \\(a &gt; b\\).</li> </ul> <p>Th\u1ee9 n\u00e0y r\u1ea5t c\u00f3 \u00edch khi b\u1ea1n mu\u1ed1n chia tr\u01b0\u1eddng h\u1ee3p ho\u1eb7c ph\u1ea3n ch\u1ee9ng.</p> <p>H\u1ec7 qu\u1ea3 t\u1ea5t y\u1ebfu c\u1ee7a \u0111i\u1ec1u n\u00e0y l\u00e0 \u0111\u1ecbnh ngh\u0129a sau \u0111\u00e2y v\u1ec1 c\u00e1c quan h\u1ec7 d\u01b0\u1edbi d\u1ea1ng \\(&lt;\\) v\u00e0 ph\u1ee7 \u0111\u1ecbnh (b\u1ea1n c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng b\u1ea5t k\u1ef3 quan h\u1ec7 n\u00e0o kh\u00e1c \\(=\\) \u0111\u1ec3 hi\u1ec3u t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 kh\u00e1c):</p> <ul> <li>\\(a = b\\) khi v\u00e0 ch\u1ec9 khi \\(a \\not &lt; b\\) v\u00e0 \\(b \\not &lt; a\\).</li> <li>\\(a &gt; b\\) khi v\u00e0 ch\u1ec9 khi \\(b &lt; a\\).</li> <li>\\(a \\le b\\) khi v\u00e0 ch\u1ec9 khi \\(b \\not &lt; a\\).</li> <li>\\(a \\ge b\\) khi v\u00e0 ch\u1ec9 khi \\(a \\not &lt; b\\).</li> </ul> <p>\u0110\u1ec3 \u00fd r\u1eb1ng n\u1ebfu ta c\u00f3 m\u1ed9t s\u1ed1 k\u1ebft qu\u1ea3 v\u1ec1 \\(&lt;\\), v\u1edbi c\u00e1c quan h\u1ec7 tr\u00ean, ta c\u00f3 th\u1ec3 t\u00ecm ra c\u00e1c quan h\u1ec7 t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c \u0111i\u1ec1u ki\u1ec7n tr\u00ean.</p> <p>Ta c\u0169ng c\u00f3 th\u1ec3 vi\u1ebft c\u00e1c quan h\u1ec7 tr\u00ean theo \\(\\le\\) - \u0111\u00e2y s\u1ebd l\u00e0 b\u00e0i t\u1eadp cho c\u00e1c b\u1ea1n \u0111\u1ec3 x\u00e1c nh\u1eadn r\u1eb1ng b\u1ea1n \u0111\u00e3 hi\u1ec3u logic \u0111\u1eb1ng sau.</p> <p>Hi\u1ec3u \u0111\u01b0\u1ee3c nh\u1eefng \u0111i\u1ec1u tr\u00ean s\u1ebd gi\u00fap c\u00e1c b\u1ea1n t\u00ecm ra logic c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c d\u1ec5 d\u00e0ng h\u01a1n.</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#tao-chuoi-cac-quan-he","title":"T\u1ea1o chu\u1ed7i c\u00e1c quan h\u1ec7","text":"<p>Gi\u1ea3 s\u1eed \\(aRb\\) v\u00e0 \\(bRc\\) \u0111\u1ec1u \u0111\u00fang, v\u1edbi R l\u00e0 m\u1ed9t trong \\(&lt;\\), \\(&gt;\\), \\(=\\), \\(\\le\\), \\(\\ge\\), ta d\u1ec5 d\u00e0ng suy ra \\(aRc\\) c\u0169ng \u0111\u00fang. \u0110i\u1ec1u n\u00e0y cho ph\u00e9p ta t\u1ea1o chu\u1ed7i c\u00e1c b\u1ea5t \u0111\u1eb3ng th\u1ee9c, v\u00e0 vi\u1ebft ra nh\u1eefng th\u1ee9 nh\u01b0 \\(a &lt; b &lt; c\\) v\u00e0 nh\u1edb r\u1eb1ng v\u00ec ta \u0111\u1ecdc bi\u1ec3u th\u1ee9c t\u1eeb tr\u00e1i sang ph\u1ea3i, c\u00e1c to\u00e1n h\u1ea1ng ch\u1ec9 c\u00f3 t\u0103ng.</p> <p>T\u00ednh ch\u1ea5t n\u00e0y g\u1ecdi l\u00e0 b\u1eafc c\u1ea7u, v\u00e0 \u0111\u01b0\u1ee3c nghi\u00ean c\u1ee9u k\u1ef9 trong c\u00e1c ng\u1eef c\u1ea3nh kh\u00e1c. Nh\u01b0ng v\u1edbi m\u1ee5c \u0111\u00edch c\u1ee7a ch\u00fang ta, n\u00f3 ch\u1ec9 gi\u00fap \u0111\u1eddi ta \u0111\u01a1n gi\u1ea3n h\u01a1n th\u00f4i.</p> <p>\u0110\u1ebfn \u0111\u00e2y, ta c\u00f3 2 l\u01b0u \u00fd quan trong sau:</p> <ul> <li>N\u1ebfu \\(a &lt; b\\) v\u00e0 \\(b &gt; c\\), ta kh\u00f4ng th\u1ec3 n\u00f3i g\u00ec v\u1ec1 th\u1ee9 t\u1ef1 c\u1ee7a \\(a\\) v\u00e0 \\(c\\). C\u00e1c b\u1ea1n m\u1edbi h\u1ecdc m\u1eafc l\u1ed7i n\u00e0y r\u1ea5t nhi\u1ec1u.</li> <li>\\(&lt;\\) l\u00e0 m\u1ed9t m\u1ec7nh \u0111\u1ec1 m\u1ea1nh h\u01a1n \\(\\le\\). V\u00ed d\u1ee5, ta c\u00f3 \\(a &lt; b\\) v\u00e0 \\(b \\le c\\), th\u00ec s\u1ebd kh\u00f4ng c\u00f3 \\(a = c\\). N\u00ean ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng \\(a &lt; c\\), thay v\u00ec m\u1ec7nh \u0111\u1ec1 y\u1ebfu h\u01a1n \\(a \\le c\\). Theo m\u1ed9t c\u00e1ch to\u00e1n h\u1ecdc h\u01a1n, ta c\u00f3 th\u1ec3 gi\u1ea3i th\u00edch theo ki\u1ec3u: \\(b \\le c\\) ngh\u0129a l\u00e0 \\(b &lt; c\\) ho\u1eb7c \\(b = c\\). Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u, chu\u1ed7i quan h\u1ec7 \u0111\u00fang. Trong tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai, v\u00ec \\(b = c\\), v\u1ecb tr\u00ed c\u1ee7a \\(b\\) v\u00e0 \\(c\\) tr\u00ean tr\u1ee5c s\u1ed1 tr\u00f9ng nhau, n\u00ean k\u1ebft qu\u1ea3 v\u1eabn \u0111\u00fang. </li> </ul>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#cac-phep-toan-so-hoc-anh-huong-en-bat-ang-thuc-nhu-the-nao","title":"C\u00e1c ph\u00e9p to\u00e1n s\u1ed1 h\u1ecdc \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn b\u1ea5t \u0111\u1eb3ng th\u1ee9c nh\u01b0 th\u1ebf n\u00e0o?","text":"<p>\u0110\u00e2y l\u00e0 th\u1ee9 m\u00e0 nhi\u1ec1u ng\u01b0\u1eddi g\u1eb7p kh\u00f3. Ta s\u1ebd \u0111i v\u00e0o gi\u1ea3i th\u00edch m\u1ed9t s\u1ed1 t\u01b0\u01a1ng t\u00e1c c\u1ee7a c\u00e1c ph\u00e9p to\u00e1n s\u1ed1 h\u1ecdc v\u00e0 b\u1ea5t \u0111\u1eb3ng th\u1ee9c (ta s\u1ebd t\u1eadp trung v\u00e0o d\u1ea5u \\(&lt;\\), nh\u01b0ng c\u00e1c quan h\u1ec7 nh\u01b0 th\u1ebf c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n cho c\u00e1c quan h\u1ec7 kh\u00e1c nh\u01b0 \\(&gt;\\), \\(\\le\\) v\u00e0 s\u1ef1 k\u1ebft h\u1ee3p c\u1ee7a ch\u00fang n\u1eefa):</p> <ul> <li>Ph\u00e9p c\u1ed9ng / ph\u00e9p tr\u1eeb: gi\u1ea3 s\u1eed ta c\u00f3 b\u1ea5t \u0111\u1eb3ng th\u1ee9c \\(a &lt; b\\). N\u1ebfu ta di chuy\u1ec3n ch\u00fang c\u00f9ng m\u1ed9t \u0111o\u1ea1n tr\u00ean tr\u1ee5c s\u1ed1, v\u1ecb tr\u00ed t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a ch\u00fang s\u1ebd kh\u00f4ng \u0111\u1ed5i. N\u00f3i c\u00e1ch kh\u00e1c, n\u1ebfu ta th\u00eam h\u1eb1ng s\u1ed1 \\(c\\) v\u00e0o c\u1ea3 \\(a\\) v\u00e0 \\(b\\), th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a \\(a + c\\) v\u00e0 \\(b + c\\) s\u1ebd gi\u1ed1ng nh\u01b0 c\u1ee7a \\(a\\) v\u00e0 \\(b\\). Ngh\u0129a l\u00e0, \\(a &lt; b\\) suy ra \\(a + c &lt; b + c\\). \u0110i\u1ec1u t\u01b0\u01a1ng t\u1ef1 x\u1ea3y ra v\u1edbi ph\u00e9p tr\u1eeb, nh\u01b0 v\u1eady ta c\u00f3 quan h\u1ec7 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng:</li> </ul> \\[ a &lt; b \\iff a + c &lt; b + c \\] <ul> <li>Ph\u00e9p nh\u00e2n v\u1edbi \\(0\\): c\u1ea3 hai v\u1ec1 c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c v\u1ec1 \\(0\\), n\u00ean sau khi nh\u00e2n v\u1edbi \\(0\\), b\u1ea5t \u0111\u1eb3ng th\u1ee9c tr\u1edf th\u00e0nh \u0111\u1eb3ng th\u1ee9c.</li> <li>Ph\u00e9p nh\u00e2n v\u1edbi s\u1ed1 d\u01b0\u01a1ng: gi\u1ea3 s\u1eed ta c\u00f3 b\u1ea5t \u0111\u1eb3ng th\u1ee9c \\(a &lt; b\\). \u0110i\u1ec1u n\u00e0y ngh\u0129a l\u00e0 \\(0 &lt; b - a\\), ngh\u0129a l\u00e0 \\(b - a\\) d\u01b0\u01a1ng. N\u1ebfu ta nh\u00e2n n\u00f3 v\u1edbi m\u1ed9t s\u1ed1 d\u01b0\u01a1ng \\(c\\), n\u00f3 v\u1eabn s\u1ebd d\u01b0\u01a1ng, ngh\u0129a l\u00e0 \\(0 &lt; c (b - a)\\). C\u1ed9ng \\(ac\\) v\u00e0o c\u1ea3 hai v\u1ebf ta c\u00f3 \\(ac &lt; bc\\). V\u00ec v\u1eady:</li> </ul> \\[ c &gt; 0, a &lt; b \\implies ac &lt; bc \\] <ul> <li>Ph\u00e9p nh\u00e2n v\u1edbi s\u1ed1 \u00e2m: gi\u1ea3 s\u1eed ta c\u00f3 b\u1ea5t \u0111\u1eb3ng th\u1ee9c \\(a &lt; b\\) v\u00e0 m\u1ed9t s\u1ed1 \u00e2m \\(c &lt; 0\\). R\u00f5 r\u00e0ng, ta c\u00f3 \\(a(-c) &lt; b(-c)\\) t\u1eeb k\u1ebft qu\u1ea3 tr\u01b0\u1edbc. C\u1ed9ng \\(ac + bc\\) cho c\u1ea3 hai v\u1ebf ta c\u00f3 \\(bc &lt; ac\\), hay \\(ac &gt; bc\\). Ngh\u0129a l\u00e0 d\u1ea5u c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c b\u1ecb \u0111\u1ea3o. V\u00ec v\u1eady:</li> </ul> \\[ c &lt; 0, a &lt; b \\implies ac &gt; bc \\] <ul> <li>C\u00f4ng hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c c\u00f9ng chi\u1ec1u: gi\u1ea3 s\u1eed ta c\u00f3 hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c \\(a &lt; b\\) v\u00e0 \\(c &lt; d\\). Th\u00ec \\(a + c &lt; b + d\\) ph\u1ea3i kh\u00f4ng? Ta th\u1eed d\u00f9ng c\u00e1c k\u1ebft qu\u1ea3 tr\u01b0\u1edbc \u0111\u1ec3 ch\u1ee9ng minh. Tr\u1eeb \\(c\\) cho c\u1ea3 hai v\u1ebf c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c, th\u00ec \\(a + c &lt; b + d \\iff a &lt; b + d - c\\). \u0110\u1ec3 \u00fd r\u1eb1ng \\(c &lt; d\\), t\u01b0\u01a1ng t\u1ef1 ta s\u1ebd c\u00f3 \\(0 &lt; d - c\\). \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 \\(d - c\\) l\u00e0 s\u1ed1 d\u01b0\u01a1ng. N\u1ebfu ta di chuy\u1ec3n \\(b\\) \u0111\u01a1n v\u1ecb c\u1ee7a m\u1ed9t s\u1ed1 d\u01b0\u01a1ng sang b\u00ean ph\u1ea3i tr\u00ean tr\u1ee5c s\u1ed1, ta \u0111ang di chuy\u1ec3n \\(b\\) ra xa \\(a\\), v\u00e0 n\u00f3 v\u1eabn s\u1ebd l\u1edbn h\u01a1n \\(a\\), c\u00f3 ngh\u0129a l\u00e0 \\(a &lt; b + d - c\\). V\u1edbi ph\u00e9p t\u01b0\u01a1ng \u0111\u01b0\u01a1ng tr\u01b0\u1edbc \u0111\u00f3, \\(a + c &lt; b + d\\) \u0111\u00fang. V\u00ec v\u1eady:</li> </ul> \\[ a &lt; b, c &lt; d \\implies a + c &lt; b + d \\] <ul> <li>Tr\u1eeb hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c ng\u01b0\u1ee3c chi\u1ec1u: gi\u1ea3 s\u1eed ta c\u00f3 hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c \\(a &lt; b\\) v\u00e0 \\(c &gt; d\\). Th\u00ec \\(a - c &lt; b - d\\) ph\u1ea3i kh\u00f4ng? Ta nh\u00e2n \\(c &gt; d\\) v\u1edbi \\(-1\\) \u0111\u01b0\u1ee3c \\(-c &lt; -d\\). V\u1eady ta c\u00f3 \\(a - c &lt; b - d\\) v\u1edbi k\u1ebft qu\u1ea3 tr\u01b0\u1edbc \u0111\u00f3. V\u00ec v\u1eady:</li> </ul> \\[ a &lt; b, c &gt; d \\implies a - c &lt; b - d \\] <p>L\u01afU \u00dd: Tr\u1eeb c\u00e1c b\u1ea5t \u0111\u1eb3ng th\u1ee9c c\u00f9ng chi\u1ec1u v\u00e0 c\u1ed9ng c\u00e1c b\u1ea5t \u0111\u1eb3ng th\u1ee9c kh\u00e1c chi\u1ec1u \u0111\u1ec1u kh\u00f4ng \u0111\u01b0\u1ee3c, v\u00e0 b\u00e0i t\u1eadp d\u00e0nh cho b\u1ea1n l\u00e0 xem c\u00e1c b\u01b0\u1edbc ch\u1ee9ng minh tr\u00ean sai \u1edf \u0111\u00e2u v\u1edbi c\u00e1c tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3.</p> <p>Nh\u00e2n v\u00e0 chia b\u1ea5t \u0111\u1eb3ng th\u1ee9c ph\u1ee9c t\u1ea1p h\u01a1n r\u1ea5t nhi\u1ec1u, nh\u01b0ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng v\u1edbi \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1. C\u1ee5 th\u1ec3 l\u00e0, v\u1edbi ph\u00e9p nh\u00e2n hai b\u1ea5t \u0111\u1eb3ng th\u1ee9c, b\u1ea1n ph\u1ea3i ki\u1ec3m tra d\u1ea5u c\u1ee7a c\u1ea3 \\(4\\) v\u1ebf. V\u1edbi ph\u00e9p chia, c\u00e1ch th\u1ee9c c\u0169ng t\u01b0\u01a1ng t\u1ef1, nh\u01b0ng th\u00eam v\u00e0o \u0111\u00f3 b\u1ea1n c\u1ea7n x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p m\u1eabu s\u1ed1 kh\u00e1c \\(0\\).</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#floor-va-ceiling","title":"Floor v\u00e0 ceiling","text":"<p>Ta b\u1eaft \u0111\u1ea7u v\u1edbi \u0111\u1ecbnh ngh\u0129a h\u00e0m floor v\u00e0 ceiling:</p> <ul> <li>H\u00e0m floor l\u00e0 m\u1ed9t h\u00e0m \\(\\lfloor \\cdot \\rfloor : \\mathbb{R} \\to \\mathbb{Z}\\) m\u00e0 v\u1edbi m\u1ecdi s\u1ed1 th\u1ef1c \\(x\\), \\(\\lfloor x \\rfloor\\) l\u00e0 s\u1ed1 nguy\u00ean \\(n\\) m\u00e0 \\(n \\le x &lt; n + 1\\).</li> <li>H\u00e0m ceiling l\u00e0 m\u1ed9t h\u00e0m \\(\\lceil \\cdot \\rceil : \\mathbb{R} \\to \\mathbb{Z}\\) m\u00e0 v\u1edbi m\u1ecdi s\u1ed1 th\u1ef1c \\(x\\), \\(\\lceil x \\rceil\\) l\u00e0 s\u1ed1 nguy\u00ean \\(n\\) m\u00e0 \\(n-1 &lt; x \\le n\\).</li> </ul> <p>R\u00f5 r\u00e0ng, n\u1ebfu \\(n\\) t\u1ed3n t\u1ea1i, n\u00f3 l\u00e0 duy nh\u1ea5t.</p> <p>T\u1ea1i sao nh\u1eefng \u0111\u1ecbnh ngh\u0129a n\u00e0y h\u1ee3p l\u00fd? \u0110\u1ec3 \u00fd r\u1eb1ng c\u00e1c \u0111o\u1ea1n \\([n, n+1)\\) v\u1edbi s\u1ed1 nguy\u00ean \\(n\\) bao ph\u1ee7 tr\u1ee5c s\u1ed1, c\u00e1c \u0111o\u1ea1n n\u00e0y kh\u00f4ng l\u1ea5n v\u00e0o nhau, n\u00ean \\(x\\) s\u1ebd lu\u00f4n n\u1eb1m tr\u00ean m\u1ed9t trong c\u00e1c \u0111o\u1ea1n n\u00e0y. T\u00ednh ch\u1ea5t n\u00e0y c\u0169ng t\u01b0\u01a1ng t\u1ef1 v\u1edbi c\u00e1c \u0111o\u1ea1n \\((n-1, n]\\).</p> <p>V\u1edbi tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t, khi \\(x\\) l\u00e0 s\u1ed1 nguy\u00ean, c\u1ea3 hai h\u00e0m \u0111\u1ec1u tr\u1ea3 v\u1ec1 \\(n\\).</p> <p>L\u01afU \u00dd: Nh\u1edb r\u1eb1ng \\(\\lfloor 1.5 \\rfloor = 1\\), nh\u01b0ng \\(\\lfloor -1.5 \\rfloor = -2\\), kh\u00f4ng ph\u1ea3i \\(-1\\).</p> <p>Ta nh\u1eadn ra \u0111\u01b0\u1ee3c r\u1eb1ng:</p> <ul> <li>\\(\\lfloor x \\rfloor\\) l\u00e0 s\u1ed1 nguy\u00ean \\(n\\) l\u1edbn nh\u1ea5t m\u00e0 \\(n \\le x\\).</li> <li>\\(\\lceil x \\rceil\\) l\u00e0 s\u1ed1 nguy\u00ean \\(n\\) nh\u1ecf nh\u1ea5t m\u00e0 \\(x \\le n\\).</li> </ul> <p>Ta ch\u1ee9ng minh t\u1eeb \u0111\u1ecbnh ngh\u0129a (\u1edf \u0111\u00e2y ta ch\u1ec9 ch\u1ee9ng minh v\u1edbi floor, c\u00f2n ceiling th\u00ec t\u01b0\u01a1ng t\u1ef1): Gi\u1ea3 s\u1eed r\u1eb1ng n\u00f3 kh\u00f4ng \u0111\u00fang, v\u00e0 t\u1ed3n t\u1ea1i \\(a &gt; n\\) m\u00e0 \\(a \\le x\\). \\(a &gt; n\\) ngh\u0129a l\u00e0 \\(a \\ge n+1\\). Nh\u01b0ng ta bi\u1ebft r\u1eb1ng \\(x &lt; n+1 \\le a\\), n\u00ean \\(x &lt; a\\) (m\u00e2u thu\u1eabn).</p> <p>L\u01b0u \u00fd, ta c\u00f3 h\u1ec7 qu\u1ea3 \\(\\lfloor x \\rfloor \\le \\lceil x \\rceil\\), v\u00e0 ch\u00fang h\u01a1n k\u00e9m nhau \\(1\\) khi v\u00e0 ch\u1ec9 khi \\(x\\) kh\u00f4ng ph\u1ea3i l\u00e0 s\u1ed1 nguy\u00ean. Khi \\(x\\) l\u00e0 s\u1ed1 nguy\u00ean, ch\u00fang s\u1ebd \u0111\u1ec1u b\u1eb1ng \\(x\\).</p> <p>Ta c\u00f3 th\u1ec3 vi\u1ebft l\u1ea1i ch\u00fang nh\u01b0 sau \u0111\u1ec3 ti\u1ec7n h\u01a1n trong vi\u1ec7c gi\u1ea3i c\u00e1c b\u00e0i t\u1eadp.</p> <ul> <li>V\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean \\(n\\) v\u00e0 m\u1ed9t s\u1ed1 th\u1ef1c \\(x\\), th\u00ec \\(n \\le x \\iff n \\le \\lfloor x \\rfloor\\).</li> <li>V\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean \\(n\\) v\u00e0 m\u1ed9t s\u1ed1 th\u1ef1c \\(x\\), th\u00ec \\(n \\ge x \\iff n \\ge \\lceil x \\rceil\\).</li> </ul> <p>\u0110i\u1ec1u n\u00e0y \u0111\u1eb7c bi\u1ec7t quan tr\u1ecdng v\u00ec c\u00e1c ph\u1ea7n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng n\u00e0y gi\u00fap ta gi\u1ea3m \u0111i r\u1ea5t nhi\u1ec1u c\u00e1c tr\u01b0\u1eddng h\u1ee3p khi gi\u1ea3i b\u1ea5t \u0111\u1eb3ng th\u1ee9c, v\u00ed d\u1ee5 nh\u01b0:</p> V\u00ed d\u1ee5 <p>\u0110\u00e2y l\u00e0 comment t\u1eeb b\u00e0i blog n\u00e0y.</p> <p>\u0110\u1ec1 b\u00e0i: Cho A, C m\u00e0 \\(\\lceil \\frac{A}{B} \\rceil &lt; C\\). T\u00ecm B nh\u1ecf nh\u1ea5t c\u00f3 th\u1ec3.</p> <p>Ng\u01b0\u1eddi vi\u1ebft d\u00f9ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u1ec3 t\u00ecm B, tuy nhi\u00ean c\u00f3 m\u1ed9t c\u00e1ch t\u1ed1t h\u01a1n t\u1eeb comment \u0111\u00f3.</p> <p>Gi\u1ea3 s\u1eed \\(A, B, C\\) \u0111\u1ec1u l\u00e0 s\u1ed1 nguy\u00ean (ng\u01b0\u1ee3c l\u1ea1i th\u00ec ch\u1ee9ng minh kh\u00f4ng h\u1ee3p l\u00fd ho\u1eb7c kh\u00f4ng \u0111\u00fang).</p> <p>V\u1edbi m\u1ecdi s\u1ed1 th\u1ef1c \\(x\\) v\u00e0 s\u1ed1 nguy\u00ean \\(n\\), theo \u0111\u1ecbnh ngh\u0129a h\u00e0m ceiling, ta c\u00f3:</p> <ul> <li>\\(x \\le n\\)</li> <li>\\(\\lceil x \\rceil \\le n\\)</li> </ul> <p>\u0110\u1ec3 \u00fd r\u1eb1ng v\u00ec \\(\\lceil \\frac{A}{B} \\rceil\\) v\u00e0 \\(C\\) \u0111\u1ec1u l\u00e0 s\u1ed1 nguy\u00ean, \\(\\lceil \\frac{A}{B} \\rceil &lt; C\\) t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi \\(\\lceil \\frac{A}{B} \\rceil \\le C - 1\\). K\u1ebft h\u1ee3p c\u00e1c \u0111i\u1ec1u ki\u1ec7n \u0111\u00f3 ngh\u0129a l\u00e0 \u0111i\u1ec1u ki\u1ec7n ban \u0111\u1ea7u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng \\(\\lceil \\frac{A}{B} \\rceil \\le C - 1\\).</p> <p>Ta kh\u00f4ng th\u1ec3 \u0111i ti\u1ebfp \u0111\u01b0\u1ee3c tr\u1eeb phi bi\u1ebft d\u1ea5u c\u1ee7a \\(C - 1\\) v\u00e0 gi\u1edbi h\u1ea1n c\u1ee7a B. R\u00f5 r\u00e0ng, n\u1ebfu \\(C &gt; 1\\) v\u00e0 \\(B\\) c\u00f3 th\u1ec3 \u00e2m, th\u00ec \\(B = -\\infty\\) l\u00e0 \u0111\u00e1p \u00e1n (ho\u1eb7c ch\u00ednh x\u00e1c h\u01a1n l\u00e0 \\(B\\) nh\u1ecf nh\u1ea5t kh\u00f4ng t\u1ed3n t\u1ea1i). T\u01b0\u01a1ng t\u1ef1, c\u00f3 th\u1ec3 kh\u00f4ng c\u00f3 \u0111\u00e1p \u00e1n n\u1ebfu \\(C &lt; 1\\). Gi\u1edd ta gi\u1ea3 s\u1eed \\(C &gt; 1\\) v\u00e0 \\(B\\) ch\u1ec9 c\u00f3 th\u1ec3 l\u00e0 s\u1ed1 nguy\u00ean d\u01b0\u01a1ng.</p> <p>B\u1ea5t \u0111\u1eb3ng th\u1ee9c b\u00e2y gi\u1edd s\u1ebd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi \\(B \\ge \\frac{A}{C-1}\\). V\u1edbi hai g\u1ea1ch \u0111\u1ea7u d\u00f2ng \u1edf tr\u00ean th\u00ec ta s\u1ebd c\u00f3 \\(B \\ge \\lceil \\frac{A}{C-1} \\rceil\\).</p> <p>V\u00ec t\u1ea5t c\u1ea3 \u0111\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, \\(B\\) nh\u1ecf nh\u1ea5t ta c\u1ea7n t\u00ecm ch\u00ednh l\u00e0 \u0111\u00e2y.</p> <p>Sau c\u00f9ng, m\u1ea5u ch\u1ed1t l\u00e0 ph\u1ea3i quen v\u1edbi t\u00ednh ch\u1ea5t c\u1ee7a ceiling v\u00e0 floor v\u00e0 tho\u1ea3i m\u00e1i v\u1edbi \u0111\u1ea1i s\u1ed1 v\u00e0 c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i b\u1ea5t \u0111\u1eb3ng th\u1ee9c.</p> <p>Ta h\u00e3y vi\u1ebft l\u1ea1i \u0111\u1ecbnh ngh\u0129a theo c\u00e1ch kh\u00e1c lu\u00f4n xem. \\(n \\le x &lt; n + 1\\) t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi hai b\u1ea5t \u0111\u1eb3ng th\u1eedc \\(n \\le x\\) v\u00e0 \\(x &lt; n + 1\\). B\u1ea5t \u0111\u1eb3ng th\u1ee9c \\(x &lt; n + 1\\) l\u1ea1i t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi \\(x - 1 &lt; n\\). N\u00ean k\u1ebft h\u1ee3p l\u1ea1i ta s\u1ebd c\u00f3 \\(x - 1 &lt; n \\le x\\). C\u00e1c b\u01b0\u1edbc n\u00e0y \u0111\u1ea3o l\u1ea1i \u0111\u01b0\u1ee3c, n\u00ean ngh\u0129a l\u00e0 \u0111\u00e2y c\u00f3 th\u1ec3 d\u00f9ng l\u00e0m \u0111\u1ecbnh ngh\u0129a c\u1ee7a h\u00e0m floor. T\u01b0\u01a1ng t\u1ef1 v\u1edbi h\u00e0m ceiling, ta c\u00f3 c\u00e1c t\u00ednh ch\u1ea5t sau \u0111\u00e2y (nh\u01b0 l\u00e0 \u0111\u1ecbnh ngh\u0129a thay th\u1ebf):</p> <ul> <li>\\(x - 1 &lt; \\lfloor x \\rfloor \\le x\\)</li> <li>\\(x \\le \\lceil x \\rceil &lt; x + 1\\)</li> </ul> <p>\u0110\u00f4i khi s\u1ebd h\u1eefu \u00edch khi ngh\u0129 v\u1ec1 ph\u1ea7n ph\u00e2n s\u1ed1 c\u1ee7a m\u1ed9t s\u1ed1 (v\u00ed d\u1ee5 nh\u01b0 kho\u1ea3ng c\u00e1ch t\u1eeb floor), v\u00ec n\u00f3 ch\u1eafc ch\u1eafn l\u00e0 m\u1ed9t s\u1ed1 th\u1ef1c d\u01b0\u01a1ng nh\u1ecf h\u01a1n \\(1\\). T\u01b0\u01a1ng t\u1ef1, kho\u1ea3ng c\u00e1ch \u0111\u1ebfn ceiling c\u0169ng h\u1eefu \u00edch.</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#cac-tinh-chat-cua-floor-va-ceiling","title":"C\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a floor v\u00e0 ceiling","text":"<p>Ta c\u00f9ng xem chuy\u1ec7n g\u00ec s\u1ebd x\u1ea3y ra v\u1edbi floor c\u1ee7a m\u1ed9t s\u1ed1 th\u1ef1c khi ta c\u1ed9ng n\u00f3 (t\u01b0\u01a1ng t\u1ef1 v\u1edbi tr\u1eeb) v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean.</p> <p>Cho \\(n' = \\lfloor x + a \\rfloor\\), v\u1edbi \\(a\\) l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean. \u0110i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi \\(n' \\le x + a &lt; n' + 1\\), t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ti\u1ebfp v\u1edbi \\(n' - a \\le x &lt; n' - a + 1\\). V\u00ec \\(n'\\) l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean, \\(n' - a\\) c\u0169ng l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean. N\u00ean b\u1ea5t \u0111\u1eb3ng th\u1ee9c tr\u01b0\u1edbc c\u0169ng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c n\u00f3i r\u1eb1ng \\(n' - a = \\lfloor x \\rfloor\\). N\u00f3i c\u00e1ch kh\u00e1c, ta \u0111\u00e3 cho th\u1ea5y r\u1eb1ng:</p> \\[a \\in \\mathbb{Z} \\implies \\lfloor x + a \\rfloor = \\lfloor x \\rfloor + a\\] <p>T\u01b0\u01a1ng t\u1ef1, ta c\u0169ng ch\u1ee9ng minh \u0111\u01b0\u1ee3c r\u1eb1ng:</p> \\[a \\in \\mathbb{Z} \\implies \\lceil x + a \\rceil = \\lceil x \\rceil + a\\] <p>Tuy nhi\u00ean, identity n\u00e0y kh\u00f4ng \u0111\u00fang v\u1edbi ph\u00e9p nh\u00e2n s\u1ed1 nguy\u00ean trong tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t. V\u00ed d\u1ee5 \\(\\lfloor 1.5 \\rfloor = 1\\), v\u00e0 \\(\\lfloor 2 \\cdot 1.5 \\rfloor = 3 \\ne 2 \\cdot \\lfloor 1.5 \\rfloor\\).</p> <p>L\u01b0u \u00fd, v\u1edbi c\u00f9ng v\u00ed d\u1ee5, ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \\(\\lfloor x + y \\rfloor\\) KH\u00d4NG b\u1eb1ng \\(\\lfloor x \\rfloor + \\lfloor y \\rfloor\\) trong tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t (v\u00e0 t\u01b0\u01a1ng t\u1ef1 v\u1edbi h\u00e0m ceiling). Tuy nhi\u00ean, ta c\u00f3 th\u1ec3 ch\u1ee9ng minh \u0111\u01b0\u1ee3c c\u00e1c identity sau:</p> \\[\\lfloor x \\rfloor + \\lfloor y \\rfloor \\le \\lfloor x + y \\rfloor \\le \\lfloor x \\rfloor + \\lfloor y \\rfloor + 1\\] \\[\\lceil x \\rceil + \\lceil y \\rceil - 1 \\le \\lceil x + y \\rceil \\le \\lceil x \\rceil + \\lceil y \\rceil\\] <p>Gi\u1edd ta h\u00e3y xem chuy\u1ec7n g\u00ec x\u1ea3y ra khi nh\u00e2n \u0111\u1ed1i s\u1ed1 c\u1ee7a c\u00e1c h\u00e0m v\u1edbi \\(-1\\).</p> <p>T\u1eeb \\(n \\le x &lt; n + 1 \\iff -n - 1 &lt; -x \\le -n\\), ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \\(-\\lfloor x \\rfloor = \\lceil -x \\rceil\\). Thay \\(x\\) b\u1eb1ng \\(-x\\) ta s\u1ebd c\u00f3 \\(\\lfloor -x \\rfloor = - \\lceil x \\rceil\\).</p> <p>V\u00ec h\u00e0m ceiling v\u00e0 floor tr\u1ea3 v\u1ec1 s\u1ed1 nguy\u00ean, d\u00f9ng bao nhi\u00eau l\u1ea7n floor v\u00e0 ceiling l\u00ean k\u1ebft qu\u1ea3 s\u1ebd kh\u00f4ng \u0111\u1ed5i k\u1ebft qu\u1ea3 sau khi d\u00f9ng m\u1ed9t l\u1ea7n.</p> <p>M\u1ed9t t\u00ednh ch\u1ea5t hay ho kh\u00e1c c\u00f3 th\u1ec3 gi\u00fap b\u1ea1n l\u00e0, v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(n\\) v\u00e0 s\u1ed1 th\u1ef1c \\(x\\) b\u1ea5t k\u1ef3:</p> <ul> <li>\\(\\lfloor \\frac{\\lfloor x \\rfloor}{n} \\rfloor = \\lfloor \\frac{x}{n} \\rfloor\\)</li> <li>\\(\\lceil \\frac{\\lceil x \\rceil}{n} \\rceil = \\lceil \\frac{x}{n} \\rceil\\)</li> </ul> <p>Ch\u1ee9ng minh \u0111i\u1ec1u n\u00e0y c\u1ea7n m\u1ed9t s\u1ed1 ki\u1ebfn th\u1ee9c v\u1ec1 b\u1ed5 \u0111\u1ec1 chia Euclid (d\u01b0 khi chia m\u1ed9t s\u1ed1 nguy\u00ean cho m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m nh\u1ecf h\u01a1n s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \u0111\u00f3), v\u00e0 \u0111\u00e2y l\u00e0 b\u00e0i t\u1eadp d\u00e0nh cho b\u1ea1n \u0111\u1ecdc.</p> <p>V\u1ec1 c\u00e1c \u1ee9ng d\u1ee5ng v\u00e0 t\u00ednh ch\u1ea5t kh\u00e1c, vui l\u00f2ng tham kh\u1ea3o Wikipedia.</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#mot-so-ung-dung-cua-floor-va-ceiling","title":"M\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng c\u1ee7a floor v\u00e0 ceiling","text":"<ul> <li>Th\u01b0\u01a1ng v\u00e0 s\u1ed1 d\u01b0: Th\u01b0\u01a1ng c\u1ee7a ph\u00e9p chia s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(a\\) v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(b\\) kh\u00e1c theo \u0111\u1ecbnh ngh\u0129a l\u00e0 \\(\\lfloor \\frac{a}{b} \\rfloor\\). D\u01b0 s\u1ebd l\u00e0 \\(a - b * \\lfloor \\frac{a}{b} \\rfloor\\).</li> <li>\u0110\u1ec3 \u0111\u1ebfm s\u1ed1 b\u1ed9 c\u1ee7a \\(a\\) m\u00e0 \\(\\le n\\), \u0111\u1ec3 \u00fd r\u1eb1ng n\u1ebfu ta c\u00f3 \\(k\\) b\u1ed9i, th\u00ec b\u1ed9i l\u1edbn nh\u1ea5t c\u1ee7a \\(a\\) l\u00e0 \\(ka\\), v\u00e0 n\u00f3 ph\u1ea3i \\(\\le n\\). V\u00ec th\u1ebf \\(k \\le \\frac{n}{a}\\). \u0110\u00e2y c\u0169ng l\u00e0 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ee7 \u0111\u1ec3 c\u00f3 \u00edt nh\u1ea5t \\(k\\) b\u1ed9i c\u1ee7a \\(a\\) nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng \\(n\\), n\u00ean \\(k = \\lfloor \\frac{n}{a} \\rfloor\\) theo c\u1ef1c \u0111\u1ea1i c\u1ee7a \\(k\\).</li> </ul>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#ap-dung-nhung-ieu-tren-e-giai-bai-tap","title":"\u00c1p d\u1ee5ng nh\u1eefng \u0111i\u1ec1u tr\u00ean \u0111\u1ec3 gi\u1ea3i b\u00e0i t\u1eadp","text":"<p>Gi\u1edd ta \u0111\u00e3 c\u00f3 c\u00e1c c\u00f4ng c\u1ee5, ta s\u1ebd \u0111i v\u00e0o c\u00e1ch \u0111\u1ec3 gi\u1ea3i c\u00e1c b\u00e0i t\u1eadp m\u00e0 kh\u00f4ng b\u1ecb m\u1eafc k\u1eb9t \u1edf qu\u00e1 nhi\u1ec1u tr\u01b0\u1eddng h\u1ee3p. V\u00ed d\u1ee5 \u1edf tr\u00ean l\u00e0 m\u1ed9t c\u00e1ch \u0111\u1ec3 suy ngh\u0129.</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#bai-1","title":"B\u00e0i 1","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i t\u1eadp AtCoder ABC165 - D.</p> <p>\u0110\u1ec1 b\u00e0i: Cho c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(A\\), \\(B\\), v\u00e0 \\(N\\). T\u00ecm gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \\(\\lfloor \\frac{Ax}{B} \\rfloor - A \\times \\lfloor \\frac{x}{B} \\rfloor\\) v\u1edbi m\u1ed9t s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m \\(x\\) kh\u00f4ng l\u1edbn h\u01a1n N.</p> <p>Gi\u1edbi h\u1ea1n: </p> <ul> <li>\\(1 \\le N \\le 10^6\\)</li> <li>\\(1 \\le A, B \\le 10^{12}\\)</li> </ul> <p>C\u00e1ch gi\u1ea3i:</p> <p>G\u1ecdi \\(f(x) = \\lfloor \\frac{Ax}{B} \\rfloor - A \\times \\lfloor \\frac{x}{B} \\rfloor\\). </p> <p>D\u1ec5 th\u1ea5y \\(f(x + B) = f(x)\\). Cho n\u00ean ta ch\u1ec9 c\u1ea7n quan t\u00e2m \\(0 \\le x \\le B-1\\).</p> <p>V\u1eady th\u00ec, \\(f(x) = \\lfloor \\frac{Ax}{B} \\rfloor - A \\times \\lfloor \\frac{x}{B} \\rfloor = \\lfloor \\frac{Ax}{B} \\rfloor\\), v\u00e0 v\u00ec \\(\\lfloor \\frac{Ax}{B} \\rfloor\\) l\u00e0 h\u00e0m \u0111\u01a1n \u0111i\u1ec7u kh\u00f4ng gi\u1ea3m, n\u00ean v\u1edbi \\(x\\) l\u1edbn nh\u1ea5t trong ph\u1ea7n gi\u1edbi h\u1ea1n (\\(0 \\le x \\le B-1\\), \\(0 \\le x \\le N\\)), \\(f(x)\\) ch\u00ednh l\u00e0 gi\u00e1 tr\u1ecb c\u1ea7n t\u00ecm. </p> <p>Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 l\u00e0 \\(f(\\min(B-1, N))\\).</p> <p>Code m\u1eabu:</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\nint main() {\n    long long A, B, N;\n    cin &gt;&gt; A &gt;&gt; B &gt;&gt; N;\n\n    long long x = 0;\n    if (N &gt;= B) x = B - 1;\n    else x = N;\n\n    cout &lt;&lt; (A * x) / B - A * (x / B);\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#bai-2","title":"B\u00e0i 2","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i t\u1eadp AtCoder ABC230 - E.</p> <p>\u0110\u1ec1 b\u00e0i: Cho s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(N\\). T\u00ecm gi\u00e1 tr\u1ecb c\u1ee7a \\(\\sum_{i = 1}^{N} \\lfloor \\frac{N}{i} \\rfloor\\).</p> <p>Gi\u1edbi h\u1ea1n:</p> <ul> <li>\\(1 \\le N \\le 10^{12}\\)</li> <li>N l\u00e0 s\u1ed1 nguy\u00ean</li> </ul> <p>C\u00e1ch gi\u1ea3i:</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng \\(1 \\le \\lfloor \\frac{N}{i} \\rfloor \\le N\\) v\u1edbi m\u1ecdi \\(1 \\le i \\le N\\).</p> <p>G\u1ecdi \\(k_0 = \\lfloor \\sqrt{N} \\rfloor\\). V\u1edbi m\u1ed7i \\(k = 1, 2, \\ldots, k_0\\), x\u00e9t s\u1ed1 c\u00e1c s\u1ed1 \\(i\\) m\u00e0 \\(\\lfloor \\frac{N}{i} \\rfloor = k\\).</p> <p>\\(\\lfloor \\frac{N}{i} \\rfloor = k\\), ngh\u0129a l\u00e0 \\(k \\le \\frac{N}{i} &lt; k + 1\\), t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi \\(\\frac{N}{k+1} &lt; i \\le \\frac{N}{k}\\). S\u1ed1 c\u00e1c s\u1ed1 \\(i\\) tho\u1ea3 m\u00e3n \u0111i\u1ec1u n\u00e0y l\u00e0 \\(\\lfloor \\frac{N}{k} \\rfloor - \\lfloor \\frac{N}{k+1} \\rfloor\\).</p> <p>Ti\u1ebfp theo, x\u00e9t tr\u01b0\u1eddng h\u1ee3p khi \\(\\lfloor \\frac{N}{i} \\rfloor \\ge k_0 + 1\\). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y \\(\\frac{N}{i} \\ge k_0 + 1\\), n\u00ean \\(i \\le \\frac{N}{k_0 + 1} &lt; \\sqrt{N}\\), v\u00e0 c\u00f3 nhi\u1ec1u nh\u1ea5t \\(\\sqrt{N}\\) tr\u01b0\u1eddng h\u1ee3p cho \\(i\\), n\u00ean ta c\u00f3 th\u1ec3 l\u1ea5y k\u1ebft qu\u1ea3 l\u1ea7n l\u01b0\u1ee3t.</p> <p>Nh\u01b0 v\u1eady, \u0111\u00e1p \u00e1n s\u1ebd l\u00e0</p> \\[\\sum_{k=1}^{k_0} ((\\lfloor \\frac{N}{k} \\rfloor - \\lfloor \\frac{N}{k+1} \\rfloor) \\times k) + \\sum_{i=1}^{\\lfloor \\frac{N}{k_0 + 1} \\rfloor} \\lfloor \\frac{N}{i} \\rfloor\\] <p>v\u00e0 m\u1ed7i ph\u1ea7n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh trong \\(O(\\sqrt{N})\\).</p> <p>Code m\u1eabu:</p> <pre><code>#include &lt;bits/stdc++.h&gt;\n\nusing namespace std;\n\nint main(void) {\n    long long n, ans, k;\n    cin &gt;&gt; n;\n\n    for (long long i = 1; i &lt;= n; i++) {\n        if (i*i &lt;= n) k = i;\n        else break;\n    }\n\n    ans = 0;\n    for (long long i = 1; i &lt;= k; i++) ans += ((n / i) - (n / (i + 1))) * i;\n    for (long long i = 1; i &lt;= n / (k + 1); i++) ans += (n / i);\n\n    cout &lt;&lt; ans &lt;&lt; endl;\n    return 0;\n}\n</code></pre>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#mot-so-identity-va-gioi-han","title":"M\u1ed9t s\u1ed1 identity v\u00e0 gi\u1edbi h\u1ea1n","text":"<p>M\u00ecnh s\u1ebd list ra m\u1ed9t s\u1ed1 identity v\u00e0 gi\u1edbi h\u1ea1n, vi\u1ec7c ch\u1ee9ng minh th\u00ec d\u00e0nh cho c\u00e1c b\u1ea1n.</p> <ul> <li>Floor v\u00e0 ceiling cho ph\u00e2n s\u1ed1: V\u1edbi s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(b\\) v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean b\u1ea5t k\u1ef3 \\(a\\), ta c\u00f3 \\(\\lceil \\frac{a}{b} \\rceil = \\lfloor \\frac{a+b-1}{b} \\rfloor\\).</li> <li>T\u00ednh ch\u1ea5t c\u1ee7a Gauss: V\u1edbi c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(m\\) v\u00e0 \\(n\\), ta c\u00f3 \\(\\sum_{i = 0}^{n - 1} \\lfloor \\frac{im}{n} \\rfloor = \\frac{(m-1)(n-1) + gcd(m, n) - 1}{2}\\). \u0110\u1ec3 ch\u1ee9ng minh, h\u00e3y xem s\u1ed1 \u0111i\u1ec3m n\u1eb1m d\u01b0\u1edbi \u0111\u01b0\u1eddng th\u1eb3ng \\(y = \\frac{mx}{n}\\) n\u1eb1m trong tam gi\u00e1c v\u1edbi c\u00e1c g\u00f3c \\((0, 0)\\) v\u00e0 \\((m, n)\\).</li> <li>Identity c\u1ee7a Hermite: V\u1edbi s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(n\\) v\u00e0 s\u1ed1 th\u1ef1c \\(x\\), c\u00e1c quan h\u1ec7 sau \u0111\u00fang: \\(\\lfloor nx \\rfloor = \\sum_{i = 0}^{n - 1} \\lfloor x + \\frac{i}{n} \\rfloor\\) v\u00e0 \\(\\lceil nx \\rceil = \\sum_{i = 0}^{n - 1} \\lceil x - \\frac{i}{n} \\rceil\\). C\u00f3 th\u1ec3 ch\u1ee9ng minh b\u1eb1ng c\u00e1c chia tr\u01b0\u1eddng h\u1ee3p ph\u1ea7n ph\u00e2n s\u1ed1 (t\u01b0\u01a1ng \u1ee9ng l\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn ceiling) l\u00e0 gi\u1eefa \\(\\frac{i}{n}\\) v\u00e0 \\(\\frac{i+1}{n}\\).</li> <li>Gi\u1edbi h\u1ea1n Harmonic: \\(\\sum_{i = 1}^n \\lfloor \\frac{x}{i} \\rfloor \\le x \\sum_{i = 1}^n \\frac{1}{i} = O(x \\log n)\\). H\u1ec7 qu\u1ea3 l\u00e0 m\u1ed9t s\u00e0ng v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u01b0\u1edbc t\u1eeb \\(1\\) \u0111\u1ebfn \\(n\\) v\u1edbi t\u1ed5ng c\u1ed9ng \\(x\\) s\u1ed1 nguy\u00ean li\u00ean ti\u1ebfp th\u00ec c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(x \\log n)\\). \u0110\u00e2y l\u00e0 l\u00fd do v\u00ec sao s\u00e0ng Eratosthenes v\u00e0 bi\u1ebfn th\u1ec3 \u0111o\u1ea1n c\u1ee7a n\u00f3 \u0111\u1ee7 nhanh. \u0110i\u1ec1u n\u00e0y c\u0169ng cho th\u1ea5y r\u1eb1ng t\u1ed5ng c\u00e1c \u01b0\u1edbc c\u1ee7a m\u1ed9t s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(n\\) t\u1ed1i \u0111a l\u00e0 \\(O(n \\log n)\\)</li> </ul>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#lien-quan-en-ngon-ngu-lap-trinh","title":"Li\u00ean quan \u0111\u1ebfn ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh","text":"<p>B\u1ea5t k\u1ef3 khi n\u00e0o b\u1ea1n th\u1ef1c hi\u1ec7n ph\u00e9p chia s\u1ed1 nguy\u00ean b\u1eb1ng b\u1ea5t c\u1ee9 ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh n\u00e0o, h\u00e3y c\u1ed1 g\u1eafng chuy\u1ec3n \u0111\u1ed5i n\u00f3 th\u00e0nh d\u1ea1ng c\u00f3 m\u1eabu s\u1ed1 d\u01b0\u01a1ng. Tuy nhi\u00ean, v\u1edbi h\u1ea7u h\u1ebft ng\u00f4n ng\u1eef, ta c\u00f3 <code>(a / b) * b + (a % b)</code> b\u1eb1ng <code>a</code> lu\u00f4n \u0111\u00fang.</p> <p>Th\u00f4ng th\u01b0\u1eddng c\u00f3 hai h\u00e0nh vi khi th\u1ef1c hi\u1ec7n ph\u00e9p chia s\u1ed1 nguy\u00ean v\u1edbi s\u1ed1 chia d\u01b0\u01a1ng:</p> <ul> <li>T\u00ednh floor trong m\u1ecdi tr\u01b0\u1eddng h\u1ee3p: v\u00ed d\u1ee5 nh\u01b0 Python. <code>a // b</code> s\u1ebd cho ra \\(\\lfloor \\frac{a}{b} \\rfloor\\), v\u00e0 <code>a % b</code> s\u1ebd cho ra s\u1ed1 d\u01b0 kh\u00f4ng \u00e2m khi \\(a\\) b\u1ecb chia b\u1edfi \\(b\\).</li> <li>L\u00e0m tr\u00f2n k\u1ebft qu\u1ea3 v\u1ec1 \\(0\\): v\u00ed d\u1ee5 nh\u01b0 C++. L\u00fd do l\u00e0 \u0111\u1ec3 ph\u00f2ng ng\u1eeba tr\u00e0n s\u1ed1 khi nh\u00e2n k\u1ebft qu\u1ea3 v\u1edbi m\u1eabu s\u1ed1. Cho n\u00ean, v\u1edbi s\u1ed1 d\u01b0\u01a1ng \\(a\\), c\u00e1ch l\u00e0m s\u1ebd t\u01b0\u01a1ng t\u1ef1 Python, nh\u01b0ng v\u1edbi s\u1ed1 \u00e2m \\(a\\), n\u00f3 s\u1ebd tr\u1ea3 v\u1ec1 \\(\\lceil \\frac{a}{b} \\rceil\\), v\u00e0 <code>a % b</code> s\u1ebd cho ra kho\u1ea3ng c\u00e1ch \u00e2m \u0111\u1ebfn b\u1ed9i t\u01b0\u01a1ng \u1ee9ng c\u1ee7a \\(b\\).</li> </ul> <p>\u0110\u1ec3 t\u00ednh ceiling c\u1ee7a \\(\\frac{a}{b}\\) v\u1edbi s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(b\\) v\u00e0 s\u1ed1 nguy\u00ean \\(a\\), ta c\u00f3 th\u1ec3 d\u00f9ng k\u1ebft qu\u1ea3 tr\u01b0\u1edbc \u0111\u00f3: \\(\\lceil \\frac{a}{b} \\rceil = \\lfloor \\frac{a+b-1}{b} \\rfloor\\). Vi\u1ec7c c\u00e0i \u0111\u1eb7t th\u00ec xin m\u1eddi b\u1ea1n \u0111\u1ecdc. </p> <p>L\u01b0u \u00fd r\u1eb1ng <code>std::floor</code> v\u00e0 <code>std::ceil</code> l\u00e0 c\u00e1c thao t\u00e1c tr\u00ean s\u1ed1 c\u00f3 d\u1ea5u ch\u1ea5m \u0111\u1ed9ng, v\u00e0 k\u1ebft qu\u1ea3 c\u0169ng thu\u1ed9c ki\u1ec3u \u0111\u00f3. N\u00ean ch\u00fang c\u00f3 th\u1ec3 kh\u00f4ng ch\u00ednh x\u00e1c khi chuy\u1ec3n th\u00e0nh s\u1ed1 nguy\u00ean, v\u00ec v\u1eady ch\u00fang h\u1ea7u nh\u01b0 kh\u00f4ng n\u00ean \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong th\u1ef1c t\u1ebf.</p>"},{"location":"Codeforces/math/floors-ceilings-inequalities/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"<p>\u1ede \u0111\u00e2y ch\u1ec9 l\u01b0u code c\u1ee7a nh\u1eefng v\u00ed d\u1ee5 \u1edf tr\u00ean</p> Problem Status Submission Code Date AtCoder ABC 165 - D Submission Code 02/05/2020 AtCoder ABC 230 - E Submission Code 07/12/2021"},{"location":"Codeforces/math/inclusion-exclusion/","title":"Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb","text":""},{"location":"Codeforces/math/inclusion-exclusion/#nguyen-tac-bao-ham-loai-tru","title":"Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb","text":""},{"location":"Codeforces/math/inclusion-exclusion/#nguon","title":"Ngu\u1ed3n","text":"<p> [Tutorial] Inclusion-Exclusion Principle</p>"},{"location":"Codeforces/math/inclusion-exclusion/#nhac-lai-cac-ky-hieu-ve-tap-hop","title":"Nh\u1eafc l\u1ea1i c\u00e1c k\u00fd hi\u1ec7u v\u1ec1 t\u1eadp h\u1ee3p","text":"<ul> <li>\\(\\cap\\) l\u00e0 giao c\u1ee7a hai t\u1eadp h\u1ee3p.</li> <li>\\(\\cup\\) l\u00e0 h\u1ee3p c\u1ee7a hai t\u1eadp h\u1ee3p.</li> <li>\\(\\setminus\\) l\u00e0 hi\u1ec7u c\u1ee7a hai t\u1eadp h\u1ee3p.</li> <li>\\(\\emptyset\\) l\u00e0 t\u1eadp h\u1ee3p r\u1ed7ng.</li> <li>\\(\\mathbb{N}\\) l\u00e0 t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 t\u1ef1 nhi\u00ean.</li> <li>\\(\\mathbb{Z}\\) l\u00e0 t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 nguy\u00ean.</li> <li>\\(\\mathbb{Q}\\) l\u00e0 t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 h\u1eefu t\u1ec9.</li> <li>\\(\\mathbb{R}\\) l\u00e0 t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 th\u1ef1c.</li> <li>\\(\\mathbb{C}\\) l\u00e0 t\u1eadp h\u1ee3p c\u00e1c s\u1ed1 ph\u1ee9c.</li> <li>\\(|X|\\) l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p \\(X\\).</li> <li>\\(\\in\\) l\u00e0 k\u00fd hi\u1ec7u cho ph\u1ea7n t\u1eed thu\u1ed9c t\u1eadp h\u1ee3p.</li> <li>\\(\\subset\\) l\u00e0 k\u00fd hi\u1ec7u cho t\u1eadp h\u1ee3p con.</li> <li>\\(\\subseteq\\) l\u00e0 k\u00fd hi\u1ec7u cho t\u1eadp h\u1ee3p con ho\u1eb7c b\u1eb1ng.</li> <li>\\(\\supset\\) l\u00e0 k\u00fd hi\u1ec7u cho t\u1eadp h\u1ee3p ch\u1ee9a.</li> <li>\\(\\supseteq\\) l\u00e0 k\u00fd hi\u1ec7u cho t\u1eadp h\u1ee3p ch\u1ee9a ho\u1eb7c b\u1eb1ng.</li> </ul>"},{"location":"Codeforces/math/inclusion-exclusion/#cac-inh-nghia","title":"C\u00e1c \u0111\u1ecbnh ngh\u0129a","text":"<p>Cho t\u1eadp h\u1eefu h\u1ea1n \\(X\\) v\u00e0 ba t\u1eadp con \\(A\\), \\(B\\), \\(C\\). \u0110\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c \\(|A \\cup B \\cup C|\\), ta l\u1ea5y t\u1ed5ng \\(|A| + |B| + |C|\\). Tr\u1eeb khi \\(A\\), \\(B\\), \\(C\\) \u0111\u00f4i m\u1ed9t kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed chung, ta s\u1ebd \u0111\u1ebfm b\u1ecb th\u1eeba, v\u00ec c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(A \\cap B\\), \\(A \\cap C\\), \\(B \\cap C\\) \u0111\u01b0\u1ee3c \u0111\u1ebfm hai l\u1ea7n. V\u1eady n\u00ean ta tr\u1eeb \\(|A \\cap B| + |A \\cap C| + |B \\cap C|\\). Gi\u1edd k\u1ebft qu\u1ea3 l\u1ea1i b\u1ecb thi\u1ebfu c\u00e1c ph\u1ea7n t\u1eed trong \\(A \\cap B \\cap C\\), do n\u00f3 \u0111\u01b0\u1ee3c th\u00eam 3 l\u1ea7n, nh\u01b0ng c\u0169ng b\u1ecb tr\u1eeb \u0111i 3 l\u1ea7n. V\u1eady k\u1ebft qu\u1ea3 l\u00e0:</p> \\[|A \\cup B \\cup C| = |A| + |B| + |C| - |A \\cap B| - |A \\cap C| - |B \\cap C| + |A \\cap B \\cap C|\\] <p>hay t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi</p> \\[|X \\setminus (A \\cup B \\cup C) = |X| - |A| - |B| - |C| + |A \\cap B| + |A \\cap C| + |B \\cap C| - |A \\cap B \\cap C|\\] <p>C\u00f4ng th\u1ee9c sau \u0111\u00e2y s\u1ebd gi\u1ea3i quy\u1ebft tr\u01b0\u1eddng h\u1ee3p c\u00f3 nhi\u1ec1u t\u1eadp h\u1ee3p h\u01a1n.</p>"},{"location":"Codeforces/math/inclusion-exclusion/#nguyen-tac-bao-ham-loai-tru-han-che-the-restricted-inclusion-exclusion-principle","title":"Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb h\u1ea1n ch\u1ebf (The Restricted Inclusion-Exclusion Principle)","text":"<p>Cho \\(A_1, A_2, \\dots, A_n\\) l\u00e0 c\u00e1c t\u1eadp con c\u1ee7a \\(X\\). Ta c\u00f3:</p> \\[|X \\setminus \\bigcup_{i=1}^n A_i| = |X| - \\sum_{i=1}^n |A_i| + \\sum_{1 \\leq i &lt; j \\leq n} |A_i \\cap A_j| - \\sum_{1 \\leq i &lt; j &lt; k \\leq n} |A_i \\cap A_j \\cap A_k| + \\dots + (-1)^n |A_1 \\cap A_2 \\cap \\dots \\cap A_n|\\] <p>\u0110\u00e2y l\u00e0 c\u00f4ng th\u1ee9c r\u1ea5t quen thu\u1ed9c v\u1edbi nhi\u1ec1u b\u1ea1n, m\u00ecnh s\u1ebd g\u1ecdi n\u00f3 l\u00e0 Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb h\u1ea1n ch\u1ebf (The Restricted Inclusion-Exclusion Principle). N\u00f3 c\u00f3 th\u1ec3 chuy\u1ec3n b\u00e0i to\u00e1n t\u00ednh k\u00edch th\u01b0\u1edbc h\u1ee3p c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p th\u00e0nh b\u00e0i to\u00e1n t\u00ednh k\u00edch th\u01b0\u1edbc giao c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p.</p> <p>Kh\u00f4ng kh\u00f3 \u0111\u1ec3 ch\u1ee9ng minh t\u00ednh \u0111\u00fang \u0111\u1eafn c\u1ee7a c\u00f4ng th\u1ee9c n\u00e0y, ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra xem m\u1ed9t ph\u1ea7n t\u1eed \\(x \\in X\\) \u0111\u01b0\u1ee3c \u0111\u1ebfm bao nhi\u00eau l\u1ea7n trong c\u1ea3 hai v\u1ebf. N\u1ebfu \\(x \\notin \\bigcup_{i=1}^n A_i\\) th\u00ec n\u00f3 \u0111\u01b0\u1ee3c \u0111\u1ebfm m\u1ed9t l\u1ea7n trong c\u1ea3 hai v\u1ebf. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu \\(x \\in \\bigcup_{i=1}^n A_i\\), hay ch\u00ednh x\u00e1c h\u01a1n l\u00e0 \\(x\\) n\u1eb1m trong \\(m\\) t\u1eadp h\u1ee3p trong c\u00e1c t\u1eadp \\(A_1, A_2, \\dots, A_n\\), v\u1ebf tr\u00e1i n\u00f3 s\u1ebd kh\u00f4ng xu\u1ea5t hi\u1ec7n, c\u00f2n v\u1ebf ph\u1ea3i th\u00ec s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n l\u00e0:</p> \\[1 - \\binom{m}{1} + \\binom{m}{2} - \\binom{m}{3} + \\dots + (-1)^m \\binom{m}{m} = 0\\] <p>v\u1edbi m\u1ecdi \\(m \\le 1\\), n\u00ean d\u1ea5u b\u1eb1ng x\u1ea3y ra.</p>"},{"location":"Codeforces/math/inclusion-exclusion/#vi-du-1","title":"V\u00ed d\u1ee5 1","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i Co-prime tr\u00ean HDU Online Judge. \u0110\u00e2y l\u00e0 m\u1ed9t b\u00e0i r\u1ea5t n\u1ed5i ti\u1ebfng s\u1eed d\u1ee5ng Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb.</p> <p>Cho \\(N\\), \\(L\\), \\(R\\), b\u1ea1n c\u1ea7n t\u00ednh s\u1ed1 s\u1ed1 nguy\u00ean \\(x\\) trong \u0111o\u1ea1n \\([L, R]\\) sao cho \\(x\\) nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi \\(N\\), hay n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 \\(\\gcd(x, N) = 1\\). C\u00f3 \\(1 \\le T \\le 100\\) test. Gi\u1edbi h\u1ea1n l\u00e0 \\(1 \\le N \\le 10^9\\), \\(1 \\le L \\le R \\le 10^{15}\\).</p> L\u1eddi gi\u1ea3i <p>N\u1ebfu ta c\u00f3 th\u1ec3 t\u00ednh s\u1ed1 s\u1ed1 nguy\u00ean \\(x\\) trong \u0111o\u1ea1n \\([1, X]\\) m\u00e0 \\(x\\) nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u01a1i \\(N\\), k\u00fd hi\u1ec7u l\u00e0 \\(f(X)\\), th\u00ec \u0111\u00e1p \u00e1n cu\u1ed1i c\u00f9ng s\u1ebd l\u00e0 \\(f(R) - f(L-1)\\). V\u1eady t\u00ednh \\(f(X)\\) ki\u1ec3u g\u00ec?</p> <p>Thay v\u00ec \u0111\u1ebfm s\u1ed1 s\u1ed1 nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi \\(N\\), ta c\u00f3 th\u1ec3 \u0111\u1ebfm s\u1ed1 s\u1ed1 kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi \\(N\\), ngh\u0129a l\u00e0 c\u00e1c s\u1ed1 c\u00f3 chung \u00edt nh\u1ea5t m\u1ed9t th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 v\u1edbi \\(N\\). \u0110\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y, \u0111\u1ea7u ti\u00ean ta c\u00f3 th\u1ec3 s\u00e0ng t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 \\(O(\\sqrt N)\\), sau \u0111\u00f3 t\u00ecm t\u1ea5t c\u1ea3 c\u00e1c th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 \\(p_1, p_2, \\dots, p_k\\) c\u1ee7a \\(N\\). G\u1ecdi \\(A_i\\) l\u00e0 t\u1eadp c\u00e1c s\u1ed1 chia h\u1ebft cho \\(p_i\\), th\u00ec s\u1ed1 s\u1ed1 kh\u00f4ng nguy\u00ean t\u1ed1 c\u00f9ng nhau v\u1edbi \\(N\\) trong \u0111o\u1ea1n \\([1, X]\\) s\u1ebd l\u00e0 \\(|\\bigcup_{i=1}^n A_i|\\), c\u00e1i n\u00e0y kh\u00e1 kh\u00f3 \u0111\u1ec3 t\u00ednh tr\u1ef1c ti\u1ebfp. Tuy nhi\u00ean, n\u1ebfu s\u1eed d\u1ee5ng Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb, ta c\u00f3 th\u1ec3 chuy\u1ec3n b\u00e0i to\u00e1n n\u00e0y th\u00e0nh b\u00e0i to\u00e1n t\u00ednh k\u00edch th\u01b0\u1edbc giao c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p \\(A_i\\), s\u1ebd d\u1ec5 h\u01a1n.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 \\(O(\\sqrt N + T \\cdot 2^k)\\), v\u1edbi \\(k &lt; 10\\) l\u00e0 s\u1ed1 th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 kh\u00e1c nhau c\u1ee7a \\(N\\).</p> <p>Di\u1ec5n gi\u1ea3i chu\u1ea9n s\u1ebd \u0111\u01b0a ta \u0111\u1ebfn v\u1edbi Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb. Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t t\u1eadp \\(X\\), g\u1ecdi l\u00e0 universe \u0111i, v\u00e0 m\u1ed9t t\u1eadp \\(E = \\{e_1, e_2, \\dots, e_n\\}\\) c\u00e1c t\u00ednh ch\u1ea5t (properties) m\u00e0 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(X\\) c\u00f3 th\u1ec3 c\u00f3 ho\u1eb7c kh\u00f4ng. Ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a b\u1ea5t k\u1ef3 t\u00ednh ch\u1ea5t n\u00e0o m\u00e0 ta mu\u1ed1n, nh\u01b0 l\u00e0 \\(e = ''\\le 5''\\), \\(e = ''\\text{l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean}''\\), hay th\u1eadm ch\u00ed \\(e = ''\\text{th\u00edch \u0103n t\u00e1o}''\\) ch\u1eb3ng h\u1ea1n. G\u1ecdi \\(A_i\\) l\u00e0 t\u1eadp con c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a X c\u00f3 t\u00ednh ch\u1ea5t \\(e_i\\) (v\u00e0 c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f3 c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t kh\u00e1c, nh\u01b0ng v\u1eabn c\u00f3 chung t\u00ednh ch\u1ea5t \\(e_i\\)). V\u1eady th\u00ec \\(|X \\setminus \\bigcup_{i=1}^n A_i|\\) l\u00e0 s\u1ed1 ph\u1ea7n t\u1eed trong X kh\u00f4ng c\u00f3 t\u00ednh ch\u1ea5t n\u00e0o trong \\(E\\). R\u00f5 r\u00e0ng, \\(A_{i_1}, A_{i_2}, \\dots, A_{i_t}\\) l\u00e0 l\u1ea7n l\u01b0\u1ee3t l\u00e0 c\u00e1c t\u1eadp con c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a X c\u00f3 chung t\u00ednh ch\u1ea5t l\u1ea7n l\u01b0\u1ee3t l\u00e0 \\(e_{i_1}, e_{i_2}, \\dots, e_{i_t}\\) (m\u1ed7i ph\u1ea7n t\u1eed trong m\u1ed9t t\u1eadp c\u00f3 th\u1ec3 c\u00f3 c\u00e1c t\u00ednh ch\u1ea5t kh\u00e1c, nh\u01b0ng t\u1ea5t c\u1ea3 ch\u00fang trong m\u1ed9t t\u1eadp \u0111\u1ec1u ph\u1ea3i c\u00f3 chung t\u00ednh ch\u1ea5t \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh). V\u1edbi c\u00e1c k\u00ed hi\u1ec7u</p> \\[N_{\\supseteq T} := \\#\\{x \\in X : \\text{T l\u00e0 t\u1eadp con c\u1ee7a t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a x}\\}\\] <p>(t\u1ee9c l\u00e0 \u0111\u1ebfm s\u1ed1 ph\u1ea7n t\u1eed \\(x\\) c\u1ee7a \\(X\\) sao cho t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t m\u00e0 \\(x\\) \u0111ang c\u00f3 s\u1ebd l\u00e0 t\u1eadp ch\u1ee9a t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t T cho tr\u01b0\u1edbc) v\u00e0</p> \\[N_{=T} := \\#\\{x \\in X : \\text{T ch\u00ednh l\u00e0 t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a x}\\}\\] <p>(t\u1ee9c l\u00e0 \u0111\u1ebfm s\u1ed1 ph\u1ea7n t\u1eed \\(x\\) c\u1ee7a \\(X\\) sao cho t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t m\u00e0 \\(x\\) \u0111ang c\u00f3 s\u1ebd b\u1eb1ng t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t T cho tr\u01b0\u1edbc), ta \u0111\u1ebfn v\u1edbi Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb.</p>"},{"location":"Codeforces/math/inclusion-exclusion/#nguyen-tac-bao-ham-loai-tru-the-inclusion-exclusion-principle","title":"Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb (The Inclusion-Exclusion Principle)","text":"<p>Cho t\u1eadp \\(X\\), v\u00e0 t\u1eadp \\(E = \\{e_1, e_2, \\dots, e_n\\}\\) l\u00e0 t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t. Ta c\u00f3</p> \\[N_{= \\emptyset} = \\sum_{T \\subseteq E} (-1)^{|T|} N_{\\supseteq T} = \\sum_{k=0}^n (-1)^k \\sum_{T:|T|=k} N_{\\supseteq T}\\] <p>C\u00f4ng th\u1ee9c n\u00e0y c\u00f2n tr\u1edf n\u00ean \u0111\u01a1n gi\u1ea3n h\u01a1n trong tr\u01b0\u1eddng h\u1ee3p \\(N_{\\supseteq T}\\) ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o k\u00edch th\u01b0\u1edbc \\(|T| = k\\). T\u1eeb \u0111\u00e2y ta c\u00f3 th\u1ec3 vi\u1ebft \\(N_{\\supseteq T} = N_{\\le k}\\) v\u1edbi \\(|T| = k\\), v\u00e0 g\u1ecdi \\(E\\) l\u00e0 m\u1ed9t t\u1eadp \u0111\u1ed3ng nh\u1ea5t c\u00e1c t\u00ednh ch\u1ea5t, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y \\(N_{= T} = N_{= k}\\) c\u0169ng ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o k\u00edch th\u01b0\u1edbc c\u1ee7a \\(T\\). V\u1eady v\u1edbi c\u00e1c t\u00ednh ch\u1ea5t \u0111\u1ed3ng nh\u1ea5t, ta c\u00f3</p> \\[N_{= \\emptyset} = N_{= 0} = \\sum_{k=0}^n (-1)^k \\binom{n}{k} N_{\\ge k}\\] <p>\u0110\u00e2y l\u00e0 b\u1ea3n ch\u1ea5t c\u1ee7a Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb. H\u00e3y c\u1ed1 g\u1eafng hi\u1ec3u t\u1ea5t c\u1ea3 c\u00e1c k\u00fd hi\u1ec7u tr\u01b0\u1edbc khi \u0111\u1ecdc ti\u1ebfp. T\u1eeb \u0111\u00e2y ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng, khi cho \\(e_i = \\{i \\in A_i\\}\\), ta s\u1ebd c\u00f3 Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb h\u1ea1n ch\u1ebf.</p>"},{"location":"Codeforces/math/inclusion-exclusion/#vi-du-2","title":"V\u00ed d\u1ee5 2","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i Character Encoding tr\u00ean HDU Online Judge.</p> <p>B\u00e0i n\u00e0y y\u00eau c\u1ea7u b\u1ea1n t\u00ednh s\u1ed1 nghi\u1ec7m nguy\u00ean c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh \\(x_1 + x_2 + \\dots + x_n = k\\) tho\u1ea3 m\u00e3n \\(0 \\le x_i &lt; m\\), l\u1ea5y d\u01b0 v\u1edbi \\(998244353\\).</p> <p>Gi\u1edbi h\u1ea1n: \\(1 \\le n, m \\le 10^5\\), \\(0 \\le k \\le 10^5\\), \\(0 \\le \\sum n, \\sum m, \\sum k \\le 5 \\times 10^6\\).</p> <p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu b\u1ea1n th\u1ef1c s\u1ef1 submit b\u00e0i n\u00e0y th\u00ec \u0111\u1ec3 \u00fd l\u00e0 vai tr\u00f2 c\u1ee7a \\(n\\) v\u00e0 \\(m\\) s\u1ebd \u0111\u1ed5i ch\u1ed7 cho nhau nh\u00e9.</p> G\u1ee3i \u00fd <p>S\u1ed1 nghi\u1ec7m nguy\u00ean kh\u00f4ng \u00e2m c\u1ee7a \\(x_1 + x_2 + \\dots + x_n = k\\) l\u00e0 \\(\\binom{n+k-1}{k} = \\binom{n+k-1}{n-1}\\).</p> <p>L\u00e0m sao \u0111\u1ec3 t\u00ednh \u0111\u01b0\u1ee3c? Ta c\u00f3 th\u1ec3 t\u01b0\u1edfng t\u01b0\u1ee3ng r\u1eb1ng ta tr\u1ea3i \\(k\\) vi\u00ean bi tr\u00ean m\u1ed9t \u0111\u01b0\u1eddng th\u1eb3ng, v\u00e0 ta mu\u1ed1n chia \\(k\\) vi\u00ean bi n\u00e0y th\u00e0nh \\(n\\) ph\u1ea7n, m\u1ed7i ph\u1ea7n c\u00f3 th\u1ec3 c\u00f3 ho\u1eb7c kh\u00f4ng c\u00f3 vi\u00ean bi n\u00e0o, m\u1ed7i ph\u1ea7n g\u1ed3m c\u00e1c vi\u00ean bi li\u00ean ti\u1ebfp nhau. Nh\u01b0 v\u1eady ta c\u1ea7n c\u00f3 \\(n-1\\) v\u00e1ch ng\u0103n \u0111\u1ec3 chia \\(k\\) vi\u00ean bi th\u00e0nh \\(n\\) ph\u1ea7n. S\u1ed1 ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng th\u1eb3ng ta c\u00f3 t\u1ea5t c\u1ea3 l\u00e0 \\(k + n - 1\\), trong \u0111\u00f3 \\(k\\) vi\u00ean bi v\u00e0 \\(n-1\\) v\u00e1ch ng\u0103n. V\u00ec m\u1ed7i ph\u1ea7n c\u00f3 th\u1ec3 c\u00f3 ho\u1eb7c kh\u00f4ng c\u00f3 vi\u00ean bi n\u00e0o, ta c\u00f3 th\u1ec3 t\u1ef1 do ch\u1ecdn \\(n-1\\) ch\u1ed7 trong \\(k+n-1\\) ch\u1ed7 \u0111\u1ec3 \u0111\u1eb7t v\u00e1ch ng\u0103n (c\u00e1c vi\u00ean bi s\u1ebd \u0111\u01b0\u1ee3c t\u1ef1 d\u1ed9ng \u0111\u1eb7t v\u00e0o ph\u1ea7n c\u00f2n l\u1ea1i). V\u1eady k\u1ebft qu\u1ea3 l\u00e0 \\(\\binom{n+k-1}{n-1}\\), c\u0169ng b\u1eb1ng v\u1edbi \\(\\binom{n+k-1}{k}\\).</p> L\u1eddi gi\u1ea3i <p>Ta th\u1ea5y r\u1eb1ng n\u1ebfu kh\u00f4ng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \\(x &lt; m\\), vi\u1ec7c t\u00ednh s\u1ed1 nghi\u1ec7m s\u1ebd r\u1ea5t d\u1ec5 d\u00e0ng, cho n\u00ean ta s\u1ebd th\u1eed t\u00ecm c\u00e1ch b\u1ecf \u0111i \u0111\u01b0\u1ee3c c\u00e1i \u0111i\u1ec1u ki\u1ec7n n\u00e0y. Ta \u00e1p d\u1ee5ng Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb \u1edf \u0111\u00e2y.</p> <p>Ta \u0111\u1ecbnh ngh\u0129a t\u00ednh ch\u1ea5t \\(e_i  = ''x_i \\ge m''\\), ta th\u1ea5y \\(N_{= \\emptyset}\\) s\u1ebd l\u00e0 k\u1ebft qu\u1ea3 ta c\u1ea7n. R\u00f5 r\u00e0ng l\u00e0 t\u1eadp c\u00e1c t\u00ednh ch\u1ea5t n\u00e0y \u0111\u1ed3ng nh\u1ea5t. G\u1ecdi \\(T = \\{1,2, \\dots, j\\} (j \\le n)\\), ta c\u00f3 \\(N_{\\supseteq T}\\) s\u1ebd l\u00e0 s\u1ed1 nghi\u1ec7m \\(x_1 \\ge m, x_2 \\ge m, \\dots, x_j \\ge m\\). \u0110\u1eb7t \\(y_i = x_i - m\\) khi \\(i \\le j\\), \\(y_i = x_i\\) khi \\(i &gt; j\\) v\u00e0 b\u00e0i to\u00e1n tr\u1edf th\u00e0nh s\u1ed1 nghi\u1ec7m c\u1ee7a</p> \\[y_1 + y_2 + \\dots + y_n = k - j \\cdot m\\] <p>Gi\u1edd n\u00f3 kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o \u0111i\u1ec1u ki\u1ec7n n\u1eefa, n\u00ean ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng g\u1ee3i \u00fd \u1edf tr\u00ean \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c s\u1ed1 nghi\u1ec7m l\u00e0</p> \\[N_{= \\emptyset} = N_{= 0} = \\sum_{j=0}^{n} (-1)^j \\binom{n}{j} \\binom{n+k-jm-1}{n-1}\\] <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 \\(O(n)\\), v\u00ec c\u1ea7n ph\u1ea3i t\u00ednh tr\u01b0\u1edbc c\u00e1c giai th\u1eeba v\u00e0 modulo ngh\u1ecbch \u0111\u1ea3o c\u1ee7a ch\u00fang.</p>"},{"location":"Codeforces/math/inclusion-exclusion/#vi-du-3","title":"V\u00ed d\u1ee5 3","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i K-Inversion Permutations tr\u00ean HackerRank.</p> <p>Cho \\(N\\), \\(K\\), t\u00ecm s\u1ed1 ho\u00e1n v\u1ecb \\(N\\) ph\u1ea7n t\u1eed m\u00e0 c\u00f3 \\(K\\) ngh\u1ecbch th\u1ebf (inversion), l\u1ea5y d\u01b0 v\u1edbi \\(10^9 + 7\\).</p> <p>Gi\u1edbi h\u1ea1n: \\(1 \\le N \\le 10^5\\), \\(1 \\le K \\le \\min(10^5, \\binom{N}{2})\\).</p> L\u1eddi gi\u1ea3i <p>Th\u01b0\u1eddng th\u00ec m\u1ecdi ng\u01b0\u1eddi c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t \u00fd l\u00e0 g\u1ecdi \\(dp[i][j]\\) l\u00e0 s\u1ed1 ho\u00e1n v\u1ecb \u0111\u1ed9 d\u00e0i \\(i\\) c\u00f3 \\(j\\) ngh\u1ecbch th\u1ebf. C\u00f4ng th\u1ee9c th\u00ec c\u0169ng \u0111\u01a1n gi\u1ea3n: \\(dp[i][j] = \\sum_{k=0}^{i-1} dp[i-1][j-k]\\), b\u1edfi v\u00ec khi ta th\u00eam \\(i\\) v\u00e0o ho\u00e1n v\u1ecb t\u1eeb \\(1\\) \u0111\u1ebfn \\(i-1\\), s\u1ed1 nghich th\u1ebf s\u1ebd c\u00e0ng t\u0103ng khi \\(i\\) c\u00e0ng n\u1eb1m g\u1ea7n \u0111\u1ea7u d\u00e3y. \u0110\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 \\(O(NK^2)\\), v\u00e0 c\u00f3 th\u1ec3 r\u00fat th\u00e0nh \\(O(NK)\\) v\u1edbi prefix sum, nh\u01b0ng t\u1ed1i \u01b0u nh\u01b0 th\u1ebf v\u1eabn l\u00e0 qu\u00e1 \u00edt \u0111\u1ec3 AC.</p> <p>V\u1edbi c\u00f4ng th\u1ee9c nh\u01b0 tr\u00ean, ta bi\u1ebft r\u1eb1ng, v\u1edbi ph\u1ea7n t\u1eed th\u1ee9 \\(i\\), ta s\u1ebd th\u00eam \u0111\u01b0\u1ee3c \\(0 \\le x \\le i-1\\) v\u00e0o t\u1ed5ng s\u1ed1 ngh\u00edch th\u1ebf, nh\u01b0 v\u1eady \u0111\u00e1p \u00e1n s\u1ebd b\u1eb1ng s\u1ed1 nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh \\(x_1 + x_2 + \\dots + x_n = K\\) v\u1edbi \\(0 \\le x_i \\le i-1\\).</p> <p>Gi\u1ed1ng v\u1edbi v\u00ed d\u1ee5 2, ta \u00e1p d\u1ee5ng Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb. G\u1ecdi \\(e_i = ''x_i \\ge i''\\), ta c\u00f3 \\(N_{= \\emptyset}\\) s\u1ebd l\u00e0 k\u1ebft qu\u1ea3 ta c\u1ea7n. \u00c1p d\u1ee5ng c\u00e1ch t\u01b0\u01a1ng t\u1ef1 nh\u01b0 v\u1edbi v\u00ed d\u1ee5 2, ta c\u00f3 th\u1ec3 nh\u1eadn ra r\u1eb1ng n\u1ebfu t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(T\\) b\u1eb1ng \\(s\\), th\u00ec s\u1ed1 nghi\u1ec7m c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh s\u1ebd l\u00e0 \\(N_{\\supseteq T} = \\binom{N-1+(K-s)}{N-1}\\). V\u1eady ta c\u00f3 th\u1ec3 g\u1ed9p c\u00e1c t\u1eadp nh\u01b0 v\u1eady l\u1ea1i v\u1edbi nhau. Theo Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb, ta c\u00f3</p> \\[N_{\\supseteq T} = \\sum_{s=0}^{K} \\binom{N-1+(K-s)}{N-1} \\cdot f(s)\\] <p>v\u1edbi \\(f(n) = \\sum_{i \\ge 0} (-1)^i g(n,i)\\) v\u00e0 \\(g(i, j)\\) l\u00e0 s\u1ed1 c\u00e1ch d\u00f9ng \\(j\\) s\u1ed1 kh\u00e1c nhau trong \u0111o\u1ea1n \\([1, N]\\) \u0111\u1ec3 c\u00f3 t\u1ed5ng b\u1eb1ng \\(i\\).</p> <p>Nh\u01b0 v\u1eady b\u00e0i to\u00e1n tr\u1edf th\u00e0nh t\u00ednh t\u1ea5t c\u1ea3 c\u00e1c \\(g(i, j)\\). \u0110\u1ec3 t\u00ednh \\(g(i,j)\\) th\u00e0nh 2 tr\u01b0\u1eddng h\u1ee3p l\u00e0:</p> <ul> <li>T\u1eadp \\(j\\) ph\u1ea7n t\u1eed c\u00f3 ch\u1ee9a \\(1\\): ta c\u1ed9ng \\(g(i-j, j-1)\\) v\u00e0o k\u1ebft qu\u1ea3.</li> <li>T\u1eadp \\(j\\) ph\u1ea7n t\u1eed kh\u00f4ng ch\u1ee9a \\(1\\): ta c\u1ed9ng \\(g(i-j, j)\\) v\u00e0o k\u1ebft qu\u1ea3.</li> </ul> <p>B\u1ea1n ngh\u0129 \u0111\u1ebfn \u0111\u00e2y l\u00e0 \u0111\u1ee7 sao? Kh\u00f4ng. C\u00e1c t\u1eadp trong \\(g(i-j, j-1)\\) v\u00e0 \\(g(i-j, j)\\) \u0111\u1ec1u c\u00f3 th\u1ec3 ch\u1ee9a \\(N\\), m\u00e0 v\u00ec ch\u1ee9a \\(N\\) n\u00ean khi t\u00ednh v\u00e0o \\(g(i, j)\\) ch\u00fang s\u1ebd th\u00e0nh \\(N+1\\), kh\u00f4ng tho\u1ea3 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a ch\u00fang ta, n\u00ean ta c\u1ea7n ph\u1ea3i tr\u1eeb \u0111i c\u00e1c t\u1eadp \u0111\u00f3. N\u00ean ta tr\u1eeb \u0111i \\(g(i - (N+1), j-1)\\).</p> <p>V\u1eady \\(g(i, j) = g(i-j, j-1) + g(i-j, j) - g(i - (N+1), j-1)\\).</p> <p>M\u1ed9t nh\u1eadn x\u00e9t quan tr\u1ecdng n\u1eefa l\u00e0 c\u00f3 nhi\u1ec1u nh\u1ea5t \\(O(\\sqrt{K})\\) gi\u00e1 tr\u1ecb cho \\(j\\). V\u00ec v\u1eady b\u00e0i to\u00e1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i trong \\(O(K \\sqrt{K})\\).</p>"},{"location":"Codeforces/math/inclusion-exclusion/#vi-du-4","title":"V\u00ed d\u1ee5 4","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i Problem K trong k\u1ef3 thi <code>XVIII Open Cup named after E.V. Pankratiev. - Grand Prix of Gomel</code>.</p> <p>Cho s\u1ed1 nguy\u00ean \\(m\\), t\u00ecm s\u1ed1 t\u1eadp kh\u00f4ng r\u1ed7ng ch\u1ee9a c\u00e1c s\u1ed1 nguy\u00ean d\u01b0\u01a1ng, m\u00e0 \u01b0\u1edbc chung l\u1edbn nh\u1ea5t c\u1ee7a ch\u00fang b\u1eb1ng \\(1\\), b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a ch\u00fang b\u1eb1ng \\(m\\), l\u1ea5y d\u01b0 v\u1edbi \\(998244353\\).</p> <p>Gi\u1edbi h\u1ea1n: \\(1 \\le m \\le 10^{18}\\).</p> L\u1eddi gi\u1ea3i <p>R\u00f5 r\u00e0ng ta c\u1ea7n ph\u00e2n t\u00edch \\(m\\) ra th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1. B\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng thu\u1eadt to\u00e1n Pollard-Rho \u1edf \u0111\u00e2y. Nh\u01b0ng c\u00f3 m\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n h\u01a1n: \u0110o\u1ea1n sau b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng ch\u1ec9 c\u00f3 s\u1ed1 m\u0169 c\u1ee7a s\u1ed1 nguy\u00ean t\u1ed1 l\u00e0 quan tr\u1ecdng, ch\u1ee9 ch\u00ednh c\u00e1i s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u00f3 th\u00ec kh\u00f4ng. N\u00ean ta c\u00f3 th\u1ec3 th\u1eed chia n\u00f3 cho t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 nguy\u00ean t\u1ed1 \u0111\u1ebfn \\(10^6\\) \u0111\u1ec3 xem ta c\u00f2n g\u00ec, m\u1ed9t s\u1ed1 nguy\u00ean t\u1ed1 \\(p\\), m\u1ed9t b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a s\u1ed1 nguy\u00ean t\u1ed1 \\(p^2\\), ho\u1eb7c t\u00edch c\u1ee7a hai s\u1ed1 nguy\u00ean t\u1ed1 kh\u00e1c nhau \\(pq\\). Ta c\u00f3 th\u1ec3 ki\u1ec3m tra tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u ti\u00ean v\u1edbi thu\u1eadt to\u00e1n Rabin-Miller, duy\u1ec7t qua \\([\\sqrt{m} - 10, \\sqrt{m} + 10]\\) \u0111\u1ec3 ki\u1ec3m tra tr\u01b0\u1eddng h\u1ee3p th\u1ee9 hai, ng\u01b0\u1ee3c l\u1ea1i n\u00f3 l\u00e0 tr\u01b0\u1eddng h\u1ee3p cu\u1ed1i c\u00f9ng.</p> <p>Sau khi ph\u00e2n t\u00edch th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1, ta c\u00f3 \\(m = p_1^{a_1} p_2^{a_2} \\dots p_k^{a_k}\\) (vi\u1ebft v\u1eady th\u00f4i ch\u1ee9 \\(p_i\\) v\u1eabn kh\u00f4ng quan tr\u1ecdng nh\u00e9). R\u00f5 r\u00e0ng ta mu\u1ed1n ch\u1ecdn m\u1ed9t t\u1eadp con c\u00e1c \u01b0\u1edbc c\u1ee7a \\(m\\) (\u0111\u1ec3 b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a ch\u00fang b\u1eb1ng \\(m\\)).</p> <p>Ta c\u1ea7n tr\u00e1nh \u0111\u1ebfm c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u00f3 \\(GCD \\neq 1\\) v\u00e0 \\(LCM \\neq m\\), n\u00ean ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng Nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb. G\u1ecdi \\(e_{i,1} = \\text{GCD chia h\u1ebft cho } p_i\\) v\u00e0 \\(e_{i,2} = \\text{LCM kh\u00f4ng chia h\u1ebft cho } p_i^{a_i}\\), n\u00ean \u0111\u00e1p \u00e1n l\u00e0 \\(N_{= \\emptyset}\\). Ta c\u00f3 \\(2k\\) t\u00ednh ch\u1ea5t c\u1ea7n x\u00e9t \u1edf \u0111\u00e2y. Nh\u01b0 v\u1eady th\u00ec ta c\u1ea7n c\u00f3 \\(2^{2k} = 4^k\\) t\u1eadp giao, v\u00e0 v\u1edbi m\u1ed7i t\u1eadp giao ta c\u1ea7n t\u00ednh \\(t\\), l\u00e0 s\u1ed1 ph\u1ea7n t\u1eed trong t\u1eadp tho\u1ea3 m\u00e3n tr\u01b0\u1eddng h\u1ee3p t\u1eadp giao \u0111\u00f3, sau \u0111\u00f3 ta th\u00eam \\(2^t - 1\\) v\u00e0o \u0111\u00e1p \u00e1n v\u1edbi d\u1ea5u ph\u00f9 h\u1ee3p.</p> <p>V\u1edbi m\u1ed7i th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 th\u00ec ta c\u00f3 4 tr\u01b0\u1eddng h\u1ee3p t\u1eadp giao l\u00e0 \\(\\emptyset\\), \\(e_{i, 1}\\), \\(e_{i, 2}\\) v\u00e0 \\(e_{i, 1} \\cap e_{i, 2}\\). V\u00ec m\u1ed7i th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 (theo c\u00e1ch ta \u0111\u1eb7t t\u00ednh ch\u1ea5t) \u0111\u1ed9c l\u1eadp v\u1edbi nhau n\u00ean \\(t\\) s\u1ebd l\u00e0 t\u00edch k\u1ebft qu\u1ea3 c\u1ee7a m\u1ed7i th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1. C\u1ee5 th\u1ec3 nh\u01b0 sau:</p> <ul> <li>\\(\\emptyset\\): ta c\u00f3 \\(a_i+1\\) c\u00e1ch ch\u1ecdn.</li> <li>\\(e_{i,1}\\): ta mu\u1ed1n \\(\\min(a'_i) \\ge 1\\) n\u00ean ta c\u00f3 \\(a_i\\) c\u00e1ch ch\u1ecdn.</li> <li>\\(e_{i,2}\\): ta mu\u1ed1n \\(\\max(a'_i) &lt; a_i\\) n\u00ean ta c\u0169ng c\u00f3 \\(a_i\\) c\u00e1ch ch\u1ecdn.</li> <li>\\(e_{i, 1} \\cap e_{i, 2}\\): g\u1ed9p 2 tr\u01b0\u1eddng h\u1ee3p tr\u00ean l\u1ea1i ta c\u00f3 \\(a_i - 1\\) c\u00e1ch ch\u1ecdn.</li> </ul> <p>T\u00ednh tr\u1ef1c ti\u1ebfp ra s\u1ebd t\u1ed1n \\(O(4^k)\\), s\u1ebd d\u1eabn \u0111\u1ebfn TLE v\u1edbi \\(k=15\\) trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t. Tuy nhi\u00ean, th\u1ea5y r\u1eb1ng v\u1edbi m\u1ed7i th\u1eeba s\u1ed1 nguy\u00ean t\u1ed1 \\(e_{i,1}\\) v\u00e0 \\(e_{i,2}\\) d\u1eabn \u0111\u1ebfn c\u00f9ng m\u1ed9t c\u00e1ch t\u00ednh, ta c\u00f3 th\u1ec3 g\u1ed9p ch\u00fang l\u1ea1i v\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u00f3 th\u1ec3 gi\u1ea3m c\u00f2n \\(O(3^k)\\).</p>"},{"location":"Codeforces/math/inclusion-exclusion/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date HDU 4135 - Co-prime Unavailable public link Code 08/11/2023 HDU 6397 - Character Encoding Unavailable public link Code 12/11/2023 HackerRank - K-Inversion Permutations Unavailable public link Code 14/11/2023 XVIII Open Cup named after E.V. Pankratiev. - Grand Prix of Gomel - Problem K Unavailable public link Code 16/11/2023"},{"location":"Codeforces/math/martingales/","title":"X\u00e1c su\u1ea5t 101, b\u00ed \u1ea9n \u0111\u1eb1ng sau Martingales v\u00e0 c\u00e1c b\u00e0i t\u1eadp \u1ee9ng d\u1ee5ng","text":""},{"location":"Codeforces/math/martingales/#xac-suat-101-bi-an-ang-sau-martingales-va-cac-bai-tap-ung-dung","title":"X\u00e1c su\u1ea5t 101, b\u00ed \u1ea9n \u0111\u1eb1ng sau Martingales v\u00e0 c\u00e1c b\u00e0i t\u1eadp \u1ee9ng d\u1ee5ng","text":""},{"location":"Codeforces/math/martingales/#nguon","title":"Ngu\u1ed3n","text":"<p> Probability 101, the intuition behind martingales and solving problems with them</p>"},{"location":"Codeforces/math/martingales/#chu-y","title":"Ch\u00fa \u00fd","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t b\u00e0i d\u1ecbch m\u00ecnh kh\u00f4ng th\u1ef1c s\u1ef1 h\u00e0i l\u00f2ng. C\u00f3 l\u1ebd l\u00e0 do m\u00ecnh kh\u00f4ng hi\u1ec3u h\u1ebft \u00fd ngh\u0129a m\u00e0 t\u00e1c gi\u1ea3 mu\u1ed1n truy\u1ec1n t\u1ea3i. B\u00e0i n\u00e0y qu\u00e1 n\u1eb7ng v\u1ec1 to\u00e1n.</p>"},{"location":"Codeforces/math/martingales/#loi-tua-cua-tac-gia","title":"L\u1eddi t\u1ef1a (c\u1ee7a t\u00e1c gi\u1ea3)","text":"<p>G\u1ea7n \u0111\u00e2y c\u00f3 ng\u01b0\u1eddi nh\u1edd t\u00f4i gi\u1ea3i th\u00edch v\u00e0i b\u00e0i to\u00e1n ki\u1ec3u nh\u01b0: \"T\u00ecm th\u1eddi gian k\u00ec v\u1ecdng tr\u01b0\u1edbc khi XYZ x\u1ea3y ra\". \u0110\u1ec3 \u00fd r\u1eb1ng th\u1eddi gian ho\u00e0n th\u00e0nh l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean, v\u00e0 trong l\u00fd thuy\u1ebft x\u00e1c su\u1ea5t, nh\u1eefng bi\u1ebfn ng\u1eabu nhi\u00ean nh\u01b0 th\u1ebf \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"th\u1eddi gian d\u1eebng\" (r\u00f5 r\u00e0ng r\u1ed3i). Ho\u00e1 ra c\u00e1c b\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng th\u1ee9 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 martingales, hay n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 nh\u1eefng quy tr\u00ecnh ng\u1eabu nhi\u00ean v\u1edbi c\u00e1c h\u1eb1ng s\u1ed1 \u0111\u1eb9p \u0111\u1ebd c\u00f9ng m\u1ed9t \u0111\u1ed1ng c\u00e1c t\u00ednh ch\u1ea5t.</p> <p>T\u00f4i ngh\u0129 nhi\u1ec1u ng\u01b0\u1eddi kh\u00f4ng hi\u1ec3u nh\u1eefng th\u1ee9 \u0111\u00f3 c\u00f9ng v\u1edbi vi\u1ec7c v\u00ec sao ch\u00fang l\u1ea1i h\u1eefu d\u1ee5ng. N\u00ean t\u00f4i hi v\u1ecdng b\u00e0i vi\u1ebft s\u1ebd gi\u00fap c\u00e1c b\u1ea1n hi\u1ec3u s\u00e2u h\u01a1n. L\u01b0u \u00fd r\u1eb1ng v\u1edbi tinh th\u1ea7n r\u00f5 r\u00e0ng, t\u00f4i s\u1ebd ch\u1ec9 x\u1eed l\u00fd c\u00e1c t\u1eadp h\u1eefu h\u1ea1n v\u00e0 c\u00e1c quy tr\u00ecnh th\u1eddi gian h\u1eefu h\u1ea1n (tr\u1eeb khi th\u1ef1c s\u1ef1 c\u1ea7n thi\u1ebft, v\u00e0 trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, vi\u1ec7c gi\u1ea3i th\u00edch c\u1ea7n ph\u1ea3i r\u00f5 r\u00e0ng). T\u00f4i l\u00e0m \u0111i\u1ec1u n\u00e0y v\u00ec m\u1ecdi ng\u01b0\u1eddi th\u01b0\u1eddng l\u1ea1c l\u1ed1i trong c\u00e1c kh\u00eda c\u1ea1nh l\u00fd thuy\u1ebft \u0111o l\u01b0\u1eddng c\u1ee7a s\u1ef1 ch\u1eb7t ch\u1ebd c\u1ea7n thi\u1ebft v\u00e0 b\u1ecf qua c\u00e1c \u0111i\u1ec3m m\u1ea5u ch\u1ed1t m\u00e0 h\u1ecd c\u1ea7n ph\u1ea3i hi\u1ec3u. Ngo\u00e0i ra, l\u01b0u \u00fd r\u1eb1ng d\u00f4i khi ph\u1ea7n gi\u1ea3i th\u00edch s\u1ebd c\u00f3 nhi\u1ec1u ph\u1ea7n h\u01a1n m\u1ee9c c\u1ea7n thi\u1ebft, nh\u01b0ng l\u00e0 \u0111\u1ec3 gi\u00fap c\u00e1c b\u1ea1n hi\u1ec3u s\u00e2u h\u01a1n l\u00e0 tr\u00ecnh b\u00e0y ng\u1eafn g\u1ecdn nh\u01b0ng kh\u00f3 hi\u1ec3u.</p> <p>Nh\u1eefng ng\u01b0\u1eddi \u0111\u00e3 quen v\u1edbi c\u00e1c kh\u00e1i ni\u1ec7m ban \u0111\u1ea7u c\u00f3 th\u1ec3 b\u1ecf qua c\u00e1c ph\u1ea7n n\u00e0y v\u00e0 \u0111i t\u1edbi nh\u1eefng ph\u1ea7n th\u00fa v\u1ecb h\u01a1n, nh\u01b0ng t\u00f4i v\u1eabn s\u1ebd khuy\u00ean c\u00e1c b\u1ea1n \u0111\u1ecdc to\u00e0n b\u1ed9 ph\u1ea7n gi\u1ea3i th\u00edch trong tr\u01b0\u1eddng h\u1ee3p b\u1ea1n khu\u1ea5t m\u1eafc ch\u1ed7 n\u00e0o \u0111\u00f3. Kh\u1ea3i ni\u1ec7m t\u1eadp h\u1ee3p \"t\u1ed1i thi\u1ec3u\" \u0111\u01b0\u1ee3c d\u00f9ng r\u1ea5t nhi\u1ec1u \u1edf \u0111\u00e2y v\u1ec1 m\u1eb7t t\u00e2m l\u00fd, v\u00ec v\u1eady c\u00f3 th\u1ec3 b\u1ea1n v\u1eabn mu\u1ed1n \u0111\u1ecdc c\u00e1c ph\u1ea7n c\u00f3 li\u00ean quan \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u trong blog n\u00e0y.</p> <p>BONUS: \u0110\u00e2y l\u00e0 m\u1ed9t b\u00e0i b\u00e1o khoa h\u1ecdc n\u00f3i v\u1ec1 vi\u1ec7c d\u00f9ng martingales \u0111\u1ec3 gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n.</p>"},{"location":"Codeforces/math/martingales/#xac-suat-ai-so-sigma-va-bien-ngau-nhien","title":"X\u00e1c su\u1ea5t, \u0111\u1ea1i s\u1ed1 sigma v\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean","text":"<p>\u0110\u1ea7u ti\u00ean ta c\u00f9ng xem l\u1ea1i c\u00e1c \u0111\u1ecbnh ngh\u0129a \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u01a1n gi\u1ea3n ho\u00e1 c\u1ee7a kh\u00f4ng gian x\u00e1c su\u1ea5t. Ta n\u00f3i \"\u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u01a1n gi\u1ea3n ho\u00e1\" v\u00ec c\u00f3 v\u00e0i k\u1ef9 thu\u1eadt c\u1ea7n \u0111\u01b0\u1ee3c d\u00f9ng cho t\u1eadp v\u00f4 h\u1ea1n, nh\u01b0ng ta s\u1ebd kh\u00f4ng x\u00e9t t\u1eadp v\u00f4 h\u1ea1n \u1edf \u0111\u00e2y.</p> <p>M\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t l\u00e0 b\u1ed9 ba \\((\\Omega, \\mathcal{F}, P)\\) bao g\u1ed3m</p> <ol> <li>\\(\\Omega\\) m\u1ed9t t\u1eadp n\u1ec1n kh\u00f4ng r\u1ed7ng, hay c\u00f2n g\u1ecdi l\u00e0 kh\u00f4ng gian m\u1eabu. N\u00f3 c\u00f2n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xem l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c k\u1ebft qu\u1ea3 c\u00f3 th\u1ec3 x\u1ea3y ra c\u1ee7a m\u1ed9t ph\u00e9p th\u1eed.</li> <li>\\(\\mathcal{F}\\): sigma-\u0111\u1ea1i s\u1ed1. \u0110\u00e2y l\u00e0 t\u1eadp h\u1ee3p bao g\u1ed3m c\u00e1c t\u1eadp con c\u1ee7a \\(\\Omega\\). L\u01b0u \u00fd r\u1eb1ng \u0111\u00e2y kh\u00f4ng ph\u1ea3i l\u00e0 t\u1eadp bao g\u1ed3m t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con c\u1ee7a \\(\\Omega\\) (t\u1eadp lu\u1ef9 th\u1eeba c\u1ee7a \\(\\Omega\\)). C\u00f3 th\u1ec3 xem c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a t\u1eadp n\u00e0y (c\u00e1c t\u1eadp con \u0111\u01b0\u1ee3c ch\u1ecdn) l\u00e0 c\u00e1c \"bi\u1ebfn c\u1ed1\". V\u00ed d\u1ee5, khi tung m\u1ed9t c\u1ee5c x\u00fac x\u1eafc, m\u1ed9t bi\u1ebfn c\u1ed1 c\u00f3 th\u1ec3 x\u1ea3y ra l\u00e0 \"tung ra s\u1ed1 ch\u1eb5n\". V\u1edbi ph\u00e9p th\u1eed n\u00e0y, ta c\u00f3 \\(\\Omega = \\{1, 2, 3, 4, 5, 6\\}\\), v\u00e0 bi\u1ebfn c\u1ed1 n\u00e0y l\u00e0 \\(\\{2, 4, 6\\}\\).</li> <li>\\(P\\): h\u00e0m x\u00e1c su\u1ea5t, h\u00e0m \u00e1nh x\u1ea1 t\u1eeb \\(\\mathcal{F}\\) sang \u0111o\u1ea1n \\([0, 1]\\). \u0110\u00e2y th\u1ef1c ra ch\u1ec9 l\u00e0 tr\u1ecdng s\u1ed1 ta g\u00e1n v\u00e0o m\u1ecdi bi\u1ebfn c\u1ed1 m\u00e0 ta ch\u1ecdn.</li> </ol> <p>\u0110\u1ec3 h\u00e0m n\u00e0y c\u00f3 c\u00e1c t\u00ednh ch\u1ea5t hay ho v\u00e0 \u0111\u1ec3 n\u00f3 t\u00ednh x\u00e1c su\u1ea5t m\u1ed9t c\u00e1ch \"c\u00f3 l\u00fd\" h\u01a1n, ta th\u00eam v\u00e0o c\u00e1c \u0111i\u1ec1u ki\u1ec7n sau:</p> <ol> <li>\\(\\Omega\\) l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1 (hay n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 \\(\\Omega \\in \\mathcal{F}\\)).</li> <li>N\u1ebfu \\(A \\in \\mathcal{F}\\), th\u00ec \\(\\Omega \\setminus A \\in \\mathcal{F}\\), ngh\u0129a l\u00e0 n\u1ebfu c\u00e1i g\u00ec \u0111\u00f3 x\u1ea3y ra l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1, th\u00ec n\u00f3 kh\u00f4ng x\u1ea3y ra c\u0169ng l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1.</li> <li>N\u1ebfu \\(A \\in \\mathcal{F}\\) v\u00e0 \\(B \\in \\mathcal{F}\\), th\u00ec \\(A \\cup B \\in \\mathcal{F}\\). Ngh\u0129a l\u00e0, n\u1ebfu \\(X\\) x\u1ea3y ra l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1, \\(Y\\) x\u1ea3y ra c\u0169ng l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1, th\u00ec \u00edt nh\u1ea5t m\u1ed9t trong \\(X\\) v\u00e0 \\(Y\\) x\u1ea3y ra c\u0169ng l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1. L\u01b0u \u00fd r\u1eb1ng \u0111i\u1ec1u n\u00e0y k\u1ebft h\u1ee3p v\u1edbi \u0111i\u1ec1u ki\u1ec7n 2 \u0111\u00f3 cho ph\u00e9p ta n\u00f3i r\u1eb1ng \\(A \\cap B\\) c\u0169ng l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1 v\u00e0 c\u00e1c t\u00ednh ch\u1ea5t t\u01b0\u01a1ng t\u1ef1, theo lu\u1eadt De Morgan.</li> <li>\\(P(\\Omega) = 1\\), ngh\u0129a l\u00e0 x\u00e1c su\u1ea5t c\u1ee7a to\u00e0n b\u1ed9 kh\u00f4ng gian m\u1eabu l\u00e0 \\(1\\).</li> <li>V\u1edbi c\u00e1c t\u1eadp r\u1eddi r\u1ea1c \\(A\\) v\u00e0 \\(B\\), \\(P(A \\cup B) = P(A) + P(B)\\). \u0110i\u1ec1u ki\u1ec7n n\u00e0y, k\u1ebft h\u1ee3p v\u1edbi \u0111i\u1ec1u ki\u1ec7n 4, l\u00e0 \u0111\u1ee7 \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 \u0111i\u1ec1u ki\u1ec7n \u0111\u01b0\u1ee3c suy ra nh\u01b0 \\(P(\\emptyset) = 0\\) hay \\(P(A) + P(\\Omega \\setminus A) = 1\\).</li> </ol> <p>Gi\u1edd ta h\u00e3y x\u00e2y d\u1ef1ng m\u1ed9t s\u1ed1 hi\u1ec3u bi\u1ebft v\u1ec1 kh\u00f4ng gian x\u00e1c su\u1ea5t. L\u01b0u \u00fd r\u1eb1ng, c\u00e1c \u0111o\u1ea1n sau \u0111\u00e2y, \u0111\u1eb7c bi\u1ec7t l\u00e0 ph\u1ea7n n\u00f3i v\u1ec1 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u, ch\u1ec9 \u00e1p d\u1ee5ng cho c\u00e1c t\u1eadp h\u1eefu h\u1ea1n, nh\u01b0ng c\u00f3 r\u1ea5t nhi\u1ec1u \u0111i\u1ec3m t\u01b0\u01a1ng \u0111\u1ed3ng trong c\u00e1c k\u1ebft lu\u1eadn khi ta kh\u00e1i qu\u00e1t ho\u00e1 sang c\u00e1c t\u1eadp kh\u00e1c v\u1edbi c\u00e1c kh\u00e1i ni\u1ec7m l\u00fd thuy\u1ebft t\u00ednh to\u00e1n.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng v\u00ec \\(\\mathcal{F}\\) \u0111\u00f3ng k\u00edn v\u1edbi ph\u00e9p giao (t\u1ee9c l\u00e0 n\u1ebfu \\(E_i \\in \\mathcal{F}\\) th\u00ec giao c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9 \\(E_i\\) c\u0169ng ph\u1ea3i thu\u1ed9c \\(\\mathcal{F}\\), theo \u0111i\u1ec1u ki\u1ec7n 3), n\u1ebfu ta th\u1ef1c hi\u1ec7n qu\u00e1 tr\u00ecnh sau nhi\u1ec1u l\u1ea7n: l\u1ea5y hai t\u1eadp v\u00e0 thay th\u1ebf ch\u00fang b\u1eb1ng giao c\u1ee7a hai t\u1eadp \u0111\u00f3, \u0111\u1ebfn cu\u1ed1i c\u00f9ng ta s\u1ebd ch\u1ec9 c\u00f2n c\u00e1c t\u1eadp \"t\u1ed1i thi\u1ec3u\" kh\u00f4ng r\u1ed7ng m\u00e0 ta kh\u00f4ng th\u1ec3 n\u00e0o c\u1ef1c ti\u1ec3u th\u00eam (\u0111i\u1ec1u n\u00e0y th\u1ef1c s\u1ef1 kh\u00f4ng chu\u1ea9n l\u1eafm nh\u01b0ng ta s\u1ebd d\u00f9ng r\u1ea5t nhi\u1ec1u trong c\u00e1c ph\u1ea7n sau). X\u00e9t t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u nh\u01b0 th\u1ebf. R\u00f5 r\u00e0ng, c\u00e1c t\u1eadp n\u00e0y t\u1ea1o th\u00e0nh c\u00e1c ph\u00e2n ho\u1ea1ch c\u1ee7a \\(\\Omega\\) v\u00ec ch\u00fang r\u1eddi r\u1ea1c (n\u1ebfu kh\u00f4ng s\u1ebd m\u00e2u thu\u1eabn v\u1edbi t\u00ednh t\u1ed1i gi\u1ea3n) v\u00e0 v\u00ec m\u1ecdi ph\u1ea7n t\u1eed \u0111\u1ec1u n\u1eb1m trong m\u1ed9t t\u1eadp t\u1ed1i gi\u1ea3n (v\u1edbi th\u1ef1c t\u1ebf l\u00e0 \\(\\mathcal{F}\\) \u0111\u00f3ng k\u00edn v\u1edbi ph\u00e9p b\u00f9, theo \u0111i\u1ec1u ki\u1ec7n 1, v\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t t\u1eadp t\u1ed1i thi\u1ec3u n\u1ebfu c\u1ea7n, ho\u1eb7c ch\u1ec9 b\u1eb1ng c\u00e1ch giao t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed \u0111\u00f3 - c\u00f3 \u00edt nh\u1ea5t m\u1ed9t t\u1eadp nh\u01b0 v\u1eady, \u0111\u00f3 l\u00e0 \\(\\Omega\\)). Gi\u1edd \\(\\mathcal{F}\\) \u0111\u00f3ng k\u00edn v\u1edbi ph\u00e9p h\u1ee3p (theo \u0111i\u1ec1u ki\u1ec7n 3), n\u00ean n\u00f3 c\u0169ng b\u1eb1ng t\u1eadp c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c h\u1ee3p c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a c\u00e1c t\u1eadp con t\u1ed1i thi\u1ec3u n\u00e0y. N\u00f3i c\u00e1ch kh\u00e1c, ta c\u00f3 m\u1ed9t ph\u00e2n ho\u1ea1ch c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(\\Omega\\) th\u00e0nh m\u1ed9t s\u1ed1 t\u1eadp h\u1ee3p, v\u00e0 \\(\\mathcal{F}\\) l\u00e0 t\u1eadp h\u1ee3p \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh b\u1edfi t\u1ea5t c\u1ea3 c\u00e1c h\u1ee3p c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a c\u00e1c t\u1eadp h\u1ee3p trong ph\u00e2n ho\u1ea1ch \u0111\u00f3. B\u00e2y gi\u1edd ta c\u00f3 th\u1ec3 ngh\u0129 v\u1ec1 c\u00e1c \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 d\u01b0\u1edbi d\u1ea1ng ph\u00e2n ho\u1ea1ch! Ngo\u00e0i ra, l\u01b0u \u00fd r\u1eb1ng x\u00e1c su\u1ea5t c\u1ee7a m\u1ed7i bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\sigma\\)-sigma s\u1ebd c\u1ed9ng l\u1ea1i khi l\u1ea5y c\u00e1c h\u1ee3p.</p> <p>Trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p, ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t kh\u00f4ng gian m\u1eabu t\u01b0\u01a1ng \u0111\u01b0\u01a1ng \\((\\Omega', \\mathcal{F}', P')\\) v\u1edbi \\(\\Omega'\\) l\u00e0 t\u1eadp c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\mathcal{F}\\), \\(\\mathcal{F}'\\) l\u00e0 t\u1eadp lu\u1ef9 th\u1eeba c\u1ee7a \\(\\Omega'\\) v\u00e0 \\(P'\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a t\u1ef1 nhi\u00ean t\u1eeb \\(P\\). \u0110\u1ecbnh ngh\u0129a n\u00e0y kh\u00f4ng ti\u00eau chu\u1ea9n l\u1eafm nh\u01b0ng s\u1ebd c\u00f3 \u00edch v\u1ec1 sau. L\u01b0u \u00fd r\u1eb1ng n\u1ebfu \\(\\mathcal{F}\\) l\u00e0 t\u1eadp lu\u1ef9 th\u1eeba c\u1ee7a \\(\\Omega\\), th\u00ec kh\u00f4ng gian m\u1eabu t\u01b0\u01a1ng \u0111\u01b0\u01a1ng s\u1ebd gi\u1ed1ng nh\u01b0 kh\u00f4ng gian m\u1eabu ban \u0111\u1ea7u. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, t\u1ea5t c\u1ea3 c\u00e1c \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 kh\u00e1c s\u1ebd th\u00f4 h\u01a1n t\u1eadp lu\u1ef9 th\u1eeba, v\u1edbi c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u c\u1ee7a ch\u00fang \u0111\u1ec1u l\u00e0 c\u00e1c ph\u1ea7n t\u1eed \u0111\u01a1n l\u1ebb.</p> <p>\u0110\u1ebfn b\u01b0\u1edbc n\u00e0y, ta nh\u1eadn ra r\u1eb1ng \\(\\mathcal{F}\\) ch\u1ec9 ra ta c\u00f3 bao nhi\u00eau \"th\u00f4ng tin\" v\u1ec1 \\(\\Omega\\) (ta kh\u00f4ng th\u1ec3 ph\u00e2n bi\u1ec7t hai ph\u1ea7n t\u1eed trong c\u00f9ng m\u1ed9t t\u1eadp t\u1ed1i thi\u1ec3u). \u00dd t\u01b0\u1edfng n\u00e0y c\u00f9ng v\u1edbi ki\u1ebfn th\u1ee9c ph\u00e2n ho\u1ea1ch \u1edf tr\u00ean l\u00e0 m\u1ed9t c\u00e1ch t\u1ed1t \u0111\u1ec3 t\u00ecm ra c\u00e1ch thu th\u1eadp th\u00f4ng tin theo th\u1eddi gian trong c\u00e1c ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean. Ta s\u1ebd \u0111\u1ebfn b\u01b0\u1edbc \u0111\u00f3 sau.</p> <p>Gi\u1edd ta \u0111\u1ebfn \u0111\u1ecbnh ngh\u0129a ch\u00ednh th\u1ee9c c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean.</p> <p>M\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u1ed1i v\u1edbi m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t \\((\\Omega, \\mathcal{F}, P)\\) l\u00e0 h\u00e0m \\(X\\) \u00e1nh x\u1ea1 t\u1eeb \\(\\Omega\\) sang \\(\\mathbb{R}\\) m\u00e0 \\(X^{-1}((-\\infty, x]) \\in \\mathcal{F}\\) v\u1edbi m\u1ecdi \\(x \\in \\mathbb{R}\\). Ngh\u0129a l\u00e0, t\u1eadp ti\u1ec1n \u0111\u1ec1 c\u1ee7a c\u00e1c s\u1ed1 th\u1ef1c \\(\\le x\\) thu\u1ed9c \\(\\mathcal{F}\\).</p> <p>L\u01b0u \u00fd r\u1eb1ng do ta \u0111ang x\u00e9t c\u00e1c t\u1eadp h\u1eefu h\u1ea1n, ta s\u1ebd d\u00f9ng m\u1ed9t \u0111\u1ecbnh ngh\u0129a kh\u00e1c (nh\u01b0ng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi t\u1eadp h\u1eefu h\u1ea1n), \u0111\u1ecbnh ngh\u0129a n\u00e0y cho ph\u00e9p ta thay \u0111o\u1ea1n b\u1eb1ng \\((-\\infty, x]\\) \\(\\{x\\}\\).</p> <p>Vi\u1ebft nh\u01b0 th\u1ebf n\u00e0y c\u00f3 th\u1ec3 tr\u00f4ng h\u01a1i \u0111\u00e1ng s\u1ee3 nh\u01b0ng \u00fd t\u01b0\u1edfng th\u00ec l\u1ea1i kh\u00e1 \u0111\u01a1n gi\u1ea3n. Ta c\u00f3 m\u1ed9t kh\u00f4ng gian m\u1eabu \\(\\Omega\\), v\u00e0 c\u00f3 m\u1ed9t t\u1eadp \\(\\mathbb{R}\\). Gi\u1edd ta mu\u1ed1n \u00e1nh x\u1ea1 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(\\Omega\\) sang \\(\\mathbb{R}\\) b\u1eb1ng c\u00e1ch n\u00e0o \u0111\u00f3 sao cho ta c\u00f3 th\u1ec3 t\u00ednh to\u00e1n tr\u00ean c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(\\Omega\\). Tuy nhi\u00ean, trong m\u1ed9t kh\u00f4ng gian m\u1eabu, \\(\\mathcal{F}\\) cho ta bi\u1ebft ta c\u00f3 bao nhi\u00eau th\u00f4ng tin (ho\u1eb7c cho ta th\u1ea5y bao nhi\u00eau th\u00f4ng tin), ta kh\u00f4ng th\u1ec3 ph\u00e2n bi\u1ec7t \u0111\u01b0\u1ee3c c\u00e1c ph\u1ea7n t\u1eed trong \\(\\Omega\\) n\u1eb1m trong c\u00f9ng m\u1ed9t bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\mathcal{F}\\). Do c\u00f3 h\u1eefu h\u1ea1n c\u00e1c ph\u1ea7n t\u1eed trong \\(\\Omega\\), v\u00e0 c\u00e1c ph\u1ea7n t\u1eed n\u1eb1m trong c\u00f9ng m\u1ed9t bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ebfu n\u00ean \u0111\u01b0\u1ee3c \u00e1nh x\u1ea1 sang c\u00f9ng m\u1ed9t s\u1ed1 th\u1ef1c, s\u1ebd ch\u1ec9 c\u00f3 h\u1eefu h\u1ea1n c\u00e1c \u0111o\u1ea1n m\u00e0 \\(X\\) ph\u00e2n ho\u1ea1ch \\(\\mathbb{R}\\) ra, v\u00e0 \u0111\u00f3 c\u0169ng l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u0111i\u1ec1u ki\u1ec7n c\u1ea7n v\u00e0 \u0111\u1ee7 c\u1ee7a \u0111\u1ecbnh ngh\u0129a (do t\u00ednh \u0111\u00f3ng c\u1ee7a \\(\\mathcal{F}\\) v\u1edbi ph\u00e9p giao v\u00e0 h\u1ee3p).</p> <p>Th\u00eam m\u1ed9t l\u01b0u \u00fd n\u1eefa l\u00e0 ta c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a c\u00e1c h\u00e0m c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \u1edf b\u01b0\u1edbc n\u00e0y b\u1eb1ng c\u00e1ch k\u1ebft h\u1ee3p h\u00e0m \\(X\\) v\u1edbi m\u1ed9t h\u00e0m \u00e1nh x\u1ea1 t\u1eeb \\(\\mathbb{R}\\) sang \\(\\mathbb{R}\\). T\u01b0\u01a1ng t\u1ef1, n\u1ebfu ta c\u00f3 hai bi\u1ebfn ng\u1eabu nhi\u00ean tr\u00ean c\u00f9ng m\u1ed9t kh\u00f4ng gian m\u1eabu, ta c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a c\u00e1c h\u00e0m c\u1ee7a ch\u00fang m\u1ed9t c\u00e1ch kh\u00e1 t\u1ef1 nhi\u00ean. Sau c\u00f9ng, ta ch\u1ec9 c\u1ea7n ch\u1ec9 \u0111\u1ecbnh c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a ch\u00fang tr\u00ean c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u l\u00e0 xong.</p>"},{"location":"Codeforces/math/martingales/#gia-tri-ki-vong-cua-mot-bien-ngau-nhien-va-xac-suat-co-ieu-kien","title":"Gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean v\u00e0 x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n","text":"<p>Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t kh\u00f4ng gian m\u1eabu \\((\\Omega, \\mathcal{F}, P)\\) v\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) tr\u00ean kh\u00f4ng gian m\u1eabu n\u00e0y. L\u00e0m sao \u0111\u1ec3 ta t\u00ecm \u0111\u01b0\u1ee3c m\u1ed9t s\u1ed1 lo\u1ea1i gi\u00e1 tr\u1ecb trung b\u00ecnh c\u1ee7a \\(X\\) tr\u00ean to\u00e0n b\u1ed9 kh\u00f4ng gian x\u00e1c su\u1ea5t? M\u1ed9t \u0111\u00e1p \u00e1n c\u00f3 th\u1ec3 l\u00e0: v\u1edbi m\u1ed7i s\u1ef1 ki\u1ec7n t\u1ed1i thi\u1ec3u, ta x\u00e9t gi\u00e1 tr\u1ecb chung c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u1ec1u t\u1ea1i m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a bi\u1ebfn c\u1ed1 \u0111\u00f3, v\u00e0 th\u00eam n\u00f3 v\u00e0o m\u1ed9t t\u1ed5ng tr\u1ecdng s\u1ed1 v\u1edbi tr\u1ecdng s\u1ed1 b\u1eb1ng v\u1edbi x\u00e1c su\u1ea5t c\u1ee7a bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u \u0111\u00f3. L\u01b0u \u00fd r\u1eb1ng m\u1ed9t s\u1ed1 bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u t\u1ea1o m\u1ed9t ph\u00e2n ho\u1ea1ch n\u00ean t\u1ed5ng c\u00e1c tr\u1ecdng s\u1ed1 n\u00e0y l\u00e0 \\(1\\). Trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p, \u0111\u00e2y l\u00e0 gi\u00e1 tr\u1ecb trung b\u00ecnh c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u, \u0111\u01b0\u1ee3c t\u00ednh tr\u1ecdng s\u1ed1 theo \u0111\u1ed9 quan tr\u1ecdng c\u1ee7a ch\u00fang.</p> <p>Nh\u01b0ng m\u00e0 l\u00e0m sao ta c\u00f3 th\u1ec3 vi\u1ebft ch\u00fang theo ki\u1ec3u to\u00e1n h\u1ecdc m\u00e0 kh\u00f4ng li\u00ean quan g\u00ec \u0111\u1ebfn bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u? C\u00f9ng xem l\u1ea1i \u0111i\u1ec1u ki\u1ec7n trong \u0111\u1ecbnh ngh\u0129a bi\u1ebfn ng\u1eabu nhi\u00ean. Thay v\u00ec t\u1ed5ng c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u, ta c\u00f3 th\u1ec3 l\u1ea5y t\u1ed5ng c\u00e1c gi\u00e1 tr\u1ecb \\(x\\) kh\u00e1c nhau c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean, v\u00e0 \u0111\u00e1nh tr\u1ecdng s\u1ed1 ch\u00fang b\u1eb1ng x\u00e1c su\u1ea5t \u0111\u1ec3 bi\u1ebfn \u0111\u00f3 b\u1eb1ng \\(x\\). X\u00e1c su\u1ea5t n\u00e0y \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 do \u0111i\u1ec1u ki\u1ec7n trong \u0111\u1ecbnh ngh\u0129a c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean (v\u00ec bi\u1ebfn c\u1ed1 c\u00f3 bi\u1ebfn ng\u1eabu nhi\u00ean b\u1eb1ng \\(x\\) l\u00e0 h\u1ee3p r\u1eddi r\u1ea1c c\u1ee7a c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u v\u00e0 x\u00e1c su\u1ea5t c\u1ee7a ch\u00fang c\u1ed9ng l\u1ea1i). \u0110\u1ecbnh ngh\u0129a n\u00e0y c\u0169ng ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c hi\u1ec3u bi\u1ebft tr\u01b0\u1edbc \u0111\u00f3 c\u1ee7a ch\u00fang ta.</p> <p>V\u00ec th\u1ebf n\u00ean ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) l\u00e0 \\(E[X] := \\sum_{x \\in \\text{range}(X)} x \\cdot P(X = x)\\).</p> <p>L\u01b0u \u00fd r\u1eb1ng v\u1edbi \u0111\u1ecbnh ngh\u0129a tr\u01b0\u1edbc \u0111\u00f3 li\u00ean quan \u0111\u1ebfn bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u, ta c\u0169ng d\u1ec5 d\u00e0ng suy ra \u0111\u01b0\u1ee3c v\u1edbi b\u1ea5t k\u1ef3 bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\), \\(Y\\) n\u00e0o tr\u00ean c\u0169ng m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t, ta c\u00f3 \\(E[X + Y] = E[X] + E[Y]\\).</p> <p>Gi\u1edd h\u00e3y xem l\u00e0m sao ta c\u00f3 th\u1ec3 c\u00f4 l\u1eadp m\u1ed9t bi\u1ebfn c\u1ed1. Gi\u1ea3 s\u1eed ta c\u00f3 bi\u1ebfn c\u1ed1 \\(E\\). Ta mu\u1ed1n b\u1ecf qua t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 kh\u00e1c v\u00e0 ch\u1ec9 t\u1eadp trung v\u00e0o c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(\\Omega\\) (bao g\u1ed3m c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\mathcal{F}\\) t\u1ea1o th\u00e0nh m\u1ed9t ph\u00e2n ho\u1ea1ch c\u1ee7a \\(E\\)). Ta c\u00f3 th\u1ec3 t\u1ea1o ra m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t cho n\u00f3 hay kh\u00f4ng? M\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n l\u00e0 k\u1ebf th\u1eeba c\u1ea5u tr\u00fac c\u1ee7a \\(\\Omega\\) v\u00e0 \\(\\mathcal{F}\\) v\u00e0 t\u1eadp c\u00e1c x\u00e1c su\u00e2t c\u1ee7a m\u1ecdi th\u1ee9 d\u00f9ng c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng ph\u1ea3i t\u1ed1i thi\u1ec3u c\u1ea5u th\u00e0nh \\(E\\) l\u00e0 \\(0\\), nh\u01b0ng ta l\u1ea1i g\u1eb7p m\u1ed9t r\u1eafc r\u1ed1i n\u1ebfu ta ch\u1ec9 k\u1ebf th\u1eeba h\u00e0m x\u00e1c su\u1ea5t. T\u1ed5ng x\u00e1c su\u1ea5t c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u kh\u00f4ng b\u1eb1ng \\(1\\). M\u1ed9t c\u00e1ch gi\u1ea3i quy\u1ebft l\u00e0 chu\u1ea9n ho\u00e1 n\u00f3 b\u1eb1ng \\(P(E)\\), \u0111i\u1ec1u n\u00e0y kh\u1ea3 thi khi v\u00e0 ch\u1ec9 khi n\u00f3 kh\u00e1c \\(0\\). C\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng ki\u1ec3m tra kh\u00f4ng gian x\u00e1c su\u1ea5t n\u00e0y th\u1ef1c s\u1ef1 l\u00e0 m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t h\u1ee3p l\u1ec7.</p> <p>\u0110\u00e2y l\u00e0 c\u00e1ch ta \u0111\u1ecbnh ngh\u0129a kh\u00f4ng gian x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi m\u1ed9t bi\u1ebfn c\u1ed1 \\(E\\) v\u1edbi \\(P(E) &gt; 0\\). Kh\u00f4ng gian m\u1eabu v\u00e0 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 gi\u1eef nguy\u00ean nh\u01b0ng h\u00e0m x\u00e1c su\u1ea5t tr\u1edf th\u00e0nh \\(P(A | E) := P'(A) = P(A \\cap E) / P(E)\\). Kh\u00f4ng gian x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n n\u00e0y l\u00e0 ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c l\u1eadp lu\u1eadn tr\u01b0\u1edbc \u0111\u00f3 b\u1eb1ng c\u00e1ch xem x\u00e9t c\u00e1c ph\u1ea7n t\u1eed t\u1ed1i thi\u1ec3u.</p> <p>M\u1ed9t c\u00e1ch nh\u00ecn r\u00f5 r\u00e0ng h\u01a1n l\u00e0 ch\u00fang ta ch\u1ec9 th\u1ef1c s\u1ef1 quan t\u00e2m \u0111\u1ebfn m\u1ed9t s\u1ed1 t\u1eadp con c\u1ee7a \\(\\Omega\\) v\u00e0 \\(\\mathcal{F}\\) t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c ph\u1ea7n t\u1eed trong \\(E\\), v\u00e0 ch\u00fang ta \u0111\u1ecbnh ngh\u0129a m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t v\u1edbi \\(E\\) l\u00e0 t\u1eadp c\u01a1 s\u1edf. Nh\u01b0ng \u0111\u1ec3 d\u00e1m ch\u1eafc r\u1eb1ng ta c\u00f3 th\u1ec3 t\u01b0\u01a1ng t\u00e1c v\u1edbi c\u00e1c bi\u1ebfn c\u1ed1 kh\u00e1c trong \\(\\mathcal{F}\\), ta l\u1ea5y bi\u1ebfn c\u1ed1 \u0111\u00f3, c\u1eaft b\u1edbt c\u00e1c ph\u1ea7n kh\u00f4ng c\u00f3 trong \\(E\\), sau \u0111\u00f3 s\u1eed d\u1ee5ng x\u00e1c su\u1ea5t (ho\u1eb7c tr\u1ecdng s\u1ed1 t\u01b0\u01a1ng \u0111\u1ed1) c\u1ee7a t\u1eadp h\u1ee3p \u0111\u00f3 \u0111\u1ed1i v\u1edbi x\u00e1c su\u1ea5t (ho\u1eb7c tr\u1ecdng s\u1ed1) c\u1ee7a \\(E\\).</p> <p>M\u1ed9t h\u1ec7 qu\u1ea3 t\u1ea5t y\u1ebfu c\u1ee7a \u0111i\u1ec1u n\u00e0y l\u00e0: \\(\\sum_{E_i} P(A | E_i) P(E_i) = P(A)\\) v\u1edbi m\u1ed9t ph\u00e2n ho\u1ea1ch c\u1ee7a \\(\\Omega\\) trong bi\u1ebfn c\u1ed1 \\(E_i\\). Ta c\u00f3 th\u1ec3 th\u1ea5y \u0111i\u1ec1u n\u00e0y \u0111\u00fang khi ch\u1ec9 x\u00e9t c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u trong \\(A\\). Trong th\u1ef1c t\u1ebf, \u0111i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 gi\u1ea3i r\u1ea5t nhi\u1ec1u li\u00ean h\u1ec7 l\u1eb7p l\u1ea1i, nh\u01b0 trong \u0111\u1ecbnh l\u00fd Bayes.</p> <p>N\u00f3 c\u0169ng c\u00f3 bi\u1ebfn th\u1ec3 li\u00ean quan \u0111\u1ebfn gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng, v\u00e0 n\u1ebfu ta h\u1ea1n ch\u1ebf m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean trong t\u1eebng kh\u00f4ng gian x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n, b\u1eb1ng c\u00e1ch t\u1ed5ng h\u1ee3p c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u, ta s\u1ebd th\u1ea5y r\u1eb1ng n\u1ebfu \\(E[X | E_i]\\) l\u00e0 gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a \\(X\\) \u0111\u1ed1i v\u1edbi kh\u00f4ng gian x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi \\(E_i\\), th\u00ec \\(\\sum_{E_i} E[X | E_i] P(E_i) = E[X]\\). Bi\u1ebfn th\u1ec3 n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c d\u00f9ng trong li\u00ean h\u1ec7 l\u1eb7p l\u1ea1i, nh\u01b0 vi\u1ec7c t\u00ecm th\u1eddi gian k\u00ec v\u1ecdng tr\u01b0\u1edbc khi ta tung ra \u0111\u01b0\u1ee3c hai m\u1eb7t tr\u00ean \u0111\u1ed3ng xu li\u00ean ti\u1ebfp (m\u1eb7c d\u00f9ng kh\u00f4ng gian m\u1eabu n\u00e0y v\u00f4 h\u1ea1n, c\u00e1c t\u00ednh ch\u1ea5t v\u1eabn \u0111\u01b0\u1ee3c gi\u1eef nguy\u00ean).</p>"},{"location":"Codeforces/math/martingales/#ki-vong-co-ieu-kien-cua-mot-bien-ngau-nhien-oi-voi-ai-so-sigma","title":"K\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u1ed1i v\u1edbi \u0111\u1ea1i s\u1ed1 sigma","text":"<p>\u1ede tr\u00ean ta \u0111\u00e3 \u0111\u1ecbnh ngh\u0129a kh\u00f4ng gian x\u00e1c su\u1ea5t t\u01b0\u01a1ng \u0111\u01b0\u01a1ng. N\u00f3 \u1ee9ng v\u1edbi vi\u1ec7c thu g\u1ecdn c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (\u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi ph\u00e2n ho\u1ea1ch) th\u00e0nh m\u1ed9t ph\u1ea7n t\u1eed duy nh\u1ea5t, \u0111\u1ec3 t\u1ea1o ra m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t tr\u00ean \u0111\u00f3 l\u00e0m kh\u00f4ng gian m\u1eabu. \u0110i\u1ec1u g\u00ec s\u1ebd x\u1ea3y ra n\u1ebfu ch\u00fang ta l\u00e0m v\u1eady l\u1ea7n n\u1eefa, sau khi x\u00e1c \u0111\u1ecbnh m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t th\u01b0a / th\u00f4 h\u01a1n tr\u00ean kh\u00f4ng gian x\u00e1c su\u1ea5t thu \u0111\u01b0\u1ee3c?</p> <p>T\u1ea5t nhi\u00ean, \u0111i\u1ec1u n\u00e0y s\u1ebd d\u1eabn \u0111\u1ebfn m\u1ed9t ph\u00e2n v\u00f9ng th\u00f4 h\u01a1n c\u1ee7a kh\u00f4ng gian m\u1eabu trong v\u00e0i tr\u01b0\u1eddng h\u1ee3p, v\u00e0 n\u1ebfu \\(\\mathcal{F}_1\\) l\u00e0 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 g\u1ed1c, \\(\\mathcal{F}_2\\) l\u00e0 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 m\u1edbi (c\u1ea3 hai \u0111\u1ec1u \u1ee9ng v\u1edbi c\u00f9ng \\(\\Omega\\), sau khi m\u1edf l\u1ea7n l\u00e0m th\u00f4 th\u1ee9 hai), th\u00ec \\(\\mathcal{F}_2 \\subseteq \\mathcal{F}_1\\).</p> <p>Gi\u1edd gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) tr\u00ean kh\u00f4ng gian x\u00e1c su\u1ea5t ban \u0111\u1ea7u. L\u00e0m sao ta \u0111i\u1ec1u ch\u1ec9nh / gi\u1ea3m bi\u1ebfn ng\u1eabu nhi\u00ean th\u00e0nh kh\u00f4ng gian x\u00e1c su\u1ea5t th\u00f4 h\u01a1n n\u00e0y \u0111\u00e2y? \u0110\u00e2y l\u00e0 n\u01a1i gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng xu\u1ea5t hi\u1ec7n. Ta s\u1ebd ch\u1ecdn m\u1ed9t \u0111\u1ecbnh ngh\u0129a cho k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n v\u00e0 th\u1ea5y r\u1eb1ng n\u00f3 tho\u1ea3 m\u00e3n nhi\u1ec1u t\u00ednh ch\u1ea5t hay ho v\u00e0 ph\u00f9 h\u1ee3p v\u1edbi c\u00e1c \u0111\u1ed3ng nh\u1ea5t x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n m\u00e0 ta t\u00ecm \u0111\u01b0\u1ee3c trong ph\u1ea7n tr\u01b0\u1edbc.</p> <p>L\u01b0u \u00fd r\u1eb1ng \\(X\\) l\u00e0 h\u1eb1ng s\u1ed1 tr\u00ean t\u1ea5t c\u1ea3 t\u1eadp t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\mathcal{F}_1\\). \u0110\u1ecbnh ngh\u0129a k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a \\(X\\) \u0111\u1ed1i v\u1edbi \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \\(\\mathcal{F}_2\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean \\(E[X | \\mathcal{F_2}] := X'\\) m\u00e0 tr\u00ean m\u1ecdi ph\u1ea7n t\u1eed c\u1ee7a t\u1eadp t\u1ed1i thi\u1ec3u \\(E_i\\) c\u1ee7a \\(\\mathcal{F}_2\\), \\(X'\\) l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a \\(E[X | E_i]\\). \u0110i\u1ec1u n\u00e0y ngh\u0129a l\u00e0 ta \u0111ang c\u1ed1 g\u1eafng l\u1ea5y \"trung b\u00ecnh c\u00f3 \u0111i\u1ec1u ki\u1ec7n\" c\u1ee7a th\u00f4ng tin v\u1ec1 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a \\(X\\) tr\u00ean t\u1eadp \\(E_i\\). D\u1ec5 th\u1ea5y \\(E[X'] = E[X]\\), n\u01a1i m\u00e0 k\u00ec v\u1ecdng \u0111\u1ea7u ti\u00ean \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u00ean kh\u00f4ng gian x\u00e1c su\u1ea5t th\u00f4 h\u01a1n, v\u00e0 k\u00ec v\u1ecdng th\u1ee9 hai \u0111\u01b0\u1ee3c l\u1ea5y tr\u00ean kh\u00f4ng gian x\u00e1c su\u1ea5t sau \u0111\u00f3. \\(X'\\) \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a \\(X\\) \u0111\u1ed1i v\u1edbi \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \\(\\mathcal{F}_2\\).</p> <p>\u0110\u1ec3 d\u1ec5 hi\u1ec3u h\u01a1n, ta x\u00e9t v\u00ed d\u1ee5 sau:</p> V\u00ed d\u1ee5 <p>Cho m\u1ed9t kh\u00f4ng gian m\u1eabu \\((\\Omega, \\mathcal{F}_1, P)\\), m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) tr\u00ean kh\u00f4ng gian m\u1eabu n\u00e0y, v\u00e0 m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \\(\\mathcal{F}_2 \\subseteq \\mathcal{F}_1\\) nh\u01b0 sau:</p> <ol> <li>\\(\\Omega = \\{1, 2, \\dots, 10\\}\\).</li> <li>\\(\\mathcal{F}_1\\) c\u00f3 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u \\(\\{1, 2, 3\\}, \\{4\\}, \\{5, 6\\}, \\{7\\}, \\{8, 9, 10\\}\\).</li> <li>\\(P(S)\\) c\u1ee7a c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u \\(S\\) l\u1ea7n l\u01b0\u1ee3t l\u00e0 \\(1/8, 1/8, 1/4, 1/3, 1/6\\).</li> <li>\\(\\mathcal{F}_2\\) c\u00f3 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u \\(\\{1, 2, 3, 5, 6\\}, \\{4\\}, \\{7, 8, 9, 10\\}\\).</li> <li>\\(X\\) c\u00f3 c\u00e1c gi\u00e1 tr\u1ecb \\([1, 1, 1, 2, 3, 3, 3, 4, 4, 4]\\) l\u1ea7n l\u01b0\u1ee3t cho \\([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\\).</li> </ol> <p>Th\u00ec \\(E[X | \\mathcal{F}_2]\\) \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh nh\u01b0 sau:</p> <ol> <li>Tr\u00ean t\u1eadp t\u1ed1i thi\u1ec3u \\(S = \\{1, 2, 3, 5, 6\\}\\), k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \\(E[X | S] = (1/8 + 3/4) / (1/8 + 1/4) = 7/3\\).</li> <li>Tr\u00ean t\u1eadp t\u1ed1i thi\u1ec3u \\(S = \\{4\\}\\), k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \\(E[X | S] = 2\\).</li> <li>Tr\u00ean t\u1eadp t\u1ed1i thi\u1ec3u \\(S = \\{7, 8, 9, 10\\}\\), k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \\(E[X | S] = (3/3 + 4/6) / (1/3 + 1/6) = 10/3\\).</li> </ol> <p>N\u00ean bi\u1ebfn ng\u1eabu nhi\u00ean \\(E[X | \\mathcal{F}_2]\\) l\u1ea5y c\u00e1c gi\u00e1 tr\u1ecb \\([7/3, 7/3, 7/3, 2, 7/3, 7/3, 10/3, 10/3, 10/3, 10/3]\\) l\u1ea7n l\u01b0\u1ee3t cho \\([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\\).</p> <p>Ta c\u00f3 v\u00e0i l\u01b0u \u00fd sau:</p> <ol> <li>Theo m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3, ta \u0111ang c\u1ed1 g\u1eafng thay th\u1ebf bi\u1ebfn ng\u1eabu nhi\u00ean b\u1eb1ng \"x\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t\" c\u1ee7a n\u00f3 theo m\u1ed9t ngh\u0129a n\u00e0o \u0111\u00f3 (v\u00ed d\u1ee5 nh\u01b0 ngh\u0129a gi\u1ea3m thi\u1ec3u ph\u01b0\u01a1ng sau, nh\u01b0ng \u0111i\u1ec1u \u0111\u00f3 ho\u00e0n to\u00e0n kh\u00f4ng li\u00ean quan). C\u0169ng l\u01b0u \u00fd r\u1eb1ng k\u1ef3 v\u1ecdng c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00f4ng thay \u0111\u1ed5i khi \u00e1p d\u1ee5ng \u0111i\u1ec1u n\u00e0y cho \\(X\\).</li> <li>V\u1edbi \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \u0111\u01a1n gi\u1ea3n \\(\\mathcal{F}_2 = \\{\\emptyset, \\Omega\\}\\), bi\u1ebfn ng\u1eabu nhi\u00ean \\(E[X | \\mathcal{F_2}]\\) \u0111\u1ed3ng nh\u1ea5t v\u1edbi h\u00e0m h\u1eb1ng b\u1eb1ng \\(E[X]\\).</li> </ol> <p>Ta c\u0169ng c\u00f3 th\u1ec3 x\u00e2u chu\u1ed7i m\u1ed9t v\u00e0i ph\u1ea7n th\u00f4. Gi\u1ea3 s\u1eed \\(\\mathcal{F}_3 \\subseteq \\mathcal{F}_2 \\subseteq \\mathcal{F}_1\\) v\u00e0 \\(X\\) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u1ed1i v\u1edbi kh\u00f4ng gian x\u00e1c su\u1ea5t \\((\\Omega, \\mathcal{F}_1, P)\\). Th\u00ec ta s\u1ebd c\u00f3 \\(E[E[X | \\mathcal{F}_2] | \\mathcal{F}_3] = E[X | \\mathcal{F_3}]\\), c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ee9ng minh d\u1ec5 d\u00e0ng b\u1eb1ng c\u00e1ch x\u00e2u chu\u1ed7i c\u00e1c k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n. Tr\u00ean th\u1ef1c t\u1ebf, k\u1ef3 v\u1ecdng v\u1eabn gi\u1eef nguy\u00ean ngay c\u1ea3 khi l\u00e0m th\u00f4 l\u00e0 h\u1ec7 qu\u1ea3 tr\u1ef1c ti\u1ebfp c\u1ee7a \u0111i\u1ec3m n\u00e0y v\u00e0 \u0111i\u1ec3m cu\u1ed1i c\u00f9ng.</p> <p>M\u1ed9t thu\u1eadt ng\u1eef \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng ph\u1ed5 bi\u1ebfn h\u01a1n l\u00e0 k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00e1c. N\u00f3 th\u01b0\u1eddng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 sau:</p> <p>Gi\u1ea3 s\u1eed \\(X\\) v\u00e0 \\(Y\\) l\u00e0 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean tr\u00ean c\u00f9ng kh\u00f4ng gian x\u00e1c su\u1ea5t. V\u1edbi b\u00e2t k\u1ef3 ph\u1ea7n t\u1eed \\(\\omega\\) n\u00e0o c\u1ee7a kh\u00f4ng gian m\u1eabu m\u00e0 \\(Y(\\omega) = y\\), ta \u0111\u1ecbnh ngh\u0129a \\(E[X | Y]\\left(\\omega\\right) = E[X | E]\\) v\u1edbi \\(E\\) l\u00e0 bi\u1ebfn c\u1ed1 m\u00e0 \\(Y = y\\). Ngh\u0129a l\u00e0, v\u1edbi m\u1ecdi ph\u1ea7n t\u1eed m\u00e0 \\(Y\\) c\u00f3 gi\u00e1 tr\u1ecb gi\u1ed1ng \\(y\\), ta l\u1ea5y k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi bi\u1ebfn c\u1ed1 m\u00e0 \\(Y = y\\) v\u00e0 \u0111\u1eb7t gi\u00e1 tr\u1ecb c\u1ee7a \u0111\u00e1p \u00e1n cho k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u00f3.</p> <p>Tuy nhi\u00ean, \u0111i\u1ec1u \u1edf tr\u00ean c\u0169ng gi\u1ed1ng nh\u01b0: cho \\(\\mathcal{F}_Y\\) l\u00e0 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 m\u00e0 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c gi\u00e1 tr\u1ecb kh\u00e1c nhau c\u1ee7a \\(Y\\). Khi \u0111\u00f3 \\(E[X | Y]\\) s\u1ebd \u0111\u1ed3ng nh\u1ea5t v\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean \\(E[X | \\mathcal{F}_Y]\\). L\u01b0u \u00fd r\u1eb1ng \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1edfi bi\u1ebfn ng\u1eabu nhi\u00ean \\(Y\\).</p> <p>Theo ngh\u0129a n\u00e0y, k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 l\u00e0 m\u1ed9t kh\u00e1i ni\u1ec7m r\u00f5 r\u00e0ng v\u00e0 ph\u1ee9c t\u1ea1p h\u01a1n k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean, m\u1eb7c d\u00f9 c\u1ea3 hai kh\u00e1i ni\u1ec7m \u0111\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (b\u1ea1n lu\u00f4n c\u00f3 th\u1ec3 t\u1ea1o ra m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 b\u1eb1ng c\u00e1ch ch\u1ecdn n\u01a1i \u0111\u1ec3 \u0111\u1eb7t c\u00e1c gi\u00e1 tr\u1ecb b\u1eb1ng nhau cho bi\u1ebfn ng\u1eabu nhi\u00ean m\u00e0 b\u1ea1n \u0111ang \u0111i\u1ec1u ch\u1ec9nh).</p> <p>M\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 suy ngh\u0129 v\u1ec1 kh\u00e1i ni\u1ec7m n\u00e0y l\u00e0 coi n\u00f3 nh\u01b0 l\u00e0 s\u1ef1 \u00e1nh x\u1ea1 t\u1eeb m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u sang m\u1ed9t t\u1eadp h\u1ee3p c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u th\u00f4 h\u01a1n. \u0110\u1ed1i v\u1edbi m\u1ed7i nh\u00f3m bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u m\u00e0 ta \u0111ang thu g\u1ecdn, ta thay th\u1ebf n\u00f3 b\u1eb1ng m\u1ed9t bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u duy nh\u1ea5t b\u1eb1ng \"t\u00e2m kh\u1ed1i l\u01b0\u1ee3ng\" c\u1ee7a c\u00e1c bi\u1ebfn c\u1ed1 \u0111\u00f3, trong \u0111\u00f3 \"v\u1ecb tr\u00ed\" l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean v\u00e0 \"kh\u1ed1i l\u01b0\u1ee3ng\" b\u1eb1ng v\u1edbi x\u00e1c su\u1ea5t c\u1ee7a c\u00e1c bi\u1ebfn c\u1ed1 t\u1ed1i thi\u1ec3u \u0111\u00f3. \u0110i\u1ec1u n\u00e0y c\u0169ng \u0111\u00fang v\u1ec1 m\u1eb7t to\u00e1n h\u1ecdc v\u00e0 ch\u00ednh x\u00e1c cho setup n\u00e0y.</p> <p>\u0110\u1ec3 cho \u0111\u1ea7y \u0111\u1ee7, v\u00ec \u0111\u1ecbnh ngh\u0129a tr\u00ean n\u1eafm b\u1eaft \u0111\u01b0\u1ee3c k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed1i v\u1edbi \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1, nh\u01b0ng kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng khi c\u1ed1 g\u1eafng t\u1ed5ng qu\u00e1t n\u00f3 cho c\u00e1c kh\u00f4ng gian m\u1eabu v\u00f4 h\u1ea1n, \u0111\u00e2y l\u00e0 \"\u0111\u1ecbnh ngh\u0129a ch\u00ednh th\u1ee9c\" m\u00e0 m\u1ecdi ng\u01b0\u1eddi s\u1eed d\u1ee5ng (kh\u00e1 l\u00e0 ph\u1ea3n tr\u1ef1c gi\u00e1c v\u00e0 m\u1ea5t ch\u00fat th\u1eddi gian \u0111\u1ec3 hi\u1ec3u r\u00f5):</p> <p>M\u1ed9t bi\u1ebfn c\u1ed1 c\u00f3 \u0111i\u1ec1u ki\u1ec7n \\(X\\) v\u1edbi \\(\\mathcal{H}\\) cho tr\u01b0\u1edbc, k\u00fd hi\u1ec7u l\u00e0 \\(E[X | \\mathcal{H}]\\), l\u00e0 b\u1ea5t k\u1ef3 bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0o tr\u00ean \\((\\Omega, \\mathcal{H}, P)\\) tho\u1ea3 m\u00e3n \\(\\int_H E[X | \\mathcal{H}] d\\mathbb{P} = \\int_H X d\\mathbb{P}\\) v\u1edbi m\u1ecdi \\(H \\in \\mathcal{H}\\).</p> <p>V\u1ec1 c\u01a1 b\u1ea3n, \u0111\u1ecbnh ngh\u0129a n\u00e0y n\u00f3i l\u1ea1i y h\u1ec7t nh\u1eefng g\u00ec ta \u0111\u00e3 b\u00e0n khi b\u1ea1n ngh\u0129 v\u1ec1 kh\u1ea3 n\u0103ng \\(H\\) c\u00f3 th\u1ec3 x\u1ea3y ra, nh\u01b0ng theo c\u00e1ch kh\u00f4ng mang t\u00ednh x\u00e2y d\u1ef1ng h\u01a1n. Ho\u00e1 ra bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0y kh\u00f4ng ph\u1ea3i l\u00e0 duy nh\u1ea5t theo ngh\u0129a ch\u1eb7t ch\u1ebd nh\u1ea5t, nh\u01b0ng \\(P(Y \\ne Z) = 0\\) \u0111\u00fang, trong \u0111\u00f3 \\(Y\\) v\u00e0 \\(Z\\) l\u00e0 hai bi\u1ebfn c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0y. Ngo\u00e0i ra, \u0111\u1ecbnh ngh\u0129a n\u00e0y l\u00e0m r\u00f5 r\u1eb1ng \\(X - E[X | \\mathcal{H}]\\)  tr\u1ef1c giao v\u1edbi h\u00e0m ch\u1ec9 b\u00e1o (v\u00ec v\u1eady ta c\u00f3 d\u1ecbnh ngh\u0129a ch\u00ednh x\u00e1c h\u01a1n v\u1ec1 ph\u00e9p chi\u1ebfu xu\u1ed1ng).</p>"},{"location":"Codeforces/math/martingales/#martingales","title":"Martingales","text":"<p>Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t \"ti\u1ebfn tr\u00ecnh\", m\u00e0 \u1edf m\u1ed7i b\u01b0\u1edbc, ta c\u00f3 th\u00eam th\u00f4ng tin. Gi\u1ea3 s\u1eed kh\u00f4ng gian m\u1eabu c\u1ee7a ch\u00fang ta cho to\u00e0n b\u1ed9 ph\u00e9p th\u1eed l\u00e0 \\(\\Omega\\). \u1ede \u0111\u00e2y, \\(\\Omega\\) g\u1ea7n nh\u01b0 lu\u00f4n v\u00f4 h\u1ea1n, nh\u01b0ng v\u1edbi nh\u1eefng hi\u1ec3u bi\u1ebft tr\u01b0\u1edbc \u0111\u00f3, ngay c\u1ea3 khi nh\u1eefng kh\u00e1i ni\u1ec7m nh\u01b0 t\u1eadp t\u1ed1i thi\u1ec3u kh\u00f4ng d\u00e0nh cho kh\u00f4ng gian m\u1eabu v\u00f4 h\u1ea1n. Ta x\u00e9t m\u1ed9t v\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n, v\u1edbi m\u1ed7i b\u01b0\u1edbc, ta tung \u0111\u1ed3ng xu. Kh\u00f4ng gian m\u1eabu c\u1ee7a to\u00e0n b\u1ed9 ph\u00e9p th\u1eed l\u00e0 t\u1eadp c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c x\u00e2u nh\u1ecb ph\u00e2n v\u00f4 h\u1ea1n. Gi\u1edd ta h\u00e3y ngh\u0129 v\u1ec1 lo\u1ea1i th\u00f4ng tin m\u00e0 ta s\u1ebd c\u00f3 sau nhi\u1ec1u b\u01b0\u1edbc c\u1ee7a ti\u1ebfn tr\u00ecnh. Sau b\u01b0\u1edbc \\(0\\), t\u1ea5t c\u1ea3 th\u00f4ng tin ta c\u00f3 (v\u00ed d\u1ee5, th\u00f4ng tin ho\u00e0n ch\u1ec9nh v\u1ec1 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean m\u00e0 c\u00f3 th\u00f4ng tin v\u1ec1 nh\u1eefng th\u1ee9 \u0111\u00e3 x\u1ea3y ra \u0111\u1ebfn th\u1eddi \u0111i\u1ec3m hi\u1ec7n t\u1ea1i) \u1ee9ng v\u1edbi \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \u0111\u01a1n gi\u1ea3n \\(\\{\\emptyset, \\Omega\\}\\). Sau b\u01b0\u1edbc th\u1ee9 \\(i\\), ta c\u00f3 th\u00f4ng tin v\u1ec1 \\(i\\) l\u1ea7n tung \u0111\u1ea7u ti\u00ean, n\u00ean th\u00f4ng tin \u1ee9ng v\u1edbi \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 v\u1edbi c\u00e1c t\u1eadp \"t\u1ed1i thi\u1ec3u\" ch\u00ednh l\u00e0 c\u00e1c t\u1eadp c\u00e1c x\u00e2u nh\u1ecb ph\u00e2n m\u00e0 gi\u1ed1ng nhau trong \\(i\\) v\u1ecb tr\u00ed \u0111\u1ea7u ti\u00ean.</p> <p>\u0110\u1ec3 hi\u1ec3u v\u00ec sao c\u00e1c \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 c\u1ea7n thi\u1ebft \u0111\u1ec3 l\u1ea5y th\u00f4ng tin, ph\u00e9p lo\u1ea1i suy sau c\u00f3 th\u1ec3 c\u00f3 \u00edch. H\u00e3y suy ngh\u0129 v\u1ec1 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u. M\u1ed7i l\u1ea7n ta l\u1ea5y th\u00eam th\u00f4ng tin, ta c\u00f3 th\u1ec3 ph\u00e2n bi\u1ec7t \u0111\u01b0\u1ee3c c\u00e1c ph\u1ea7n t\u1eed trong t\u1eadp t\u1ed1i thi\u1ec3u. \u0110\u1ec3 c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c nh\u01b0 t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed9t s\u1ed1 bi\u1ebfn ng\u1eabu nhi\u00ean trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ta c\u1ea7n ph\u1ea3i c\u00f3 kh\u1ea3 n\u0103ng ph\u00e2n bi\u1ec7t c\u00e1c ph\u1ea7n t\u1eed n\u00e0y. Theo m\u1ed9t ngh\u0129a n\u00e0o \u0111\u00f3, b\u1ea1n \u0111ang ki\u1ec3m tra nhi\u1ec1u v\u0169 tr\u1ee5 song song c\u00f9ng m\u1ed9t l\u00fac, v\u00e0 trong m\u1ed7i v\u0169 tr\u1ee5, b\u1ea1n c\u00f3 m\u1ed9t ti\u1ec1n t\u1ed1 nh\u1ea5t \u0111\u1ecbnh v\u1ec1 nh\u1eefng th\u1ee9 \u0111\u00e3 x\u1ea3y ra, \u0111\u1ed1i v\u1edbi m\u1ed7i s\u1ef1 vi\u1ec7c m\u00e0 b\u1ea1n mu\u1ed1n ph\u00e2n t\u00edch \u0111\u01b0\u1ee3c nh\u1eefng g\u00ec s\u1ebd x\u1ea3y ra ti\u1ebfp theo.</p> <p>L\u01b0u \u00fd r\u1eb1ng ta lu\u00f4n l\u1ea5y th\u00eam th\u00f4ng tin \u1edf m\u1ed7i giai \u0111o\u1ea1n c\u1ee7a m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean nh\u01b0 v\u1eady. N\u00ean ta \u0111\u1ecbnh ngh\u0129a m\u1ed9t b\u1ed9 l\u1ecdc nh\u01b0 sau (m\u00e0 kh\u00f4ng c\u00f3 b\u1ea5t k\u1ef3 tham chi\u1ebfu n\u00e0o \u0111\u1ebfn m\u1ed9t ti\u1ebfn tr\u00ecnh v\u00ec m\u1ee5c \u0111\u00edch t\u1ed5ng qu\u00e1t): m\u1ed9t d\u00e3y c\u00e1c \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \\(\\mathcal{F}_i\\) m\u00e0 \\(\\mathcal{F}_i \\subseteq \\mathcal{F}_j\\) khi v\u00e0 ch\u1ec9 khi \\(i \\le j\\)</p> <p>V\u1eady th\u00ec ti\u1ebfn tr\u00ecnh l\u00e0 c\u00e1i g\u00ec? \u1ede m\u1ed7i b\u01b0\u1edbc c\u1ee7a m\u1ed9t ti\u1ebfn tr\u00ecnh, ta c\u00f3 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean xu\u1ea5t hi\u1ec7n. Nh\u01b0ng \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u00f3 l\u00e0 g\u00ec? \u0110\u1ec3 kh\u1eafc ph\u1ee5c, ta l\u1ea5y m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \\(\\mathcal{F}\\) m\u00e0 n\u00f3 l\u1ea5y \u0111\u01b0\u1ee3c to\u00e0n b\u1ed9 th\u00f4ng tin c\u00f3 th\u1ec3 c\u00f3. V\u1eady n\u00ean ta \u0111\u1ecbnh ngh\u0129a m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean nh\u01b0 sau:</p> <p>V\u1edbi m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t \\((\\Omega, \\mathcal{F}, P)\\), m\u1ed9t t\u1eadp \u0111\u00e1nh d\u1ea5u \\(I\\) v\u1edbi t\u1ed5ng th\u1ee9 t\u1ef1 \\(\\le\\), m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean \\(X\\) l\u00e0 b\u1ed9 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \\(\\{X(i) | i \\in I\\}\\).</p> <p>V\u1edbi m\u1ee5c \u0111\u00edch c\u1ee7a ch\u00fang ta, \\(I\\) s\u1ebd g\u1ea7n nh\u01b0 l\u00e0 c\u00e1c s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m, m\u1eb7c d\u00f9 \\(I = \\mathbb{R}\\) \u0111\u01b0\u1ee3c d\u00f9ng r\u1ed9ng r\u00e3i trong nhi\u1ec1u t\u00ecnh hu\u1ed1ng. \\(I\\) c\u00f3 t\u1ed5ng th\u1ee9 t\u1ef1 ngh\u0129a l\u00e0 c\u00f3 m\u1ed9t s\u1ed1 kh\u00e1i ni\u1ec7m v\u1ec1 th\u1eddi gian li\u00ean quan \u0111\u1ebfn \\(I\\).</p> <p>Gi\u1edd l\u00e0m sao \u0111\u1ec3 ta x\u00e2y d\u1ef1ng \u0111\u01b0\u1ee3c m\u1ed9t \"b\u1ed9 l\u1ecdc t\u1ef1 nhi\u00ean\" \u0111\u1ec3 l\u1ea5y th\u00f4ng tin m\u00e0 \\(i\\) b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean c\u1ee7a ti\u1ebfn tr\u00ecnh (ngh\u0129a l\u00e0 \\(\\{X(j) | j \\le i\\}\\)) cho ch\u00fang ta? Nh\u1edb l\u1ea1i l\u00e0m sao \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 t\u1eeb m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00f4ng? Ta c\u0169ng c\u00f3 th\u1ec3 d\u00f9ng th\u1ee9 t\u01b0\u01a1ng t\u1ef1 \u0111\u1ec3 x\u00e2y d\u1ef1ng n\u00f3 t\u1eeb m\u1ed9t t\u1eadp h\u1eefu h\u1ea1n c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean, b\u1eb1ng c\u00e1ch tinh ch\u1ec9nh hai ph\u00e2n ho\u1ea1ch v\u1edbi nhau khi c\u00f3 th\u1ec3 (t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ph\u00e9p n\u1ed1i hai ph\u00e2n ho\u1ea1ch trong m\u1ea1ng tinh ch\u1ebf, n\u1ebfu b\u1ea1n quen v\u1edbi t\u1eadp th\u1ee9 t\u1ef1 m\u1ed9t ph\u1ea7n v\u00e0 m\u1ea1ng tinh th\u1ec3). V\u00ec v\u1eady qu\u00e1 tr\u00ecnh l\u1ecdc c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp theo c\u00e1ch n\u00e0y, b\u1eb1ng c\u00e1ch tinh ch\u1ec9nh \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 hi\u1ec7n t\u1ea1i v\u1edbi m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean m\u1edbi m\u1ed7i l\u1ea7n. Ta c\u00f3 di\u1ec5n gi\u1ea3i t\u1eeb Wikipedia, </p> <p>V\u1edbi \\({\\displaystyle (X_{n})_{n\\in \\mathbb {N} }}\\) l\u00e0 m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean tr\u00ean kh\u00f4ng gian m\u1eabu \\({\\displaystyle (\\Omega ,{\\mathcal {F}},P)}\\). Th\u00ec</p> \\[{\\displaystyle {\\mathcal {F}}_{n}:=\\sigma (X_{k}\\mid k\\leq n)}\\] <p>l\u00e0 m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 v\u00e0 \\({\\displaystyle \\mathbb {F} =({\\mathcal {F}}_{n})_{n\\in \\mathbb {N} }}\\) l\u00e0 m\u1ed9t b\u1ed9 l\u1ecdc. \u1ede \u0111\u00e2y \\({\\displaystyle \\sigma (X_{k}\\mid k\\leq n)}\\) th\u1ec3 hi\u1ec7n r\u1eb1ng \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \u0111\u01b0\u1ee3c sinh ra t\u1eeb c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \\({\\displaystyle X_{1},X_{2},\\dots ,X_{n}}\\). \\({\\mathbb F}\\) l\u00e0 m\u1ed9t b\u1ed9 l\u1ecdc, v\u00ec v\u1edbi \u0111\u1ecbnh ngh\u0129a t\u1ea5t c\u1ea3 \\({\\displaystyle {\\mathcal {F}}_{n}}\\) l\u00e0 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 v\u00e0 \\({\\displaystyle \\sigma (X_{k}\\mid k\\leq n)\\subseteq \\sigma (X_{k}\\mid k\\leq n+1)}\\).</p> <p>Th\u1ee9 n\u00e0y \u0111\u01b0\u1ee3c bi\u1ebfn \u0111\u1ebfn nh\u01b0 b\u1ed9 l\u1ecdc t\u1ef1 nhi\u00ean c\u1ee7a \\({\\displaystyle {\\mathcal {F}}}\\) \u0111\u1ed1i v\u1edbi \\(X\\).</p> <p>Cu\u1ed1i c\u00f9ng, ta c\u0169ng c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a martingale. L\u01b0u \u00fd r\u1eb1ng n\u1ebfu \\(\\sigma(X_i) \\subseteq \\mathcal{H}\\) v\u1edbi m\u1ed9t s\u1ed1 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 \\(\\mathcal{H}\\), th\u00ec \\(E[X_i | \\mathcal{H}] = X_i\\) (nh\u1edb l\u1ea1i t\u1eadp t\u1ed1i thi\u1ec3u v\u00e0 \u0111\u1ecbnh ngh\u0129a). M\u1ed9t martingale n\u00f3i r\u1eb1ng t\u00ednh \u0111i\u1ec1u ki\u1ec7n d\u1ef1a tr\u00ean th\u00f4ng tin ch\u00fang ta c\u00f3 \u0111\u1ebfn th\u1eddi \u0111i\u1ec3m \\(i\\), m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \\(X_j\\) v\u1edbi \\(j \\ge i\\) tr\u00f4ng gi\u1ed1ng nh\u01b0 \\(X_i\\). N\u00f3i c\u00e1ch kh\u00e1c,</p> <p>M\u1ed9t martingale l\u00e0 m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean \\(X_1, X_2, \\ldots\\) m\u00e0 \\(E[X_{n + 1} | \\sigma(X_1, X_2, \\dots, X_n)] = X_n\\)</p> <p>\u0110i\u1ec1u ki\u1ec7n \u0111\u1ea7u ti\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft th\u00e0nh \\(E[X_{n + 1} - X_n | \\sigma(X_1, X_2, \\dots, X_n)] = 0\\). L\u01b0u \u00fd r\u1eb1ng ta \u0111ang b\u00e0n v\u1ec1 s\u1ef1 b\u1eb1ng nhau \"g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn\" c\u1ee7a c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean khi x\u1eed l\u00fd c\u00e1c kh\u00f4ng gian x\u00e1c su\u1ea5t ph\u1ee9c t\u1ea1p h\u01a1n, nh\u01b0ng v\u00ec m\u1ee5c ti\u00eau, ta s\u1ebd kh\u00f4ng quan t\u00e2m \u0111\u1ebfn chi ti\u1ebft n\u00e0y.</p> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u00e2y l\u00e0 \u0111i\u1ec1u ki\u1ec7n c\u1ea7n v\u00e0 \u0111\u1ee7, b\u1edfi \\(X_j - X_i = (X_j - X_{j - 1}) + (X_{j - 1} - X_{j - 2}) + \\dots + (X_{i+1} - X_i)\\), v\u00e0 th\u00eam v\u00e0o t\u00ednh ch\u1ea5t l\u1ed3ng nhau th\u00f4, n\u00f3 gia gi\u1ea3m th\u00e0nh \\(E[X_j - X_i | \\sigma(X_1, \\dots, X_i)] = 0\\).</p> <p>T\u1ea1i sao martingale h\u1eefu \u00edch? \u0110\u1ea7u ti\u00ean, n\u00f3 cho ch\u00fang ta m\u1ed9t b\u1ea5t bi\u1ebfn, v\u00e0 nh\u01b0 ta \u0111\u00e3 bi\u1ebft, c\u00e1c b\u1ea5t bi\u1ebfn l\u00e0m m\u1ecdi th\u1ee9 d\u1ec5 d\u00e0ng h\u01a1n khi ch\u1ee9ng minh c\u00e1c k\u1ebft qu\u1ea3 trong to\u00e1n h\u1ecdc. Th\u1ee9 hai, n\u00f3 b\u1eaft ngu\u1ed3n t\u1eeb l\u00fd thuy\u1ebft c\u1edd b\u1ea1c v\u00e0 \u0111\u1ed1i v\u1edbi c\u00e1c tr\u00f2 c\u1edd b\u1ea1c c\u00f4ng b\u1eb1ng, gi\u00e1 tr\u1ecb l\u1ee3i nhu\u1eadn k\u00ec v\u1ecdng t\u1ea1i th\u1eddi \u0111i\u1ec3m sau ph\u1ea3i b\u1eb1ng v\u1edbi l\u1ee3i nhu\u1eadn t\u1ea1i th\u1eddi \u0111i\u1ec3m \u0111\u00f3, \u0111\u00f3 ch\u00ednh l\u00e0 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a martingale!</p> <p>M\u1ed9t s\u1ed1 c\u00e1ch x\u00e2y d\u1ef1ng martingale nh\u01b0 sau:</p> <ol> <li>X\u00e9t vi\u1ec7c \u0111i b\u1ed9 ng\u1eabu nhi\u00ean, v\u1edbi v\u1ecb tr\u00ed \u0111\u1ea7u l\u00e0 \\(X_0 = 0\\), v\u00e0 \\(X_i = X_{i-1} \\pm 1\\), v\u1edbi x\u00e1c su\u1ea5t b\u1eb1ng nhau \\(p \\le 1/2\\), v\u00e0 \\(X_i = X_{i-1}\\) v\u1edbi x\u00e1c su\u1ea5t \\(1-2p\\). Th\u00ec \u0111\u00e2y l\u00e0 m\u1ed9t martingale (theo \u0111\u1ecbnh ngh\u0129a).</li> <li>X\u00e9t vi\u1ec7c \u0111i b\u1ed9 ng\u1eabu nhi\u00ean bi\u1ec3u th\u1ecb t\u1ed5ng t\u00e0i s\u1ea3n c\u1ee7a m\u1ed9t bet th\u1ee7, anh ta lu\u00f4n t\u00e1i \u0111\u1ea7u t\u01b0 v\u1ed1n c\u1ee7a m\u00ecnh v\u00e0o tr\u00f2 ch\u01a1i. Tr\u00f2 n\u00e0y tr\u1ea3 \\(r\\) ph\u1ea7n tr\u0103m n\u1ebfu anh ta th\u1eafng (x\u00e1c su\u1ea5t l\u00e0 \\(p\\)), m\u1ea5t \\(r\\) ph\u1ea7n tr\u0103m n\u1ebfu anh ta thua (x\u00e1c su\u1ea5t l\u00e0 \\(p\\)), v\u00e0 t\u00e0i s\u1ea3n gi\u1eef nguy\u00ean n\u1ebfu ho\u00e0 (x\u00e1c su\u1ea5t \\(1-2p\\)). Th\u00ec t\u00e0i s\u1ea3n c\u1ee7a anh ta l\u00e0 m\u1ed9t martingale.</li> </ol> <p>Gi\u1edd ta x\u00e9t k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n trong \u0111\u1ecbnh ngh\u0129a c\u1ee7a martingale khi ta \u00e1p d\u1ee5ng h\u00e0m l\u1ed3i cho m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean (ngh\u0129a l\u00e0 cho t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean trong ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean). V\u00ec c\u00e1c x\u00e1c su\u1ea5t \u0111\u1ec1u d\u01b0\u01a1ng, n\u00ean b\u1ea5t c\u1ee9 khi n\u00e0o ch\u00fang ta l\u1ea5y k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u00ean, ta s\u1ebd l\u1ea5y m\u1ed9t t\u1ed5 h\u1ee3p l\u1ed3i c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m l\u1ed3i c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean. Theo b\u1ea5t \u0111\u1eb3ng th\u1ee9c Jensen, ta nh\u1eadn \u0111\u01b0\u1ee3c \u0111i\u1ec1u \u0111\u00f3 thay v\u00ec \u0111\u1eb3ng th\u1ee9c, \\(\\ge\\) \u0111\u00fang trong ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ecbnh ngh\u0129a cho martingale. T\u01b0\u01a1ng t\u1ef1, n\u1ebfu ta c\u00f3 m\u1ed9t h\u00e0m l\u00f5m, \\(\\le\\) \u0111\u00fang trong ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ecbnh ngh\u0129a cho martingale. C\u00e1c lo\u1ea1i ti\u1ebfn tr\u00ecnh n\u00e0y (trong \u0111\u00f3 \\(\\ge\\) v\u00e0 \\(\\le\\) \u0111\u01b0\u1ee3c gi\u1eef thay v\u00ec \\(=\\)) \u0111\u01b0\u1ee3c g\u1ecdi l\u1ea7n l\u01b0\u1ee3t l\u00e0 sub-martingale v\u00e0 super-martingale. L\u01b0u \u00fd r\u1eb1ng kh\u00f4ng ph\u1ea3i t\u1ea5t c\u1ea3 ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean \u0111\u1ec1u ph\u1ea3i l\u00e0 sub ho\u1eb7c super-martingale. Th\u00eam n\u1eefa l\u00e0 \\(\\ge 0\\) v\u00e0 \\(\\le 0\\) ngh\u0129a l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean tr\u00ean LHS (Latin hypercube sampling) l\u1ea7n l\u01b0\u1ee3t g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn kh\u00f4ng \u00e2m v\u00e0 kh\u00f4ng d\u01b0\u01a1ng.</p> <p>M\u1ed9t v\u00ed d\u1ee5 v\u1ec1 sub-martingale:</p> V\u00ed d\u1ee5 <p>Gi\u1ea3 s\u1eed ta c\u00f3 martingale \\(X\\). Ta n\u00f3i \\(X^2\\) l\u00e0 m\u1ed9t sub-martingale. Theo b\u1ea5t \u0111\u1eb3ng th\u1ee9c Jensen, \\(\\sum_{i = 1}^N \\lambda_i f(x_i) \\ge f \\left(\\sum_{i = 1}^{N} \\lambda_i x_i\\right)\\), v\u1edbi \\(f\\) l\u1ed3i v\u00e0 \\(\\lambda_i\\) kh\u00f4ng \u00e2m c\u00f3 t\u1ed5ng b\u1eb1ng \\(1\\). \u00c1p d\u1ee5ng \u0111i\u1ec1u n\u00e0y khi l\u00e0m th\u00f4 c\u00e1c t\u1eadp t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 m\u1ecbn h\u01a1n (khi l\u1ea5y k\u00ec v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n) cho ta \\(E[X_{N + 1}^2 \\mid \\sigma(X_{i}^2)_{i = 0}^{N}] \\ge X_N^2\\), ch\u1ee9ng minh \u0111\u01b0\u1ee3c \\(X^2\\) l\u00e0 sub-martingale. Trong th\u1ef1c t\u1ebf, trong tr\u01b0\u1eddng h\u1ee3p \\(X_n\\) l\u00e0 \u0111\u1ed9 may m\u1eafn c\u1ee7a ng\u01b0\u1eddi c\u00e1 c\u01b0\u1ee3c khi l\u1ee3i nhu\u1eadn v\u00e0 thua l\u1ed7 (c\u00f3 \u0111\u1ed9 l\u1edbn b\u1eb1ng nhau) c\u00f3 kh\u1ea3 n\u0103ng x\u1ea3y ra nh\u01b0 nhau, \\(X_n^2 - n\\) l\u00e0 m\u1ed9t martingale. L\u01b0u \u00fd r\u1eb1ng trong \u0111\u1ecbnh ngh\u0129a t\u1ed5ng qu\u00e1t nh\u1ea5t c\u1ee7a martingale, b\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng b\u1ed9 l\u1ecdc tr\u01b0\u1edbc \u0111\u00f3 (\\(\\sigma(X_i)\\)). \u0110\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u \u0111\u00f3, t\u1ea5t c\u1ea3 nh\u1eefng th\u1ee9 c\u1ea7n thi\u1ebft l\u00e0 \u0111\u1ec3 ti\u1ebfn tr\u00ecnh th\u00edch \u1ee9ng v\u1edbi b\u1ed9 l\u1ecdc, nh\u01b0ng v\u00ec ta \u0111\u00e3 \u0111\u1ecbnh ngh\u0129a martingale tr\u00ean b\u1ed9 l\u1ecdc t\u1ef1 nhi\u00ean, ta \u0111\u00e3 ti\u1ebfp t\u1ee5c v\u1edbi m\u1ed9t b\u1ed9 l\u1ecdc r\u00f5 r\u00e0ng h\u01a1n.</p> <p>Ta s\u1ebd kh\u00f4ng \u0111i qu\u00e1 s\u00e2u v\u00e0o martingale (v\u00ec n\u00f3 x\u1ee9ng \u0111\u00e1ng c\u00f3 m\u1ed9t ng\u00e0nh nghi\u00ean c\u1ee9u ri\u00eang), nh\u01b0ng ta s\u1ebd xem m\u1ed9t v\u00e0i t\u00ednh ch\u1ea5t hay ho:</p> <ol> <li>B\u1ea5t \u0111\u1eb3ng th\u1ee9c Azuma: N\u00f3 cho ta m\u1ed9t gi\u1edbi h\u1ea1n v\u1ec1 m\u1ee9c \u0111\u1ed9 \"\u0111\u00f3ng\" c\u1ee7a ta v\u1edbi gi\u00e1 tr\u1ecb ban \u0111\u1ea7u c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean, v\u1edbi c\u00e1c gi\u1edbi h\u1ea1n chuy\u1ec3n \u0111\u1ed9ng c\u1ee7a martingale (ho\u1eb7c ta \u0111\u00e3 \u0111i sai h\u01b0\u1edbng bao xa b\u1edbi m\u1ed9t sub / super-martingale). G\u1ecdi \\(\\{X_k\\}\\) l\u00e0 m\u1ed9t super-martingale (c\u0169ng l\u00e0 martingale), v\u00e0 gi\u1ea3 s\u1eed \\(|X_k - X_{k - 1}| \\le c_k\\) l\u00e0 g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn. Th\u00ec ta c\u00f3 \\(P(X_N - X_0 \\ge \\varepsilon) \\le \\exp(-\\varepsilon^2/(2 \\sum_{k = 1}^N c_k^2))\\). V\u00ec \u00e2m c\u1ee7a super-martingale l\u00e0 sub-martingale, v\u1edbi sub-martingale \\(X\\), ta s\u1ebd c\u00f3 \\(P(X_N - X_0 \\le -\\varepsilon) \\le \\exp(-\\varepsilon^2/(2 \\sum_{k = 1}^N c_k^2))\\).V\u00ec martingale v\u1eeba l\u00e0 sub-martingale, v\u1eeba l\u00e0 super-martingale, ta c\u00f3 m\u1ed9t gi\u1edbi h\u1ea1n x\u00e1c su\u1ea5t v\u1ec1 \u0111\u1ed9 g\u1ea7n c\u1ee7a \\(X_N\\) v\u1edbi \\(X_0\\), ngh\u0129a l\u00e0 \\(P(|X_N - X_0| \\ge \\varepsilon) \\le 2 \\exp(-\\varepsilon^2/(2 \\sum_{k = 1}^N c_k^2))\\). C\u00f3 m\u1ed9t phi\u00ean b\u1ea3n m\u1ea1nh h\u01a1n c\u1ee7a b\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y nh\u01b0ng nh\u01b0 tr\u00ean \u0111\u00e3 l\u00e0 \u0111\u1ee7 \u0111\u1ec3 th\u1ea5y \u0111\u01b0\u1ee3c martingale t\u1ed1t nh\u01b0 th\u1ebf n\u00e0o. </li> <li>B\u1ea5t \u0111\u1eb3ng th\u1ee9c martingale Doob: \u0110\u00e2y l\u00e0 b\u1ea5t \u0111\u1eb3ng th\u1ee9c ki\u1ec3u Markov tr\u00ean x\u00e1c su\u1ea5t m\u00e0 m\u1ed9t sub-martingale s\u1ebd v\u01b0\u1ee3t qu\u00e1 \\(x\\). N\u00f3i c\u00e1ch kh\u00e1c, v\u1edbi m\u1ed9t sub-martingale \\(X\\), ta c\u00f3 \\(P(\\max_{1 \\le i \\le n} X_i \\ge x) \\le E[\\max(X_n, 0)] / x\\). \u0110i\u1ec1u n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 cho th\u1ea5y b\u1ea5t \u0111\u1eb3ng th\u1ee9c Markov</li> <li>\u0110\u1ecbnh l\u00fd h\u1ed9i t\u1ee5 martingale Doob: \u0110\u00e2y l\u00e0 h\u1ec7 qu\u1ea3 cho r\u1eb1ng super-martingale b\u1ecb ch\u1eb7n d\u01b0\u1edbi s\u1ebd h\u1ed9i t\u1ee5 (g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn) th\u00e0nh m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean v\u1edbi k\u1ef3 v\u1ecdng h\u1eefu h\u1ea1n. L\u01b0u \u00fd r\u1eb1ng n\u1ebfu ta ch\u1eb7n tr\u01b0\u1eddng h\u1ee3p khi bi\u1ebfn s\u1ed1 ph\u00e2n k\u1ef3 \u0111\u1ebfn v\u00f4 h\u1ea1n theo ngh\u0129a n\u00e0o \u0111\u00f3, th\u00ec c\u00e1ch kh\u1ea3 d\u0129 kh\u00e1c \u0111\u1ec3 n\u00f3 kh\u00f4ng h\u1ed9i t\u1ee5 l\u00e0 dao \u0111\u1ed9ng. B\u1ea5t \u0111\u1eb3ng th\u1ee9c n\u00e0y \u0111\u1ea1i kh\u00e1i n\u00f3i r\u1eb1ng c\u00e1c martingale c\u00f3 gi\u1edbi h\u1ea1n th\u00ec kh\u00f4ng dao \u0111\u1ed9ng.</li> </ol>"},{"location":"Codeforces/math/martingales/#thoi-gian-dung-stopping-times","title":"Th\u1eddi gian d\u1eebng (Stopping times)","text":"<p>Th\u1eddi gian d\u1eebng kh\u00e1 l\u00e0 th\u00fa v\u1ecb trong to\u00e1n h\u1ecdc, v\u00e0 khi k\u1ebft h\u1ee3p v\u1edbi martingale, ch\u00fang s\u1ebd cho ra nhi\u1ec1u k\u1ebft qu\u1ea3 th\u00fa v\u1ecb kh\u00f4ng k\u00e9m v\u00e0 l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 r\u1ea5t m\u1ea1nh m\u1ebd.</p> <p>Gi\u1ea3 s\u1eed ta \u0111ang trong ho\u00e0n c\u1ea3nh c\u1ee7a ng\u01b0\u1eddi ch\u01a1i b\u1ea1c, v\u00e0 ta mu\u1ed1n vi\u1ebft m\u1ed9t thu\u1eadt to\u00e1n \u0111\u1ec3 k\u1ebft th\u00fac tr\u00f2 ch\u01a1i, tu\u1ef3 v\u00e0o m\u1ed9t s\u1ed1 k\u1ebft qu\u1ea3 nh\u1ea5t \u0111\u1ecbnh trong ti\u1ebfn tr\u00ecnh n\u00e0y. Th\u1eddi gian d\u1eebng l\u00e0 m\u1ed9t c\u00e1ch \u0111\u1ec3 ch\u00ednh th\u1ee9c ho\u00e1 ph\u00e2n t\u00edch khi \u0111\u1ea1t \u0111\u1ebfn c\u00e1c \u0111i\u1ec1u ki\u1ec7n tho\u00e1t nh\u01b0 v\u1eady. \u0110i\u1ec1u t\u1ed1t nh\u1ea5t m\u00e0 ta c\u00f3 th\u1ec3 l\u00e0m, d\u1ef1a tr\u00ean l\u00fd thuy\u1ebft hi\u1ec7n t\u1ea1i m\u00e0 ta c\u00f3, l\u00e0 \u0111\u1ecbnh ngh\u0129a n\u00f3 nh\u01b0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean (c\u00f3 th\u1ec3 ph\u1ee5 thu\u1ed9c ho\u1eb7c kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean). Ta c\u0169ng c\u00f3 h\u1ea1n ch\u1ebf l\u00e0 kh\u00f4ng th\u1ec3 th\u1ea5y tr\u01b0\u1edbc t\u01b0\u01a1ng lai, v\u00ec v\u1eady quy\u1ebft \u0111\u1ecbnh v\u1ec1 th\u1eddi \u0111i\u1ec3m d\u1eebng ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u01b0a ra v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c th\u00f4ng tin \u1edf th\u1eddi \u0111i\u1ec3m hi\u1ec7n t\u1ea1i.</p> <p>X\u00e9t m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \\(\\tau\\) (l\u1ea5y gi\u00e1 tr\u1ecb trong t\u1eadp \u0111\u00e1nh d\u1ea5u, l\u00e0 t\u1eadp ch\u1ee9a c\u00e1c s\u1ed1 nguy\u00ean kh\u00f4ng \u00e2m) tr\u00ean kh\u00f4ng gian x\u00e1c su\u1ea5t \\((\\Omega, \\mathcal{F}, P)\\), v\u00e0 gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean \\(X\\) tr\u00ean c\u00f9ng kh\u00f4ng gian x\u00e1c su\u1ea5t v\u1edbi b\u1ed9 l\u1ecdc li\u00ean quan \\(\\{\\mathcal{F}_i\\}\\). Ta g\u1ecdi \\(\\tau\\) l\u00e0 th\u1eddi gian d\u1eebng n\u1ebfu bi\u1ebfn c\u1ed1 \\(\\{\\tau = t\\}\\) l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1 trong \\(\\{\\mathcal{F}_t\\}\\). Ngh\u0129a l\u00e0, quy\u1ebft \u0111\u1ecbnh d\u1eebng \u1edf th\u1eddi \u0111i\u1ec3m \\(t\\) ph\u1ea3i \u0111\u01b0\u1ee3c \u0111\u01b0a v\u1edbi th\u00f4ng tin kh\u00f4ng nhi\u1ec1u h\u01a1n th\u00f4ng tin ta c\u00f3 \u1edf th\u1eddi \u0111i\u1ec3m \\(t\\). \u0110\u1ec3 gi\u1eef t\u00ednh nh\u1ea5t qu\u00e1n v\u1edbi vi\u1ec7c \u0111\u00e1nh d\u1ea5u s\u1ed1 th\u1ef1c, ta thay \u0111\u1ed5i \u0111i\u1ec1u ki\u1ec7n th\u00e0nh \\(\\{\\tau \\le t\\}\\) l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1 trong \\(\\{\\mathcal{F}_t\\}\\).</p> <p>\u0110\u1ec3 hi\u1ec3u t\u1ea1i sao \u0111i\u1ec1u n\u00e0y \u0111\u1ea3m b\u1ea3o vi\u1ec7c kh\u00f4ng h\u01b0\u1edbng t\u1edbi t\u01b0\u01a1ng lai, ta x\u00e9t nh\u01b0 sau. Nh\u00f3m c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(\\Omega\\) c\u00f3 th\u1eddi gian d\u1eebng \\(\\le t\\) l\u1ea1i v\u1edbi nhau, v\u1edbi \u0111i\u1ec1u ki\u1ec7n l\u00e0 ta kh\u00f4ng th\u1ec3 ph\u00e2n bi\u1ec7t ch\u00fang n\u1ebfu kh\u00f4ng c\u00f3 th\u00f4ng tin \u1edf th\u1eddi gian sau \\(t\\). T\u01b0\u01a1ng t\u1ef1, kh\u00f4ng th\u1ec3 x\u1ea3y ra tr\u01b0\u1eddng h\u1ee3p hai ph\u1ea7n t\u1eed c\u1ee7a \\(\\Omega\\) trong c\u00f9ng m\u1ed9t t\u1eadp t\u1ed1i thi\u1ec3u c\u1ee7a \\(\\mathcal{F}_t\\) c\u00f3 th\u1eddi gian d\u1eebng kh\u00e1c nhau, khi kh\u00f4ng ph\u1ea3i c\u1ea3 hai \u0111\u1ec1u \\(&gt; t\\). Trong v\u00ed d\u1ee5 tung \u0111\u1ed3ng xu c\u1ee7a ch\u00fang ta, \u0111i\u1ec1u sau s\u1ebd h\u1ee3p l\u00fd n\u1ebfu b\u1ea1n ngh\u0129 v\u1ec1 l\u00fd do v\u00ec sao b\u1ea1n kh\u00f4ng c\u00f3 th\u1eddi gian d\u1eebng cho 000010110... = 4 v\u00e0 cho 000011000... = 6.</p> <p>M\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 ch\u00ednh th\u1ee9c ho\u00e1 \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 l\u00e0 n\u00f3i r\u1eb1ng ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean (bi\u1ec3u th\u1ecb vi\u1ec7c d\u1eebng m\u1ed9t ti\u1ebfn tr\u00ecnh) \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi \\(Y_t = 0\\) n\u1ebfu \\(\\tau &lt; t\\) v\u00e0 \\(1\\), n\u1ebfu kh\u00f4ng th\u00ec l\u00e0 m\u1ed9t ti\u1ebfn tr\u00ecnh th\u00edch \u1ee9ng \u0111\u1ed1i v\u1edbi b\u1ed9 l\u1ecdc, ngh\u0129a l\u00e0 \\(\\sigma(Y_t) \\subseteq \\mathcal{F}_t\\) v\u1edbi m\u1ecdi \\(t\\).</p> <p>V\u00ec th\u1eddi gian d\u1eebng l\u00e0 m\u1ed9t ch\u1ec9 s\u1ed1, n\u00ean ta c\u00f3 th\u1ec3 ngh\u0129 c\u00e1ch \u0111\u00e1nh d\u1ea5u ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean v\u1edbi m\u1ed9t s\u1ed1 h\u00e0m c\u1ee7a th\u1eddi gian d\u1eebng. N\u1ebfu ta quay v\u1ec1 \u0111\u1ecbnh ngh\u0129a bi\u1ebfn ng\u1eabu nhi\u00ean, r\u00f5 r\u00e0ng l\u00e0 ta c\u1ea7n g\u00e1n m\u1ed9t gi\u00e1 tr\u1ecb cho n\u00f3 \u1edf m\u1ecdi ph\u1ea7n t\u1eed trong \\(\\Omega\\). Trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p \u0111\u01a1n gi\u1ea3n, \u0111i\u1ec1u n\u00e0y kh\u00f4ng quan tr\u1ecdng, v\u00ec ta c\u00f3 th\u1ec3 t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a \\(\\tau\\) \u1edf t\u1eadp t\u1ed1i thi\u1ec3u c\u00f3 ph\u1ea7n t\u1eed n\u00e0y (cho gi\u00e1 tr\u1ecb n\u00e0y l\u00e0 \\(t\\)), v\u00e0 t\u00ednh l\u1ea1i gi\u00e1 tr\u1ecb \\(X_t\\) \u1edf t\u1eadp t\u1ed1i thi\u1ec3u. T\u1eeb \u0111\u00e2y, r\u00f5 r\u00e0ng \\(X_{\\tau}\\) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean tr\u00ean kh\u00f4ng gian x\u00e1c su\u1ea5t g\u1ed1c, v\u00e0 n\u00f3 th\u1ec3 hi\u1ec7n gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t ti\u1ebfn tr\u00ecnh ng\u1eabu nhi\u00ean khi k\u1ebft th\u00fac ti\u1ebfn tr\u00ecnh. C\u0169ng l\u01b0u \u00fd r\u1eb1ng v\u1edbi l\u00fd do tr\u00ean, \\(X_{\\min(\\tau, t)}\\) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean c\u00f3 \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 l\u00e0 t\u1eadp con c\u1ee7a \\(\\mathcal{F}_t\\). \\(X_{\\min(\\tau, t)}\\) \u1ee9ng v\u1edbi m\u1ed9t ti\u1ebfn tr\u00ecnh \u0111\u00e3 d\u1eebng. ngh\u0129a l\u00e0 ta \u0111\u00e3 d\u1eebng m\u1ed9t ti\u1ebfn t\u00ecnh sau khi qu\u00e1 th\u1eddi gian cho ph\u00e9p. \u0110\u00e2y l\u00e0 nh\u1eefng lo\u1ea1i ti\u1ebfn tr\u00ecnh r\u1ea5t quan tr\u1ecdng v\u00e0 \u0111\u00e3 \u0111\u01b0\u1ee3c nghi\u00ean c\u1ee9u r\u1ed9ng r\u00e3i.</p> <p>C\u00e1i hay c\u1ee7a martingale v\u00e0 th\u1eddi gian d\u1eebng l\u00e0 ch\u00fang \u0111\u01b0\u1eddng nghi\u00ean c\u1ee9u r\u1ea5t nhi\u1ec1u, v\u00e0 c\u00f3 m\u1ed9t s\u1ed1 k\u1ebft qu\u1ea3 quan tr\u1ecdng m\u00e0 m\u00ecnh s\u1ebd ghi ra \u1edf \u0111\u00e2y (kh\u00f4ng ch\u1ee9ng minh), ch\u00fang c\u00f3 th\u1ec3 gi\u00fap ta gi\u1ea3i r\u1ea5t nhi\u1ec1u b\u00e0i to\u00e1n c\u0169ng nh\u01b0 x\u00e2y d\u1ef1ng m\u1ed9t hi\u1ec3u bi\u1ebft xung quang martingale v\u00e0 th\u1eddi gian d\u1eebng:</p> <ol> <li>\u0110\u1ecbnh l\u00fd gi\u1edbi h\u1ea1n trung t\u00e2m martingale: \u0110\u00e2y l\u00e0 s\u1ef1 t\u1ed5ng qu\u00e1t ho\u00e1 c\u1ee7a \u0111\u1ecbnh l\u00fd gi\u1edbi h\u1ea1n trung t\u00e2m th\u00f4ng th\u01b0\u1eddng \u0111\u1ed1i v\u1edbi martingale. Ti\u1ebfn tr\u00ecnh li\u00ean quan l\u00e0 m\u1ed9t martingale b\u00ecnh th\u01b0\u1eddng, nh\u01b0ng v\u1edbi s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa c\u00e1c gi\u00e1 tr\u1ecb li\u00ean ti\u1ebfp \u0111\u01b0\u1ee3c gi\u1edbi h\u1ea1n b\u1edfi m\u1ed9t gi\u1edbi h\u1ea1n g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn c\u1ed1 \u0111\u1ecbnh. Ta ch\u1ecdn th\u1eddi \u0111i\u1ec3m d\u1eebng nh\u01b0 sau: t\u1ea1i m\u1ed7i b\u01b0\u1edbc \\(i + 1\\), ta t\u00ednh ph\u01b0\u01a1ng sai c\u00f3 \u0111i\u1ec1u ki\u1ec7n c\u1ee7a \\(X_{i + 1}\\) \u0111\u1ed1i v\u1edbi \\(\\mathcal{F}_i\\), v\u00e0 ti\u1ebfp t\u1ee5c th\u00eam n\u00f3 v\u00e0o b\u1ed9 \u0111\u1ebfm. D\u1eebng khi b\u1ed9 \u0111\u1ebfm l\u1edbn h\u01a1n m\u1ed9t gi\u00e1 tr\u1ecb nh\u1ea5t \u0111\u1ecbnh \\(\\sigma^2\\) (theo ngh\u0129a n\u00e0o \u0111\u00f3, ta \u0111ang \u0111\u1ee3i cho \u0111\u1ebfn khi l\u1ea5y \u0111\u01b0\u1ee3c ph\u01b0\u01a1ng sai \u0111\u1ee7 l\u1edbn). N\u1ebfu th\u1eddi gian d\u1eebng l\u00e0 \\(\\tau_\\sigma\\), th\u00ec bi\u1ebfn ng\u1eabu nhi\u00ean \\(X_{\\tau_\\sigma} / \\sigma\\) h\u1ed9i t\u1ee5 t\u1ea1i m\u1ed9t bi\u1ebfn ph\u00e2n ph\u1ed1i chu\u1ea9n v\u1edbi trung b\u00ecnh l\u00e0 \\(0\\) v\u00e0 ph\u01b0\u01a1ng sai \\(1\\), v\u00ec \\(\\sigma\\) c\u00f3 xu h\u01b0\u1edbng \u0111\u1ebfn \\(\\inf\\). \u0110i\u1ec1u n\u00e0y c\u0169ng gi\u1ea3 \u0111\u1ecbnh r\u1eb1ng t\u1ed5ng ph\u01b0\u01a1ng sai ph\u00e2n k\u1ef3.</li> <li>\u0110\u1ecbnh l\u00fd d\u1eebng tu\u1ef3 ch\u1ecdn Doob: \u0110\u00e2y l\u00e0 m\u1ed9t \u0111\u1ecbnh l\u00fd r\u1ea5t quan tr\u1ecdng, v\u00e0 r\u1ea5t h\u1eefu \u00edch cho vi\u1ec7c t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a th\u1eddi gian d\u1eebng. N\u00f3 n\u00f3i v\u1ec1 s\u1ef1 c\u00f4ng b\u1eb1ng c\u1ee7a martingale khi ta d\u1eebng sau m\u1ed9t th\u1eddi gian d\u1eebng ng\u1eabu nhi\u00ean, theo ngh\u0129a ta \u0111\u00e3 ph\u00e1t tri\u1ec3n \u1edf tr\u00ean. Ta s\u1ebd c\u00f3 \\(E[X_\\tau] = E[X_0]\\), v\u00e0 ho\u00e1 ra \u0111i\u1ec1u n\u00e0y \u0111\u00fang n\u1ebfu m\u1ed9t trong ba \u0111i\u1ec1u ki\u1ec7n sau tho\u1ea3 m\u00e3n:<ul> <li>Th\u1eddi gian d\u1eebng \\(\\tau\\) b\u1ecb ch\u1eb7n tr\u00ean.</li> <li>Martingale b\u1ecb ch\u1eb7n v\u00e0 th\u1eddi gian d\u1eebng \\(\\tau\\) g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn h\u1eefu h\u1ea1n (\\(P(\\tau = \\infty) = 0\\)).</li> <li>Gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a \\(\\tau\\) h\u1eefu h\u1ea1n, v\u00e0 hi\u1ec7u \\(X_{i+1}\\) v\u00e0 \\(X_i\\) b\u1ecb ch\u1eb7n. L\u01b0u \u00fd r\u1eb1ng \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 t\u00ednh th\u1eddi gian d\u1eebng n\u1ebfu ta thay \u0111\u1ed5i martingale m\u1ed9t ch\u00fat, ta s\u1ebd th\u1ea5y sau.</li> </ul> </li> </ol>"},{"location":"Codeforces/math/martingales/#mot-so-bai-tap-toan","title":"M\u1ed9t s\u1ed1 b\u00e0i t\u1eadp to\u00e1n","text":"<p>Ta b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t s\u1ed1 b\u00e0i to\u00e1n m\u00e0 t\u00f4i \u0111\u00e3 g\u1eb7p trong nh\u1eefng n\u0103m qua (xin l\u1ed7i v\u00ec kh\u00f4ng nh\u1edb ngu\u1ed3n c\u1ee7a m\u1ed9t s\u1ed1 b\u00e0i).</p>"},{"location":"Codeforces/math/martingales/#bai-1","title":"B\u00e0i 1","text":"<p>Cho m\u1ed9t bet th\u1ee7 c\u00f3 \\(n\\) dollar v\u00e0 c\u00e1 c\u01b0\u1ee3c v\u00f4 s\u1ed1 l\u1ea7n. Ph\u1ea7n th\u01b0\u1edfng v\u00f2ng \\(i\\) l\u00e0 \\(X_t\\), v\u1edbi \\(X_t\\) l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean b\u1ecb ch\u1eb7n hai \u0111\u1ea7u b\u1edfi m\u1ed9t s\u1ed1 h\u1eb1ng s\u1ed1 x\u00e1c \u0111\u1ecbnh. Ta bi\u1ebft \\(E[X_t|X_{t-1},\\cdots,X_1]\\geq c\\) v\u1edbi \\(c &gt; 0\\). Gi\u1ea3 s\u1eed x\u00e1c su\u1ea5t bet th\u1ee7 n\u00e0y h\u1ebft ti\u1ec1n l\u00e0 \\(p(n)\\). C\u00f3 khi n\u00e0o \\(\\lim_{n\\rightarrow \\infty}p(n)=0\\) kh\u00f4ng?</p> L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>D\u00f9ng b\u1ea5t \u0111\u1eb3ng th\u1ee9c Azuma b\u1eb1ng c\u00e1ch x\u00e2y d\u1ef1ng sub-martingale b\u1eb1ng v\u1edbi t\u00e0i s\u1ea3n \u1edf th\u1eddi gian \\(t\\) tr\u1eeb \u0111i \\(ct\\).</p>"},{"location":"Codeforces/math/martingales/#bai-2","title":"B\u00e0i 2","text":"<p>Cho m\u1ed9t b\u1ea3ng v\u00f4 h\u1ea1n, v\u1edbi m\u1ed9t s\u1ed1 th\u1ef1c kh\u00f4ng \u00e2m \u1edf m\u1ed7i \u00f4. Gi\u1ea3 s\u1eed r\u1eb1ng v\u1edbi m\u1ed7i \u00f4, s\u1ed1 trong \u0111\u00f3 l\u00e0 trung b\u00ecnh c\u1ee7a 4 \u00f4 li\u1ec1n k\u1ec1. Ch\u1ee9ng minh t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 b\u1eb1ng nhau.</p> L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>X\u00e2y d\u1ef1ng m\u1ed9t martingale, v\u1edbi ti\u1ebfn tr\u00ecnh b\u00ean d\u01b0\u1edbi l\u00e0 vi\u1ec7c \u0111i b\u1ed9 ng\u1eabu nhi\u00ean v\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean l\u00e0 s\u1ed1 tr\u00ean \u00f4 \u0111ang \u0111\u1ee9ng. Gi\u1edd d\u00f9ng \u0111\u1ecbnh l\u00fd h\u1ed9i t\u1ee5 martingale, v\u00e0 b\u1ea1n c\u00f3 th\u1ec3 ph\u1ea3i d\u00f9ng th\u00eam lu\u1eadt kh\u00f4ng-m\u1ed9t Hewitt-Savage d\u1ef1a tr\u00ean c\u00e1ch b\u1ea1n d\u00f9ng h\u1ed9i t\u1ee5.</p>"},{"location":"Codeforces/math/martingales/#bai-3-usa-imo-2018-winter-tst-1-p2","title":"B\u00e0i 3 (USA IMO 2018 Winter TST 1, P2)","text":"<p>T\u00ecm t\u1ea5t c\u1ea3 c\u00e1c h\u00e0m \\(f\\colon \\mathbb{Z}^2 \\to [0, 1]\\) m\u00e0 v\u1edbi b\u1ea5t k\u1ef3 s\u1ed1 nguy\u00ean \\(x\\), \\(y\\) n\u00e0o,</p> \\[f(x, y) = \\frac{f(x - 1, y) + f(x, y - 1)}{2}\\] L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>X\u00e2y d\u1ef1ng m\u1ed9t martingale t\u01b0\u01a1ng t\u1ef1 b\u00e0i tr\u01b0\u1edbc.</p>"},{"location":"Codeforces/math/martingales/#bai-4-2022-putnam-a4","title":"B\u00e0i 4 (2022 Putnam A4)","text":"<p>Gi\u1ea3 s\u1eed \\(X_1, X_2, \\ldots\\) l\u00e0 c\u00e1c s\u1ed1 th\u1ef1c trong kho\u1ea3ng \\([0, 1]\\) \u0111\u01b0\u1ee3c ch\u1ecdn \u0111\u1ed9c l\u1eadp v\u00e0 ng\u1eabu nhi\u00ean. Cho \\(S=\\sum_{i=1}^kX_i/2^i\\), v\u1edbi \\(k\\) l\u00e0 s\u1ed1 nguy\u00ean d\u01b0\u01a1ng nh\u1ecf nh\u1ea5t m\u00e0 \\(X_k &lt; X_{k+1}\\), ho\u1eb7c \\(k = \\inf\\) n\u1ebfu kh\u00f4ng c\u00f3 s\u1ed1 nguy\u00ean n\u00e0o nh\u01b0 v\u1eady. T\u00ecm gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a \\(S\\).</p> L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>Bi\u1ebfn t\u1ed5ng t\u1eebng ph\u1ea7n \\(S_n\\) th\u00e0nh m\u1ed9t martingale. C\u00e1ch d\u1ec5 nh\u1ea5t l\u00e0 tr\u1eeb \u0111i k\u00ec v\u1ecdng c\u1ee7a n\u00f3, sau \u0111\u00f3 ki\u1ec3m tra xem n\u00f3 c\u00f3 th\u1ef1c s\u1ef1 tr\u1edf th\u00e0nh m\u1ed9t martingale hay kh\u00f4ng. Gi\u1edd x\u00e1c \u0111\u1ecbnh th\u1eddi gian d\u1eebng c\u00f3 li\u00ean quan m\u1ed9t c\u00e1ch t\u1ef1 nhi\u00ean b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh trong b\u00e0i t\u1eadp, v\u00e0 \u00e1p d\u1ee5ng \u0111\u1ecbnh l\u00fd d\u1eebng tu\u1ef3 ch\u1ecdn c\u1ee7a Doob.</p>"},{"location":"Codeforces/math/martingales/#bai-5-agmc-2021-p1","title":"B\u00e0i 5 (AGMC 2021 P1)","text":"<p>Trong m\u1ed9t b\u1eefa ti\u1ec7c nh\u1ea3y, ban \u0111\u1ea7u h\u1ed3 b\u01a1i g\u1ed3m 20 n\u1eef m\u00e0 22 nam, v\u00e0 c\u00f3 nhi\u1ec1u nam n\u1eef n\u1eefa \u0111ang ch\u1edd \u1edf ngo\u00e0i. \u1ede m\u1ed7i v\u00f2ng, m\u1ed9t ng\u01b0\u1eddi trong h\u1ed3 b\u01a1i \u0111\u01b0\u1ee3c ch\u1ecdn ng\u1eabu nhi\u00ean. N\u1ebfu b\u1ea1n n\u1eef \u0111\u01b0\u1ee3c ch\u1ecdn, b\u1ea1n \u0111\u00f3 s\u1ebd m\u1eddi m\u1ed9t b\u1ea1n nam trong h\u1ed3 \u0111\u1ec3 nh\u1ea3y c\u00f9ng v\u00e0 c\u1ea3 hai r\u1eddi kh\u1ecfi bu\u1ed5i ti\u1ec7c sau khi nh\u1ea3y xong. N\u1ebfu b\u1ea1n nam \u0111\u01b0\u1ee3c ch\u1ecdn, b\u1ea1n \u0111\u00f3 s\u1ebd m\u1eddi m\u1ed9t b\u1ea1n n\u1eef v\u00e0 m\u1ed9t b\u1ea1n nam \u0111\u1ee3i \u1edf ngo\u00e0i \u0111\u1ec3 nh\u1ea3y c\u00f9ng, sau \u0111\u00f3 c\u1ea3 3 b\u1ea1n \u1edf l\u1ea1i bu\u1ed5i ti\u1ec7c. Bu\u1ed5i ti\u1ec7c k\u1ebft th\u00fac khi ch\u1ec9 c\u00f2n (hai b\u1ea1n) nam trong h\u1ed3 b\u01a1i.</p> <p>(a) X\u00e1c su\u1ea5t \u0111\u1ec3 bu\u1ed5i ti\u1ec7c kh\u00f4ng bao gi\u1edd k\u1ebft th\u00fac l\u00e0 bao nhi\u00eau?</p> <p>(b) Ng\u01b0\u1eddi qu\u1ea3n l\u00fd ti\u1ec7c quy\u1ebft \u0111\u1ecbnh \u0111\u1ea3o ng\u01b0\u1ee3c lu\u1eadt, ngh\u0129a l\u00e0 n\u1ebfu b\u1ea1n n\u1eef \u0111\u01b0\u1ee3c ch\u1ecdn, b\u1ea1n \u0111\u00f3 s\u1ebd m\u1eddi m\u1ed9t b\u1ea1n n\u1eef v\u00e0 m\u1ed9t b\u1ea1n nam \u0111\u1ee3i \u1edf ngo\u00e0i \u0111\u1ec3 nh\u1ea3y c\u00f9ng, sau \u0111\u00f3 c\u1ea3 3 b\u1ea1n \u1edf l\u1ea1i bu\u1ed5i ti\u1ec7c. N\u1ebfu b\u1ea1n nam \u0111\u01b0\u1ee3c ch\u1ecdn, b\u1ea1n \u0111\u00f3 s\u1ebd m\u1eddi m\u1ed9t b\u1ea1n n\u1eef trong h\u1ed3 \u0111\u1ec3 nh\u1ea3y c\u00f9ng v\u00e0 c\u1ea3 hai r\u1eddi kh\u1ecfi bu\u1ed5i ti\u1ec7c sau khi nh\u1ea3y xong. Bu\u1ed5i ti\u1ec7c k\u1ebft th\u00fac khi ch\u1ec9 c\u00f2n (hai b\u1ea1n) nam trong h\u1ed3 b\u01a1i. Gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a s\u1ed1 v\u00f2ng m\u00e0 bu\u1ed5i ti\u1ec7c c\u00f3 th\u1ec3 c\u00f3 l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>D\u00f9ng ph\u00e9p l\u1eb7p l\u1ea1i \u0111\u1ec3 gi\u1ea3i (a). V\u1edbi (b), l\u01b0u \u00fd r\u1eb1ng s\u1ef1 l\u1eb7p l\u1ea1i thay \u0111\u1ed5i m\u1ed9t ch\u00fat. G\u1ecdi \\(X_n\\) l\u00e0 t\u1ed5ng s\u1ed1 ng\u01b0\u1eddi trong nh\u00f3m. C\u00f3 m\u1ed9t \\(c\\) sao cho \\(X_n^2 + cn\\) l\u00e0 m\u1ed9t martingale kh\u00f4ng? Gi\u1edd \u00e1p d\u1ee5ng \u0110\u1ecbnh l\u00fd d\u1eebng tu\u1ef3 ch\u1ecdn Doob v\u00e0 xem \u0111i\u1ec1u g\u00ec x\u1ea3y ra.</p>"},{"location":"Codeforces/math/martingales/#bai-6","title":"B\u00e0i 6","text":"<p>Cho m\u1ed9t con kh\u1ec9 \u0111\u00e1nh ph\u00edm ng\u1eabu nhi\u00ean tr\u00ean m\u1ed9t c\u00e1i b\u00e0n ph\u00edm c\u00f3 b\u1ea3ng ch\u1eef c\u00e1i l\u00e0 \\(\\Sigma\\). V\u1edbi m\u1ed9t x\u00e2u \\(w\\in\\Sigma^*\\), g\u1ecdi \\(w_1,\\dots,w_n\\) l\u00e0 c\u00e1c x\u00e2u kh\u00f4ng r\u1ed7ng \u0111\u1ed3ng th\u1eddi l\u00e0 ti\u1ec1n t\u1ed1 v\u00e0 h\u1eadu t\u1ed1 c\u1ee7a \\(w\\). Ch\u1ee9ng minh k\u00ec v\u1ecdng s\u1ed1 l\u1ea7n b\u1ea5m ph\u00edm c\u1ee7a con kh\u1ec9 c\u1ea7n l\u00e0m l\u00e0 \\(\\sum_{i=1}^n|\\Sigma|^{|w_i|}\\).</p> L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>C\u00f3 hai c\u00e1ch t\u1ea1o martingale \u1edf \u0111\u00e2y. Nh\u00ecn v\u00e0o h\u1eadu t\u1ed1 c\u1ee7a k\u00edch th\u01b0\u1edbc \\(\\min(\\text{number of steps}, |w|)\\). Ta t\u1ea1o m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean nh\u01b0 sau: v\u1edbi m\u1ecdi h\u1eadu t\u1ed1 hi\u1ec7n t\u1ea1i \\(s_i\\) m\u00e0 c\u0169ng l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a \\(w\\), bi\u1ebfn ng\u1eabu nhi\u00ean b\u1eb1ng v\u1edbi \\(\\sum_{s_i} |\\Sigma|^{|s_i|}\\). H\u00e3y xem \u0111i\u1ec1u g\u00ec x\u1ea3y ra khi ta th\u00eam k\u00ed t\u1ef1 m\u1edbi v\u00e0o, \u0111\u00f3 c\u00f3 ph\u1ea3i l\u00e0 martingale kh\u00f4ng? Ta c\u00f3 th\u1ec3 l\u00e0m g\u00ec \u0111\u1ec3 t\u1ea1o m\u1ed9t c\u00e1i kh\u00f4ng? Gi\u1edd d\u00f9ng \u0111\u1ecbnh l\u00fd d\u1eebng tu\u1ef3 ch\u1ecdn Doob xem.</p> <p>M\u1ed9t c\u00e1ch t\u1ef1 nhi\u00ean h\u01a1n l\u00e0 th\u00f4ng qua c\u00e1ch nh\u00ecn c\u00e1 c\u01b0\u1ee3c. Gi\u1ea3 s\u1eed \u1edf m\u1ed7i th\u1eddi \u0111i\u1ec3m \\(t\\), m\u1ed9t bet th\u1ee7 m\u1edbi \u0111\u1ebfn v\u00e0 tr\u1ea3 \\(1\\) \u0111\u1ec3 ch\u01a1i. Anh ta t\u00e1i \u0111\u1ea7u t\u01b0 l\u1ea7n c\u01b0\u1ee3c (\\(|\\Sigma|\\) l\u1ea7n so v\u1edbi l\u1ea7n c\u01b0\u1ee3c tr\u01b0\u1edbc) n\u1ebfu ch\u1eef c\u00e1i ti\u1ebfp theo l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a ti\u1ec1n t\u1ed1 khi anh ta b\u1eaft \u0111\u1ea7u ch\u01a1i. N\u1ebfu anh ta thua, anh ta ngh\u1ec9 v\u00e0 kh\u00f4ng l\u00e0m g\u00ec. Gi\u1edd th\u00ec n\u00f3 l\u00e0 martingale, v\u00e0 t\u1ed5ng ti\u1ec1n m\u00e0 t\u1ea5t c\u1ea3 bet th\u1ee7 tr\u1ea3 cho nh\u00e0 c\u00e1i l\u00e0 gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a th\u1eddi gian d\u1eebng.</p> <p>M\u1ed9t c\u00e1ch gi\u1ea3i kh\u00e1c cho b\u00e0i n\u00e0y l\u00e0 \u1edf \u0111\u00e2y</p>"},{"location":"Codeforces/math/martingales/#bai-7-alon-spencer","title":"B\u00e0i 7 (Alon, Spencer)","text":"<p>Cho \u0111\u1ed3 th\u1ecb \\(G=(V,E)\\) v\u1edbi s\u1ed1 m\u00e0u \\(\\chi(G)=1000\\). G\u1ecdi \\(U \\subseteq V\\) l\u00e0 t\u1eadp con ng\u1eabu nhi\u00ean c\u1ee7a \\(V\\) \u0111\u01b0\u1ee3c ch\u1ecdn t\u1eeb t\u1ea5t c\u1ea3 \\(2^{|V|}\\) t\u1eadp con c\u1ee7a \\(V\\). G\u1ecdi \\(H=G[U]\\) l\u00e0 \u0111\u1ed3 th\u1ecb con suy bi\u1ebfn c\u1ee7a \\(G\\) tr\u00ean \\(U\\). Ch\u1ee9ng minh r\u1eb1ng x\u00e1c su\u1ea5t \\(H\\) c\u00f3 m\u1ed9t s\u1ed1 m\u00e0u \\(\\le 400\\) nh\u1ecf h\u01a1n \\(0.01\\).</p> L\u1eddi gi\u1ea3i s\u01a1 b\u1ed9 <p>G\u1ecdi \\(J\\) l\u00e0 \u0111\u1ed3 th\u1ecb con suy bi\u1ebfn tr\u00ean \\(V \\ U\\). Th\u00ec r\u00f5 r\u00e0ng \\(\\chi(H) + \\chi(J) \\ge 1000\\), ng\u01b0\u1ee3c l\u1ea1i ta c\u00f3 th\u1ec3 c\u00f3 vi\u1ec7c t\u00f4 m\u00e0u t\u1ed1t h\u01a1n c\u1ee7a \\(G\\) so v\u1edbi vi\u1ec7c t\u00f4 m\u00e0u t\u1ed1i \u01b0u. L\u01b0u \u00fd l\u00e0 vi\u1ec7c ch\u1ecdn \\(U\\) v\u00e0 \\(V \\ U\\) l\u00e0 g\u1ea7n nh\u01b0 b\u1eb1ng nhau, n\u00ean gi\u00e1 tr\u1ecb k\u00ec v\u1ecdng c\u1ee7a \\(\\chi(H)\\) l\u00e0 \u00edt nh\u1ea5t \\(500\\). Gi\u1edd ta th\u1eed d\u00f9ng b\u1ea5t \u0111\u1eb1ng th\u1ee9c Azuma \u1edf \u0111\u00e2y. Nh\u01b0ng l\u00e0m sao t\u1ea1o m\u1ed9t martingale \u0111\u00e2y?</p> <p>Nh\u1edb l\u1ea1i l\u00e0 n\u1ebfu ta b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean tr\u00ean m\u1ed9t kh\u00f4ng gian x\u00e1c su\u1ea5t \\((\\Omega, \\mathcal{F}, P)\\) v\u1edbi b\u1ed9 l\u1ecdc \\(\\mathcal{F}_i\\) v\u1edbi m\u1ecdi th\u1ee9 l\u00e0 t\u1eadp con c\u1ee7a \\(\\mathcal{F}\\), \\(E[X | \\mathcal{F}_i]\\) l\u00e0 m\u1ed9t martingale. T\u1eadn d\u1ee5ng th\u1ef1c t\u1ebf l\u00e0 ta \u0111\u00e3 \u0111\u01b0\u1ee3c cung c\u1ea5p l\u1ea1i s\u1ed1 m\u00e0u c\u1ee7a \u0111\u1ed3 th\u1ecb. X\u00e9t vi\u1ec7c t\u00f4 m\u00e0u \u0111\u1ed3 th\u1ecb v\u00e0 ph\u00e2n chia n\u00f3 th\u00e0nh c\u00e1c t\u1eadp \\(P_i\\) \u0111\u01b0\u1ee3c ph\u00e2n \u0111\u1ecbnh b\u1edfi c\u00e1c m\u00e0u c\u1ee7a c\u00e1c \u0111\u1ec9nh. Gi\u1edd h\u00e3y xem x\u00e9t qu\u1ea3 tr\u00ecnh l\u1ecdc m\u00e0 s\u1ebd cho th\u1ea5y \\(U \\cap P_i\\) l\u1ea7n l\u01b0\u1ee3t (c\u00e1c t\u1eadp n\u00e0y \u0111\u1ed9c l\u1eadp). L\u01b0u \u00fd r\u1eb1ng s\u1ef1 thay \u0111\u1ed5i s\u1ed1 m\u00e0u s\u1ebd nhi\u1ec1u nh\u1ea5t ch\u1ec9 l\u00e0 \\(1\\). N\u00ean theo b\u1ea5t \u0111\u1eb3ng th\u1ee9c Azuma, \\(P(\\chi(H) \\le 400) &lt; P(\\chi(H) - e \\le -100) \\le \\exp(-100^2/(2 \\cdot 1000))\\), v\u1edbi \\(e\\) l\u00e0 k\u00ec v\u1ecdng s\u1ed1 m\u00e0u c\u1ee7a \\(H\\).</p>"},{"location":"Codeforces/math/martingales/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"<p>G\u1ea7n nh\u01b0 t\u1ea5t c\u1ea3 c\u00e1c b\u00e0i t\u1eadp CP trong ph\u1ea7n n\u00e0y m\u00e0 t\u00f4i bi\u1ebft \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp trong blog n\u00e0y v\u00e0 solution c\u1ee7a b\u00e0i 1479E gi\u1ea3i th\u00edch \u00fd ch\u00ednh h\u01a1i kh\u00e1c m\u1ed9t t\u00ed. M\u00ecnh s\u1ebd kh\u00f4ng l\u1eb7p l\u1ea1i nh\u1eefng \u0111i\u1ec1u \u0111\u00f3 (c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh s\u1ebd d\u1ec5 hi\u1ec3u n\u1ebfu b\u1ea1n hi\u1ec3u \u0111\u01b0\u1ee3c c\u00e1ch ti\u1ebfp c\u1eadn to\u00e1n h\u1ecdc v\u1edbi c\u00e1c b\u00e0i t\u1eadp to\u00e1n \u1edf tr\u00ean), nh\u01b0ng m\u00ecnh v\u1eabn ghi c\u00e1c b\u00e0i m\u00e0 h\u1ecd ch\u1ec9 ra \u1edf \u0111\u00e2y c\u0169ng nh\u01b0 c\u00e1c b\u00e0i xu\u1ea5t hi\u1ec7n sau \u0111\u00f3 (theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c th\u1eddi gian).</p> Problem Status Submission Code Date 1575F - Finding Expected Value 1479E - School Clubs 1392H - ZS Shuffles Cards 1349D - Slime and Biscuits 1025G - Company Acquisitions 850F - Rainbow Balls USACO 2018 \u2014 Balance Beam"},{"location":"Codeforces/math/permutations-for-beginners/","title":"Ho\u00e1n v\u1ecb cho ng\u01b0\u1eddi m\u1edbi b\u1eaft \u0111\u1ea7u","text":""},{"location":"Codeforces/math/permutations-for-beginners/#hoan-vi-cho-nguoi-moi-bat-au","title":"Ho\u00e1n v\u1ecb cho ng\u01b0\u1eddi m\u1edbi b\u1eaft \u0111\u1ea7u","text":""},{"location":"Codeforces/math/permutations-for-beginners/#nguon","title":"Ngu\u1ed3n","text":"<p> [Tutorial] A comprehensive guide to permutations for beginners</p>"},{"location":"Codeforces/math/permutations-for-beginners/#inh-nghia-cac-tinh-chat-co-ban-va-cac-ky-hieu","title":"\u0110\u1ecbnh ngh\u0129a, c\u00e1c t\u00ednh ch\u1ea5t c\u01a1 b\u1ea3n v\u00e0 c\u00e1c k\u00fd hi\u1ec7u","text":""},{"location":"Codeforces/math/permutations-for-beginners/#inh-nghia","title":"\u0110\u1ecbnh ngh\u0129a","text":"<p>\u0110\u1ec3 b\u1eaft \u0111\u1ea7u th\u00ec ta s\u1ebd c\u00f9ng xem x\u00e9t \u0111\u1ecbnh ngh\u0129a c\u1ee7a ho\u00e1n v\u1ecb m\u00e0 ch\u1eafc b\u1ea1n \u0111\u00e3 th\u1ea5y r\u1ea5t nhi\u1ec1u l\u1ea7n tr\u00ean Codeforces.</p> <p>\u0110\u1ecbnh ngh\u0129a: M\u1ed9t ho\u00e1n v\u1ecb k\u00edch th\u01b0\u1edbc \\(n\\) l\u00e0 m\u1ed9t m\u1ea3ng k\u00edch th\u01b0\u1edbc \\(n\\) ch\u1ee9a c\u00e1c s\u1ed1 nguy\u00ean t\u1eeb \\(1\\) \u0111\u1ebfn \\(n\\) m\u00e0 m\u1ed7i s\u1ed1 ch\u1ec9 xu\u1ea5t hi\u1ec7n \u0111\u00fang m\u1ed9t l\u1ea7n.</p> <p>Nh\u01b0ng t\u1ea1i sao ta l\u1ea1i quan t\u00e2m \u0111\u1ebfn m\u1ea5y c\u00e1i m\u1ea3ng hay d\u00e3y s\u1ed1 nh\u01b0 th\u1ebf? L\u00fd do th\u1ef1c ra kh\u00e1 \u0111\u01a1n gi\u1ea3n.</p> <p>X\u00e9t d\u00e3y \\(a\\) ch\u1ee9a \\(n\\) s\u1ed1 nguy\u00ean. Ta c\u00f3 th\u1ec3 \u0111\u00e1nh d\u1ea5u ch\u00fang v\u1edbi c\u00e1c s\u1ed1 nguy\u00ean t\u1eeb \\(1\\) \u0111\u1ebfn \\(n\\), v\u1eady s\u1ed1 nguy\u00ean th\u1ee9 \\(i\\) trong d\u00e3y l\u00e0 \\(a_i\\). \u0110\u1ec3 hi\u1ec3u nh\u1eefng \u0111i\u1ec1u sau \u0111\u00e2y, s\u1ebd r\u1ea5t h\u1eefu \u00edch khi ta x\u00e9t v\u00ed d\u1ee5 v\u1edbi \\(a_i = i\\) v\u1edbi m\u1ecdi \\(i\\).</p> <p>Gi\u1edd ta x\u00e1o m\u1ea3ng n\u00e0y l\u00ean (m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed c\u00f3 th\u1ec3 \u1edf y\u00ean t\u1ea1i ch\u1ed7 sau khi x\u00e1o). Ta s\u1ebd t\u1ea1o m\u1ed9t ho\u00e1n v\u1ecb t\u1eeb vi\u1ec7c x\u00e1o n\u00e0y theo hai c\u00e1ch:</p> <ol> <li>Ch\u1ec9 s\u1ed1 c\u1ee7a ph\u1ea7n t\u1eed l\u00fac \u0111\u1ea7u \u1edf v\u1ecb tr\u00ed \\(i\\) l\u00e0 g\u00ec? (Trong tr\u01b0\u1eddng h\u1ee3p \\(a_i = i\\), \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 t\u00ecm v\u1ecb tr\u00ed c\u1ee7a \\(i\\) trong m\u1ea3ng sau khi x\u00e1o). G\u1ecdi ch\u1ec9 s\u1ed1 n\u00e0y l\u00e0 \\(f(i)\\). Th\u00ec \\(f\\) l\u00e0 h\u00e0m \u00e1nh x\u1ea1 t\u1eeb t\u1eadp \\(\\{1, 2, \\dots, n\\}\\) \u0111\u1ebfn ch\u00ednh n\u00f3. Gi\u1edd \u0111\u1ec3 \u00fd r\u1eb1ng khi ta c\u00f3 m\u1ea3ng \\([f(1), f(2), \\dots, f(n)]\\), n\u00f3 tho\u1ea3 m\u00e3n \u0111\u1ecbnh ngh\u0129a c\u1ee7a ho\u00e1n v\u1ecb! V\u00ed d\u1ee5, ban \u0111\u1ea7u ta c\u00f3 m\u1ea3ng \\(1, 2, 3, 4, 5\\), sau khi x\u00e1o ta c\u00f3 m\u1ea3ng \\(2, 4, 1, 5, 3\\). V\u1eady th\u00ec m\u1ea3ng \\(f\\) s\u1ebd l\u00e0 \\(3, 1, 5, 2, 4\\).</li> <li>Ch\u1ec9 s\u1ed1 c\u0169 c\u1ee7a ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \\(i\\) b\u00e2y gi\u1edd l\u00e0 g\u00ec? (Trong tr\u01b0\u1eddng h\u1ee3p \\(a_i\\) = i$, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 xem s\u1ed1 \u1edf v\u1ecb tr\u00ed \\(i\\) b\u00e2y gi\u1edd l\u00e0 bao nhi\u00eau). G\u1ecdi ch\u1ec9 s\u1ed1 n\u00e0y l\u00e0 \\(g(i)\\). Th\u00ec \\(g\\) c\u0169ng l\u00e0 h\u00e0m \u00e1nh x\u1ea1 t\u1eeb t\u1eadp \\(\\{1, 2, \\dots, n\\}\\) \u0111\u1ebfn ch\u00ednh n\u00f3. Khi ta c\u00f3 m\u1ea3ng \\([g(1), g(2), \\dots, g(n)]\\), n\u00f3 c\u0169ng tho\u1ea3 m\u00e3n \u0111\u1ecbnh ngh\u0129a c\u1ee7a ho\u00e1n v\u1ecb! V\u00ed d\u1ee5, ban \u0111\u1ea7u ta c\u00f3 m\u1ea3ng \\(1, 2, 3, 4, 5\\), sau khi x\u00e1o ta c\u00f3 m\u1ea3ng \\(2, 4, 1, 5, 3\\). Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y m\u1ea3ng \\(g\\) c\u0169ng s\u1ebd l\u00e0 \\(2, 4, 1, 5, 3\\). \u0110\u1ec3 \u00fd r\u1eb1ng \\(f\\) v\u00e0 \\(g\\) kh\u00f4ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a gi\u1ed1ng nhau, v\u00e0 c\u00e1c ho\u00e1n v\u1ecb \u0111\u01b0\u1ee3c sinh ra c\u0169ng kh\u00e1c nhau. Th\u1ef1c t\u1ebf, kh\u00f4ng kh\u00f3 \u0111\u1ec3 nh\u1eadn ra r\u1eb1ng \\(f(g(x)) = g(f(x)) = x\\) v\u1edbi m\u1ecdi \\(x\\) trong t\u1eadp \\(\\{1, 2, \\dots, n\\}\\). </li> </ol> <p>Nh\u01b0 v\u1eady vi\u1ec7c x\u00e1o c\u00e1c ph\u1ea7n t\u1eed (hay vi\u1ec7c \u0111\u1ed5i ch\u1ed7 / ho\u00e1n v\u1ecb c\u00e1c ph\u1ea7n t\u1eed) l\u00e0 m\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 th\u1ec3 hi\u1ec7n ho\u00e1n v\u1ecb.</p> <p>N\u00f3 cho th\u1ea5y r\u1eb1ng l\u00e0m th\u1ebf n\u00e0o c\u00e1c ho\u00e1n v\u1ecb l\u1ea1i li\u00ean quan \u0111\u1ebfn c\u00e1c h\u00e0m \u00e1nh x\u1ea1 t\u1eeb t\u1eadp \\(\\{1, 2, \\dots, n\\}\\) \u0111\u1ebfn ch\u00ednh n\u00f3 sao cho t\u1ea5t c\u1ea3 c\u00e1c \u1ea3nh \u0111\u1ec1u kh\u00e1c nhau (v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c \u1ea3nh \u0111\u1ec1u t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t v\u1ecb tr\u00ed g\u1ed1c duy nh\u1ea5t). N\u00f3i c\u00e1ch kh\u00e1c, m\u1ed9t ho\u00e1n v\u1ecb c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c coi l\u00e0 m\u1ed9t song \u00e1nh tr\u00ean m\u1ed9t t\u1eadp, \u0111\u00e2y l\u00e0 \u0111\u1ecbnh ngh\u0129a t\u1ef1 nhi\u00ean nh\u1ea5t \u0111\u1ec3 s\u1eed d\u1ee5ng cho kh\u00e1 nhi\u1ec1u \u1ee9ng d\u1ee5ng. G\u00f3c nh\u00ecn th\u1ee9 hai (h\u00e0m \\(g\\)) l\u00e0 c\u00e1i t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111\u1ecbnh ngh\u0129a n\u00e0y, trong khi ho\u00e1n v\u1ecb trong c\u00e1ch th\u1ee9 nh\u1ea5t (h\u00e0m \\(f\\)) l\u00e0 c\u00e1i m\u00e0 ta th\u01b0\u1eddng g\u1ecdi l\u00e0 m\u1ea3ng v\u1ecb tr\u00ed c\u1ee7a ho\u00e1n v\u1ecb trong c\u00e1ch th\u1ee9 hai (t\u00ean n\u00e0y kh\u00f4ng chu\u1ea9n l\u1eafm). Sau n\u00e0y ta s\u1ebd th\u1ea5y r\u1eb1ng n\u00f3 ch\u00ednh l\u00e0 c\u00e1i \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ngh\u1ecbch \u0111\u1ea3o c\u1ee7a ho\u00e1n v\u1ecb.</p> <p>L\u01b0u \u00fd r\u1eb1ng gi\u1ea3i th\u00edch v\u1eeba r\u1ed3i kh\u00e1 quan tr\u1ecdng trong vi\u1ec7c hi\u1ec3u r\u00f5 ho\u00e1n v\u1ecb l\u00e0 g\u00ec. H\u00e3y \u0111\u1ecdc l\u1ea1i m\u1ed9t v\u00e0i l\u1ea7n v\u00e0 th\u1eed m\u1ed9t v\u00e0i v\u00ed d\u1ee5 cho \u0111\u1ebfn khi b\u1ea1n hi\u1ec3u \u0111\u01b0\u1ee3c ho\u00e1n v\u1ecb, c\u0169ng nh\u01b0 c\u00e1ch c\u00e1c h\u00e0m \\(f\\) v\u00e0 \\(g\\) t\u01b0\u01a1ng t\u00e1c v\u1edbi nhau.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#ky-hieu-hai-dong-two-line-notation","title":"K\u00fd hi\u1ec7u hai d\u00f2ng (Two-line notation)","text":"<p>\u0110\u1ec3 \u00fd r\u1eb1ng ho\u00e1n v\u1ecb \\([a_1, a_2, \\dots, a_n]\\) c\u1ee7a \\([1, 2, \\dots, n]\\) t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t h\u00e0m \\(f\\) tr\u00ean t\u1eadp \\({1, 2, \\dots, n}\\) \u0111\u1ecbnh ngh\u0129a b\u1edfi h\u00e0m \\(f(i) = a_i\\). Ngh\u0129a l\u00e0, t\u1eadp c\u00e1c c\u1eb7p \\((i, a_i)\\) x\u00e1c \u0111\u1ecbnh m\u1ed9t ho\u00e1n v\u1ecb duy nh\u1ea5t (n\u00f3 ch\u1ec9 l\u00e0 m\u1ed9t t\u1eadp c\u00e1c \u00e1nh x\u1ea1 t\u1eeb v\u1ecb tr\u00ed \u0111\u1ebfn ph\u1ea7n t\u1eed) v\u00e0 ng\u01b0\u1ee3c l\u1ea1i. \u0110\u1ec3 hi\u1ec3u k\u1ebft h\u1ee3p v\u00e0 ngh\u1ecbch \u0111\u1ea3o (gi\u1edbi thi\u1ec7u \u1edf c\u00e1c ph\u1ea7n sau) r\u00f5 h\u01a1n, ta x\u00e9t k\u00fd hi\u1ec7u sau \u0111\u00e2y:</p> \\[ \\begin{equation*} \\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n \\\\ a_1 &amp; a_2 &amp; \\cdots &amp; a_n \\end{pmatrix} \\end{equation*} \\] <p>\u1ede \u0111\u00e2y ta \u0111\u1eb7t c\u00e1c c\u1eb7p tr\u00ean t\u1eebng c\u1ed9t, t\u1eeb tr\u00e1i sang ph\u1ea3i. L\u01b0u \u00fd r\u1eb1ng c\u00e1c c\u1eb7p n\u00e0y c\u00f3 th\u1ec3 b\u1ecb x\u00e1o tr\u1ed9n (nh\u01b0 domino \u1ea5y), d\u1eabn \u0111\u1ebfn m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t th\u00fa v\u1ecb sau:</p> <ol> <li>\u0110i\u1ec1u g\u00ec s\u1ebd x\u1ea3y ra khi ta \u0111\u1ea3o c\u00e1c c\u1eb7p (thay \\((i, a_i)\\) b\u1eb1ng \\((a_i, i)\\) v\u1edbi m\u1ecdi \\(i\\), t\u01b0\u01a1ng \u1ee9ng v\u1edbi vi\u1ec7c \u0111\u1ed5i ch\u1ed7 hai d\u00f2ng \u1ea5y)? N\u1ebfu ho\u00e1n v\u1ecb ban \u0111\u1ea7u t\u01b0\u01a1ng \u1ee9ng v\u1edbi h\u00e0m \\(g\\), ho\u00e1n v\u1ecb sau khi \u0111\u1ea3o s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi h\u00e0m \\(f\\)! \u0110i\u1ec1u n\u00e0y s\u1ebd cho th\u1ea5y r\u00f5 h\u01a1n v\u1ec1 m\u1ed1i quan h\u1ec7 gi\u1eefa \\(f\\) v\u00e0 \\(g\\). V\u1eady n\u00ean thao t\u00e1c n\u00e0y s\u1ebd ngh\u1ecbch \u0111\u1ea3o h\u00e0m.</li> <li>Gi\u1ea3 s\u1eed ta c\u00f3 hai ho\u00e1n v\u1ecb \\(p_1\\) v\u00e0 \\(p_2\\). Ta s\u1eafp x\u1ebfp c\u00e1c c\u1eb7p c\u1ee7a \\(p_2\\) sao cho h\u00e0ng tr\u00ean c\u1ee7a n\u00f3 gi\u1ed1ng h\u1ec7t h\u00e0ng d\u01b0\u1edbi c\u1ee7a \\(p_1\\), chuy\u1ec7n g\u00ec s\u1ebd x\u1ea3y ra? N\u1ebfu h\u00e0m \\(g\\) c\u1ee7a \\(p_1\\) l\u00e0 \\(g_1\\), c\u1ee7a \\(p_2\\) l\u00e0 \\(g_2\\), th\u00ec c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh r\u1eb1ng h\u00e0m \\(g\\) c\u1ee7a ho\u00e1n v\u1ecb m\u1edbi s\u1ebd l\u00e0 h\u00e0m \u0111\u01b0\u1ee3c t\u1ea1o ra b\u1edfi vi\u1ec7c \u00e1p d\u1ee5ng \\(g_1\\), r\u1ed3i \\(g_2\\). V\u1eady n\u00ean thao t\u00e1c n\u00e0y s\u1ebd k\u1ebft h\u1ee3p h\u00e0m.</li> </ol>"},{"location":"Codeforces/math/permutations-for-beginners/#cac-gia-tri-bat-bien-cua-hoan-vi","title":"C\u00e1c gi\u00e1 tr\u1ecb b\u1ea5t bi\u1ebfn c\u1ee7a ho\u00e1n v\u1ecb","text":"<p>\u0110\u1ec3 \u00fd r\u1eb1ng khi m\u1ed9t ho\u00e1n v\u1ecb \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, n\u00f3 s\u1ebd l\u00e0 \\([1, 2, \\dots, n]\\). V\u1eady n\u00ean b\u1ea5t k\u1ef3 thao t\u00e1c t\u00edch lu\u1ef9 n\u00e0o tr\u00ean m\u1ea3ng ho\u00e1n v\u1ecb (nh\u01b0 t\u1ed5ng, t\u00edch, xor, t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng, s\u1ed1 s\u1ed1 l\u1ebb, v\u00e2n v\u00e2n) m\u00e0 kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o th\u1ee9 t\u1ef1 c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng s\u1ebd cho ra k\u1ebft qu\u1ea3 nh\u01b0 nhau v\u1edbi m\u1ecdi ho\u00e1n v\u1ecb c\u00f9ng k\u00edch th\u01b0\u1edbc.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#goc-nhin-thu-tu","title":"G\u00f3c nh\u00ecn th\u1ee9 t\u1ef1","text":""},{"location":"Codeforces/math/permutations-for-beginners/#cac-iem-co-inh","title":"C\u00e1c \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh","text":"<p>M\u1ed9t \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh c\u1ee7a ho\u00e1n v\u1ecb \\(a\\) l\u00e0 m\u1ed9t ch\u1ec9 s\u1ed1 \\(i\\) sao cho \\(a_i = i\\). C\u00e1c \u0111i\u1ec3m n\u00e0y l\u00e0 c\u00e1c \u0111i\u1ec3m kh\u00f4ng b\u1ecb \u1ea3nh h\u01b0\u1edfng b\u1edfi ho\u00e1n v\u1ecb, v\u1eady n\u00ean n\u1ebfu ta b\u1ecf qua nh\u1eefng g\u00ec x\u1ea3y ra v\u1edbi c\u00e1c \u0111i\u1ec3m n\u00e0y, ta s\u1ebd kh\u00f4ng b\u1ecb m\u1ea5t \u0111i b\u1ea5t k\u1ef3 th\u00f4ng tin n\u00e0o v\u1ec1 ho\u00e1n v\u1ecb \u0111\u00f3. \u0110\u00e2y c\u0169ng l\u00e0 l\u00fd do t\u1ea1i sao c\u00e1c ch\u1ec9 s\u1ed1 \\(i\\) n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c b\u1ecf qua trong k\u00fd hi\u1ec7u hai d\u00f2ng (v\u00e0 c\u0169ng trong k\u00fd hi\u1ec7u chu tr\u00ecnh, s\u1ebd \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u \u1edf ph\u1ea7n sau).</p> <p>L\u01b0u \u00fd: n\u1ebfu b\u1ea1n \u0111\u00e3 quen v\u1edbi chu tr\u00ecnh ho\u1eb7c \u0111ang \u0111\u1ecdc l\u1ea1i b\u00e0i vi\u1ebft n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y r\u1eb1ng \u00fd n\u00e0y ph\u00f9 h\u1ee3p h\u01a1n v\u1edbi chu tr\u00ecnh v\u00e0 t\u1ed5 h\u1ee3p, nh\u01b0ng m\u00ecnh v\u1eabn \u0111\u1ec3 n\u00f3 \u1edf \u0111\u00e2y v\u00ec n\u00f3 c\u00f3 chung m\u1ed9t s\u1ed1 \u00fd t\u01b0\u1edfng v\u1edbi c\u00e1c ph\u1ea7n nh\u1ecf kh\u00e1c trong ph\u1ea7n n\u00e0y. T\u01b0\u01a1ng t\u1ef1, \u0111i\u1ec1u n\u00e0y c\u0169ng \u00e1p d\u1ee5ng cho ph\u1ea7n ti\u1ebfp theo.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#cac-derangement","title":"C\u00e1c derangement","text":"<p>M\u1ed9t derangement l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb kh\u00f4ng c\u00f3 \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh n\u00e0o. Ngh\u0129a l\u00e0 v\u1edbi m\u1ecdi \\(i\\), ta c\u00f3 \\(a_i \\neq i\\). G\u1ecdi \\(D_n\\) l\u00e0 s\u1ed1 ho\u00e1n v\u1ecb \u0111\u1ed9 d\u00e0i \\(n\\) l\u00e0 derangement. C\u00f3 \u00edt nh\u1ea5t 3 c\u00e1ch kh\u00e1c nhau \u0111\u1ec3 \u0111\u1ebfm:</p>"},{"location":"Codeforces/math/permutations-for-beginners/#giai-cac-phuong-trinh-tuyen-tinh","title":"Gi\u1ea3i c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh tuy\u1ebfn t\u00ednh","text":"<p>Ta nh\u00f3m t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb b\u1eb1ng s\u1ed1 \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh c\u1ee7a ch\u00fang. N\u1ebfu c\u00f3 \\(i\\) \u0111i\u1ec3m c\u1ed1 d\u1ecbnh, ta \u0111\u00e1nh s\u1ed1 \\(n-i\\) ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i t\u1eeb \\(1\\) \u0111\u1ebfn \\(n-i\\) th\u00ec ta s\u1ebd c\u00f3 m\u1ed9t derangement. V\u1eady s\u1ed1 ho\u00e1n v\u1ecb \\(n\\) ph\u1ea7n t\u1eed v\u1edbi \\(i\\) \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh s\u1ebd l\u00e0 \\(\\binom{n}{i} \\cdot D_{n-i}\\).</p> <p>T\u1ed5ng h\u1ebft l\u1ea1i tr\u00ean m\u1ecdi \\(i\\) s\u1ebd cho ta identity l\u00e0 \\(n! = \\sum_{i=0}^{n} \\binom{n}{i} \\cdot D_{n-i}\\).</p> <p>C\u00f9ng v\u1edbi \\(D_0 = 1\\) v\u00e0 \\(D_1 = 0\\), ta c\u00f3 th\u1ec3 d\u00f9ng quy n\u1ea1p \u0111\u1ec3 c\u00f3 \\(D_n = n! \\cdot \\sum_{i=0}^{n} \\frac{(-1)^i}{i!}\\). Ta c\u0169ng c\u00f3 th\u1ec3 d\u00f9ng identity sau \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 n\u00e0y:</p> Tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a ngh\u1ecbch \u0111\u1ea3o Mobius <p>N\u1ebfu c\u00f3 c\u00e1c h\u00e0m \\(f\\) v\u00e0 \\(g\\) \u00e1nh x\u1ea1 t\u1eeb \\(\\mathbb{Z}_{\\ge 0}\\) \u0111\u1ebfn \\(\\mathbb{R}\\), th\u00ec hai m\u1ec7nh \u0111\u1ec1 sau \u0111\u00e2y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng:</p> <ol> <li>\\(g(n) = \\sum_{i = 0}^n (-1)^i \\binom{n}{i} f(i)\\)</li> <li>\\(f(n) = \\sum_{i = 0}^n (-1)^i \\binom{n}{i} g(i)\\)</li> </ol>"},{"location":"Codeforces/math/permutations-for-beginners/#e-quy","title":"\u0110\u1ec7 quy","text":"<p>Gi\u1ea3 s\u1eed \\(a_n = k \\neq n\\). X\u00e9t \\(a_k\\). N\u1ebfu \\(a_k = n\\) th\u00ec ta c\u00f3 \\(D_{n-2}\\) c\u00e1ch \u0111\u1ec3 ho\u00e1n v\u1ecb c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i. N\u1ebfu \\(a_k \\neq n\\), ta \u0111\u1ec3 \u00fd r\u1eb1ng b\u00e0i to\u00e1n s\u1ebd quay v\u1ec1 t\u00ednh s\u1ed1 derangement cho \\(n-1\\) ph\u1ea7n t\u1eed b\u1eb1ng c\u00e1ch thay \\(n\\) (\u0111\u01b0\u1ee3c g\u00e1n trong \\(n-2\\) slot c\u00f2n l\u1ea1i) b\u1eb1ng \\(k\\).</p> <p>Nh\u01b0 v\u1eady c\u00f4ng th\u1ee9c s\u1ebd l\u00e0 \\(D_n = (n-1) \\cdot (D_{n-1} + D_{n-2})\\), d\u00f9ng quy n\u1ea1p c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3i ra \u0111\u01b0\u1ee3c.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#dung-nguyen-tac-bao-ham-va-loai-tru","title":"D\u00f9ng nguy\u00ean t\u1eafc bao h\u00e0m v\u00e0 lo\u1ea1i tr\u1eeb","text":"<p>G\u1ecdi \\(S_i\\) l\u00e0 t\u1eadp c\u00e1c ho\u00e1n v\u1ecb c\u00f3 \\(i\\) l\u00e0 \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh (ph\u1ea7n c\u00f2n l\u1ea1i ho\u00e1n v\u1ecb tho\u1ea3i m\u00e1i). Ta s\u1ebd c\u00f3 \u0111\u00e1p \u00e1n l\u00e0 \\(n! - |\\cup_{i} S_i|\\). V\u1edbi nguy\u00ean t\u1eafc Bao h\u00e0m - Lo\u1ea1i tr\u1eeb, v\u00ec giao c\u1ee7a b\u1ea5t k\u1ef3 \\(k\\) th\u1eb1ng \\(S_i\\) n\u00e0o c\u0169ng c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 \\((n - k)!\\), ta s\u1ebd c\u00f3 c\u00f4ng th\u1ee9c t\u01b0\u01a1ng t\u1ef1 cho \\(D_n\\).</p>"},{"location":"Codeforces/math/permutations-for-beginners/#cac-nghich-the","title":"C\u00e1c ngh\u1ecbch th\u1ebf","text":"<p>M\u1ed9t ngh\u1ecbch th\u1ebf trong m\u1ed9t m\u1ea3ng (kh\u00f4ng nh\u1ea5t thi\u1ebft l\u00e0 m\u1ea3ng ho\u00e1n v\u1ecb) l\u00e0 b\u1ea5t k\u1ef3 c\u1eb7p ch\u1ec9 s\u1ed1 \\((i, j)\\) sao cho \\(i &lt; j\\) v\u00e0 \\(a_i &gt; a_j\\). S\u1ed1 ngh\u1ecbch th\u1ebf \u00edt nh\u1ea5t l\u00e0 bao nhi\u00eau? L\u00e0 0, v\u00ec ta ch\u1ec9 c\u1ea7n cho \\(a_i = i\\). S\u1ed1 ngh\u1ecbch th\u1ebf nhi\u1ec1u nh\u1ea5t l\u00e0 bao nhi\u00eau? L\u00e0 \\(\\frac{n \\cdot (n-1)}{2}\\) v\u00ec ta ch\u1ec9 c\u1ea7n cho \\(a_i = n - i + 1\\), khi \u0111\u00f3 th\u00ec b\u1ea5t k\u1ef3 c\u1eb7p ch\u1ec9 s\u1ed1 n\u00e0o c\u0169ng l\u00e0 ngh\u1ecbch th\u1ebf.</p> <p>X\u00e9t b\u00e0i t\u1eadp sau. Cho m\u1ed9t ho\u00e1n v\u1ecb (hay m\u1ed9t m\u1ea3ng c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f4i m\u1ed9t kh\u00e1c nhau), ta \u0111\u01b0\u1ee3c ph\u00e9p th\u1ef1c hi\u1ec7n thao t\u00e1c sau v\u00f4 s\u1ed1 l\u1ea7n: Ch\u1ecdn b\u1ea5t k\u1ef3 ch\u1ec9 s\u1ed1 \\(1 \\le i &lt; n\\) n\u00e0o v\u00e0 \u0111\u1ed5i ch\u1ed7 \\(a_i\\) v\u00e0 \\(a_{i+1}\\). C\u00f3 hai c\u00e2u h\u1ecfi \u1edf \u0111\u00e2y:</p> <ol> <li>Ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp m\u1ea3ng m\u00e0 ch\u1ec9 d\u00f9ng c\u00e1c thao t\u00e1c nh\u01b0 tr\u00ean kh\u00f4ng?</li> <li>N\u1ebfu c\u00f3, s\u1ed1 l\u1ea7n thao t\u00e1c \u00edt nh\u1ea5t ta c\u1ea7n l\u00e0 bao nhi\u00eau?</li> </ol> <p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu ta l\u00e0m \u0111\u01b0\u1ee3c tr\u00ean ho\u00e1n v\u1ecb, ta c\u0169ng l\u00e0m \u0111\u01b0\u1ee3c tr\u00ean m\u1ea3ng c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f4i m\u1ed9t kh\u00e1c nhau (ch\u1ec9 c\u1ea7n thay c\u00e1c ph\u1ea7n t\u1eed b\u1eb1ng ch\u1ec9 s\u1ed1 c\u1ee7a ch\u00fang trong m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp).</p> <p>V\u1edbi c\u00e2u h\u1ecfi \u0111\u1ea7u ti\u00ean, c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 c\u00f3. \u00dd t\u01b0\u1edfng ch\u00ednh \u1edf \u0111\u00e2y l\u00e0 t\u00ecm s\u1ed1 b\u00e9 nh\u1ea5t r\u1ed3i c\u1ee9 \u0111\u1ed5i ch\u1ed7 n\u00f3 v\u1edbi ph\u1ea7n t\u1eed tr\u01b0\u1edbc n\u00f3 cho \u0111\u1ebfn khi \u0111\u1ebfn \u0111\u01b0\u1ee3c v\u1ecb tr\u00ed \u0111\u1ea7u ti\u00ean, sau \u0111\u00f3 l\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi s\u1ed1 b\u00e9 nh\u00ec, v\u00e0 ti\u1ebfp t\u1ee5c nh\u01b0 v\u1eady.</p> <p>C\u00f2n s\u1ed1 thao t\u00e1c th\u00ec sao nh\u1ec9? \u0110\u1ec3 chuy\u1ec3n s\u1ed1 b\u00e9 nh\u1ea5t th\u00ec ta c\u1ea7n bao nhi\u00eau thao t\u00e1c? L\u01b0u \u00fd r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 tr\u01b0\u1edbc \\(1\\) trong ho\u00e1n v\u1ecb ban \u0111\u1ea7u s\u1ebd g\u00f3p ph\u1ea7n t\u1ea1o ra m\u1ed9t ngh\u1ecbch th\u1ebf trong \u0111\u00f3 ph\u1ea7n t\u1eed th\u1ee9 hai l\u00e0 \\(1\\) (l\u00e0 \\(j\\) trong c\u1eb7p ch\u1ec9 s\u1ed1 \\((i, j)\\) \u1ea5y). Gi\u1edd sau khi \\(1\\) \u0111\u00e3 \u1edf \u0111\u00fang v\u1ecb tr\u00ed c\u1ee7a n\u00f3 (v\u1ecb tr\u00ed \u0111\u1ea7u ti\u00ean), s\u1ebd kh\u00f4ng c\u00f2n ngh\u1ecbch th\u1ebf n\u00e0o li\u00ean quan \u0111\u1ebfn \\(1\\) n\u1eefa. V\u1edbi ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a ho\u00e1n v\u1ecb, ta c\u00f3 th\u1ec3 ti\u1ebfp t\u1ee5c d\u00f9ng c\u00e1ch n\u00e0y, v\u1edbi ph\u1ea7n t\u1eed b\u00e9 nh\u1ea5t l\u00e0 \\(2\\). Nh\u01b0ng \u0111\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u \u0111\u00f3, ta c\u1ea7n xem chuy\u1ec7n g\u00ec s\u1ebd x\u1ea3y ra v\u1edbi c\u00e1c ngh\u1ecbch th\u1ebf kh\u00f4ng c\u00f3 \\(1\\) trong \u0111\u00f3. L\u01b0u \u00fd r\u1eb1ng th\u1ee9 t\u1ef1 t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a c\u00e1c c\u1eb7p kh\u00e1c kh\u00f4ng thay \u0111\u1ed5i n\u00ean c\u00e1c ngh\u1ecbch th\u1ebf c\u00f2n l\u1ea1i v\u1eabn y nguy\u00ean. V\u1eady t\u1ed5ng s\u1ed1 thao t\u00e1c r\u00f5 r\u00e0ng l\u00e0 s\u1ed1 ngh\u1ecbch th\u1ebf trong ho\u00e1n v\u1ecb.</p> <p>\u0110\u00f3 c\u00f3 ph\u1ea3i l\u00e0 s\u1ed1 thao t\u00e1c \u00edt nh\u1ea5t \u0111\u1ec3 s\u1eafp x\u1ebfp m\u1ea3ng kh\u00f4ng? Ho\u00e1 ra c\u00e2u tr\u1ea3 l\u1eddi l\u00e0 c\u00f3. X\u00e9t m\u1ed9t thao t\u00e1c n\u00e0o \u0111\u00f3 \u0111\u00e3 xong. V\u00ec n\u00f3 \u0111\u1ed5i ch\u1ed7 hai ph\u1ea7n t\u1eed k\u1ec1 nhau, s\u1ebd c\u00f3 nhi\u1ec1u nh\u1ea5t m\u1ed9t ngh\u1ecbch th\u1ebf m\u1ea5t \u0111i. V\u1eady t\u1ed5ng s\u1ed1 ngh\u1ecbch th\u1ebf gi\u1ea3m \u0111i nhi\u1ec1u nh\u1ea5t l\u00e0 \\(1\\). Trong m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp, kh\u00f4ng c\u00f3 ngh\u1ecbch th\u1ebf n\u00e0o c\u1ea3. V\u1eady s\u1ed1 thao t\u00e1c s\u1ebd \u00edt nh\u1ea5t l\u00e0 s\u1ed1 ngh\u1ecbch th\u1ebf trong ho\u00e1n v\u1ecb.</p> <p>Gi\u1edd b\u1ea1n c\u00f3 th\u1ec3 ngh\u0129, l\u00e0m sao ta c\u00f3 th\u1ec3 \u0111\u1ebfm s\u1ed1 ngh\u1ecbch th\u1ebf trong m\u1ed9t ho\u00e1n v\u1ecb \u0111\u00e2y? B\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng merge sort ho\u1eb7c c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u tr\u00ean \u0111o\u1ea1n nh\u01b0 Fenwick tree hay Segment tree. Gi\u1ea3i b\u1eb1ng merge sort th\u00ec b\u1ea1n c\u00f3 th\u1ec3 xem t\u1ea1i \u0111\u00e2y, c\u00f2n v\u1edbi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u th\u00ec nh\u01b0 sau:</p> <ul> <li>Ban \u0111\u1ea7u, ta c\u00f3 m\u1ea3ng \\(A\\) \u0111\u1ed9 d\u00e0i \\(n\\) g\u1ed3m to\u00e0n s\u1ed1 \\(0\\) (khi kh\u1edfi t\u1ea1p c\u1ea5u tr\u00fac d\u1eef li\u1ec7u).</li> <li>V\u1edbi m\u1ed7i \\(i\\) t\u1eeb \\(1\\) \u0111\u1ebfn \\(n\\), t\u00ecm t\u1ed5ng ti\u1ec1n t\u1ed1 c\u1ee7a \\(A\\) t\u1eeb \\(0\\) \u0111\u1ebfn \\(a_i - 1\\), v\u00e0 th\u00eam n\u00f3 v\u00e0o \u0111\u00e1p \u00e1n. Sau \u0111\u00f3, t\u0103ng \\(A_i\\) l\u00ean \\(1\\).</li> </ul>"},{"location":"Codeforces/math/permutations-for-beginners/#day-con-tang-dai-nhat-longest-increasing-subsequence-lis-va-inh-ly-erdosszekeres","title":"D\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t (Longest Increasing Subsequence - LIS) v\u00e0 \u0111\u1ecbnh l\u00fd Erd\u0151s\u2013Szekeres","text":"<p>M\u1ed9t d\u00e3y con t\u0103ng c\u1ee7a m\u1ed9t m\u1ea3ng \\(a\\) (kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i l\u00e0 ho\u00e1n v\u1ecb) l\u00e0 m\u1ed9t d\u00e3y c\u00e1c ch\u1ec9 s\u1ed1 \\(i_1 &lt; i_2 &lt; \\dots &lt; i_k\\) sao cho \\(a_{i_1} &lt; a_{i_2} &lt; \\dots &lt; a_{i_k}\\). D\u00e3y con gi\u1ea3m c\u0169ng \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a t\u01b0\u01a1ng t\u1ef1.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 xem thu\u1eadt to\u00e1n t\u00ecm d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t (ho\u1eb7c d\u00e3y con kh\u00f4ng gi\u1ea3m d\u00e0i nh\u1ea5t) c\u1ee7a m\u1ed9t m\u1ea3ng t\u1ea1i \u0111\u00e2y. Nh\u01b0ng \u1edf \u0111\u00e2y ta s\u1ebd kh\u00f4ng quan t\u00e2m \u0111\u1ebfn ph\u1ea7n n\u00e0y cho l\u1eafm.</p> <p>C\u00e1i ta quan t\u00e2m l\u00e0 gi\u1edbi h\u1ea1n \u0111\u1ed9 d\u00e0i c\u1ee7a b\u1ea5t k\u1ef3 d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t n\u00e0o (t\u1eeb gi\u1edd g\u1ecdi l\u00e0 LIS - Longest Increasing Subsequence nh\u00e9). Tuy nhi\u00ean, v\u1edbi d\u00e3y con gi\u1ea3m, LIS c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 \\(1\\). \u0110\u1ecbnh l\u00fd Erd\u0151s\u2013Szekeres cho ta bi\u1ebft r\u1eb1ng trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, \u0111\u1ed9 d\u00e0i d\u00e3y con gi\u1ea3m d\u00e0i nh\u1ea5t s\u1ebd l\u1edbn.</p> <p>\u0110\u1ecbnh l\u00fd ph\u00e1t bi\u1ec3u r\u1eb1ng trong b\u1ea5t k\u1ef3 ho\u00e1n v\u1ecb n\u00e0o (ho\u1eb7c m\u1ea3ng c\u00f3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f4i m\u1ed9t kh\u00e1c nhau) \u0111\u1ed9 d\u00e0i \\(xy + 1\\), ta s\u1ebd lu\u00f4n c\u00f3 m\u1ed9t d\u00e3y con t\u0103ng d\u00e0i \\(x + 1\\) ho\u1eb7c m\u1ed9t d\u00e3y con gi\u1ea3m d\u00e0i \\(y + 1\\).</p> <p>C\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 ch\u1ee9ng minh \u0111\u1ecbnh l\u00fd n\u00e0y l\u00e0 d\u00f9ng nguy\u00ean t\u1eafc chu\u1ed3ng chim (Pigeonhole principle).</p> <p>Ta ph\u1ea3n ch\u1ee9ng r\u1eb1ng \u0111\u1ecbnh l\u00fd sai v\u1edbi m\u1ed9t ho\u00e1n v\u1ecb \\(a\\) n\u00e0o \u0111\u00f3. V\u1edbi m\u1ecdi \\(i\\), x\u00e9t \u0111\u1ed9 d\u00e0i d\u00e3y con t\u0103ng d\u00e0i nh\u1ea5t k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed \\(i\\) v\u00e0 \u0111\u1ed9 d\u00e0i d\u00e3y con gi\u1ea3m d\u00e0i nh\u1ea5t c\u0169ng k\u1ebft th\u00fac \u1edf v\u1ecb tr\u00ed \\(i\\). G\u1ecdi c\u00e1c s\u1ed1 n\u00e0y l\u00e0 \\(x_i\\) v\u00e0 \\(y_i\\). L\u01b0u \u00fd r\u1eb1ng t\u1ea5t c\u1ea3 \\(x_i\\) l\u00e0 s\u1ed1 nguy\u00ean v\u00e0 n\u1eb1m gi\u1eefa \\(1\\) v\u00e0 \\(x\\), v\u00e0 t\u1ea5t c\u1ea3 \\(y_i\\) l\u00e0 s\u1ed1 nguy\u00ean v\u00e0 n\u1eb1m gi\u1eefa \\(1\\) v\u00e0 \\(y\\). V\u1eady n\u00ean ta s\u1ebd c\u00f3 nhi\u1ec1u nh\u1ea5t \\(xy\\) c\u1eb7p \\((x_i, y_i)\\) kh\u00e1c nhau. Theo nguy\u00ean t\u1eafc chu\u1ed3ng chim, s\u1ebd t\u1ed3n t\u1ea1i \\(i &lt; j\\) sao cho \\(x_i = x_j\\) v\u00e0 \\(y_i = y_j\\). V\u00ec t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ec1u kh\u00e1c nhau, \\(a_i &lt; a_j\\) ho\u1eb7c \\(a_i &gt; a_j\\), trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ea7u, kh\u00f4ng th\u1ec3 x\u1ea3y ra chuy\u1ec7n \\(x_i = x_j\\) v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p sau, kh\u00f4ng th\u1ec3 x\u1ea3y ra chuy\u1ec7n \\(y_i = y_j\\). \u0110i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi gi\u1ea3 thi\u1ebft ban \u0111\u1ea7u, v\u1eady n\u00ean \u0111\u1ecbnh l\u00fd \u0111\u00fang.</p> <p>C\u00f3 m\u1ed9t ch\u1ee9ng minh tinh t\u1ebf v\u00e0 s\u00e2u h\u01a1n d\u00f9ng \u0111\u1ecbnh l\u00fd Dilworth. Blog n\u00e0y d\u00f9ng n\u00f3 \u0111\u1ec3 ch\u1ee9ng minh m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a \u0111\u1ecbnh l\u00fd, m\u1eb7c d\u00f9 ta c\u0169ng c\u00f3 th\u1ec3 s\u1eeda n\u00f3 m\u1ed9t ch\u00fat \u0111\u1ec3 ch\u1ee9ng minh to\u00e0n b\u1ed9 \u0111\u1ecbnh l\u00fd.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#hoan-vi-tiep-theo","title":"Ho\u00e1n v\u1ecb ti\u1ebfp theo","text":"<p>Ho\u00e1n v\u1ecb ch\u1ec9 l\u00e0 m\u1ed9t d\u00e3y s\u1ed1 nguy\u00ean, n\u00ean ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp t\u1eadp t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y \u0111\u1ed9 d\u00e0i \\(n\\) theo th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n. \u0110i\u1ec1u n\u00e0y \u0111\u1ecbnh ra th\u1ee9 t\u1ef1 t\u1ef1 nhi\u00ean c\u1ee7a m\u1ed7i ho\u00e1n v\u1ecb. Gi\u1edd l\u00e0m sao \u0111\u1ec3 t\u00ecm ho\u00e1n v\u1ecb ti\u1ebfp theo c\u1ee7a m\u1ed9t ho\u00e1n v\u1ecb cho tr\u01b0\u1edbc?</p> <p>C\u00e1ch d\u1ec5 nh\u1ea5t (trong C++) l\u00e0 d\u00f9ng <code>std::next_permutation</code>, nh\u01b0ng ta s\u1ebd xem s\u01a1 l\u01b0\u1ee3c v\u1ec1 c\u00e1ch n\u00f3 ho\u1ea1t \u0111\u1ed9ng.</p> <p>\u0110\u1ea7u ti\u00ean ta c\u1ea7n t\u00ecm ch\u1ec9 s\u1ed1 \\(i\\) t\u1eeb ph\u1ea3i sang sao cho \\(a_i &lt; a_{i+1}\\). V\u00ec \\(i\\) l\u00e0 ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean tho\u1ea3 m\u00e3n \u0111i\u1ec1u n\u00e0y, t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb n\u1eb1m trong c\u00e1c ch\u1ec9 s\u1ed1 t\u1eeb \\(i\\) \u0111\u1ebfn \\(n\\) s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t m\u1ea3ng gi\u1ea3m d\u1ea7n. L\u01b0u \u00fd r\u1eb1ng s\u1ed1 nh\u1ecf nh\u1ea5t trong d\u00e3y gi\u1ea3m n\u00e0y m\u00e0 l\u1edbn h\u01a1n \\(a_i\\) s\u1ebd l\u00e0 ph\u1ea7n t\u1eed m\u1edbi \u1edf v\u1ecb tr\u00ed \\(i\\), v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i (c\u00f9ng v\u1edbi s\u1ed1 \\(a_i\\) b\u00e2y gi\u1edd) s\u1ebd \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp t\u0103ng d\u1ea7n. C\u00e1i n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i trong \\(O(n-i+1)\\).</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng b\u1eaft \u0111\u1ea7u t\u1eeb ho\u00e1n v\u1ecb c\u00f3 th\u1ee9 t\u1ef1 t\u1eeb \u0111i\u1ec3n nh\u1ecf nh\u1ea5t (l\u00e0 \\([1, 2, \\dots, n]\\)), s\u1ed1 ho\u00e1n v\u1ecb gi\u1eefa (v\u00e0 bao g\u1ed3m) ho\u00e1n v\u1ecb n\u00e0y v\u00e0 ho\u00e1n v\u1ecb c\u00f3 ch\u1ec9 s\u1ed1 \\(i\\) \u0111\u1ea7u ti\u00ean m\u00e0 \\(a_i \\ne i\\) l\u00e0 \\(k\\) s\u1ebd \u00edt nh\u1ea5t l\u00e0 \\((n-k)! + 1\\). \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 n\u1ebfu b\u1ea1n d\u00f9ng <code>next_permutation</code> nhi\u1ec1u l\u1ea7n, s\u1ed1 ph\u1ea7n t\u1eed trong ho\u00e1n v\u1ecb thay \u0111\u1ed5i s\u1ebd kh\u00f4ng nhi\u1ec1u (tr\u1eeb khi b\u1ea1n b\u1eaft \u0111\u1ea7u \u1edf m\u1ed9t ho\u00e1n v\u1ecb n\u00e0o \u0111\u00f3, v\u00e0 ngay c\u1ea3 trong tr\u01b0\u1eddng h\u1ee3p \u0111\u00f3, ngo\u00e0i m\u1ed9t thay \u0111\u1ed5i v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c ch\u1ec9 s\u1ed1 ti\u1ec1m n\u0103ng, k\u1ebft lu\u1eadn t\u01b0\u01a1ng t\u1ef1 v\u1eabn gi\u1eef nguy\u00ean).</p> <p>V\u1eady n\u1ebfu ta c\u00f3 m\u1ed9t ho\u00e1n v\u1ecb \u0111\u1ed9 d\u00e0i \\(n\\), b\u1ea1n d\u00f9ng <code>next_permutation</code>(nh\u01b0 c\u00e0i \u0111\u1eb7t \u1edf tr\u00ean) trong \\(O(n^k)\\) l\u1ea7n, th\u1eddi gian c\u1ea7n s\u1ebd l\u00e0 kho\u1ea3ng (\u00edt h\u01a1n nhi\u1ec1u so v\u1edbi) \\(O(kn^k \\log n)\\). Ta c\u0169ng c\u00f3 th\u1ec3 m\u00f4 ph\u1ecfng k\u1ebft qu\u1ea3 c\u1ee7a \\(r\\) thao t\u00e1c <code>next_permutation</code> trong \\(O(r+n)\\) (cho ra k\u1ebft qu\u1ea3 ch\u00ednh x\u00e1c ch\u1ee9 kh\u00f4ng c\u00e0i \u0111\u1eb7t t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean). Ph\u00e2n t\u00edch c\u0169ng t\u01b0\u01a1ng t\u1ef1 v\u1edbi vi\u1ec7c ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p khi t\u0103ng m\u1ed9t s\u1ed1 nh\u1ecb ph\u00e2n \\(n\\) bit l\u00ean \\(r\\) l\u1ea7n.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#cac-hoan-vi-ngau-nhien","title":"C\u00e1c ho\u00e1n v\u1ecb ng\u1eabu nhi\u00ean","text":"<p>C\u00f3 t\u1ed5ng c\u1ed9ng \\(n!\\) ho\u00e1n v\u1ecb \u0111\u1ed9 d\u00e0i \\(n\\). L\u00e0m sao \u0111\u1ec3 t\u1ea1o ra m\u1ed9t ho\u00e1n v\u1ecb ng\u1eabu nhi\u00eau n\u1ebfu ta ch\u1ec9 c\u00f3 m\u1ed9t tr\u00ecnh sinh s\u1ed1 ng\u1eabu nhi\u00ean (random number generator - RNG) cho ta m\u1ed9t s\u1ed1 nguy\u00ean trong m\u1ed9t \u0111o\u1ea1n t\u1ef1 ch\u1ecdn n\u00e0o \u0111\u00f3?</p> <p>V\u1ec1 vi\u1ec7c ngh\u0129 c\u00e1ch l\u00e0m sao \u0111\u1ec3 t\u1ea1o d\u1ea7n m\u1ed9t ho\u00e1n v\u1ecb nh\u01b0 th\u1ebf, h\u00e3y th\u1eed lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \\(&gt; k\\) v\u1edbi m\u1ed9t s\u1ed1 \\(k\\). L\u01b0u \u00fd r\u1eb1ng v\u1ecb tr\u00ed c\u1ee7a \\(k\\) trong m\u1ea3ng n\u00e0y c\u00f3 kh\u1ea3 n\u0103ng l\u00e0 b\u1ea5t c\u1ee9 s\u1ed1 nguy\u00ean n\u00e0o t\u1eeb \\(1\\) \u0111\u1ebfn \\(k\\). Tuy nhi\u00ean n\u00f3 s\u1ebd kh\u00f4ng \u0111\u01b0a ta \u0111\u1ebfn m\u1ed9t thu\u1eadt to\u00e1n hi\u1ec7u qu\u1ea3 ngay \u0111\u01b0\u1ee3c.</p> <p>Ta s\u1ebd mu\u1ed1n t\u1ea1o m\u1ed9t ho\u00e1n v\u1ecb t\u1eeb tr\u00e1i sang ph\u1ea3i. Gi\u1ea3 s\u1eed ta ch\u1ecdn ra \u0111\u01b0\u1ee3c m\u1ed9t ti\u1ec1n t\u1ed1. L\u01b0u \u00fd r\u1eb1ng ho\u00e1n v\u1ecb c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i \u0111\u1ec1u c\u00f3 kh\u1ea3 n\u0103ng nh\u01b0 nhau. Th\u00eam n\u1eefa, t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed b\u00ean ph\u1ea3i c\u0169ng c\u00f3 kh\u1ea3 n\u0103ng nh\u01b0 nhau \u0111\u1ec3 tr\u1edf th\u00e0nh ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a h\u1eadu t\u1ed1 (ph\u1ea7n t\u1eed ti\u1ebfp theo c\u1ee7a ti\u1ec1n t\u1ed1 \u1ea5y). Nh\u1eadn x\u00e9t n\u00e0y d\u1eabn \u0111\u1ebfn bi\u1ebfn th\u1ec3 Durstenfeld c\u1ee7a thu\u1eadt to\u00e1n x\u00e1o Fisher-Yates.</p> <p>Gi\u1edd ta xem x\u00e9t m\u1ed9t v\u00e0i th\u00f4ng s\u1ed1 c\u1ee7a ho\u00e1n v\u1ecb ng\u1eabu nhi\u00ean:</p> <p>\u0110\u1ea7u ti\u00ean, \u0111\u1ed9 d\u00e0i k\u1ef3 v\u1ecdng c\u1ee7a d\u00e3y t\u0103ng d\u1ea7n \u0111\u01b0\u1ee3c ch\u1ecdn tham lam b\u1eb1ng thu\u1eadt to\u00e1n n\u00e0y l\u00e0 bao nhi\u00eau:</p> <ul> <li>N\u1ebfu kh\u00f4ng c\u00f3 g\u00ec trong d\u00e3y ho\u1eb7c ph\u1ea7n t\u1eed m\u1edbi l\u1edbn h\u01a1n ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c ch\u1ecdn cu\u1ed1i c\u00f9ng, ch\u1ecdn ph\u1ea7n t\u1eed n\u00e0y.</li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c ch\u1ecdn khi v\u00e0 ch\u1ec9 khi n\u00f3 l\u1edbn h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c ch\u1ecdn tr\u01b0\u1edbc n\u00f3. V\u1eady n\u00ean ta d\u00f9ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh:</p> <p>\\(E[l] = E[\\sum_i(a_i \\text{ \u0111\u01b0\u1ee3c ch\u1ecdn})] = \\sum_i P[a_i \\text{ \u0111\u01b0\u1ee3c ch\u1ecdn}] = \\sum_i P[a_i &gt; \\max(a_1, \\dots, a_{i - 1})] = \\sum_i \\frac{1}{i}\\) x\u1ea5p x\u1ec9 \\(\\ln n\\)</p> <p>Tuy nhi\u00ean, th\u1ef1c ra k\u1ef3 v\u1ecdng \u0111\u1ed9 d\u00e0i c\u1ee7a LIS l\u00e0 \\(\\Theta(\\sqrt{n})\\), cho n\u00ean thu\u1eadt tham lam s\u1ebd t\u1ec7 h\u01a1n nhi\u1ec1u so v\u1edbi vi\u1ec7c t\u00ednh LIS b\u00e0i b\u1ea3n.</p> <p>\u0110\u1ec3 bi\u1ebft th\u00eam s\u1ed1 li\u1ec7u th\u1ed1ng k\u00ea ho\u00e1n v\u1ecb ng\u1eabu nhi\u00ean c\u0169ng c\u00f3 m\u1ed9t s\u1ed1 th\u00f4ng tin v\u1ec1 s\u1ed1 li\u1ec7u th\u1ed1ng k\u00ea \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb m\u1ed9t s\u1ed1 ph\u1ea7n ti\u1ebfp theo, b\u1ea1n c\u00f3 th\u1ec3 xem t\u1ea1i \u0111\u00e2y.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#goc-nhin-phan-ra-chu-trinh","title":"G\u00f3c nh\u00ecn ph\u00e2n r\u00e3 chu tr\u00ecnh","text":"<p>Gi\u1edd ta s\u1ebd \u0111\u1ebfn v\u1edbi ph\u1ea7n r\u1ea5t quan tr\u1ecdng trong l\u00fd thuy\u1ebft ho\u00e1n v\u1ecb - ph\u00e2n r\u00e3 chu tr\u00ecnh. B\u1ea1n s\u1ebd th\u1ea5y r\u1eb1ng b\u1ea3n th\u00e2n d\u00f9ng nh\u1eefng th\u1ee9 sau \u0111\u00e2y kh\u00e1 nhi\u1ec1u khi gi\u1ea3i c\u00e1c b\u00e0i t\u1eadp v\u1ec1 ho\u00e1n v\u1ecb.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#chu-trinh","title":"Chu tr\u00ecnh","text":"<p>Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t ho\u00e1n v\u1ecb \\(a\\). C\u1ed1 \u0111\u1ecbnh v\u1ecb tr\u00ed \\(i\\). Gi\u1edd nh\u00ecn v\u00e0o d\u00e3y \\(i\\), \\(a_i\\), \\(a_{a_i}\\), \\(a_{a_{a_i}}\\), \\(\\dots\\). \u0110\u1ebfn c\u00f9ng th\u00ec n\u00f3 s\u1ebd l\u1eb7p l\u1ea1i v\u00ec ch\u1ec9 c\u00f3 nhi\u1ec1u nh\u1ea5t \\(n\\) gi\u00e1 tr\u1ecb m\u00e0 d\u00e3y n\u00e0y c\u00f3 th\u1ec3 c\u00f3. \u0110\u1ec3 cho ti\u1ec7n th\u00ec g\u1ecdi ph\u1ea7n t\u1eed th\u1ee9 \\(j\\) c\u1ee7a d\u00e3y n\u00e0y l\u00e0 \\(b_j\\).</p> <p>Ti\u1ebfp theo th\u00ec v\u1edbi \\(k\\) n\u00e0o \u0111\u00f3 m\u00e0 \\(k &lt; l\\), ta s\u1ebd c\u00f3 \\(b_k = b_l\\). Cho \\(k\\) l\u00e0 ch\u1ec9 s\u1ed1 b\u00e9 nh\u1ea5t c\u00f3 t\u00ednh ch\u1ea5t nh\u01b0 v\u1eady, v\u00e0 \\(l\\) l\u00e0 ch\u1ec9 s\u1ed1 b\u00e9 nh\u1ea5t \u1ee9ng v\u1edbi \\(k\\). N\u1ebfu \\(k\\) kh\u00f4ng ph\u1ea3i \\(1\\) th\u00ec ta s\u1ebd c\u00f3 \\(b_{k-1} = b_{l-1}\\), v\u00ec \\(a\\) l\u00e0 song \u00e1nh. Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y m\u00e2u thu\u1eabn v\u1edbi t\u00ednh t\u1ed1i gi\u1ea3n c\u1ee7a \\(k\\). Ngh\u0129a l\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1eb7p trong d\u00e3y n\u00e0y th\u1ef1c ra l\u1ea1i l\u00e0 \\(i\\).</p> <p>Gi\u1edd gi\u1ea3 s\u1eed c\u00f3 g\u00ec \u0111\u00f3 trong d\u00e3y gi\u1eefa \\(1\\) v\u00e0 \\(l\\) l\u1eb7p l\u1ea1i (\u1edf c\u00e1c v\u1ecb tr\u00ed \\(1 &lt; m &lt; o &lt; l\\)). Ta l\u1eadp lu\u1eadn song \u00e1nh \\(m-1\\) l\u1ea7n, ta s\u1ebd c\u00f3 \\(b_{o - m + 1} = b_1 = i\\), n\u00ean l\u00e0 \\(o - m + 1 \\ge l\\), c\u00e1i n\u00e0y c\u0169ng m\u00e2u thu\u1eabn lu\u00f4n. \u0110i\u1ec1u n\u00e0y ngh\u0129a l\u00e0 d\u00e3y b\u1eaft \u0111\u1ea7u l\u1eb7p t\u1eeb \\(l\\) v\u00e0 t\u1ea1o m\u1ed9t chu tr\u00ecnh (cycle).</p> <p>Ta g\u1ecdi n\u00f3 l\u00e0 chu tr\u00ecnh v\u00ec n\u1ebfu ta t\u1ea1o m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 c\u00e1c c\u1ea1nh c\u00f3 h\u01b0\u1edbng t\u1eeb \\(i\\) \u0111\u1ebfn \\(a_i\\), th\u00ec \\(i\\) s\u1ebd n\u1eb1m trong m\u1ed9t chu tr\u00ecnh \u0111\u1ed9 d\u00e0i \\(l - 1\\).</p> <p>Ta \u0111\u00e3 xong v\u1edbi m\u1ed9t \\(i\\). L\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi t\u1ea5t c\u1ea3 \\(i\\) ngh\u0129a l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed s\u1ebd n\u1eb1m trong m\u1ed9t chu tr\u00ecnh n\u00e0o \u0111\u00f3 trong \u0111\u1ed3 th\u1ecb. V\u00ec b\u1eadc v\u00e0o v\u00e0 b\u1eadc ra c\u1ee7a m\u1ed7i \\(i\\) \u0111\u1ec1u l\u00e0 \\(1\\), c\u00e1c chu tr\u00ecnh n\u00e0y ri\u00eang r\u1ebd v\u1edbi nhau.</p> <p>V\u00ed d\u1ee5, ta c\u00f3 ho\u00e1n v\u1ecb \\([2,3,1,5,4]\\). C\u00e1c chu tr\u00ecnh c\u1ee7a m\u1ed7i ph\u1ea7n t\u1eed l\u00e0:</p> <ul> <li>\\(1 \\to 2 \\to 3 \\to 1\\)</li> <li>\\(2 \\to 3 \\to 1 \\to 2\\)</li> <li>\\(3 \\to 1 \\to 2 \\to 3\\)</li> <li>\\(4 \\to 5 \\to 4\\)</li> <li>\\(5 \\to 4 \\to 5\\)</li> </ul> <p>C\u00e1c chu tr\u00ecnh n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c chu tr\u00ecnh \\(1 \\to 2 \\to 3 \\to 1\\) v\u00e0 \\(4 \\to 5 \\to 4\\) trong \u0111\u1ed3 th\u1ecb.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#ky-hieu-chu-trinh","title":"K\u00fd hi\u1ec7u chu tr\u00ecnh","text":"<p>V\u00ec c\u00e1c chu tr\u00ecnh n\u00e0y \u0111\u1ed9c l\u1eadp, ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng v\u1edbi m\u1ed7i chu tr\u00ecnh, c\u00e1c ph\u1ea7n t\u1eed n\u1eb1m ngo\u00e0i n\u00f3 s\u1ebd kh\u00f4ng li\u00ean quan. V\u1eady v\u1edbi b\u1ea5t k\u1ef3 ho\u00e1n v\u1ecb n\u00e0o, ta ch\u1ec9 c\u1ea7n ch\u1ec9 ra nh\u1eefng chu tr\u00ecnh c\u1ee7a ch\u00fang v\u00e0 ta c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c ho\u00e1n v\u1ecb \u0111\u00f3.</p> <p>V\u1eady ta ch\u1ec9 c\u1ea7n bi\u1ec3u di\u1ec5n ho\u00e1n v\u1ecb d\u01b0\u1edbi d\u1ea1ng m\u1ed9t d\u00e3y c\u00e1c chu tr\u00ecnh c\u1ee7a n\u00f3. V\u00ed d\u1ee5, ho\u00e1n v\u1ecb \\([2,3,1,5,4]\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n l\u00e0 \\((123)(45)\\).</p> <p>L\u01b0u \u00fd, k\u00fd hi\u1ec7u n\u00e0y c\u00f3 \u00fd ngh\u0129a s\u00e2u xa h\u01a1n li\u00ean quan \u0111\u1ebfn k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb v\u00e0 c\u00e1ch c\u00e1c chu tr\u00ecnh r\u1eddi r\u1ea1c t\u00e1c \u0111\u1ed9ng \u0111\u1ebfn k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#tim-gia-tri-thu-k-tiep-theo-o-thi-chuc-nang","title":"T\u00ecm gi\u00e1 tr\u1ecb th\u1ee9 k ti\u1ebfp theo, \u0111\u1ed3 th\u1ecb ch\u1ee9c n\u0103ng","text":"<p>X\u00e9t b\u00e0i to\u00e1n sau: v\u1edbi m\u1ed9t ho\u00e1n v\u1ecb, t\u00ecm gi\u00e1 tr\u1ecb c\u1ee7a \\(a_{a_{\\ddots_{i}}}\\) v\u1edbi m\u1ecdi \\(i\\) khi ta c\u00f3 \\(k\\) ch\u1eef \\(a\\) trong k\u00fd hi\u1ec7u, \\(k \\le 10^{18}\\).</p> <p>L\u01b0u \u00fd r\u1eb1ng n\u1ebfu t\u00ecm \u0111\u01b0\u1ee3c c\u00e1c chu tr\u00ecnh, ta c\u00f3 th\u1ec3 d\u00f9ng modulo \u0111\u1ed9 d\u00e0i chu tr\u00ecnh \u0111\u1ec3 t\u00ecm ra k\u1ebft qu\u1ea3.</p> <p>Chuy\u1ec7n g\u00ec s\u1ebd x\u1ea3y ra n\u1ebfu \\(a\\) kh\u00f4ng \u0111\u1ea3m b\u1ea3o l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb nh\u01b0ng t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong \\(a\\) v\u1eabn n\u1eb1m trong \u0111o\u1ea1n \\([1,n]\\)? Khi \u0111\u00f3 th\u00ec \u0111\u1ed3 th\u1ecb s\u1ebd kh\u00f4ng c\u00f2n ch\u1ec9 t\u1ed3n t\u1ea1i c\u00e1c chu tr\u00ecnh n\u1eefa, nh\u01b0ng n\u00f3 s\u1ebd c\u00f3 t\u00ednh ch\u1ea5t nh\u01b0 sau:</p> <ul> <li>M\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng y\u1ebfu bao g\u1ed3m 2 ph\u1ea7n: m\u1ed9t chu tr\u00ecnh c\u00f3 h\u01b0\u1edbng v\u00e0 c\u00e1c c\u00e2y c\u00f3 h\u01b0\u1edbng v\u1edbi g\u1ed1c t\u1ea1i c\u00e1c \u0111\u1ec9nh ri\u00eang bi\u1ec7t trong chu tr\u00ecnh, h\u01b0\u1edbng v\u1ec1 g\u1ed1c (c\u00f2n g\u1ecdi l\u00e0 c\u00e1c c\u1ee5m c\u00e2y \u0111\u1ecbnh h\u01b0\u1edbng ng\u01b0\u1ee3c - reverse-oriented arborescences).</li> </ul> <p>B\u00e0i to\u00e1n t\u01b0\u01a1ng t\u1ef1 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i theo c\u00e1ch n\u00e0y, d\u00f9ng binary lifting cho m\u1ed7i \u0111\u1ec9nh cho \u0111\u1ebfn khi \u0111\u1ea1t \u0111\u1ebfn chu tr\u00ecnh \"ch\u00ednh\" c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a n\u00f3.</p> <p>N\u00f3i theo c\u00e1ch c\u1ee7a l\u00fd thuy\u1ebft \u0111\u1ed3 th\u1ecb, \u0111\u1ed3 th\u1ecb nh\u01b0 v\u1eady \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u1ed3 th\u1ecb ch\u1ee9c n\u0103ng (functional graph), ch\u00fang c\u00f3 b\u1eadc ra c\u1ee7a m\u1ed7i \u0111\u1ec9nh l\u00e0 \\(1\\).</p> <p>M\u1ed9t s\u1ed1 b\u00e0i luy\u1ec7n t\u1eadp l\u00e0 b\u00e0i Planet Queries I v\u00e0 Planet Queries II tr\u00ean CSES.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#oi-cho-chuyen-vi","title":"\u0110\u1ed5i ch\u1ed7 / chuy\u1ec3n v\u1ecb","text":"<p>B\u1eaft \u0111\u1ea7u t\u1eeb m\u1ea3ng \\([1, 2, \\dots, n]\\), d\u00f9ng m\u1ed9t s\u1ed1 ph\u00e9p \u0111\u1ed5i ch\u1ed7 tr\u00ean m\u1ea3ng n\u00e0y cho \u0111\u1ebfn khi ta \u0111\u1ebfn \u0111\u01b0\u1ee3c m\u1ed9t ho\u00e1n v\u1ecb mong mu\u1ed1n \\(a = [a_1, a_2, \\dots, a_n]\\). L\u01b0u \u00fd r\u1eb1ng ta lu\u00f4n c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng c\u00e1c ph\u00e9p \u0111\u1ed5i ch\u1ed7, b\u1eb1ng c\u00e1ch t\u1ea1o ho\u00e1n v\u1ecb t\u1eeb tr\u00e1i sang ph\u1ea3i. C\u00e1c ph\u00e9p \u0111\u1ed5i ch\u1ed7 n\u00e0y c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c ph\u00e9p chuy\u1ec3n v\u1ecb (transpositions).</p>"},{"location":"Codeforces/math/permutations-for-beginners/#oi-cho-trong-chu-trinh","title":"\u0110\u1ed5i ch\u1ed7 trong chu tr\u00ecnh","text":"<p>Gi\u1edd ta xem chuy\u1ec7n g\u00ec x\u1ea3y ra khi ta \u00e1p d\u1ee5ng m\u1ed9t ph\u00e9p \u0111\u1ed5i ch\u1ed7 tr\u00ean m\u1ed9t ho\u00e1n v\u1ecb. Gi\u1ea3 s\u1eed ph\u00e9p \u0111\u1ed5i ch\u1ed7 n\u00e0y \u0111\u1ed5i ch\u1ed7 hai ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \\(i\\) v\u00e0 \\(j\\). X\u00e9t \u0111\u1ed3 th\u1ecb bi\u1ec3u di\u1ec5n ho\u00e1n v\u1ecb n\u00e0y. Trong \u0111\u1ed3 th\u1ecb, \u0111\u1ed5i ch\u1ed7 hai ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \\(x\\) v\u00e0 \\(z\\) s\u1ebd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c b\u1ebb hai c\u1ea1nh \\(x \\to y\\) v\u00e0 \\(z \\to w\\) v\u00e0 t\u1ea1o hai c\u1ea1nh \\(x \\to w\\) v\u00e0 \\(z \\to y\\) (gi\u1ed1ng b\u1eaft ch\u00e9o nhau \u1ea5y).</p> <p>C\u00f3 hai tr\u01b0\u1eddng h\u1ee3p \u1edf \u0111\u00e2y:</p> <ol> <li>\\(i\\) v\u00e0 \\(j\\) n\u1eb1m kh\u00e1c chu tr\u00ecnh: hai chu tr\u00ecnh s\u1ebd nh\u1eadp l\u00e0m m\u1ed9t.</li> <li>\\(i\\) v\u00e0 \\(j\\) n\u1eb1m trong c\u00f9ng m\u1ed9t chu tr\u00ecnh: chu tr\u00ecnh n\u00e0y s\u1ebd t\u00e1ch ra l\u00e0m hai.</li> </ol> <p>B\u1ea1n c\u00f3 th\u1ec3 l\u00e0m th\u1eed b\u00e0i 1768D - Lucky Permutation.</p> <p>Th\u00eam m\u1ed9t b\u00e0i s\u1eafp x\u1ebfp ho\u00e1n v\u1ecb kh\u00e1c, nh\u01b0ng ta kh\u00f4ng ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u1ed5i ch\u1ed7 hai ph\u1ea7n t\u1eed c\u1ea1nh nhau, ta c\u00f3 th\u1ec3 \u0111\u1ed5i ch\u1ed7 b\u1ea5t k\u1ef3 c\u1eb7p n\u00e0o. S\u1ed1 l\u1ea7n \u0111\u1ed5i ch\u1ed7 \u00edt nh\u1ea5t c\u1ea7n \u0111\u1ec3 s\u1eafp x\u1ebfp m\u1ea3ng n\u00e0y l\u00e0 bao nhi\u00eau?</p> <p>L\u01b0u \u00fd r\u1eb1ng \u1edf k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng (ho\u00e1n v\u1ecb \u0111\u00e3 s\u1eafp x\u1ebfp), ta s\u1ebd c\u00f3 \u0111\u00fang \\(n\\) chu tr\u00ecnh (\u0111\u1ec9nh n\u1ed1i ch\u00ednh n\u00f3). Gi\u1ea3 s\u1eed gi\u1edd ta c\u00f3 \\(c\\) chu tr\u00ecnh. V\u00ec s\u1ed1 chu tr\u00ecnh t\u0103ng 1 m\u1ed7i l\u1ea7n \u0111\u1ed5i ch\u1ed7, ta s\u1ebd c\u1ea7n \u00edt nh\u1ea5t \\(n - c\\) l\u1ea7n \u0111\u1ed5i ch\u1ed7 \u0111\u1ec3 s\u1eafp x\u1ebfp ho\u00e1n v\u1ecb n\u00e0y.</p> <p>Nh\u01b0ng \u0111\u00f3 c\u00f3 ph\u1ea3i \u0111\u00e1p \u00e1n th\u1ef1c s\u1ef1 kh\u00f4ng? \u0110\u00fang. Ta c\u00f3 th\u1ec3 \u0111\u1ed5i ch\u1ed7 c\u00e1c ph\u1ea7n t\u1eed trong c\u00f9ng chu tr\u00ecnh khi \u0111\u1ed9 d\u00e0i chu tr\u00ecnh t\u1eeb \\(2\\) tr\u1edf l\u00ean, v\u00e0 \u0111\u1ebfn cu\u1ed1i c\u00f9ng n\u00f3 s\u1ebd s\u1eafp x\u1ebfp ho\u00e1n v\u1ecb \u0111\u1ec1 b\u00e0i.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#goc-nhin-ket-hop-hoan-vi","title":"G\u00f3c nh\u00ecn k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb","text":""},{"location":"Codeforces/math/permutations-for-beginners/#inh-nghia_1","title":"\u0110\u1ecbnh ngh\u0129a","text":"<p>Gi\u1ea3 s\u1eed ta c\u00f3 hai ho\u00e1n v\u1ecb \\(a\\) v\u00e0 \\(b\\) c\u00f3 c\u00f9ng \u0111\u1ed9 d\u00e0i \\(n\\). Gi\u1edd ta mu\u1ed1n \u0111\u1ecbnh ngh\u0129a k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb nh\u01b0 sau: \\(ab\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 m\u1ea3ng \\(c\\) sao cho \\(c_i = a_{b_i}\\).</p> <p>\u0110i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi vi\u1ec7c t\u00ecm h\u1ee3p c\u1ee7a h\u00e0m \\(g\\) c\u1ee7a \\(a\\) v\u00e0 \\(b\\), v\u1edbi \\(g\\) c\u1ee7a \\(b\\) \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng tr\u01b0\u1edbc.</p> <p>\u0110\u1ec3 cho d\u1ec5 hi\u1ec3u th\u00ec ta \u0111i v\u00e0o ph\u00e2n t\u00edch m\u1ed9t ch\u00fat. \u0110\u1ea7u ti\u00ean ta x\u00e9t tr\u01b0\u1eddng h\u1ee3p khi t\u1ea5t c\u1ea3 \\(b_i = i\\) (ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t), th\u00ec \\(c = a\\) theo \u0111\u1ecbnh ngh\u0129a. T\u01b0\u01a1ng t\u1ef1, n\u1ebfu \\(a\\) l\u00e0 ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t th\u00ec \\(c = b\\). Nh\u01b0 v\u1eady vi\u1ec7c k\u1ebft h\u1ee3p v\u1edbi ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t theo b\u1ea5t k\u1ef3 th\u1ee9 t\u1ef1 n\u00e0o c\u0169ng s\u1ebd cho ra l\u1ea1i ho\u00e1n v\u1ecb ban \u0111\u1ea7u.</p> <p>Gi\u1edd ta h\u00e3y d\u00f9ng k\u00fd hi\u1ec7u hai d\u00f2ng \u0111\u1ec3 di\u1ec5n t\u1ea3. X\u00e9t hai ho\u00e1n v\u1ecb \\(a\\) v\u00e0 \\(b\\) nh\u01b0 sau:</p> \\[ \\begin{equation*} \\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n \\\\ a_1 &amp; a_2 &amp; \\cdots &amp; a_n \\end{pmatrix} \\end{equation*} \\] <p>v\u00e0 </p> \\[ \\begin{equation*} \\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n \\\\ b_1 &amp; b_2 &amp; \\cdots &amp; b_n \\end{pmatrix} \\end{equation*} \\] <p>S\u1eafp x\u1ebfp l\u1ea1i c\u00e1c c\u1ed9t trong k\u00fd hi\u1ec7u hai d\u00f2ng c\u1ee7a \\(a\\) sao cho h\u00e0ng d\u01b0\u1edbi c\u1ee7a \\(b\\) \u1ee9ng v\u1edbi h\u00e0ng tr\u00ean c\u1ee7a \\(a\\). Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c x\u00e1o c\u00e1c c\u1ed9t c\u1ee7a \\(a\\) theo \\(b\\):</p> \\[ \\begin{equation*} \\begin{pmatrix} b_1 &amp; b_2 &amp; \\cdots &amp; b_n \\\\ a_{b_1} &amp; a_{b_2} &amp; \\cdots &amp; a_{b_n} \\end{pmatrix} \\end{equation*} \\] <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u00e2y v\u1eabn l\u00e0 k\u00fd hi\u1ec7u hai d\u00f2ng chu\u1ea9n cho \\(a\\). Gi\u1edd n\u1ebfu ta \"ch\u1eadp\" n\u00f3 v\u1edbi k\u00fd hi\u1ec7u hai d\u00f2ng c\u1ee7a \\(b\\), ta s\u1ebd c\u00f3 k\u00fd hi\u1ec7u hai d\u00f2ng c\u1ee7a h\u1ee3p c\u1ee7a \\(a\\) v\u00e0 \\(b\\).</p> <p>\u0110i\u1ec1u n\u00e0y gi\u1ea3i th\u00edch m\u1ed9t c\u00e1ch t\u1ef1 nhi\u00ean v\u00ec sao ho\u00e1n v\u1ecb l\u1ea1i \u0111\u01b0\u1ee3c xem nh\u01b0 m\u1ed9t song \u00e1nh tr\u00ean m\u1ed9t t\u1eadp h\u1ee3p.</p> <p>Ta b\u1eaft \u0111\u1ea7u v\u1edbi ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t, r\u1ed3i \u00e1p ho\u00e1n v\u1ecb \u0111\u1ea7u ti\u00ean v\u00e0o, r\u1ed3i \u00e1p ho\u00e1n v\u1ecb th\u1ee9 hai v\u00e0o. \u00c1p d\u1ee5ng v\u00e0o ngh\u0129a l\u00e0 thay \\(x \\mapsto a_x\\). K\u00fd hi\u1ec7u hai d\u00f2ng c\u1ee7a ho\u00e1n v\u1ecb \\(a\\) c\u00f3 t\u00ednh ch\u1ea5t nh\u01b0 sau:</p> <ul> <li>N\u1ebfu ho\u00e1n v\u1ecb h\u00e0ng tr\u00ean l\u00e0 \\(p\\) th\u00ec ho\u00e1n v\u1ecb h\u00e0ng d\u01b0\u1edbi l\u00e0 \\(ap\\).</li> </ul>"},{"location":"Codeforces/math/permutations-for-beginners/#vi-du-chu-trinh-va-oi-cho","title":"V\u00ed d\u1ee5 - chu tr\u00ecnh v\u00e0 \u0111\u1ed5i ch\u1ed7","text":"<p>L\u01b0u \u00fd r\u1eb1ng ta c\u00f3 th\u1ec3 li\u00ean k\u1ebft m\u1ed9t chu tr\u00ecnh v\u1edbi m\u1ed9t ho\u00e1n v\u1ecb, trong \u0111\u00f3 c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng ph\u1ea3i l\u00e0 chu tr\u00ecnh l\u00e0 c\u00e1c \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh, v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c \u00e1nh x\u1ea1 theo chu tr\u00ecnh. Theo ngh\u0129a n\u00e0y, c\u00e1c chu tr\u00ecnh l\u00e0 c\u00e1c ho\u00e1n v\u1ecb.</p> <p>C\u0169ng l\u01b0u \u00fd r\u1eb1ng m\u1ed9t ph\u00e9p \u0111\u1ed5i ch\u1ed7 c\u0169ng l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb theo ngh\u0129a nh\u01b0 v\u1eady. Th\u1ef1c t\u1ebf, m\u1ed9t thao t\u00e1c \u0111\u1ed5i ch\u1ed7 ch\u1ec9 l\u00e0 m\u1ed9t chu tr\u00ecnh \u0111\u1ed9 d\u00e0i \\(2\\).</p> <p>B\u1ea1n c\u00f3 th\u1ec3 vi\u1ebft ra v\u00e0i v\u00ed d\u1ee5 v\u1ec1 \u0111\u1ed5i ch\u1ed7 v\u00e0 chu tr\u00ecnh v\u00e0 vi\u1ebft ch\u00fang d\u01b0\u1edbi d\u1ea1ng k\u00fd hi\u1ec7u hai d\u00f2ng \u0111\u1ec3 hi\u1ec3u c\u00e1ch ch\u00fang \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh v\u00e0 \u00e1nh x\u1ea1.</p> <p>\u0110\u1ebfn \u0111\u00e2y, ta c\u1ea7n nh\u1edb hai \u0111i\u1ec1u sau:</p> <ol> <li>Khi gi\u1edbi thi\u1ec7u v\u1ec1 chu tr\u00ecnh, ta vi\u1ebft ch\u00fang d\u01b0\u1edbi m\u1ed9t format nh\u1ea5t \u0111\u1ecbnh. Th\u1ef1c t\u1ebf, b\u1ea1n c\u00f3 th\u1ec3 vi\u1ebft c\u00e1c chu tr\u00ecnh r\u1eddi r\u1ea1c m\u00e0 kh\u00f4ng c\u1ea7n quan t\u00e2m \u0111\u1ebfn th\u1ee9 t\u1ef1 ch\u00fang \u0111\u01b0\u1ee3c vi\u1ebft nh\u01b0 th\u1ebf n\u00e0o. Vi\u1ec7c n\u00e0y \u0111i t\u1eeb th\u1ef1c t\u1ebf r\u1eb1ng ch\u00fang \u0111\u1ed9c l\u1eadp theo m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3 (m\u1ed9t ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c di chuy\u1ec3n trong m\u1ed9t ho\u00e1n v\u1ecb s\u1ebd l\u00e0 \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh c\u1ee7a c\u00e1c ho\u00e1n v\u1ecb c\u00f2n l\u1ea1i). B\u1ea1n c\u0169ng c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng k\u00fd hi\u1ec7u \\((123)(45)\\) c\u0169ng cho ta th\u1ea5y r\u1eb1ng ho\u00e1n v\u1ecb n\u00e0y bao g\u1ed3m hai chu tr\u00ecnh \\((123)\\) v\u00e0 \\((45)\\).</li> <li>Khi ta n\u00f3i v\u1ec1 vi\u1ec7c \u0111\u1ed5i ch\u1ed7, \u00fd \u1edf \u0111\u00e2y l\u00e0 th\u1ef1c s\u1ef1 \u0111\u1ed5i ch\u1ed7 c\u00e1c ph\u1ea7n t\u1eed. N\u00f3 t\u01b0\u01a1ng \u1ee9ng v\u1edbi vi\u1ec7c nh\u00e2n ho\u00e1n v\u1ecb v\u1edbi m\u1ed9t ho\u00e1n v\u1ecb \u0111\u1ed5i ch\u1ed7 t\u01b0\u01a1ng \u1ee9ng. S\u1ebd d\u1ec5 hi\u1ec3u h\u01a1n n\u1ebfu b\u1ea1n c\u00f3 m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 v\u1ec1 vi\u1ec7c \u0111\u1ed5i ch\u1ed7 v\u00e0 c\u00e1ch ch\u00fang c\u00f3 th\u1ec3 k\u1ebft h\u1ee3p v\u1edbi nhau.</li> </ol> <p>\u0110i\u1ec1u quan tr\u1ecdng c\u1ea7n l\u01b0u \u00fd l\u00e0 h\u1ee3p ho\u00e1n v\u1ecb c\u00f3 t\u00ednh k\u1ebft h\u1ee3p.</p> <p>Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t ho\u00e1n v\u1ecb \u0111\u01b0\u1ee3c t\u1ea1o ra t\u1eeb vi\u1ec7c \u00e1p d\u1ee5ng 3 ho\u00e1n v\u1ecb sau: \\((12)\\), \\((312)(43)\\) v\u00e0 \\((53241)\\) theo th\u1ee9 t\u1ef1 nh\u01b0 v\u1eady, ta s\u1ebd vi\u1ebft ch\u00fang th\u00e0nh \\((53241)(312)(43)(12)\\). L\u01b0u \u00fd r\u1eb1ng \\((12)\\) v\u00e0 \\((43)\\) l\u00e0 c\u00e1c chu tr\u00ecnh \u0111\u1ed9 d\u00e0i \\(2\\), ngh\u0129a l\u00e0 ch\u00fang l\u00e0 c\u00e1c ph\u00e9p \u0111\u1ed5i ch\u1ed7.</p> <p>Gi\u1edd l\u00e0m sao \u0111\u1ec3 \u0111\u01b0a n\u00f3 v\u1ec1 l\u1ea1i m\u1ed9t ho\u00e1n v\u1ecb b\u00ecnh th\u01b0\u1eddng? C\u00f3 m\u1ed9t c\u00e1ch l\u00e0 vi\u1ebft ho\u00e1n v\u1ecb c\u1ee7a m\u1ed7i chu tr\u00ecnh v\u00e0 t\u1ea1o ra n\u00f3. M\u1ed9t c\u00e1ch t\u1ed1t \u0111\u1ec3 l\u00e0m vi\u1ec7c n\u00e0y l\u00e0: v\u1edbi m\u1ed7i ph\u1ea7n t\u1eed, \u0111i t\u1eeb b\u00ean ph\u1ea3i, v\u00e0 thay n\u00f3 b\u1eb1ng c\u00e1i m\u00e0 chu tr\u00ecnh ch\u1ee9a n\u00f3 \u00e1nh x\u1ea1 t\u1edbi. V\u00ed d\u1ee5, n\u1ebfu ta mu\u1ed1n t\u00ecm \u1ea3nh c\u1ee7a \\(1\\), chu tr\u00ecnh \u0111\u1ea7u ti\u00ean s\u1ebd \u00e1nh x\u1ea1 \\(1\\) t\u1edbi \\(2\\), chu tr\u00ecnh th\u1ee9 hai s\u1ebd \u00e1nh x\u1ea1 \\(2\\) t\u1edbi \\(2\\), chu tr\u00ecnh th\u1ee9 ba s\u1ebd \u00e1nh x\u1ea1 \\(2\\) t\u1edbi \\(3\\), v\u00e0 chu tr\u00ecnh cu\u1ed1i c\u00f9ng s\u1ebd \u00e1nh x\u1ea1 \\(3\\) t\u1edbi \\(2\\).</p>"},{"location":"Codeforces/math/permutations-for-beginners/#tinh-chan-le-cua-hoan-vi","title":"T\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb","text":"<p>\u1ede tr\u00ean th\u00ec ta \u0111\u00e3 \u0111\u1ec1 c\u1eadp \u0111\u1ebfn vi\u1ec7c \u0111\u1ed5i ch\u1ed7 hai ph\u1ea7n t\u1eed c\u1ea1nh nhau s\u1ebd gi\u1ea3m s\u1ed1 ngh\u1ecbch th\u1ebf \u0111i \\(1\\). Ch\u00ednh x\u00e1c h\u01a1n th\u00ec n\u00f3 s\u1ebd \\(\\pm 1\\) s\u1ed1 ngh\u1ecbch th\u1ebf, v\u00e0 s\u1ebd thay \u0111\u1ed5i t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a s\u1ed1 ngh\u1ecbch th\u1ebf c\u1ee7a ho\u00e1n v\u1ecb.</p> <p>Ta \u0111\u1ecbnh ngh\u0129a t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb l\u00e0 t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a s\u1ed1 ngh\u1ecbch th\u1ebf c\u1ee7a ho\u00e1n v\u1ecb \u0111\u00f3.</p> <p>\u0110i\u1ec1u n\u00e0y quan tr\u1ecdng v\u00ec n\u00f3 gi\u00fap x\u00e1c \u0111\u1ecbnh t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a c\u00e1c ph\u00e9p \u0111\u1ed5i ch\u1ed7 (kh\u00f4ng ch\u1ec9 l\u00e0 c\u00e1c ph\u00e9p \u0111\u1ed5i ch\u1ed7 li\u1ec1n k\u1ec1) c\u0169ng nh\u01b0 m\u1ed9t s\u1ed1 th\u00f4ng tin v\u1ec1 t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a c\u00e1c chu tr\u00ecnh, nh\u01b0 sau.</p> <p>X\u00e9t m\u1ed9t ph\u00e9p \u0111\u1ed5i ch\u1ed7 hai ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \\(i &lt; j\\). V\u1eady th\u00ec n\u00f3 s\u1ebd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c \u00e1p d\u1ee5ng \\(j-i\\) ph\u00e9p \u0111\u1ed5i ch\u1ed7 li\u1ec1n k\u1ec1 \u0111\u1ec3 mang \\(a_j\\) v\u1ec1 v\u1ecb tr\u00ed \\(i\\), v\u00e0 \\(j-i-1\\) ph\u00e9p \u0111\u1ed5i ch\u1ed7 li\u1ec1n k\u1ec1 \u0111\u1ec3 mang \\(a_i\\) (t\u1eeb v\u1ecb tr\u00ed m\u1edbi c\u1ee7a n\u00f3) \u0111\u1ebfn v\u1ecb tr\u00ed \\(j\\). N\u00f3 s\u1ebd t\u1ed1n s\u1ed1 l\u1ebb l\u1ea7n \u0111\u1ed5i ch\u1ed7 li\u1ec1n k\u1ec1, n\u00ean n\u00f3 s\u1ebd thay \u0111\u1ed5i t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb.</p> <p>Nh\u01b0 m\u1ed9t h\u1ec7 qu\u1ea3 t\u1ea5t y\u1ebfu, vi\u1ec7c \u00e1p d\u1ee5ng b\u1ea5t k\u1ef3 ph\u00e9p \u0111\u1ed5i ch\u1ed7 n\u00e0o s\u1ebd l\u00e0m thay \u0111\u1ed5i t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb, v\u00e0 c\u1ee5 th\u1ec3 h\u01a1n, t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb \u0111\u1ed5i ch\u1ed7 \u0111\u1ec1u c\u00f3 t\u00ednh l\u1ebb.</p> <p>Gi\u1edd l\u01b0u \u00fd r\u1eb1ng v\u1edbi m\u1ed9t chu tr\u00ecnh, ta c\u00f3 th\u1ec3 t\u1ea1o ra n\u00f3 v\u1edbi m\u1ed9t s\u1ed1 ph\u00e9p \u0111\u1ed5i ch\u1ed7. C\u1ee5 th\u1ec3 h\u01a1n, n\u1ebfu chu tr\u00ecnh l\u00e0 \\((i_1, i_2, \\dots, i_k)\\), ta c\u00f3 th\u1ec3 d\u00f9ng \\(k-1\\) ph\u00e9p \u0111\u1ed5i ch\u1ed7 \u0111\u1ec3 \u00e1p d\u1ee5ng bi\u1ebfn \u0111\u1ed5i t\u01b0\u01a1ng t\u1ef1 nh\u01b0 ho\u00e1n v\u1ecb chu tr\u00ecnh.</p> <p>V\u1eady t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh ch\u1eb5n s\u1ebd c\u00f3 t\u00ednh l\u1ebb, v\u00e0 t\u1ea5t c\u00e1c chu tr\u00ecnh l\u1ebb s\u1ebd c\u00f3 t\u00ednh ch\u1eb5n.</p> <p>X\u00e9t m\u1ed9t s\u1ef1 ph\u00e2n r\u00e3 b\u1ea5t k\u1ef3 c\u1ee7a m\u1ed9t ho\u00e1n v\u1ecb th\u00e0nh c\u00e1c chu tr\u00ecnh (c\u00f3 th\u1ec3 kh\u00f4ng r\u1eddi r\u1ea1c). Theo k\u1ebft qu\u1ea3 \u1edf tr\u00ean, t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb l\u00e0 l\u1ebb khi v\u00e0 ch\u1ec9 khi s\u1ed1 chu tr\u00ecnh ch\u1eb5n l\u00e0 l\u1ebb.</p> <p>C\u1ee5 th\u1ec3, v\u1edbi vi\u1ec7c ph\u00e2n r\u00e3 m\u1ed9t ho\u00e1n v\u1ecb th\u00e0nh c\u00e1c ph\u00e9p \u0111\u1ed5i ch\u1ed7, t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb s\u1ebd gi\u1ed1ng t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a s\u1ed1 l\u1ea7n \u0111\u1ed5i ch\u1ed7 trong ph\u00e2n r\u00e3 \u0111\u00f3. L\u01b0u \u00fd r\u1eb1ng \u0111i\u1ec1u n\u00e0y c\u0169ng t\u01b0\u01a1ng \u0111u\u01a1ng v\u1edbi vi\u1ec7c kh\u00f4ng th\u1ec3 c\u00f3 hai c\u00e1ch ph\u00e2n r\u00e3 v\u1edbi hi\u1ec7u s\u1ed1 l\u1ea7n \u0111\u1ed5i ch\u1ed7 l\u00e0 l\u1ebb.</p> <p>T\u1eeb k\u1ebft qu\u1ea3 tr\u00ean, ta c\u00f3 m\u1ed9t fact l\u00e0 n\u1ebfu c\u1ea7n m\u1ed9t s\u1ed1 l\u1ebb ph\u00e9p \u0111\u1ed5i ch\u1ed7 \u0111\u1ec3 t\u1ea1o ra m\u1ed9t ho\u00e1n v\u1ecb, ho\u00e1n v\u1ecb \u0111\u00f3 s\u1ebd c\u00f3 t\u00ednh l\u1ebb v\u00e0 ng\u01b0\u1ee3c l\u1ea1i.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#tinh-chan-le-khi-ket-hop","title":"T\u00ednh ch\u1eb5n l\u1ebb khi k\u1ebft h\u1ee3p","text":"<p>R\u00f5 r\u00e0ng, t\u1eeb tr\u00ean ta suy ra \u0111\u01b0\u1ee3c t\u00ednh ch\u1eb5n l\u1ebb c\u1ed9ng d\u1ed3n v\u1edbi modulo 2 khi k\u1ebft h\u1ee3p. C\u00e1i n\u00e0y kh\u00e1 quan tr\u1ecdng \u0111\u1ec3 c\u00f3 m\u1ed9t ph\u1ea7n ri\u00eang v\u00ec n\u00f3 t\u00f3m t\u1eaft t\u1ea5t c\u1ea3 c\u00e1c \u00fd \u1edf tr\u00ean.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#nghich-ao-cua-hoan-vi","title":"Ngh\u1ecbch \u0111\u1ea3o c\u1ee7a ho\u00e1n v\u1ecb","text":"<p>Ta x\u00e9t ho\u00e1n v\u1ecb trong ho\u00e0n c\u1ea3nh th\u1ef1c t\u1ebf. C\u00f3 c\u00e1ch n\u00e0o \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c ho\u00e1n v\u1ecb ban \u0111\u1ea7u sau khi c\u00f3 m\u1ed9t s\u1ed1 ho\u00e1n v\u1ecb kh\u00e1c \u0111\u00e3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng v\u00e0o n\u00f3 kh\u00f4ng? T\u1eeb c\u00e1c l\u01b0u \u00fd trong ph\u1ea7n k\u00fd hi\u1ec7u hai d\u00f2ng, ch\u1ec9 c\u1ea7n l\u00e0m nh\u01b0 sau l\u00e0 \u0111\u1ee7 v\u1edbi ho\u00e1n v\u1ecb ban \u0111\u1ea7u l\u00e0 ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t. Gi\u1ea3 s\u1eed ho\u00e1n v\u1ecb \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng l\u00e0 \\(a\\):</p> \\[ \\begin{equation*}  \\begin{pmatrix} 1 &amp; 2 &amp; \\cdots &amp; n \\\\ a_1 &amp; a_2 &amp; \\cdots &amp; a_n \\end{pmatrix}  \\end{equation*} \\] <p>Theo nh\u01b0 l\u01b0u \u00fd v\u1ec1 k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb d\u00f9ng k\u00fd hi\u1ec7u hai d\u00f2ng, ta c\u1ea7n \u0111\u1ea3o hai d\u00f2ng nh\u01b0 sau:</p> \\[ \\begin{equation*} \\begin{pmatrix} a_1 &amp; a_2 &amp; \\cdots &amp; a_n\\\\ 1 &amp; 2 &amp; \\cdots &amp; n \\end{pmatrix} \\end{equation*} \\] <p>X\u00e9t m\u1ea3ng v\u1ecb tr\u00ed \\(p\\) c\u1ee7a \\(a\\) ta \u0111\u1ecbnh ngh\u0129a \u1edf tr\u00ean, t\u1ee9c l\u00e0 \\(p_i\\) l\u00e0 v\u1ecb tr\u00ed m\u00e0 c\u00f3 \\(a\\) c\u00f3 gi\u00e1 tr\u1ecb l\u00e0 \\(i\\), ngh\u0129a l\u00e0 \\(a_{p_i} = i\\). L\u01b0u \u00fd r\u1eb1ng \\(a\\) c\u00f3 gi\u00e1 tr\u1ecb \\(a_i\\) \u1edf v\u1ecb tr\u00ed \\(i\\), n\u00ean \\(p_{a_i}\\) l\u00e0 v\u1ecb tr\u00ed m\u00e0 \\(a\\) c\u00f3 gi\u00e1 tr\u1ecb l\u00e0 \\(a_i\\), ngh\u0129a l\u00e0 \\(p_{a_i} = i\\). Suy ra \\(pa = ap\\), v\u00e0 gi\u00e1 tr\u1ecb chung n\u00e0y g\u1ecdi l\u00e0 ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t - identity permutation, ta s\u1ebd g\u1ecdi n\u00f3 l\u00e0 \\(\\text{id}\\) lu\u00f4n nh\u00e9.</p> <p>N\u00f3i c\u00e1ch kh\u00e1c, \\(p\\) v\u00e0 \\(a\\) ngh\u1ecbch nhau khi k\u1ebft h\u1ee3p. L\u01b0u \u00fd r\u1eb1ng \\(a\\) c\u0169ng l\u00e0 m\u1ea3ng v\u1ecb tr\u00ed c\u1ee7a \\(p\\). Ta g\u1ecdi \\(p\\) l\u00e0 \\(a^{-1}\\).</p> <p>Gi\u1edd ta c\u00f3 m\u1ed9t s\u1ed1 hi\u1ec3u bi\u1ebft v\u1ec1 ho\u00e1n v\u1ecb ngh\u1ecbch \u0111\u1ea3o theo k\u00fd hi\u1ec7u hai d\u00f2ng, c\u00f2n theo chu tr\u00ecnh, \u0111\u1ed5i ch\u1ed7, k\u1ebft h\u1ee3p th\u00ec nh\u01b0 th\u1ebf n\u00e0o?</p> <ol> <li>Ngh\u1ecbch \u0111\u1ea3o c\u1ee7a chu tr\u00ecnh \\((i_1, i_2, \\dots, i_k)\\) s\u1ebd l\u00e0 \\((i_k, \\dots, i_2, i_1)\\). Ta \u0111\u01a1n gi\u1ea3n \u0111\u1ea3o t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh c\u00f3 h\u01b0\u1edbng c\u1ee7a \u0111\u1ed3 th\u1ecb.</li> <li>Ngh\u1ecbch \u0111\u1ea3o c\u1ee7a m\u1ed9t ph\u00e9p \u0111\u1ed5i ch\u1ed7 l\u00e0 ch\u00ednh n\u00f3. \u0110\u01a1n gi\u1ea3n l\u00e0 v\u00ec n\u00f3 l\u00e0 chu tr\u00ecnh \u0111\u1ed9 d\u00e0i \\(2\\).</li> <li>Ngh\u1ecbch \u0111\u1ea3o c\u1ee7a m\u1ed9t ph\u00e9p k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb \\(ab\\) l\u00e0 \\(b^{-1} a^{-1}\\). \u0110i\u1ec1u n\u00e0y t\u01b0\u01a1ng \u1ee9ng v\u1edbi vi\u1ec7c ho\u00e0n t\u00e1c vi\u1ec7c \u00e1p d\u1ee5ng ho\u00e1n v\u1ecb tr\u00ean m\u1ed9t stack v\u00e0 c\u0169ng c\u00f3 \u00fd ngh\u0129a \u0111\u1ea1i s\u1ed1 nh\u01b0 sau: \\(abb^{-1}a^{-1} = aa^{-1} = \\text{id} = b^{-1}b = b^{-1}a^{-1}ab\\).</li> </ol> <p>C\u1ee5 th\u1ec3, \u0111\u1ec3 ph\u00e2n t\u00e1ch m\u1ed9t ho\u00e1n v\u1ecb th\u00e0nh c\u00e1c chu tr\u00ecnh (kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i r\u1eddi r\u1ea1c), ta ch\u1ec9 c\u1ea7n l\u1ea5y \u1ea3nh ph\u1ea3n chi\u1ebfu c\u1ee7a ph\u00e2n r\u00e3 \u0111\u00f3, n\u00f3 s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi ngh\u1ecbch \u0111\u1ea3o c\u1ee7a ho\u00e1n v\u1ecb!</p> <p>Th\u00eam n\u1eefa, t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb ngh\u1ecbch \u0111\u1ea3o c\u0169ng y nh\u01b0 t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a ho\u00e1n v\u1ecb g\u1ed1c.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#involution","title":"Involution","text":"<p>M\u1ed9t involution l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb c\u00f3 ngh\u1ecbch \u0111\u1ea3o l\u00e0 ch\u00ednh n\u00f3. X\u00e9t s\u1ef1 ph\u00e2n t\u00e1ch m\u1ed9t ho\u00e1n v\u1ecb \\(a\\) th\u00e0nh c\u00e1c chu tr\u00ecnh r\u1eddi r\u1ea1c \\(a = c_1 \\dots c_k\\). \\(a = a^{-1}\\) ngh\u0129a l\u00e0 \\(\\text{id} = a^2 = \\prod_i c_i^2\\). Ta vi\u1ebft \u0111\u01b0\u1ee3c nh\u01b0 th\u1ebf v\u00ec c\u00e1c chu tr\u00ecnh r\u1eddi r\u1ea1c giao ho\u00e1n v\u00e0 c\u00e1c chu tr\u00ecnh gi\u1ed1ng nhau c\u0169ng v\u1eady. \\(c_i^2\\) ph\u1ea3i l\u00e0 m\u1ed9t map nh\u1eadn d\u1ea1ng tr\u00ean c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \\(c_i\\) v\u00ec n\u1ebfu kh\u00f4ng th\u00ec ho\u00e1n v\u1ecb k\u1ebft qu\u1ea3 s\u1ebd kh\u00f4ng ph\u1ea3i l\u00e0 \\(\\text{id}\\). \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 \\(c_i\\) c\u00f3 \u0111\u1ed9 d\u00e0i \\(1\\) ho\u1eb7c \\(2\\). Ng\u01b0\u1ee3c l\u1ea1i, c\u00f3 th\u1ec3 ki\u1ec3m tra xem c\u00e1c ho\u00e1n v\u1ecb n\u00e0y c\u00f3 ph\u1ea3i involution hay kh\u00f4ng.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#mu-k-cua-hoan-vi","title":"M\u0169 k c\u1ee7a ho\u00e1n v\u1ecb","text":"<p>V\u00ec ph\u00e9p k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb c\u00f3 t\u00ednh k\u1ebft h\u1ee3p, ta c\u00f3 th\u1ec3 d\u00f9ng lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n \u0111\u1ec3 t\u00ednh ho\u00e1n v\u1ecb. M\u1ed9t c\u00e1ch to\u00e1n h\u1ecdc h\u01a1n \u0111\u1ec3 l\u00e0m l\u00e0 d\u00f9ng c\u00e1ch t\u01b0\u01a1ng t\u1ef1 v\u1edbi ph\u1ea7n tr\u01b0\u1edbc. V\u1edbi \u0111\u1ecbnh ngh\u0129a t\u01b0\u01a1ng t\u1ef1 ph\u1ea7n tr\u01b0\u1edbc, v\u1edbi m\u1ecdi \\(a\\), \\(a^k = \\prod_i c_i^k\\), v\u00ec th\u1ebf n\u00ean c\u1ea5u tr\u00fac chu tr\u00ecnh s\u1ebd \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh b\u1edfi s\u1ed1 m\u0169 c\u1ee7a chu tr\u00ecnh.</p> <p>Vi\u1ec7c t\u00ecm m\u0169 \\(k\\) c\u1ee7a m\u1ed9t chu tr\u00ecnh c\u0169ng t\u01b0\u01a1ng \u1ee9ng v\u1edbi vi\u1ec7c \u00e1nh x\u1ea1 n\u00f3 \u0111\u1ebfn \u0111i\u1ec3m th\u1ee9 \\(k\\) ti\u1ebfp theo c\u1ee7a n\u00f3 tr\u00ean chu tr\u00ecnh. N\u1ebfu \u0111\u1ed9 d\u00e0i chu tr\u00ecnh l\u00e0 \\(c\\) v\u00e0 \\(g = gcd(c, k)\\), th\u00ec vi\u1ec7c ph\u00e2n t\u00e1ch chu tr\u00ecnh r\u1eddi r\u1ea1c \\(c^k\\) g\u1ed3m \\(g\\) chu tr\u00ecnh, v\u1edbi m\u1ed7i chu tr\u00ecnh t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t b\u01b0\u1edbc \u0111\u1ed9 d\u00e0i \\(k\\) d\u1ecdc theo chu tr\u00ecnh ban \u0111\u1ea7u.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#thu-tu-cua-hoan-vi","title":"Th\u1ee9 t\u1ef1 c\u1ee7a ho\u00e1n v\u1ecb","text":"<p>Th\u1ee9 t\u1ef1 c\u1ee7a ho\u00e1n v\u1ecb \\(a\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 \\(k\\) nh\u1ecf nh\u1ea5t sao cho \\(a^k\\) l\u00e0 ho\u00e1n v\u1ecb \u0111\u1ed3ng nh\u1ea5t. Xem l\u1ea1i ph\u1ea7n tr\u01b0\u1edbc, v\u1edbi chu tr\u00ecnh \\(c\\) \u0111\u1ed9 d\u00e0i \\(l\\) c\u1ea7n ph\u00e2n t\u00e1ch th\u00e0nh c\u00e1c \u0111i\u1ec3m c\u1ed1 \u0111\u1ecbnh, \u0111i\u1ec3u ki\u1ec7n c\u1ea7n v\u00e0 \u0111\u1ee7 l\u00e0 s\u1ed1 m\u0169 c\u1ee7a ho\u00e1n v\u1ecb chia h\u1ebft cho \\(l\\). V\u1eady th\u1ef1 t\u1ef1 c\u1ee7a ho\u00e1n v\u1ecb ch\u1ec9 l\u00e0 b\u1ed9i chung nh\u1ecf nh\u1ea5t c\u1ee7a \u0111\u1ed9 d\u00e0i c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c chu tr\u00ecnh.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#can-bac-hai-cua-hoan-vi","title":"C\u0103n b\u1eadc hai c\u1ee7a ho\u00e1n v\u1ecb","text":"<p>Ph\u1ea7n n\u00e0y ta s\u1ebd gi\u1ea3i b\u00e0i t\u1eadp sau 612E - Square Root of Permutation. B\u00e0i n\u00e0y s\u1ebd kh\u00f4ng kh\u00f3 v\u1edbi nh\u1eefng ki\u1ebfn th\u1ee9c \u1edf c\u00e1c ph\u1ea7n tr\u01b0\u1edbc.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#lien-hop-va-lop-lien-hop","title":"Li\u00ean h\u1ee3p v\u00e0 l\u1edbp li\u00ean h\u1ee3p","text":"<p>Cho hai ho\u00e1n v\u1ecb \\(a\\), \\(b\\). X\u00e9t ho\u00e1n v\u1ecb \\(aba^{-1}\\). Nh\u1edb l\u1ea1i c\u00e1ch k\u1ebft h\u1ee3p k\u00fd hi\u1ec7u hai d\u00f2ng cho vi\u1ec7c k\u1ebft h\u1ee3p c\u00e1c ho\u00e1n v\u1ecb n\u00e0y, \u0111\u00e2y ch\u1ec9 l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb c\u00f3 ph\u00e2n t\u00e1ch chu tr\u00ecnh g\u1ea7n gi\u1ed1ng \\(b\\), nh\u01b0ng \\(a\\) \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho m\u1ed7i ph\u1ea7n t\u1eed trong chu tr\u00ecnh. N\u00f3i c\u00e1ch kh\u00e1c, ta di\u1ec5n gi\u1ea3i l\u1ea1i c\u00e1c chu tr\u00ecnh b\u1eb1ng c\u00e1ch \u00e1nh x\u1ea1 t\u1edbi v\u00e0 t\u1eeb m\u1ed9t ground set ri\u00eang bi\u1ec7t th\u00f4ng qua ho\u00e1n v\u1ecb \\(a\\).</p> <p>C\u1ee5 th\u1ec3 h\u01a1n, g\u1ecdi ph\u00e2n t\u00e1ch chu tr\u00ecnh c\u1ee7a \\(b\\) l\u00e0 \\(c_1 \\cdots c_k\\), trong \u0111\u00f3 \\(c_i = (x_{i1}, \\dots, x_{il_i})\\). Ta n\u00f3i r\u1eb1ng \\(aba^{-1}\\) c\u00f3 ph\u00e2n t\u00e1ch chu tr\u00ecnh l\u00e0 \\(c'_1 \\cdots c'_k\\) trong \u0111\u00f3 \\(c'_i = (a_{x_{i1}}, \\dots, a_{x_{il_i}})\\).</p> <p>Ch\u1ee9ng minh s\u1ebd l\u00e0m r\u00f5 m\u1ec7nh \u0111\u1ec1 \u1edf \u0111\u1ea7u ph\u1ea7n n\u00e0y. X\u00e9t ph\u1ea7n t\u1eed \\(i\\), ta s\u1ebd xem chuy\u1ec7n g\u00ec x\u1ea3y ra v\u1edbi \\(i\\) khi m\u1ed7i ho\u00e1n v\u1ecb \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng v\u00e0o n\u00f3:</p> <ol> <li>\\(aba^{-1}\\): T\u1ed3n t\u1ea1i m\u1ed9t \\(j\\) sao cho \\(a_j = i\\) v\u00ec \\(a\\) l\u00e0 m\u1ed9t ho\u00e1n v\u1ecb. N\u00ean \\((aba^{-1})_i = a_{b_{a^{-1}_i}} = a_{b_j}\\).</li> <li>\\(c'_1 \\cdots c'_k\\): Kh\u00f4ng l\u00e0m m\u1ea5t \u0111i t\u00ednh t\u1ed5ng qu\u00e1t, ta cho \\(i\\) l\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a \\(c'_1\\), ngh\u0129a l\u00e0 \\(i = a_{x_{i1}}\\). Gi\u1edd n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c \u00e1nh x\u1ea1 th\u00e0nh \\(a_{x_{i2}} = a_{b_{x_{i1}}} = a_{b_j}\\)</li> </ol> <p>V\u00ec c\u1ea3 hai \u0111\u1ec1u cho ra c\u00f9ng k\u1ebft qu\u1ea3, ta c\u00f3 \u0111i\u1ec1u ph\u1ea3i ch\u1ee9ng minh.</p> <p>\u0110i\u1ec1u n\u00e0y n\u00f3i l\u00ean r\u1eb1ng thao t\u00e1c \\(aba^{-1}\\) kh\u00f4ng g\u00ec kh\u00e1c l\u00e0 vi\u1ec7c chuy\u1ec3n c\u00e1c nh\u00e3n c\u1ee7a \\(b\\) theo \\(a\\).</p> <p>Theo k\u1ebft qu\u1ea3 n\u00e0y, v\u00ec ta ch\u1ec9 \u00e1p d\u1ee5ng ho\u00e1n v\u1ecb cho m\u1ecdi th\u1ee9 b\u00ean trong chu tr\u00ecnh, ta c\u00f3 th\u1ec3 \u00e1nh x\u1ea1 b\u1ea5t k\u1ef3 t\u00edch n\u00e0o c\u1ee7a c\u00e1c chu tr\u00ecnh r\u1eddi r\u1ea1c t\u1edbi b\u1ea5t k\u1ef3 t\u00edch n\u00e0o kh\u00e1c c\u1ee7a c\u00e1c chu tr\u00ecnh r\u1eddi r\u1ea1c, mi\u1ec5n multiset c\u1ee7a k\u00edch th\u01b0\u1edbc c\u00e1c chu tr\u00ecnh kh\u00f4ng thay \u0111\u1ed5i.</p> <p>Ta n\u00f3i \\(b\\) v\u00e0 \\(c\\) li\u00ean h\u1ee3p n\u1ebfu t\u1ed3n t\u1ea1i \\(a\\) sao cho \\(c = aba^{-1}\\) v\u00e0 g\u1ecdi \u0111\u00e2y l\u00e0 thao t\u00e1c li\u00ean h\u1ee3p.</p> <p>Do \u0111\u00f3, \u0111i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn s\u1ef1 ph\u00e2n chia t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb th\u00e0nh c\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng (sau khi x\u00e1c minh m\u1ed9t v\u00e0i ti\u00ean \u0111\u1ec1), trong \u0111\u00f3 m\u1ecdi th\u1ee9 b\u00ean trong m\u1ed9t l\u1edbp \u0111\u01b0\u1ee3c li\u00ean h\u1ee3p v\u1edbi m\u1ecdi th\u1ee9 kh\u00e1c trong l\u1edbp. L\u01b0u \u00fd r\u1eb1ng b\u1ea5t k\u1ef3 l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng n\u00e0o c\u0169ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh duy nh\u1ea5t b\u1edfi multiset c\u1ee7a k\u00edch th\u01b0\u1edbc c\u00e1c chu tr\u00ecnh. C\u00e1c l\u1edbp t\u01b0\u01a1ng \u0111\u01b0\u01a1ng n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c l\u1edbp li\u00ean h\u1ee3p.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#cac-topic-khac","title":"C\u00e1c topic kh\u00e1c","text":"<p>Ph\u1ea7n n\u00e0y ch\u1ee7 y\u1ebfu \u0111\u1ec1 c\u1eadp \u0111\u1ebfn m\u1ed9t s\u1ed1 t\u00e0i li\u1ec7u tham kh\u1ea3o v\u00e0 nh\u1eb1m m\u1ee5c \u0111\u00edch cho ng\u01b0\u1eddi \u0111\u1ecdc bi\u1ebft v\u1ec1 m\u1ed9t s\u1ed1 ch\u1ee7 \u0111\u1ec1 tr\u01b0\u1edbc \u0111\u00e2y ch\u01b0a t\u1eebng nghe th\u1ea5y, nh\u01b0ng c\u00f3 li\u00ean quan \u0111\u1ebfn b\u00e0i vi\u1ebft n\u00e0y. Trong t\u01b0\u01a1ng lai c\u00f3 th\u1ec3 c\u00f3 nh\u1eefng blog kh\u00e1c li\u00ean quan \u0111\u1ebfn c\u00e1c ch\u1ee7 \u0111\u1ec1 n\u00e0y, nh\u01b0ng v\u1eabn s\u1ebd r\u1ea5t t\u1ed1t n\u1ebfu b\u1ea1n bi\u1ebft s\u01a1 l\u01b0\u1ee3c tr\u01b0\u1edbc v\u1ec1 ch\u00fang.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#ly-thuyet-nhom","title":"L\u00fd thuy\u1ebft nh\u00f3m","text":"<p>M\u1ed9t t\u1eadp c\u00e1c ho\u00e1n v\u1ecb k\u00edch th\u01b0\u1edbc \\(n\\) t\u1ea1o th\u00e0nh m\u1ed9t \"nh\u00f3m\", k\u00fd hi\u1ec7u l\u00e0 \\(S_n\\), v\u00e0 h\u00f3a ra t\u1ea5t c\u1ea3 c\u00e1c nh\u00f3m h\u1eefu h\u1ea1n c\u00f3 k\u00edch th\u01b0\u1edbc \\(n\\) \u0111\u1ec1u \u0111\u1eb3ng c\u1ea5u v\u1edbi m\u1ed9t nh\u00f3m con n\u00e0o \u0111\u00f3 c\u1ee7a \\(S_n\\). \u0110\u00e2y l\u00e0 l\u00fd do t\u1ea1i sao \u0111\u00e3 c\u00f3 r\u1ea5t nhi\u1ec1u nghi\u00ean c\u1ee9u v\u1ec1 ho\u00e1n v\u1ecb t\u1eeb g\u00f3c \u0111\u1ed9 l\u00fd thuy\u1ebft nh\u00f3m. Ph\u1ea7n v\u1ec1 k\u1ebft h\u1ee3p ho\u00e1n v\u1ecb d\u01b0\u1edbi g\u00f3c nh\u00ecn c\u1ee7a l\u00fd thuy\u1ebft nh\u00f3m l\u00e0 t\u1ed1t nh\u1ea5t.</p> <p>Vi\u1ec7c ph\u00e2n t\u00edch r\u1ea5t nhi\u1ec1u tr\u00f2 ch\u01a1i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng l\u00fd thuy\u1ebft nh\u00f3m, ch\u1eb3ng h\u1ea1n nh\u01b0, tr\u00f2 15, tr\u00f2 Rubik, h\u00ecnh vu\u00f4ng Latin, v\u00e2n v\u00e2n...</p> <p>C\u00f3 m\u1ed9t nh\u00f3m con c\u00e1c ho\u00e1n v\u1ecb t\u01b0\u01a1ng \u1ee9ng v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c ho\u00e1n v\u1ecb ch\u1eb5n. Nh\u00f3m n\u00e0y c\u0169ng \u0111\u01a1n gi\u1ea3n v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 cho bi\u1ebft k\u1ebft qu\u1ea3 v\u1ec1 c\u00e1c tr\u00f2 ch\u01a1i, v\u00ed d\u1ee5 nh\u01b0 tr\u00f2 15.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#em-burnside-liet-ke-polya-so-stirling","title":"\u0110\u1ebfm: Burnside, li\u1ec7t k\u00ea Polya, s\u1ed1 Stirling","text":"<p>V\u1edbi c\u00e1c \u00fd t\u01b0\u1edfng v\u1ec1 l\u00fd thuy\u1ebft nh\u00f3m, b\u1ed5 \u0111\u1ec1 Burnside v\u00e0 \u0111\u1ecbnh l\u00fd li\u1ec7t k\u00ea Polya xu\u1ea5t hi\u00ean v\u00e0 gi\u00fap \u0111\u1ebfm c\u00e1c l\u1edbp \u0111\u1ed1i t\u01b0\u1ee3ng (t\u01b0\u01a1ng \u0111\u01b0\u01a1ng theo quan h\u1ec7 n\u00e0o \u0111\u00f3) thay v\u00ec b\u1ea3n th\u00e2n c\u00e1c \u0111\u1ed1i t\u01b0\u1ee3ng \u0111\u00f3.</p> <p>S\u1ed1 Stirling kh\u00e1 h\u1eefu \u00edch khi \u0111\u1ebfn nh\u1eefng th\u1ee9 li\u00ean quan \u0111\u1ebfn ho\u00e1n v\u1ecb v\u00e0 x\u1ee9ng \u0111\u00e1ng c\u00f3 m\u1ed9t b\u00e0i vi\u1ebft ri\u00eang.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#nen-toa-o","title":"N\u00e9n to\u1ea1 \u0111\u1ed9","text":"<p>\u1ede tr\u00ean, \u0111\u1eb7c bi\u1ec7t l\u00e0 trong ph\u1ea7n v\u1ec1 th\u1ee9 t\u1ef1, ta d\u00f9ng m\u1ea3ng c\u00e1c ph\u1ea7n t\u1eed ri\u00eang bi\u1ec7t v\u00e0 c\u00e1c ho\u00e1n v\u1ecb thay th\u1ebf cho nhau. B\u1ea5t c\u1ee9 khi n\u00e0o m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1c quan h\u1ec7 \\(\\le\\), \\(&lt;\\), \\(&gt;\\), \\(\\ge\\), \\(=\\) gi\u1eefa c\u00e1c ph\u1ea7n t\u1eed ch\u1ee9 kh\u00f4ng ph\u1ea3i b\u1ea3n th\u00e2n c\u00e1c ph\u1ea7n t\u1eed \u0111\u00f3, th\u00ec vi\u1ec7c thay th\u1ebf c\u00e1c ph\u1ea7n t\u1eed b\u1eb1ng th\u1ee9 h\u1ea1ng c\u1ee7a ch\u00fang l\u00e0 \u0111i\u1ec1u h\u1ee3p l\u00fd. Trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed ri\u00eang bi\u1ec7t, \"phi\u00ean b\u1ea3n n\u00e9n\" n\u00e0y tr\u1edf th\u00e0nh m\u1ed9t ho\u00e1n v\u1ecb.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#dp-tren-thanh-phan-lien-thong","title":"DP tr\u00ean th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng","text":"<p>Gi\u1ed1ng nh\u01b0 \u00fd t\u01b0\u1edfng th\u1ea5t b\u1ea1i v\u1ec1 vi\u1ec7c sinh ho\u00e1n v\u1ecb, \u00fd t\u01b0\u1edfng \u0111\u00f3 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng cho DP. B\u1ea1n xem \u1edf \u0111\u00e2y \u0111\u1ec3 bi\u1ebft th\u00eam chi ti\u1ebft.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#young-tableaus","title":"Young tableaus","text":"<p>\u00dd t\u01b0\u1edfng c\u1ee7a Young tableaus li\u00ean quan ch\u1eb7t ch\u1ebd \u0111\u1ebfn LIS v\u00e0 c\u00e1c kh\u00e1i ni\u1ec7m s\u1eafp x\u1ebfp kh\u00e1c. \u0110\u00e2y l\u00e0 m\u1ed9t l\u00fd thuy\u1ebft r\u1ea5t th\u00fa v\u1ecb v\u00e0 blog n\u00e0y l\u00e0 m\u1ed9t t\u00e0i li\u1ec7u tham kh\u1ea3o hay v\u1ec1 n\u00f3.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#thuat-toan-schreier-sims","title":"Thu\u1eadt to\u00e1n Schreier Sims","text":"<p>Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t nh\u00f3m con \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh b\u1edfi m\u1ed9t s\u1ed1 ho\u00e1n v\u1ecb v\u00e0 ta mu\u1ed1n t\u00ecm k\u00edch th\u01b0\u1edbc nh\u00f3m con n\u00e0y. Thu\u1eadt to\u00e1n Schreier Sims gi\u00fap t\u00ecm k\u00edch th\u01b0\u1edbc, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc t\u1ea1i \u0111\u00e2y.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#cay-hoan-vi","title":"C\u00e2y ho\u00e1n v\u1ecb","text":"<p>C\u00f3 m\u1ed9t lo\u1ea1i c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1 th\u00fa v\u1ecb c\u00f3 th\u1ec3 \u0111\u00e1p \u1ee9ng m\u1ed9t s\u1ed1 lo\u1ea1i truy v\u1ea5n tr\u00ean ho\u00e1n v\u1ecb v\u00e0 m\u1ea3ng con. Blog n\u00e0y gi\u1edbi thi\u1ec7u v\u1ec1 n\u00f3.</p>"},{"location":"Codeforces/math/permutations-for-beginners/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"<p>D\u01b0\u1edbi \u0111\u00e2y ch\u1ec9 l\u00e0 c\u00e1c b\u00e0i t\u1eadp \u0111\u01b0\u1ee3c nh\u1eafc \u0111\u1ebfn trong b\u00e0i. B\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u00eam c\u00e1c b\u00e0i ho\u00e1n v\u1ecb (ch\u1eb3ng h\u1ea1n t\u00ecm b\u1eb1ng t\u1eeb kho\u00e1 \"permutation\" tr\u00ean Codeforces) tr\u00ean c\u00e1c trang Online Judge.</p> Problem Status Submission Code Date CSES - Planet Queries I Unavailable public link Code 09/12/2023 CSES - Planet Queries II Unavailable public link Code 09/12/2023 Codeforces - Lucky Permutation Submission Code 09/12/2023 Codeforces - Square Root of Permutation Submission Code 12/12/2023"},{"location":"Codeforces/math/sums-and-expected-value/","title":"T\u1ed5ng v\u00e0 Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng","text":""},{"location":"Codeforces/math/sums-and-expected-value/#tong-va-gia-tri-ky-vong","title":"T\u1ed5ng v\u00e0 Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng","text":""},{"location":"Codeforces/math/sums-and-expected-value/#nguon","title":"Ngu\u1ed3n","text":"<p> Sums and Expected Value - part 1</p> <p> Sums and Expected Value - part 2</p>"},{"location":"Codeforces/math/sums-and-expected-value/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>\u0110\u1ea7u ti\u00ean th\u00ec b\u1ea1n c\u1ea7n bi\u1ebft v\u1ec1 x\u00e1c su\u1ea5t v\u00e0 m\u1ed9t ch\u00fat v\u1ec1 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng. V\u1ec1 k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh th\u00ec m\u00ecnh c\u00f3 m\u1ed9t b\u00e0i d\u1ecbch kh\u00e1 d\u1ec5 hi\u1ec3u \u1edf \u0111\u00e2y, c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm \u0111\u1ecdc.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#so-bo-ve-gia-tri-ky-vong","title":"S\u01a1 b\u1ed9 v\u1ec1 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng","text":"<p>V\u00ed d\u1ee5 ta mua m\u1ed9t v\u00e9 s\u1ed1 gi\u00e1 2 \u0111\u00f4. Ta th\u1eafng gi\u1ea3i 10 \u0111\u00f4 v\u1edbi x\u00e1c su\u1ea5t l\u00e0 10%, th\u1eafng gi\u1ea3i 20 \u0111\u00f4 v\u1edbi x\u00e1c su\u1ea5t 2%. Trung b\u00ecnh, n\u00f3 s\u1ebd cho ta \\(0.1 \\cdot 10 + 0.02 \\cdot 20 = 1.4\\), n\u00ean ta s\u1ebd m\u1ea5t nhi\u1ec1u h\u01a1n l\u00e0 \u0111\u01b0\u1ee3c khi mua v\u00e9 s\u1ed1. Gi\u00e1 tr\u1ecb trung b\u00ecnh v\u1eeba t\u00ednh ch\u00ednh l\u00e0 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng.</p> <p>Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng (Expected Value - EV, c\u00f3 th\u1ec3 g\u1ecdi t\u1eaft l\u00e0 k\u1ef3 v\u1ecdng) l\u00e0 gi\u00e1 tr\u1ecb trung b\u00ecnh c\u1ee7a m\u1ed9t bi\u1ebfn c\u1ed1 / ph\u00e9p th\u1eed. V\u00ed d\u1ee5, EV c\u1ee7a s\u1ed1 ch\u1ea5m khi ta tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t l\u00e0 \\(3.5\\):</p> \\[E(X) = \\sum_{\\omega \\in \\Omega} P(\\omega) \\cdot X(\\omega) = \\frac{1}{6} \\cdot 1 + \\frac{1}{6} \\cdot 2 + \\ldots + \\frac{1}{6} \\cdot 6 = 3.5\\] <p>K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh (r\u1ea5t quan tr\u1ecdng):</p> \\[E(X + Y) = E(X) + E(Y)\\]"},{"location":"Codeforces/math/sums-and-expected-value/#ky-thuat-gop-vao-tong","title":"K\u1ef9 thu\u1eadt \"g\u00f3p v\u00e0o t\u1ed5ng\"","text":"<p>N\u1ebfu ta mu\u1ed1n t\u00ednh m\u1ed9t t\u1ed5ng n\u00e0o \u0111\u00f3 c\u1ee7a nhi\u1ec1u c\u00e1ch / kh\u1ea3 n\u0103ng, ta c\u00f3 th\u1ec3 xem x\u00e9t m\u1ed9t ph\u1ea7n t\u1eed (hay m\u1ed9t s\u1ed1, m\u1ed9t c\u1ea1nh, m\u1ed9t c\u1eb7p g\u00ec \u0111\u00f3) v\u00e0 \u0111\u1ebfm xem c\u00f3 bao nhi\u00eau l\u1ea7n ph\u1ea7n t\u1eed \u0111\u00f3 n\u1eb1m trong k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#cac-bai-ev-on-gian","title":"C\u00e1c b\u00e0i EV \u0111\u01a1n gi\u1ea3n","text":""},{"location":"Codeforces/math/sums-and-expected-value/#bai-1","title":"B\u00e0i 1","text":"<p>Ch\u1ecdn 10 l\u00e1 b\u00e0i ng\u1eabu nhi\u00ean trong m\u1ed9t b\u1ed9 b\u00e0i 52 l\u00e1 ti\u00eau chu\u1ea9n. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 con \u00e1t (ace) trong \u0111\u00f3.</p> L\u1eddi gi\u1ea3i 1 <p>\u0110\u00e2y l\u00e0 c\u00e1ch c\u1ee7a m\u00ecnh (farmerboy). N\u1ebfu b\u1ea1n \u0111\u00e3 \u0111\u1ecdc b\u00e0i vi\u1ebft k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh tr\u00ean trang n\u00e0y th\u00ec b\u1ea1n h\u1eb3n s\u1ebd quen v\u1edbi c\u00e1ch gi\u1ea3i sau \u0111\u00e2y.</p> <p>G\u1ecdi \\(E_i\\) l\u00e0 k\u1ef3 v\u1ecdng con \u00e1t th\u1ee9 \\(i\\) \u0111\u01b0\u1ee3c b\u1ed1c ra khi k\u1ebft th\u00fac vi\u1ec7c ch\u1ecdn 10 l\u00e1 b\u00e0i. Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(E_1 + E_2 + E_3 + E_4\\), theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, v\u00ec ta c\u00f3 4 con \u00e1t. Ta d\u1ec5 d\u00e0ng th\u1ea5y \u0111\u01b0\u1ee3c \\(E_i = 1 \\cdot P_i + 0 \\cdot (1 - P_i) = P_i\\), hay l\u00e0 k\u1ef3 v\u1ecdng b\u1ed1c ra \u0111\u01b0\u1ee3c con \u00e1t th\u1ee9 \\(i\\) c\u0169ng l\u00e0 x\u00e1c su\u1ea5t b\u1ed1c ra \u0111\u01b0\u1ee3c con \u00e1t \u0111\u00f3 (s\u1eed d\u1ee5ng c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng th\u00ec ta suy ra \u0111\u01b0\u1ee3c n\u00f3).</p> <p>Th\u1ebf th\u00ec s\u1ed1 c\u00e1ch ch\u1ecdn ra m\u1ed9t con \u00e1t n\u00e0o \u0111\u00f3, v\u00ed d\u1ee5 \u00e1t c\u01a1 l\u00e0 bao nhi\u00eau (v\u00e0 c\u0169ng \u00e1p d\u1ee5ng v\u1edbi c\u00e1c con \u00e1t c\u00f2n l\u1ea1i). Th\u00ec ta c\u00f3</p> \\[E_i = P_i = \\frac{1 \\cdot \\binom{51}{9}}{\\binom{52}{10}} = \\frac{10}{52} = \\frac{5}{26}\\] <p>Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(E = E_1 + E_2 + E_3 + E_4 = 4 \\cdot E_1 = 4 * \\frac{5}{26} = \\frac{10}{13}\\).</p> L\u1eddi gi\u1ea3i 2 <p>\u0110\u00e2y l\u00e0 c\u00e1ch gi\u1ea3i c\u1ee7a Errichto.</p> <p>Ta c\u00f3 x\u00e1c su\u1ea5t \u0111\u1ec3 b\u1ed1c ra \u0111\u01b0\u1ee3c m\u1ed9t con \u00e1t l\u00e0 \\(P = \\frac{4}{52} = \\frac{1}{13}\\).</p> <p>G\u1ecdi \\(E_i\\) l\u00e0 k\u1ef3 v\u1ecdng b\u1ed1c ra \u0111\u01b0\u1ee3c con \u00e1t trong l\u1ea7n b\u1ed1c th\u1ee9 \\(i\\). Nh\u01b0 v\u1eady, theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh \\(E = \\sum_{i=1}^{10} E_i\\).</p> <p>\u1ede \u0111\u00e2y d\u1ec5 th\u1ea5y r\u1eb1ng \\(E_i = P_i\\) (l\u00fd do t\u01b0\u01a1ng t\u1ef1 l\u1eddi gi\u1ea3i 1), nh\u01b0 v\u1eady \\(E = \\sum_{i=1}^{10} E_i = \\sum_{i=1}^{10} P_i = 10 \\cdot \\frac{1}{13} = \\frac{10}{13}\\).</p> <p>L\u01b0u \u00fd l\u00e0 d\u00f9 cho \u1edf c\u00e1c l\u1ea7n b\u1ed1c sau, x\u00e1c su\u1ea5t b\u1ed1c ra \u00e1t c\u00f3 th\u1ec3 thay \u0111\u1ed5i nh\u01b0ng ta v\u1eabn c\u00f3 th\u1ec3 t\u00ednh \u0111\u01b0\u1ee3c nh\u01b0 v\u1eady d\u1ef1a v\u00e0o k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh.</p> <p>N\u1ebfu v\u1eabn th\u1ea5y kh\u00f3 hi\u1ec3u v\u00ec sao x\u00e1c su\u1ea5t \u1edf sau v\u1eabn l\u00e0 \\(\\frac{1}{13}\\), b\u1ea1n c\u00f3 th\u1ec3 t\u01b0\u1edfng t\u01b0\u1ee3ng r\u1eb1ng n\u1ebfu m\u00ecnh l\u1ea5y 10 l\u00e1 b\u00e0i l\u1ea7n l\u01b0\u1ee3t v\u00e0 m\u00ecnh kh\u00f4ng n\u00f3i cho b\u1ea1n bi\u1ebft 9 l\u00e1 \u0111\u1ea7u ti\u00ean l\u00e0 g\u00ec, th\u00ec b\u1ea1n c\u00f3 ngh\u0129 x\u00e1c su\u1ea5t l\u00e1 th\u1ee9 10 l\u00e0 con \u00e1t kh\u00f4ng ph\u1ea3i \\(\\frac{1}{13}\\) hay kh\u00f4ng? \u0110\u00e2y l\u00e0 l\u00fac b\u1ea1n nh\u1eadn ra v\u1ea5n \u0111\u1ec1.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-2","title":"B\u00e0i 2","text":"<p>Gi\u00e1 c\u1ee7a m\u1ed9t chi\u1ebfc TV l\u00e0 1000 \u0111\u00f4. Trong \\(N\\) ng\u00e0y ti\u1ebfp theo, m\u1ed7i ng\u00e0y gi\u00e1 c\u1ee7a TV t\u0103ng 5 \u0111\u00f4 ho\u1eb7c 10 \u0111\u00f4 (x\u00e1c su\u1ea5t nh\u01b0 nhau l\u00e0 50%). T\u00ednh k\u1ef3 v\u1ecdng gi\u00e1 TV sau \\(N\\) ng\u00e0y.</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(E_i\\) l\u00e0 k\u1ef3 v\u1ecdng gi\u00e1 t\u0103ng trong \u1edf ng\u00e0y th\u1ee9 \\(i\\), nh\u01b0 v\u1eady ta s\u1ebd c\u00f3 k\u1ebft qu\u1ea3 l\u00e0 \\(E = \\sum_{i=1}^{N} E_i\\). Ta c\u00f3 m\u1ed7i ng\u00e0y gi\u00e1 t\u0103ng nh\u01b0 \u0111\u1ec1 b\u00e0i n\u00ean \\(E_i = 5 \\cdot 0.5 + 10 \\cdot 0.5 = 7.5\\).</p> <p>Theo \u0111\u1ec1 b\u00e0i th\u00ec ng\u00e0y n\u00e0o gi\u00e1 c\u0169ng t\u0103ng nh\u01b0 v\u1eady n\u00ean c\u00e1c \\(E_i\\) b\u1eb1ng nhau. Nh\u01b0 v\u1eady \\(E = \\sum_{i=1}^{N} E_i = N \\cdot E_1 = 7.5 \\cdot N\\).</p> <p>L\u01b0u \u00fd \\(E\\) l\u00e0 gi\u00e1 t\u0103ng ch\u1ee9 kh\u00f4ng ph\u1ea3i t\u1ed5ng gi\u00e1, t\u1ed5ng gi\u00e1 th\u00ec \u0111\u01a1n gi\u1ea3n s\u1ebd l\u00e0 \\(1000 + N \\cdot 7.5\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-3","title":"B\u00e0i 3","text":"<p>Tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t hai l\u1ea7n. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1edbn h\u01a1n trong hai l\u1ea7n tung \u0111\u00f3.</p> L\u1eddi gi\u1ea3i <p>B\u1ea1n c\u00f3 th\u1ec3 v\u1ebd ra m\u1ed9t b\u1ea3ng cho ra s\u1ed1 l\u1edbn h\u01a1n trong hai s\u1ed1 ki\u1ec3u nh\u01b0 sau: </p><pre><code>  | 1 2 3 4 5 6\n---------------\n1 | 1 2 3 4 5 6\n2 | 2 2 3 4 5 6\n3 | 3 3 3 4 5 6\n4 | 4 4 4 4 5 6\n5 | 5 5 5 5 5 6\n6 | 6 6 6 6 6 6\n</code></pre><p></p> <p>M\u1ed7i tr\u01b0\u1eddng h\u1ee3p trong \u0111\u00e2y c\u00f3 x\u00e1c su\u1ea5t l\u00e0 \\(\\frac{1}{36}\\). Nh\u01b0 v\u1eady theo c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng \\(E(X) = \\sum_{\\omega \\in \\Omega} P(\\omega) \\cdot X(\\omega)\\), ta ch\u1ec9 c\u1ea7n t\u00ednh l\u1ea7n l\u01b0\u1ee3t t\u1ea5t c\u1ea3 c\u00e1c tr\u01b0\u1eddng h\u1ee3p tr\u00ean r\u1ed3i c\u1ed9ng l\u1ea1i v\u1edbi nhau l\u00e0 ra \u0111\u00e1p \u00e1n. Nh\u01b0ng c\u00f3 v\u1ebb h\u01a1i d\u00e0i.</p> <p>V\u1eady ta c\u00f3 th\u1ec3 t\u00ednh trong 36 tr\u01b0\u1eddng h\u1ee3p n\u00e0y th\u00ec c\u00f3 bao nhi\u00eau s\u1ed1 1, 2, 3, ..., 6 kh\u00f4ng? V\u00ed d\u1ee5 t\u00ednh s\u1ed1 s\u1ed1 5 \u0111i. S\u1ed1 c\u00e1ch ch\u1ecdn hai s\u1ed1 kh\u00f4ng l\u1edbn h\u01a1n 5 l\u00e0 \\(5 \\cdot 5 = 25\\) c\u00e1ch. Nh\u01b0ng \u0111\u00f3 l\u00e0 s\u1ed1 c\u00e1ch ch\u1ecdn hai s\u1ed1 kh\u00f4ng l\u1edbn h\u01a1n 5, c\u00f3 ph\u1ea3i ch\u1eafc ch\u1eafn c\u00f3 5 trong \u0111\u00f3 \u0111\u00e2u? \u1ede \u0111\u00e2y, ta ph\u1ea3i tr\u1eeb s\u1ed1 c\u00e1ch ch\u1ecdn hai s\u1ed1 kh\u00f4ng l\u1edbn h\u01a1n 4 n\u1eefa l\u00e0 c\u00f3 \u0111\u00e1p \u00e1n, nh\u01b0 v\u1eady s\u1ed1 c\u00e1ch ch\u1ecdn hai s\u1ed1 c\u00f3 max l\u00e0 5 l\u00e0 \\(5 \\cdot 5 - 4 \\cdot 4 = 5^2 - 4^2 = 9\\). T\u01b0\u01a1ng t\u1ef1 ta c\u00f3 th\u1ec3 t\u00ednh \u0111\u01b0\u1ee3c \u0111\u00e1p \u00e1n c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 c\u00f2n l\u1ea1i.</p> <p>Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 s\u1ebd l\u00e0</p> \\[E = \\sum_{i=1}^6 i \\cdot \\frac{i^2 - (i-1)^2}{6^2} = \\frac{\\sum_{i=1}^6 i \\cdot (i^2 - (i-1)^2)}{36} = \\frac{161}{36} = 4.4722 \\ldots\\]"},{"location":"Codeforces/math/sums-and-expected-value/#bai-4","title":"B\u00e0i 4","text":"<p>Tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t \\(N\\) l\u1ea7n. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1edbn nh\u1ea5t trong \\(N\\) l\u1ea7n tung \u0111\u00f3.</p> L\u1eddi gi\u1ea3i <p>T\u01b0\u01a1ng t\u1ef1 b\u00e0i tr\u01b0\u1edbc, s\u1ed1 c\u00e1ch ch\u1ecdn N s\u1ed1 c\u00f3 max l\u00e0 \\(i\\) s\u1ebd l\u00e0 \\(i^N - (i-1)^N\\). Kh\u00f4ng gian m\u1eabu l\u00e0 \\(6^N\\)</p> <p>Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 l\u00e0</p> \\[E = \\sum_{i=1}^6 i \\cdot \\frac{i^N - (i-1)^N}{6^N} = \\frac{\\sum_{i=1}^6 i \\cdot (i^N - (i-1)^N)}{6^N}\\] <p>\u0110\u00e2y c\u0169ng l\u00e0 b\u00e0i 454C tr\u00ean Codeforces. Code s\u1ebd \u1edf ph\u1ea7n Luy\u1ec7n t\u1eadp nh\u00e9.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-5","title":"B\u00e0i 5","text":"<p>B\u1ea1n d\u1ea1y trong m\u1ed9t l\u1edbp 20 ng\u01b0\u1eddi. Khi ai \u0111\u00f3 c\u00f3 sinh nh\u1eadt, b\u1ea1n ph\u1ea3i cho c\u1ea3 l\u1edbp ch\u01a1i game thay v\u00ec h\u1ecdc b\u00e0i m\u1edbi ng\u00e0y h\u00f4m \u0111\u00f3. C\u00f3 th\u1ec3 m\u1ed9t s\u1ed1 h\u1ecdc sinh c\u00f3 ng\u00e0y sinh nh\u1eadt tr\u00f9ng nhau, n\u00ean s\u1ebd c\u00f3 \u00edt h\u01a1n 20 ng\u00e0y b\u1ecb l\u00e3ng ph\u00ed trong m\u1ed9t n\u0103m ph\u1ea3i kh\u00f4ng? T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 ng\u00e0y l\u00e3ng ph\u00ed trong n\u0103m.</p> L\u1eddi gi\u1ea3i <p>Ta g\u1ecdi \\(E_i\\) l\u00e0 k\u00ec v\u1ecdng m\u1ed9t ng\u00e0y th\u1ee9 \\(i\\) l\u00e0 ng\u00e0y sinh nh\u1eadt c\u1ee7a b\u1ea5t k\u1ef3 h\u1ecdc sinh n\u00e0o trong l\u1edbp. Nh\u01b0 v\u1eady k\u1ef3 v\u1ecdng s\u1ed1 ng\u00e0y l\u00e3ng ph\u00ed trong n\u0103m s\u1ebd l\u00e0 \\(E = \\sum_{i=1}^{365} E_i\\). V\u00ec k\u00ec v\u1ecdng c\u00e1c ng\u00e0y b\u1eb1ng nhau n\u00ean \\(E = \\sum_{i=1}^{365} E_i = 365 \\cdot E_1\\).</p> <p>V\u00ec \\(E_i\\) l\u00e0 k\u1ef3 v\u1ecdng ng\u00e0y th\u1ee9 \\(i\\) l\u00e0 sinh nh\u1eadt ai \u0111\u00f3, n\u00ean n\u00f3 ch\u1ec9 c\u00f3 \u0111\u00fang ho\u1eb7c sai (1 ho\u1eb7c 0), n\u00ean \\(E_i = P_i\\), c\u0169ng l\u00e0 x\u00e1c su\u1ea5t ng\u00e0y th\u1ee9 \\(i\\) l\u00e0 sinh nh\u1eadt ai \u0111\u00f3. T\u00ednh \\(P_i\\) nh\u01b0 th\u1ebf n\u00e0o?</p> <p>T\u00ednh th\u1eb3ng \\(P_i\\) c\u00f3 v\u1ebb kh\u00f3, gi\u1edd ta th\u1eed t\u00ednh \\(1 - P_i\\), hay c\u00f2n g\u1ecdi l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 ng\u00e0y th\u1ee9 \\(i\\) kh\u00f4ng ph\u1ea3i sinh nh\u1eadt ai c\u1ea3, xem sao. X\u00e1c su\u1ea5t \u0111\u00f3 s\u1ebd l\u00e0 \\((1 - \\frac{1}{365})^{20}\\), v\u00ec v\u1edbi m\u1ed7i h\u1ecdc sinh, ta ch\u1ec9 c\u1ea7n ch\u1ecdn ng\u00e0y kh\u00e1c v\u1edbi ng\u00e0y \\(i\\) l\u00e0 xong. V\u1eady \\(1 - P_i = (1 - \\frac{1}{365})^{20} = (\\frac{364}{365})^{20}\\). Suy ra \\(P_i = 1 - (\\frac{364}{365})^{20} \\approx 0.05339\\)</p> <p>Nh\u01b0 v\u1eady \\(E = \\sum_{i=1}^{365} E_i = 365 \\cdot E_1 = 365 \\cdot (1 - (\\frac{364}{365})^{20}) \\approx 19.4879\\) ng\u00e0y.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-6","title":"B\u00e0i 6","text":"<p>Cho m\u1ed9t \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng (x\u00e1c su\u1ea5t tung ra m\u1eb7t ng\u1eeda b\u1eb1ng x\u00e1c su\u1ea5t tung ra m\u1eb7t s\u1ea5p). T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra m\u1eb7t ng\u1eeda.</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(E_i\\) l\u00e0 s\u1ed1 l\u1ea7n tung \u0111\u1ed3ng xu \u0111\u1ec3 ra m\u1eb7t ng\u1eeda sau khi \u0111\u00e3 tung \\(i\\) l\u1ea7n. \\(E_0\\) l\u00e0 \u0111\u00e1p \u00e1n c\u1ee7a ch\u00fang ta. Ta th\u1ea5y r\u1eb1ng n\u1ebfu tung l\u1ea7n \u0111\u1ea7u \u0111\u01b0\u1ee3c m\u1eb7t s\u1ea5p, th\u00ec k\u1ef3 v\u1ecdng sau \u0111\u00f3 v\u1eabn s\u1ebd b\u1eb1ng k\u1ef3 v\u1ecdng khi ch\u01b0a tung l\u1ea7n n\u00e0o, ngh\u0129a l\u00e0 \\(E_1 = E_0\\).</p> <p>Theo c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng, ta c\u00f3 \\(E_0 = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E_0)\\). Ngh\u0129a l\u00e0, khi tung \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda \u1edf l\u1ea7n \u0111\u1ea7u, ta \u0111\u00e3 c\u00f3 m\u1eb7t ng\u1eeda r\u1ed3i n\u00ean kh\u00f4ng tung n\u1eefa, s\u1ed1 l\u1ea7n tung l\u00e0 1, c\u00f2n khi tung ra m\u1eb7t s\u1ea5p, ta m\u1ea5t m\u1ed9t l\u1ea7n tung v\u00e0 ph\u1ea3i tung ti\u1ebfp. Chuy\u1ec3n \\(E_0\\) v\u1ec1 1 v\u1ebf v\u00e0 t\u00ednh, ta s\u1ebd c\u00f3 \\(E_0 = 2\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-7","title":"B\u00e0i 7","text":"<p>Cho m\u1ed9t \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra t\u1ed5ng c\u1ed9ng hai l\u1ea7n m\u1eb7t ng\u1eeda.</p> L\u1eddi gi\u1ea3i <p>Sau khi tung ra \u0111\u01b0\u1ee3c 1 l\u1ea7n m\u1eb7t ng\u1eeda, k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra m\u1eb7t ng\u1eeda th\u1ee9 hai l\u00e0 bao nhi\u00eau? Ch\u00ednh x\u00e1c, l\u00e0 2 l\u1ea7n, nh\u01b0 b\u00e0i tr\u01b0\u1edbc. Th\u1ebf th\u00ec k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra l\u1ea7n m\u1eb7t ng\u1eeda \u0111\u1ea7u ti\u00ean l\u00e0 bao nhi\u00eau? V\u1eabn l\u00e0 2.</p> <p>Nh\u01b0 v\u1eady \\(E(\\text{2 ng\u1eeda}) = E(\\text{1 ng\u1eeda} + \\text{1 ng\u1eeda}) = E(\\text{1 ng\u1eeda}) + E(\\text{1 ng\u1eeda}) = 2 + 2 = 4\\), theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-8","title":"B\u00e0i 8","text":"<p>Cho m\u1ed9t \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra t\u1ed5ng c\u1ed9ng hai l\u1ea7n m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp.</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(E_i\\) k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 t\u1eeb \\(i\\) m\u0103t ng\u1eeda sau c\u00f9ng ta c\u00f3 \\(i+1\\) m\u1eb7t ng\u1eeda sau c\u00f9ng. \\(E_0 + E_1\\) l\u00e0 \u0111\u00e1p \u00e1n c\u1ee7a ch\u00fang ta. R\u00f5 r\u00e0ng ta c\u00f3 \\(E_2 = 0\\), v\u00ec l\u00fac n\u00e0y ta \u0111\u00e3 c\u00f3 2 m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp.</p> <p>Ta c\u00f3 \\(E_0 = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E_0)\\). Gi\u1ea3i ra ta s\u1ebd c\u00f3 \\(E_0 = 2\\).</p> <p>L\u1ea1i c\u00f3 \\(E_1 = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E_0 + E_1)\\). \u1ede \u0111\u00e2y ngh\u0129a l\u00e0 n\u1ebfu tung ra m\u1eb7t ng\u1eeda ti\u1ebfp th\u00ec ta \u0111\u1ebfn tr\u1ea1ng th\u00e1i 2 m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp, ng\u01b0\u1ee3c l\u1ea1i ta t\u1ed1n m\u1ed9t l\u01b0\u1ee3t tung v\u00e0 ph\u1ea3i c\u1ea7n \\(E_0\\) l\u1ea7n tung \u0111\u1ec3 quay l\u1ea1i tr\u1ea1ng th\u00e1i 1 m\u1eb7t ng\u1eeda, sau \u0111\u00f3 tung \\(E_1\\) l\u1ea7n \u0111\u1ec3 \u0111\u1ebfn tr\u1ea1ng th\u00e1i 2 m\u1eb7t ng\u1eeda. Gi\u1ea3i c\u00e1i n\u00e0y ra ta s\u1ebd c\u00f3 \\(E_1 = 4\\).</p> <p>Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 l\u00e0 \\(E_0 + E_1 = 2 + 4 = 6\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-9","title":"B\u00e0i 9","text":"<p>12 \u0111\u1ed9i, trong \u0111\u00f3 c\u00f3 \u0111\u1ed9i c\u1ee7a b\u1ea1n, ch\u01a1i trong m\u1ed9t gi\u1ea3i b\u00f3ng chuy\u1ec1n. C\u00e1c \u0111\u1ed9i \u0111\u01b0\u1ee3c chia ra l\u00e0m 4 b\u1ea3ng, m\u1ed7i b\u1ea3ng 3 \u0111\u1ed9i. Trong m\u1ed7i b\u1ea3ng, c\u00e1c \u0111\u1ed9i \u0111\u1ea5u v\u00f2ng tr\u00f2n m\u1ed9t l\u01b0\u1ee3t v\u00e0 hai \u0111\u1ed9i \u0111\u1ea7u b\u1ea3ng s\u1ebd v\u00e0o v\u00f2ng knockout. N\u1ebfu c\u00f3 c\u00e1c \u0111\u1ed9i b\u1eb1ng \u0111i\u1ec3m v\u00e0 b\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c ch\u1ec9 s\u1ed1 kh\u00e1c, hai \u0111\u1ed9i ng\u1eabu nhi\u00ean s\u1ebd \u0111i ti\u1ebfp. V\u00f2ng knockout c\u00f3 t\u1ee9 k\u1ebft, b\u00e1n k\u1ebft v\u00e0 chung k\u1ebft. Trong m\u1ed7i tr\u1eadn, x\u00e1c su\u1ea5t m\u1ed9t \u0111\u1ed9i th\u1eafng l\u00e0 50%, kh\u00f4ng c\u00f3 k\u1ebft qu\u1ea3 ho\u00e0.</p> <p>T\u00ecm x\u00e1c su\u1ea5t \u0111\u1ed9i c\u1ee7a b\u1ea1n th\u1eafng gi\u1ea3i n\u00e0y. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 tr\u1eadn th\u1eafng c\u1ee7a \u0111\u1ed9i b\u1ea1n. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 tr\u1eadn th\u1eafng c\u1ee7a \u0111\u1ed9i b\u1ea1n, v\u1edbi \u0111i\u1ec1u ki\u1ec7n \u0111\u1ed9i b\u1ea1n th\u1eafng gi\u1ea3i (ngh\u0129a l\u00e0 t\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 tr\u1eadn th\u1eafng c\u1ee7a \u0111\u1ed9i th\u1eafng cu\u1ed9c).</p> L\u1eddi gi\u1ea3i <p>Do c\u00e1c \u0111\u1ed9i l\u00e0 nh\u01b0 nhau trong m\u1ed9t b\u1ea3ng (symmetry - c\u00e2n \u0111\u1ed1i) n\u00ean x\u00e1c su\u1ea5t \u0111\u1ec3 m\u1ed9t \u0111\u1ed9i v\u01b0\u1ee3t qua v\u00f2ng b\u1ea3ng l\u00e0 \\(\\frac{2}{3}\\) (t\u01b0\u01a1ng t\u1ef1 x\u00e1c su\u1ea5t b\u1ecb lo\u1ea1i l\u00e0 \\(\\frac{1}{3}\\)). \u0110\u1ed9i c\u1ee7a b\u1ea1n c\u1ea7n th\u1eafng t\u1ee9 k\u1ebft, b\u00e1n k\u1ebft v\u00e0 chung k\u1ebft \u0111\u1ec3 v\u00f4 \u0111\u1ecbch, v\u1edbi x\u00e1c su\u1ea5t l\u00e0 50% m\u1ed7i tr\u1eadn, n\u00ean x\u00e1c su\u1ea5t th\u1eafng gi\u1ea3i l\u00e0</p> \\[P(\\text{th\u1eafng gi\u1ea3i}) = \\frac{2}{3} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{12}\\] <p>K\u1ef3 v\u1ecdng s\u1ed1 tr\u1eadn \u0111\u1ea5u c\u1ee7a \u0111\u1ed9i b\u1ea1n s\u1ebd b\u1eb1ng t\u1ed5ng c\u00e1c t\u00edch s\u1ed1 tr\u1eadn \u0111\u01b0\u1ee3c thi \u0111\u1ea5u v\u1edbi x\u00e1c su\u1ea5t c\u1ee7a m\u1ed7i tr\u01b0\u1eddng h\u1ee3p, theo c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng, nh\u01b0 v\u1eady</p> \\[\\begin{align} E(\\text{s\u1ed1 tr\u1eadn c\u1ee7a \u0111\u1ed9i}) &amp;= P(\\text{\u0111\u1ed9i b\u1ecb lo\u1ea1i sau v\u00f2ng b\u1ea3ng}) \\cdot 2 + P(\\text{\u0111\u1ed9i thua t\u1ee9 k\u1ebft}) \\cdot 3 + P(\\text{\u0111\u1ed9i thua b\u00e1n k\u1ebft}) \\cdot 4 + P(\\text{\u0111\u1ed9i thua chung k\u1ebft}) \\cdot 5 + P(\\text{\u0111\u1ed9i th\u1eafng chung k\u1ebft}) \\cdot 5\\\\ &amp;= \\frac{1}{3} \\cdot 2 + \\frac{2}{3} \\cdot \\frac{1}{2} \\cdot 3 + \\frac{2}{3} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot 4 + \\frac{2}{3} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot 5 + \\frac{2}{3} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} \\cdot 5\\\\ &amp;= \\frac{19}{6}\\\\ \\end{align}\\] <p>V\u1eady c\u00f2n k\u1ef3 v\u1ecdng s\u1ed1 tr\u1eadn th\u1eafng c\u1ee7a \u0111\u1ed9i v\u00f4 \u0111\u1ecbch? Ta c\u00f3</p> \\[E(\\text{s\u1ed1 tr\u1eadn th\u1eafng c\u1ee7a \u0111\u1ed9i v\u00f4 \u0111\u1ecbch}) = E(\\text{s\u1ed1 tr\u1eadn th\u1eafng sau v\u00f2ng b\u1ea3ng}) + E(\\text{s\u1ed1 tr\u1eadn th\u1eafng v\u00f2ng knockout})\\] <p>S\u1ed1 tr\u1eadn th\u1eafng v\u00f2ng knockout th\u00ec r\u00f5 r\u00e0ng l\u00e0 3 v\u00ec c\u1ea7n ph\u1ea3i th\u1eafng h\u1ebft c\u00e1c tr\u1eadn \u0111\u00f3 m\u1edbi v\u00f4 \u0111\u1ecbch.</p> <p>Gi\u1edd ta ch\u1ec9 c\u1ea7n t\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 tr\u1eadn th\u1eafng v\u00f2ng b\u1ea3ng v\u1edbi \u0111i\u1ec1u ki\u1ec7n l\u00e0 \u0111\u1ed9i n\u00e0y v\u01b0\u1ee3t qua v\u00f2ng b\u1ea3ng, g\u1ecdi gi\u00e1 tr\u1ecb n\u00e0y l\u00e0 \\(E_2\\), th\u00ec \\(E = 3 + E_2\\). Ta c\u00f3</p> \\[E_2 = 0 \\cdot P(0|\\text{\u0111i ti\u1ebfp}) + 1 \\cdot P(1|\\text{\u0111i ti\u1ebfp}) + 2 \\cdot P(2|\\text{\u0111i ti\u1ebfp})\\] <p>Kh\u00f4ng c\u00f3 \u0111\u1ed9i n\u00e0o c\u00f3 th\u1ec3 \u0111i ti\u1ebfp khi kh\u00f4ng th\u1eafng tr\u1eadn n\u00e0o \u1edf v\u00f2ng b\u1ea3ng, n\u00ean \\(P(0|\\text{\u0111i ti\u1ebfp}) = 0\\). Suy ra \\(P(1|\\text{\u0111i ti\u1ebfp}) + P(2|\\text{\u0111i ti\u1ebfp}) = 1\\).</p> <p>Theo \u0111\u1ecbnh l\u00fd Bayes,</p> \\[P(2|\\text{\u0111i ti\u1ebfp}) = \\frac{P(\\text{\u0111i ti\u1ebfp}|2) \\cdot P(2)}{P(\\text{\u0111i ti\u1ebfp})}\\] <p>Ta bi\u1ebft r\u1eb1ng \\(P(2) = \\frac{1}{4}\\) v\u00e0 \\(P(\\text{\u0111i ti\u1ebfp}) = \\frac{2}{3}\\). Ta c\u0169ng bi\u1ebft r\u1eb1ng n\u1ebfu th\u1eafng 2 tr\u1eadn th\u00ec s\u1ebd ch\u1eafc ch\u1eafn \u0111i ti\u1ebfp, n\u00ean \\(P(\\text{\u0111i ti\u1ebfp}|2) = 1\\). V\u1eady</p> \\[P(2|\\text{\u0111i ti\u1ebfp}) = \\frac{P(\\text{\u0111i ti\u1ebfp}|2) \\cdot P(2)}{P(\\text{\u0111i ti\u1ebfp})} = \\frac{1 \\cdot \\frac{1}{4} }{\\frac{2}{3} } = \\frac{3}{8}\\] <p>N\u00ean \\(P(1|\\text{\u0111i ti\u1ebfp}) = 1 - P(2|\\text{\u0111i ti\u1ebfp}) = 1 - \\frac{3}{8} = \\frac{5}{8}\\).</p> <p>V\u1eady \\(E_2 = 1 \\cdot \\frac{5}{8} + 2 \\cdot \\frac{3}{8} = \\frac{11}{8}\\)</p> <p>Suy ra \\(E = E_2 + 3 = \\frac{11}{8} + 3 = \\frac{35}{8}\\).</p> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u00e2y l\u00e0 k\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u00ean, \u0111i\u1ec1u ki\u1ec7n \u1edf \u0111\u00e2y l\u00e0 \u0111\u1ed9i ph\u1ea3i qua v\u00f2ng b\u1ea3ng, n\u00f3 kh\u00e1c v\u1edbi k\u1ef3 v\u1ecdng b\u00ecnh th\u01b0\u1eddng, n\u01a1i b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh t\u1ea5t c\u1ea3 c\u00e1c tr\u01b0\u1eddng h\u1ee3p. \u1ede \u0111\u00e2y ta kh\u00f4ng th\u1ec3 \u0111\u1eb7t \u0111\u01b0\u1ee3c bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0o m\u00e0 kh\u00f4ng c\u00f3 \u0111i\u1ec1u ki\u1ec7n qua v\u00f2ng b\u1ea3ng.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#cac-bai-tap-cho-ky-thuat-gop-vao-tong","title":"C\u00e1c b\u00e0i t\u1eadp cho k\u1ef9 thu\u1eadt \"g\u00f3p v\u00e0o t\u1ed5ng\"","text":""},{"location":"Codeforces/math/sums-and-expected-value/#bai-1_1","title":"B\u00e0i 1","text":"<p>Cho d\u00e3y s\u1ed1 \u0111\u1ed9 d\u00e0i \\(N\\) (\\(N \\le 10^5\\)), \u0111\u1ebfm c\u00e1c b\u1ed9 ba \\(i &lt; j &lt; k\\) sao cho \\(a_i &lt; a_j &gt; a_k\\).</p> <p>Bonus: \u0110\u1ebfm c\u00e1c \u0111o\u1ea1n zig-zag \u0111\u1ed9 d\u00e0i \\(10\\), ngh\u0129a l\u00e0 \\(i_1 &lt; i_2 &lt; \\ldots &lt; i_{10}\\) sao cho \\(a[i_1] &lt; a[i_2] &gt; a[i_3] &lt; a[i_4] &gt; \\ldots &lt; a[i_{10}]\\).</p> L\u1eddi gi\u1ea3i <p>\u1ede \u0111\u00e2y th\u00ec b\u1ea1n c\u00f3 th\u1ec3 duy\u1ec7t \\(j\\). Sau \u0111\u00f3 t\u00ecm s\u1ed1 c\u00e1c b\u1ed9 ba ch\u1ee9a \\(a_j\\) (ph\u1ea7n t\u1eed \u1edf gi\u1eefa). S\u1ed1 b\u1ed9 ba ch\u1ee9a \\(a_j\\) \u1edf gi\u1eefa s\u1ebd l\u00e0 s\u1ed1 c\u00e1c s\u1ed1 nh\u1ecf h\u01a1n \\(a_j\\) n\u1eb1m b\u00ean tr\u00e1i n\u00f3 v\u00e0 s\u1ed1 c\u00e1c s\u1ed1 nh\u1ecf h\u01a1n \\(a_j\\) n\u1eb1m b\u00ean ph\u1ea3i n\u00f3. Ta c\u00f3 th\u1ec3 t\u00ecm s\u1ed1 c\u00e1c s\u1ed1 nh\u1ecf h\u01a1n n\u00e0y v\u1edbi BIT (Binary Indexed Tree - c\u00e2y ch\u1ec9 s\u1ed1 nh\u1ecb ph\u00e2n) trong \\(O(\\log n)\\).</p> <p>Bonus: N\u00f3 s\u1ebd ph\u1ee9c t\u1ea1p h\u01a1n m\u1ed9t ch\u00fat. V\u1ec1 c\u01a1 b\u1ea3n, b\u1ea1n \u0111\u1ecbnh ngh\u0129a \\(dp[i][j]\\) l\u00e0 s\u1ed1 c\u00e1c b\u1ed9 zig-zag \u0111\u1ed9 d\u00e0i \\(j\\) khi x\u00e9t trong \u0111o\u1ea1n \\([1..i]\\) v\u1edbi \\(a_i\\) l\u00e0 ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng c\u1ee7a b\u1ed9 \u0111\u00f3. V\u1edbi m\u1ed7i \\(j\\) ta s\u1ebd t\u00ednh h\u1ebft \\(dp[i][j]\\). V\u00ed d\u1ee5 \\(j\\) l\u00e0 \\(4\\), t\u1ea1i \\(dp[i][j]\\) ta c\u1ea7n t\u1ed5ng c\u00e1c \\(dp[k][j-1]\\), v\u1edbi \\(k &lt; i\\) v\u00e0 \\(a[k] &lt; a[i]\\), \u0111\u1ec3 t\u1ed5ng n\u00e0y th\u00ec m\u1ed9t l\u1ea7n n\u1eefa ta l\u1ea1i d\u00f9ng BIT, v\u1edbi gi\u00e1 tr\u1ecb t\u1ea1i node \\(k\\) s\u1ebd l\u00e0 \\(dp[k][j-1]\\). L\u01b0u \u00fd l\u00e0 qua m\u1ed7i \\(j\\) th\u00ec d\u1ea5u so s\u00e1nh l\u1ea1i \u0111\u1ea3o n\u00ean c\u0169ng c\u1ea7n thay \u0111\u1ed5i m\u1ed9t ch\u00fat trong BIT. \u0110\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 \\(O(n \\log n)\\)</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-2_1","title":"B\u00e0i 2","text":"<p>Cho m\u1ed9t c\u00e2y c\u00f3 \\(N\\) \u0111\u1ec9nh (\\(N \\le 10^5\\)), t\u00ecm t\u1ed5ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed9 d\u00e0i c\u00e1c \u0111\u01b0\u1eddng \u0111i (Gi\u1ea3i kh\u00f4ng d\u00f9ng DP ph\u1ee9c t\u1ea1p ho\u1eb7c centroid).</p> <p>Bonus: T\u00ednh t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng \u0111\u1ed9 d\u00e0i c\u00e1c \u0111\u01b0\u1eddng \u0111i.</p> L\u1eddi gi\u1ea3i <p>X\u00e9t m\u1ed9t c\u1ea1nh \\(E(u, v)\\) tr\u00ean c\u00e2y, g\u1ecdi \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 l\u00e0 \\(e\\). V\u1eady \\(e\\) s\u1ebd \u0111\u00f3ng g\u00f3p bao nhi\u00eau trong k\u1ebft qu\u1ea3? \\(e\\) \u0111\u00f3ng g\u00f3p v\u00e0o k\u1ebft qu\u1ea3 khi c\u00f3 \u0111\u01b0\u1eddng \u0111i ch\u1ee9a c\u1ea1nh \\(E\\). V\u1eady c\u00f3 bao nhi\u00eau \u0111\u01b0\u1eddng \u0111i \u0111i qua c\u1ea1nh \\(E\\)? \u0110\u00f3 s\u1ebd l\u00e0 s\u1ed1 \u0111\u1ec9nh b\u00ean ph\u00eda \\(u\\) tr\u00ean c\u00e2y nh\u00e2n v\u1edbi s\u1ed1 \u0111\u1ec9nh b\u00ean ph\u00eda \\(v\\) tr\u00ean c\u00e2y. \"B\u00ean ph\u00eda\" \\(u\\) ngh\u0129a l\u00e0 \u0111\u1ec9nh c\u00f3 \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t \u0111\u1ebfn \\(u\\) kh\u00f4ng qua c\u1ea1nh \\(E\\).</p> <p>G\u1ecdi \\(num[u]\\) l\u00e0 s\u1ed1 \u0111\u1ec9nh trong c\u00e2y con g\u1ed1c \\(u\\). V\u1edbi m\u1ed9t c\u1ea1nh \\(E(u, v)\\) (\\(u\\) l\u00e0 \u0111\u1ec9nh cha c\u1ee7a \\(v\\)). S\u1ed1 \u0111\u1ec9nh b\u00ean ph\u00eda \\(v\\) r\u00f5 r\u00e0ng l\u00e0 \\(num[v]\\). C\u00f2n s\u1ed1 \u0111\u1ec9nh b\u00ean ph\u00eda \\(u\\) s\u1ebd l\u00e0 c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i, ngh\u0129a l\u00e0 \\(N - num[v]\\). Nh\u01b0 v\u1eady \\(e\\) \u0111\u00f3ng g\u00f3p v\u00e0o k\u1ebft qu\u1ea3 l\u00e0 \\(e \\cdot num[v] \\cdot (N - num[u])\\). X\u00e9t t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh, l\u1ea5y t\u1ed5ng l\u00e0 s\u1ebd c\u00f3 \u0111\u01b0\u1ee3c \u0111\u00e1p \u00e1n.</p> <p>Bonus: \u0110\u1ea7u ti\u00ean ta t\u00ednh t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb g\u1ed1c c\u1ee7a c\u00e2y, g\u1ecdi n\u00f3 l\u00e0 \\(S\\). Ta DFS t\u1eeb g\u1ed1c, v\u00e0 khi di chuy\u1ec3n, ta s\u1ebd duy tr\u00ec \\(S\\) sao cho khi \u0111\u1ebfn \u0111\u1ec9nh \\(u\\) n\u00e0o \u0111\u00f3, \\(S\\) s\u1ebd l\u00e0 t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng t\u1ea5t c\u1ea3 c\u00e1c \u0111\u01b0\u1eddng \u0111i t\u1eeb \u0111\u1ec9nh \\(u\\). Sau \u0111\u00f3 th\u00eam \\(S\\) v\u00e0o \u0111\u00e1p \u00e1n cu\u1ed1i c\u00f9ng v\u1edbi m\u1ed7i \u0111\u1ec9nh \\(u\\).</p> <p>L\u00fd thuy\u1ebft l\u00e0 nh\u01b0 v\u1eady, c\u00f2n l\u00e0m sao \u0111\u1ec3 duy tr\u00ec? Khi \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh cha \\(u\\) xu\u1ed1ng \u0111\u1ec9nh con \\(v\\), c\u00e1c \u0111\u1ec9nh n\u1eb1m trong c\u00e2y con g\u1ed1c \\(v\\) s\u1ebd b\u1ecb gi\u1ea3m gi\u00e1 tr\u1ecb b\u00ecnh ph\u01b0\u01a1ng \u0111\u01b0\u1eddng \u0111i t\u1eeb \\(v\\) \u0111\u1ebfn ch\u00fang, c\u00f2n c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i s\u1ebd t\u0103ng gi\u00e1 tr\u1ecb, m\u00e0 c\u1ee5 th\u1ec3 l\u00e0 t\u0103ng bao nhi\u00eau?</p> <p>X\u00e9t gi\u00e1 tr\u1ecb b\u1ecb gi\u1ea3m \u0111i, gi\u1ea3 s\u1eed m\u1ed9t \u0111\u01b0\u1eddng \u0111i t\u1eeb \\(u\\) \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh n\u00e0o \u0111\u00f3 trong c\u00e2y con g\u1ed1c \\(v\\) c\u00f3 t\u1ed5ng (kh\u00f4ng b\u00ecnh ph\u01b0\u01a1ng) l\u00e0 \\(x\\), nh\u01b0 v\u1eady t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng l\u00e0 \\(x^2\\). G\u1ecdi gi\u00e1 tr\u1ecb c\u1ea1nh \\(E(u, v)\\) l\u00e0 \\(e\\). Khi \u0111\u1ebfn \u0111\u1ec9nh \\(v\\), \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i n\u00e0y s\u1ebd l\u00e0 \\(x - e\\), v\u00e0 b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a n\u00f3 l\u00e0 \\((x - e)^2\\). B\u00ecnh ph\u01b0\u01a1ng \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i s\u1ebd gi\u1ea3m \u0111i \\(x^2 - (x - e)^2 = 2ex - e^2\\). V\u1eady ta c\u1ea7n b\u1edbt \u0111i \\(2ex - e^2\\) t\u1eeb \\(x^2\\) \u0111\u1ec3 c\u00f3 \\((x - e)^2\\). Ta g\u1ecdi \\(numEdges[u]\\) l\u00e0 s\u1ed1 c\u1ea1nh trong c\u00e2y con g\u1ed1c \\(u\\), v\u00e0 \\(sum[u]\\) l\u00e0 t\u1ed5ng t\u1ea5t c\u1ea3 c\u00e1c c\u1ea1nh trong c\u00e2y con g\u1ed1c \\(u\\). Nh\u01b0 v\u1eady t\u1ed5ng gi\u00e1 tr\u1ecb c\u1ea7n b\u1edbt t\u1eeb \\(S\\) s\u1ebd l\u00e0: \\(2e \\cdot sum[v] - numEdges[v] \\cdot e^2\\).</p> <p>X\u00e9t gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c t\u0103ng l\u00ean, t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean, b\u00ecnh ph\u01b0\u01a1ng \u0111\u1ed9 d\u00e0i t\u0103ng l\u00ean l\u00e0 \\((x + e)^2 - x^2 = e^2 + 2ex\\). V\u1eady ta c\u1ea7n t\u0103ng \\(e^2 + 2ex\\) t\u1eeb \\(x^2\\) \u0111\u1ec3 c\u00f3 \\((x + e)^2\\). Tuy nhi\u00ean \u1edf \u0111\u00e2y kh\u00f4ng ph\u1ea3i c\u00e2y con n\u00ean s\u1ebd h\u01a1i kh\u00e1c m\u1ed9t ch\u00fat. C\u1ee5 th\u1ec3, \u0111\u00e2y l\u00e0 c\u00e2y ban \u0111\u1ea7u kh\u00f4ng ch\u1ee9a c\u00e2y con g\u1ed1c \\(v\\). T\u1ed5ng gi\u00e1 tr\u1ecb c\u1ea7n t\u0103ng l\u00ean t\u1eeb \\(S\\) s\u1ebd l\u00e0 \\(2e \\cdot (sum[root] - sum[v]) + (numEdges[root] - numEdges[v]) \\cdot e^2\\).</p> <p>Sau khi c\u00f3 k\u1ebft qu\u1ea3 l\u00e0 \\(S\\) th\u00ec c\u1ea7n l\u01b0u \u00fd l\u00e0 m\u1ed9t \u0111\u01b0\u1eddng \u0111i \u1edf \u0111\u00e2y \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00ednh 2 l\u1ea7n, l\u1ea7n \u0111\u1ea7u t\u1eeb 1 \u0111\u1ea7u c\u1ee7a \u0111\u01b0\u1eddng \u0111i, l\u1ea7n hai l\u00e0 t\u1eeb \u0111\u1ea7u c\u00f2n l\u1ea1i. N\u00ean ta chia k\u1ebft qu\u1ea3 cho 2 \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c \u0111\u00e1p \u00e1n cu\u1ed1i c\u00f9ng.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-3_1","title":"B\u00e0i 3","text":"<p>C\u00f3 \\(N\\) cu\u1ed9c thi, cu\u1ed9c thi th\u1ee9 \\(i\\) c\u00f3 gi\u1ea3i th\u01b0\u1edfng l\u00e0 \\(a_i\\). B\u1ea1n c\u00f3 th\u1ec3 th\u1eafng m\u1ed9t cu\u1ed9c thi v\u1edbi x\u00e1c su\u1ea5t 50%. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n th\u1eafng \u0111\u01b0\u1ee3c.</p> <p>B\u00e0i to\u00e1n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng: T\u00ecm t\u1ed5ng gi\u1ea3i tr\u00ean \\(2^N\\) kh\u1ea3 n\u0103ng c\u00f3 th\u1ec3 x\u1ea3y ra, in \u0111\u00e1p \u00e1n l\u1ea5y d\u01b0 v\u1edbi \\(10^9 + 7\\). (\u0110\u00e1p \u00e1n \u1edf \u0111\u00e2y chia \\(2^N\\) s\u1ebd ra \u0111\u00e1p \u00e1n c\u00e2u tr\u00ean).</p> L\u1eddi gi\u1ea3i <p>V\u1edbi b\u00e0i to\u00e1n k\u1ef3 v\u1ecdng, ta d\u1ec5 d\u00e0ng t\u00ednh \u0111\u01b0\u1ee3c k\u1ef3 v\u1ecdng t\u1ed5ng s\u1ed1 ti\u1ec1n th\u1eafng \u0111\u01b0\u1ee3c s\u1ebd b\u1eb1ng t\u1ed5ng k\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n th\u1eafng \u0111\u01b0\u1ee3c \u1edf m\u1ed7i cu\u1ed9c thi, theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh. M\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n th\u1eafng \u0111\u01b0\u1ee3c \u1edf cu\u1ed9c thi \\(i\\) s\u1ebd l\u00e0 \\(\\frac{1}{2} \\cdot a_i\\), n\u00ean k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(E = \\sum_{i = 1}^N E_i = \\frac{1}{2} \\cdot \\sum_{i=1}^N a_i\\).</p> <p>Tuy nhi\u00ean, khi \u0111\u1ecdc v\u00e0o b\u00e0i to\u00e1n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, ta c\u1ea7n t\u00ecm xem v\u1edbi m\u1ed7i gi\u1ea3i th\u01b0\u1edfng \\(a_i\\), n\u00f3 s\u1ebd \u0111\u00f3ng g\u00f3p v\u00e0o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng l\u00e0 bao nhi\u00eau. \u0110\u00f3 s\u1ebd l\u00e0 t\u00edch c\u1ee7a \\(a_i\\) v\u1edbi s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a \\(a_i\\) trong \\(2^N\\) kh\u1ea3 n\u0103ng c\u00f3 th\u1ec3 x\u1ea3y ra. M\u00e0 ta bi\u1ebft l\u00e0 \\(a_i\\) s\u1ebd xu\u1ea5t hi\u1ec7n trong \\(2^{N-1}\\) l\u1ea7n trong \\(2^N\\) kh\u1ea3 n\u0103ng. Nh\u01b0 v\u1eady gi\u1ea3i th\u01b0\u1edfng \\(a_i\\) s\u1ebd \u0111\u00f3ng g\u00f3p \\(2^{N-1} \\cdot a_i\\) v\u00e0o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng. T\u01b0\u01a1ng t\u1ef1 v\u1edbi c\u00e1c gi\u1ea3i th\u01b0\u1edfng kh\u00e1c, ta s\u1ebd c\u00f3 t\u1ed5ng gi\u1ea3i l\u00e0 \\(2^{N-1} \\cdot \\sum_{i=1}^N a_i\\). \u0110\u00e1p \u00e1n \u1edf \u0111\u00e2y chia \\(2^N\\) s\u1ebd ra \u0111\u00e1p \u00e1n c\u00e2u tr\u00ean, theo \u0111\u1ecbnh ngh\u0129a k\u1ef3 v\u1ecdng.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-4_1","title":"B\u00e0i 4","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i Math Encoder c\u1ee7a Google Kickstart 2017 Round B</p> <p>Cho d\u00e3y \u0111\u1ed9 d\u00e0i \\(N\\) (\\(N \\le 2000\\) hay \\(N \\le 10^5\\)). Ch\u1ecdn ng\u1eabu nhi\u00ean m\u1ed9t trong \\(2^N-1\\) t\u1eadp con kh\u00f4ng r\u1ed7ng. T\u00ecm k\u1ef3 v\u1ecdng ch\u00eanh l\u1ec7ch s\u1ed1 l\u1edbn nh\u1ea5t v\u00e0 s\u1ed1 b\u00e9 nh\u1ea5t trong t\u1eadp \u0111\u01b0\u1ee3c ch\u1ecdn.</p> <p>B\u00e0i to\u00e1n t\u01b0\u01a1ng \u0111\u01b0\u01a1ng: T\u00ecm t\u1ed5ng ch\u00eanh l\u1ec7ch c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con kh\u00f4ng r\u1ed7ng, t\u00ednh k\u1ebft qu\u1ea3 l\u1ea5y d\u01b0 v\u1edbi \\(10^9+7\\).</p> L\u1eddi gi\u1ea3i <p>\u0110\u1ea7u ti\u00ean, v\u00ec th\u1ee9 t\u1ef1 \u1edf \u0111\u00e2y kh\u00f4ng quan tr\u1ecdng l\u1eafm, v\u00ec ta ch\u1ecdn t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp con, n\u00ean ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp t\u0103ng d\u1ea7n d\u00e3y ban \u0111\u1ea7u.</p> <p>V\u1edbi b\u00e0i t\u00ednh k\u00ec v\u1ecdng, ta c\u1ea7n t\u00ecm \\(E(max - min)\\), m\u00e0 theo k\u00ec v\u1ecdng tuy\u1ebfn t\u00ednh, \\(E(max - min) = E(max) - E(min)\\). T\u00ednh 2 k\u1ef3 v\u1ecdng n\u00e0y th\u00ec t\u01b0\u01a1ng t\u1ef1 nhau. V\u00ed d\u1ee5 v\u1edbi t\u00ednh \\(E(max)\\), l\u00e0m sao \u0111\u1ec3 t\u00ednh x\u00e1c su\u1ea5t c\u1ee7a m\u1ed9t s\u1ed1 \\(x\\) n\u00e0o \u0111\u00f3 l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t? Do \u0111\u00e3 s\u1eafp x\u1ebfp n\u00ean \\(x\\) s\u1ebd l\u00e0 m\u1ed9t nh\u00f3m k\u1ec1 nhau tr\u00ean d\u00e3y. Ta s\u1ebd kh\u00f4ng ch\u1ecdn c\u00e1c ph\u1ea7n t\u1eed l\u1edbn h\u01a1n \\(x\\), g\u1ecdi s\u1ed1 ph\u1ea7n t\u1eed l\u1edbn h\u01a1n \\(x\\) l\u00e0 \\(M\\) th\u00ec x\u00e1c su\u1ea5t \u1edf \u0111\u00e2y s\u1ebd l\u00e0 \\(\\frac{1}{2^M}\\). V\u1edbi c\u00e1c ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n \\(x\\), ta kh\u00f4ng c\u00f3 y\u00eau c\u1ea7u g\u00ec. Gi\u1edd \u0111\u1ebfn vi\u1ec7c ch\u1ecdn \\(x\\), ta c\u1ea7n \u00edt nh\u1ea5t m\u1ed9t \\(x\\) trong d\u00e3y \u0111\u00e3 ch\u1ecdn, v\u1edbi s\u1ed1 ph\u1ea7n t\u1eed b\u1eb1ng \\(x\\) l\u00e0 \\(K\\) th\u00ec x\u00e1c su\u1ea5t ch\u1ecdn ra \u0111\u01b0\u1ee3c \u00edt nh\u1ea5t m\u1ed9t \\(x\\) l\u00e0 \\(\\frac{2^K-1}{2^K}\\). Nh\u01b0 v\u1eady x\u00e1c su\u1ea5t \u0111\u1ec3 \\(x\\) l\u00e0 s\u1ed1 l\u1edbn nh\u1ea5t l\u00e0 \\(\\frac{1}{2^M} \\cdot \\frac{2^K-1}{2^K}\\). Tuy nhi\u00ean, ta \u0111ang gi\u1ea3 s\u1eed l\u00e0 x\u00e1c su\u1ea5t ch\u1ecdn m\u1ed9t ph\u1ea7n t\u1eed l\u00e0 \\(\\frac{1}{2}\\), kh\u00e1c v\u1edbi vi\u1ec7c ch\u1ecdn m\u1ed9t \\(2^N - 1\\) t\u1eadp con. C\u00e1i ta gi\u1ea3 s\u1eed l\u00e0 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c ch\u1ecdn \\(2^N\\) t\u1eadp con. Nh\u01b0 v\u1eady x\u00e1c su\u1ea5t n\u00e0y c\u1ea7n nh\u00e2n v\u1edbi \\(2^N\\) r\u1ed3i chia \\(2^N-1\\) m\u1edbi ch\u00ednh x\u00e1c. T\u00ednh t\u1ed5ng t\u1ea5t c\u1ea3 c\u00e1c \\(x\\) kh\u00e1c nhau trong d\u00e3y s\u1ebd ra \u0111\u01b0\u1ee3c \\(E(max)\\). T\u01b0\u01a1ng t\u1ef1 ta t\u00ednh \u0111\u01b0\u1ee3c \\(E(min)\\) v\u00e0 cu\u1ed1i c\u00f9ng l\u00e0 \u0111\u00e1p \u00e1n.</p> <p>V\u1edbi b\u00e0i t\u01b0\u01a1ng \u0111\u01b0\u01a1ng, ta c\u00f3 th\u1ec3 ch\u1ecdn ra 2 ph\u1ea7n t\u1eed b\u1ea5t k\u1ef3 trong d\u00e3y \u0111\u00e3 s\u1eafp x\u1ebfp, th\u00ec s\u1ebd c\u00f3 bao nhi\u00eau l\u1ea7n ch\u00eanh l\u1ec7ch gi\u1eefa ch\u00fang \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o \u0111\u00e1p \u00e1n. Gi\u1ea3 s\u1eed c\u00f3 \\(P\\) ph\u1ea7n t\u1eed n\u1eb1m gi\u1eefa hai ph\u1ea7n t\u1eed \u0111\u00e3 ch\u1ecdn, th\u00ec ch\u00eanh l\u1ec7ch gi\u1eefa ch\u00fang s\u1ebd \u0111\u00f3ng g\u00f3p \\(2^P\\) l\u1ea7n v\u00e0o \u0111\u00e1p \u00e1n. Nh\u01b0 v\u1eady ta s\u1ebd c\u00f3 \u0111\u01b0\u1ee3c m\u1ed9t l\u1eddi gi\u1ea3i \\(O(N^2)\\) \u1edf \u0111\u00e2y. N\u1ebfu \\(N \\le 10^5\\) th\u00ec sao? \u0110\u1ec3 \u00fd r\u1eb1ng \u0111\u00e1p \u00e1n s\u1ebd t\u0103ng l\u00ean \\(2^P \\cdot (a_r - a_l) = 2^P \\cdot a_r - 2^P \\cdot a_l\\). Ta c\u00f3 th\u1ec3 t\u00e1ch ri\u00eang \u0111\u1ec3 t\u00ednh s\u1ed1 l\u1ea7n c\u1ed9ng \\(a_i\\) v\u00e0 s\u1ed1 l\u1ea7n tr\u1eeb \\(a_i\\). C\u1ee5 th\u1ec3, ta s\u1ebd c\u1ed9ng \\(a_i\\) \u0111\u01b0\u1ee3c \\(2^{i-1} - 1\\) l\u1ea7n, v\u00e0 tr\u1eeb \\(a_i\\) \u0111i \\(2^{n-i} - 1\\) l\u1ea7n. Ta c\u00f3 th\u1ec3 gi\u1ea3i b\u00e0i n\u00e0y trong \\(O(N)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-5_1","title":"B\u00e0i 5","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i Imbalanced Array c\u1ee7a Codeforces Educational Round 23</p> <p>T\u01b0\u01a1ng t\u1ef1 b\u00e0i tr\u01b0\u1edbc, nh\u01b0ng ch\u1ecdn ng\u1eabu nhi\u00ean trong \\(\\frac{N \\cdot (N+1)}{2}\\) \u0111o\u1ea1n con.</p> <p>Bonus: L\u00e0m trong \\(O(N)\\) n\u1ebfu input ch\u1ee9a ho\u00e1n v\u1ecb c\u00e1c s\u1ed1 t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\).</p> L\u1eddi gi\u1ea3i <p>Ta c\u00f3 th\u1ec3 gi\u1ea3i c\u1ea3 hai trong \\(O(N)\\).</p> <p>V\u1edbi m\u1ed7i \u0111o\u1ea1n, ta mu\u1ed1n bi\u1ebft gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t \\(Max\\) v\u00e0 gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t \\(Min\\). Sau \u0111\u00f3 ta th\u00eam \\(Max - Min\\) v\u00e0o \u0111\u00e1p \u00e1n cu\u1ed1i c\u00f9ng. L\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n th\u00ec ta s\u1ebd c\u00f3 k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng. Ta c\u00f3 th\u1ec3 l\u00e0m tr\u00e2u nh\u01b0 v\u1eady trong \\(O(N^3)\\) ho\u1eb7c \\(O(N^2)\\) v\u1edbi RMQ.</p> <p>Nh\u01b0ng th\u1ebf th\u00ec ch\u1eadm qu\u00e1. Gi\u1edd ta s\u1ebd \u0111i m\u1ed9t h\u01b0\u1edbng kh\u00e1c. C\u00e2u h\u1ecfi s\u1ebd l\u00e0: V\u1edbi m\u1ed9t v\u1ecb tr\u00ed \\(i\\) n\u00e0o \u0111\u00f3, \\(a[i]\\) s\u1ebd l\u00e0 \\(Max\\) bao nhi\u00eau l\u1ea7n. Hay ch\u00ednh x\u00e1c h\u01a1n l\u00e0, c\u00f3 bao nhi\u00eau \u0111o\u1ea1n con nh\u1eadn ph\u1ea7n t\u1eed th\u1ee9 \\(i\\) l\u00e0 \\(Max\\)? N\u1ebfu ta gi\u1ea3i \u0111\u01b0\u1ee3c b\u00e0i n\u00e0y, th\u00ec c\u0169ng c\u00f3 th\u1ec3 l\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi \\(Min\\).</p> <p>Gi\u1ea3 s\u1eed c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ec1u kh\u00e1c nhau \u0111\u00f4i m\u1ed9t (b\u00e0i bonus). \u0110\u1ec3 ph\u1ea7n t\u1eed th\u1ee9 \\(i\\) l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t trong \u0111o\u1ea1n, ta c\u1ea7n xem r\u1eb1ng ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng \u0111o\u1ea1n (ban \u0111\u1ea7u ch\u1ec9 ch\u1ee9a \\(a[i]\\)) v\u1ec1 b\u00ean tr\u00e1i bao xa, v\u00e0 v\u1ec1 b\u00ean ph\u1ea3i bao xa, m\u00e0 \\(a[i]\\) v\u1eabn l\u00e0 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t. B\u00ean tr\u00e1i th\u00ec ta c\u00f3 th\u1ec3 \u0111i cho \u0111\u1ebfn khi g\u1eb7p m\u1ed9t ph\u1ea7n t\u1eed l\u1edbn h\u01a1n ho\u1eb7c \u0111\u1ebfn h\u1ebft d\u00e3y. B\u00ean ph\u1ea3i th\u00ec ta c\u00f3 th\u1ec3 \u0111i cho \u0111\u1ebfn khi g\u1eb7p m\u1ed9t ph\u1ea7n t\u1eed l\u1edbn h\u01a1n ho\u1eb7c \u0111\u1ebfn h\u1ebft d\u00e3y. G\u1ecdi c\u00e1c v\u1ecb tr\u00ed n\u00e0y l\u00e0 \\(l\\) v\u00e0 \\(r\\). Nh\u01b0 v\u1eady, \\(a[i]\\) c\u00f3 th\u1ec3 \u0111\u00f3ng g\u00f3p \\((r - i) * (i - l) * a[i]\\) v\u00e0o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng. T\u01b0\u01a1ng t\u1ef1 v\u1edbi gi\u00e1 tr\u1ecb \\(Min\\), s\u1ef1 kh\u00e1c nhau ch\u1ec9 l\u00e0 \u0111i \u0111\u1ebfn khi g\u1eb7p ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n. \u1ede \u0111\u00e2y \\(a[i]\\) c\u00f3 th\u1ec3 \u0111\u00f3ng g\u00f3p \\(-(r - i) * (i - l) * a[i]\\) v\u00e0o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng.</p> <p>Vi\u1ec7c t\u00ecm gi\u00e1 tr\u1ecb g\u1ea7n nh\u1ea5t l\u1edbn / nh\u1ecf h\u01a1n b\u00ean tr\u00e1i / ph\u1ea3i ph\u1ea7n t\u1eed th\u1ee9 \\(i\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng k\u1ef9 thu\u1eadt Sliding Window trong \\(O(N)\\), sau \u0111\u00f3 l\u01b0u c\u00e1c v\u1ecb tr\u00ed n\u00e0y v\u00e0o 4 m\u1ea3ng kh\u00e1c nhau.</p> <p>N\u1ebfu c\u00e1c ph\u1ea7n t\u1eed kh\u00f4ng kh\u00e1c nhau th\u00ec sao? N\u1ebfu l\u00e0m nh\u01b0 tr\u00ean ta c\u00f3 th\u1ec3 \u0111\u1ebfm ph\u1ea3i nh\u1eefng k\u1ebft qu\u1ea3 tr\u00f9ng nhau. C\u00e1ch t\u1ed1t nh\u1ea5t \u0111\u1ec3 l\u00e0m \u1edf \u0111\u00e2y l\u00e0:</p> <ul> <li>T\u00ecm v\u1ecb tr\u00ed g\u1ea7n nh\u1ea5t b\u00ean tr\u00e1i sao cho gi\u00e1 tr\u1ecb \u1edf \u0111\u00f3 l\u1edbn h\u01a1n ho\u1eb7c B\u1eb0NG \\(a[i]\\).</li> <li>T\u00ecm v\u1ecb tr\u00ed g\u1ea7n nh\u1ea5t b\u00ean ph\u1ea3i sao cho gi\u00e1 tr\u1ecb \u1edf \u0111\u00f3 l\u1edbn h\u01a1n \\(a[i]\\) (nh\u01b0 \u1edf b\u00e0i kh\u00e1c nhau).</li> <li>T\u00ecm v\u1ecb tr\u00ed g\u1ea7n nh\u1ea5t b\u00ean tr\u00e1i sao cho gi\u00e1 tr\u1ecb \u1edf \u0111\u00f3 l\u1edbn h\u01a1n ho\u1eb7c B\u1eb0NG \\(a[i]\\).</li> <li>T\u00ecm v\u1ecb tr\u00ed g\u1ea7n nh\u1ea5t b\u00ean ph\u1ea3i sao cho gi\u00e1 tr\u1ecb \u1edf \u0111\u00f3 l\u1edbn h\u01a1n \\(a[i]\\) (nh\u01b0 \u1edf b\u00e0i kh\u00e1c nhau).</li> </ul> <p>L\u00e0m v\u1eady s\u1ebd lo\u1ea1i b\u1ecf \u0111\u01b0\u1ee3c c\u00e1c gi\u00e1 tr\u1ecb tr\u00f9ng nhau. K\u1ebft l\u1ea1i, ta c\u00f3 th\u1ec3 gi\u1ea3i b\u00e0i n\u00e0y trong \\(O(N)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-6_1","title":"B\u00e0i 6","text":"<p>Cho m\u1ed9t \u0111a gi\u00e1c l\u1ed3i \\(N\\) \u0111\u1ec9nh (\\(N \\le 2000\\) hay \\(N \\le 10^5\\)). Ch\u1ecdn m\u1ed9t t\u1eadp con ng\u1eabu nhi\u00ean c\u00e1c \u0111\u1ec9nh, n\u00f3 s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t \u0111a gi\u00e1c l\u1ed3i nh\u1ecf h\u01a1n. T\u00ednh k\u1ef3 v\u1ecdng chu vi c\u1ee7a \u0111a gi\u00e1c m\u1edbi n\u00e0y.</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t phi\u00ean b\u1ea3n d\u1ec5 h\u01a1n c\u1ee7a b\u00e0i Randomizer c\u1ee7a Codeforces Round 313 Div 1 D. V\u1ec1 b\u00e0i n\u00e0y, ta \u0111\u01b0\u1ee3c cho m\u1ed9t \u0111a gi\u00e1c l\u1ed3i kh\u00f4ng c\u00f3 3 \u0111\u1ec9nh n\u00e0o th\u1eb3ng h\u00e0ng. Ta ph\u1ea3i ch\u1ecdn m\u1ed9t t\u1eadp con ng\u1eabu nhi\u00ean c\u00f3 di\u1ec7n t\u00edch kh\u00e1c 0 (ngh\u0129a l\u00e0 \u00edt nh\u1ea5t 3 \u0111\u1ec9nh). T\u00ednh k\u1ef3 v\u1ecdng s\u1ed1 to\u1ea1 \u0111\u1ed9 nguy\u00ean n\u1eb1m h\u1eb3n b\u00ean trong \u0111a gi\u00e1c m\u1edbi.</p> L\u1eddi gi\u1ea3i <p>V\u1edbi b\u00e0i \u0111\u1ea7u ti\u00ean, ta c\u1ea7n t\u00ednh k\u1ef3 v\u1ecdng chu vi (perimeter) c\u1ee7a \u0111a gi\u00e1c m\u1edbi, hay \\(E(perimeter)\\). M\u00e0 ta bi\u1ebft r\u1eb1ng chu vi b\u1eb1ng t\u1ed5ng \u0111\u1ed9 d\u00e0i c\u00e1c c\u1ea1nh c\u1ee7a \u0111a gi\u00e1c, ngh\u0129a l\u00e0 \\(E(perimeter) = E(\\sum L_i) = \\sum E(L_i)\\), trong \u0111\u00f3 \\(L_i\\) l\u00e0 \u0111\u1ed9 d\u00e0i m\u1ed9t c\u1ea1nh th\u1ee9 \\(i\\) n\u00e0o \u0111\u00f3 trong \u0111a gi\u00e1c. Nh\u01b0 v\u1eady c\u00f3 ngh\u0129a l\u00e0, v\u1edbi m\u1ecdi c\u1ea1nh, n\u1ebfu n\u00f3 xu\u1ea5t hi\u1ec7n trong \u0111a gi\u00e1c, \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o trong k\u1ebft qu\u1ea3. Vi\u1ec7c ta c\u1ea7n l\u00e0m l\u00e0 duy\u1ec7t c\u00e1c c\u1ea1nh c\u00f3 th\u1ec3 c\u00f3, k\u1ef3 v\u1ecdng \u0111\u1ed9 d\u00e0i c\u1ee7a n\u00f3 trong \u0111\u00e1p \u00e1n l\u00e0 t\u00edch c\u1ee7a \u0111\u1ed9 d\u00e0i c\u1ea1nh v\u1edbi x\u00e1c su\u1ea5t n\u00f3 n\u1eb1m trong \u0111\u00e1p \u00e1n. </p> <p>X\u00e9t hai \u0111\u1ec9nh th\u1ee9 \\(i\\) v\u00e0 \\(j\\) trong input, x\u00e1c su\u1ea5t ch\u1ecdn ra \u0111\u01b0\u1ee3c c\u1ea3 hai \u0111\u1ec9nh l\u00e0 \\(\\frac{1}{4}\\). Ta c\u00f3 th\u1ec3 th\u1ea5y c\u1ea1nh n\u00e0y (n\u1ed1i hai \u0111\u1ec9nh th\u1ee9 \\(i\\) v\u00e0 \\(j\\) trong input) s\u1ebd chia \u0111a gi\u00e1c ra l\u00e0m hai ph\u1ea7n, th\u00ec \u1edf \u0111\u00e2y, \u0111\u1ec3 ch\u1ecdn ra \u0111\u01b0\u1ee3c m\u1ed9t \u0111a gi\u00e1c n\u00e0o \u0111\u00f3, ta c\u1ea7n ch\u1ecdn th\u00eam (\u00edt nh\u1ea5t m\u1ed9t) \u0111\u1ec9nh \u1edf m\u1ed9t trong hai ph\u1ea7n, v\u00e0 ho\u00e0n to\u00e0n b\u1ecf qua ph\u1ea7n c\u00f2n l\u1ea1i. Ta s\u1ebd xem m\u1ed9t ph\u1ea7n c\u00f3 \\(j - i - 1\\) \u0111\u1ec9nh (\\(j &gt; i\\)) v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i c\u00f3 \\(n - (j - i + 1)\\) \u0111\u1ec9nh. V\u00e2y x\u00e1c su\u1ea5t \u0111\u1ec3 c\u1ea1nh n\u00e0y n\u1eb1m trong \u0111a gi\u00e1c l\u00e0</p> \\[P = \\frac{1}{4} \\cdot \\left( \\left(\\frac{1}{2}\\right)^{j-i+1} \\cdot \\frac{2^{n-(j-i+1)} - 1}{ 2^{n-(j-i+1)} } + \\left(\\frac{1}{2}\\right)^{n-(j-i+1)} \\cdot \\frac{2^{j-i+1} - 1 }{2^{j-i+1} } \\right)\\] <p>Ok, ta \u0111\u00e3 gi\u1ea3i \u0111\u01b0\u1ee3c nh\u01b0ng c\u00e1ch n\u00e0y t\u1ed1n \\(O(N^2)\\). V\u1edbi \\(N\\) l\u1edbn, ta c\u1ea7n \u0111\u1ec3 \u00fd r\u1eb1ng v\u1edbi \\(i\\) v\u00e0 \\(j\\) n\u1eb1m qu\u00e1 xa nhau (\\(j - i + 1 &gt; 60\\)), \\(\\left(\\frac{1}{2}\\right)^{j-i+1}\\) s\u1ebd r\u1ea5t r\u1ea5t nh\u1ecf. Cho n\u00ean \u1edf \u0111\u00e2y, v\u1edbi m\u1ed7i \\(i\\), ta ch\u1ec9 c\u1ea7n duy\u1ec7t c\u00e1c \\(j\\) c\u00e1ch n\u00f3 trong t\u1ea7m \\(60\\) \u0111\u01a1n v\u1ecb l\u00e0 \u0111\u01b0\u1ee3c. Cho n\u00ean ta c\u00f3 th\u1ec3 gi\u1ea3i nh\u01b0 c\u00e1ch tr\u00ean nh\u01b0ng b\u1ecf qua c\u00e1c x\u00e1c su\u1ea5t qu\u00e1 nh\u1ecf, trong \\(O(N)\\). Th\u00eam m\u1ed9t \u0111i\u1ec3m n\u1eefa, ta kh\u00f4ng x\u00e9t l\u1ea1i c\u00e1c c\u1eb7p \\((i, j)\\) \u0111\u00e3 x\u00e9t nh\u00e9, khi \\(N\\) nh\u1ecf r\u1ea5t c\u00f3 th\u1ec3 ta s\u1ebd x\u00e9t c\u00e1c c\u1eb7p tr\u00f9ng nhau.</p> <p>V\u1edbi b\u00e0i Randomizer, \u0111\u1ea7u ti\u00ean ta c\u1ea7n bi\u1ebft ch\u00fat v\u1ec1 \u0111\u1ecbnh l\u00fd Pick. Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t \u0111a gi\u00e1c tr\u00ean h\u1ec7 to\u1ea1 \u0111\u1ed9 \\(Oxy\\), v\u1edbi c\u00e1c \u0111\u1ec9nh c\u1ee7a n\u00f3 c\u00f3 ho\u00e0nh \u0111\u1ed9 v\u00e0 tung \u0111\u1ed9 l\u00e0 s\u1ed1 nguy\u00ean. G\u1ecdi \\(i\\) l\u00e0 s\u1ed1 c\u00e1c \u0111\u1ec9nh c\u00f3 to\u1ea1 \u0111\u1ed9 nguy\u00ean n\u1eb1m ho\u00e0n to\u00e0n trong \u0111a gi\u00e1c, g\u1ecdi \\(b\\) l\u00e0 s\u1ed1 \u0111\u1ec9nh c\u00f3 to\u1ea1 \u0111\u1ed9 nguy\u00ean n\u1eb1m tr\u00ean \u0111a gi\u00e1c (n\u1eb1m tr\u00ean c\u1ea3 \u0111\u1ec9nh v\u00e0 c\u1ea1nh). \u0110\u1ecbnh l\u00fd Pick cho ta c\u00f4ng th\u1ee9c t\u00ednh di\u1ec7n t\u00edch \\(A\\) c\u1ee7a \u0111a gi\u00e1c l\u00e0</p> \\[A = i + \\frac{b}{2} - 1\\] <p>T\u1eeb \u0111\u00f3 ta s\u1ebd c\u00f3:</p> \\[i = A - \\frac{b}{2} + 1\\] <p>R\u00f5 r\u00e0ng ta c\u1ea7n t\u00ednh \\(E(i)\\). Theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, ta s\u1ebd c\u00f3 nh\u01b0 sau:</p> \\[\\begin{align} E(i) &amp;= E(A - \\frac{b}{2} + 1)\\\\ &amp;= E(A) - \\frac{E(b)}{2} + 1\\\\ \\end{align}\\] <p>Ta c\u00f9ng t\u00ednh k\u1ef3 v\u1ecdng c\u00e1c \u0111\u1ec9nh tr\u00ean c\u1ea1nh tr\u01b0\u1edbc. V\u1edbi m\u1ed9t c\u1ea1nh n\u1ed1i \u0111\u1ec9nh \\((0, 0)\\) v\u00e0 \u0111\u1ec9nh \\((x, y)\\), ta c\u00f3 th\u1ec3 t\u00ednh s\u1ed1 \u0111\u1ec9nh nguy\u00ean tr\u00ean c\u1ea1nh l\u00e0 \\(GCD(x, y) + 1\\). Nh\u01b0ng \u0111\u1ec3 cho \u0111\u01a1n gi\u1ea3n, ta s\u1ebd kh\u00f4ng t\u00ednh m\u1ed9t trong hai \u0111\u1ea7u m\u00fat c\u1ee7a c\u1ea1nh. L\u00fd do \u1edf \u0111\u00e2y l\u00e0 khi t\u1ea1o th\u00e0nh m\u1ed9t \u0111a gi\u00e1c, s\u1ed1 \u0111\u1ec9nh n\u1eb1m tr\u00ean c\u00e1c c\u1ea1nh ch\u00ednh l\u00e0 t\u1ed5ng tr\u00ean c\u00e1c c\u1ea1nh ri\u00eang l\u1ebb nh\u01b0ng kh\u00f4ng t\u00ednh m\u1ed9t trong hai \u0111\u1ea7u m\u00fat. B\u1ea1n c\u00f3 th\u1ec3 v\u1ebd ra \u0111\u1ec3 th\u1ea5y. \u1ede \u0111\u00e2y, v\u00ec t\u1ed5ng c\u00e1c \u0111\u1ec9nh n\u1eb1m tr\u00ean c\u1ea1nh s\u1ebd b\u1eb1ng t\u1ed5ng tr\u00ean c\u00e1c c\u1ea1nh ri\u00eang l\u1ebb, n\u00ean theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, ta c\u00f3 th\u1ec3 t\u00ednh k\u1ef3 v\u1ecdng s\u1ed1 \u0111\u1ec9nh n\u1eb1m tr\u00ean m\u1ed7i c\u1ea1nh c\u00f3 th\u1ec3 t\u1ea1o th\u00e0nh. </p> <p>X\u00e9t c\u1ea1nh n\u1ed1i hai \u0111\u1ec9nh \\(i\\) v\u00e0 \\(j\\) (\\(i &lt; j\\)), ta c\u1ea7n t\u00ednh x\u00e1c su\u1ea5t c\u1ea1nh n\u00e0y xu\u1ea5t hi\u1ec7n trong m\u1ed9t \u0111a gi\u00e1c n\u00e0o \u0111\u00f3. Kh\u00f4ng gian m\u1eabu c\u1ee7a vi\u1ec7c ch\u1ecdn m\u1ed9t \u0111a gi\u00e1c \u00edt nh\u1ea5t 3 \u0111\u1ec9nh l\u00e0 s\u1ebd l\u00e0 \\(2^n - 1 - n - \\frac{n(n-1)}{2}\\). \u0110i\u1ec1u n\u00e0y l\u00e0 v\u00ec ta c\u1ea7n ch\u1ecdn \u00edt nh\u1ea5t 3 \u0111\u1ec9nh n\u00ean ph\u1ea3i lo\u1ea1i c\u00e1c tr\u01b0\u1eddng h\u1ee3p ch\u1ecdn 0, 1 v\u00e0 2 \u0111\u1ec9nh ra. \u0110\u1ec3 hai \u0111\u1ec9nh \u0111\u01b0\u1ee3c ch\u1ecdn tr\u1edf th\u00e0nh c\u1ea1nh th\u00ec m\u1ed9t trong hai ph\u00eda ph\u1ea3i kh\u00f4ng c\u00f3 \u0111\u1ec9nh n\u00e0o, ta ch\u1ecdn xo\u00e1 ph\u00eda c\u00f3 \\(j - i - 1\\) \u0111\u1ec9nh, s\u1ed1 c\u00e1ch ch\u1ecdn s\u1ebd l\u00e0 \\(2^{n - (j - i - 1 + 2)} - 1 = 2^{n - (j - i) + 1} - 1\\). Ta xo\u00e1 m\u1ed9t ph\u00eda \u0111\u1ec3 kh\u00f4ng ph\u1ea3i x\u1eed l\u00fd ph\u00eda c\u00f2n l\u1ea1i n\u1ebfu ch\u1ecdn ph\u1ea3i c\u1eb7p \\((j, i)\\) v\u1ec1 sau. Tuy nhi\u00ean, t\u01b0\u01a1ng t\u1ef1 b\u00e0i tr\u00ean, khi \\(j - i &gt; 60\\) th\u00ec x\u00e1c su\u1ea5t n\u00e0y s\u1ebd tr\u1edf n\u00ean r\u1ea5t nh\u1ecf, n\u00ean ta ch\u1ec9 c\u1ea7n x\u00e9t c\u00e1c c\u1eb7p c\u00e1ch nhau kh\u00f4ng qu\u00e1 60 l\u00e0 \u0111\u01b0\u1ee3c.</p> <p>Nh\u01b0 v\u1eady x\u00e1c su\u1ea5t \u0111\u1ec3 ch\u1ecdn ra m\u1ed9t c\u1ea1nh ch\u1ee9a hai \u0111\u1ec9nh, \u0111\u1ec9nh th\u1ee9 \\(i\\) v\u00e0 \u0111\u1ec9nh th\u1ee9 \\(i + k\\) l\u00e0:</p> \\[\\frac{2^{n-k-1} - 1 }{2^n - 1 - n - \\frac{n(n-1)}{2} } = \\frac{1 - \\frac{1}{2^{n - k - 1} } }{2^{k+1} - (n^2 + n + 2) \\cdot \\frac{1}{2^{n-k} } }\\] <p>L\u01b0u \u00fd, bi\u1ec3u th\u1ee9c ph\u00eda sau l\u00e0 \u0111\u1ec3 d\u1ec5 t\u00ednh h\u01a1n khi code.</p> <p>Th\u1ebf c\u00f2n di\u1ec7n t\u00edch th\u00ec sao? Khi c\u00e1c \u0111\u1ec9nh \\((x_i, y_i)\\) \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo chi\u1ec1u ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3, ta t\u00ednh \u0111\u01b0\u1ee3c di\u1ec7n t\u00edch c\u1ee7a \u0111a gi\u00e1c t\u1ea1o b\u1edfi n\u00f3 nh\u01b0 sau:</p> \\[S = \\frac{1}{2} \\cdot (x_1y_2 - x_2y_1 + x_2y_3 - x_3y_2 + \\ldots + x_{n-1}y_{n} - x_{n}y_{n-1} + x_{n}y_{1} - x_{1}y_{n})\\] <p>\u0110\u00e2y l\u00e0 c\u00f4ng th\u1ee9c t\u00ednh di\u1ec7n t\u00edch d\u1ef1a tr\u00ean t\u00edch c\u00f3 h\u01b0\u1edbng. V\u00ec sao n\u00f3 \u0111\u00fang th\u00ec b\u1ea1n c\u00f3 th\u1ec3 xem \u1edf \u0111\u00e2y. V\u1ec1 c\u01a1 b\u1ea3n, v\u1edbi c\u1ea1nh \\((i, j)\\) (\\(j\\) n\u1eb1m sau \\(i\\) theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3), n\u00f3 s\u1ebd th\u00eam v\u00e0o \u0111\u00e1p \u00e1n (kh\u00f4ng t\u00ednh ph\u1ea7n chia 2), m\u1ed9t kho\u1ea3ng l\u00e0 \\(x_iy_j - x_jy_i\\). \u0110\u1ebfn \u0111\u00e2y th\u00ec theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh th\u00ec b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 l\u00e0m t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean v\u1edbi c\u00f9ng x\u00e1c su\u1ea5t.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-7_1","title":"B\u00e0i 7","text":"<p>Cho \\(N\\) \u0111i\u1ec3m (\\(B \\le 200\\) hay \\(N \\le 2000\\)), kh\u00f4ng c\u00f3 3 \u0111i\u1ec3m th\u1eb3ng h\u00e0ng. M\u1ed7i \u0111i\u1ec3m bi\u1ebfn m\u1ea5t v\u1edbi x\u00e1c su\u1ea5t 50%. T\u00ecm k\u1ef3 v\u1ecdng k\u00edch th\u01b0\u1edbc bao l\u1ed3i c\u1ee7a c\u00e1c \u0111i\u1ec3m c\u00f2n l\u1ea1i (K\u00edch th\u01b0\u1edbc bao l\u1ed3i l\u00e0 s\u1ed1 \u0111\u1ec9nh c\u1ee7a bao l\u1ed3i).</p> L\u1eddi gi\u1ea3i <p>T\u00ecnh c\u1edd l\u00e0 trong m\u1ed9t \u0111a gi\u00e1c l\u1ed3i, s\u1ed1 \u0111\u1ec9nh b\u1eb1ng s\u1ed1 c\u1ea1nh c\u1ee7a \u0111a gi\u00e1c \u0111\u00f3 (kh\u00f4ng t\u00ednh tr\u01b0\u1eddng h\u1ee3p c\u00f3 m\u1ed9t ho\u1eb7c hai \u0111\u1ec9nh \u0111\u01b0\u1ee3c ch\u1ecdn, b\u1ea1n c\u00f3 th\u1ec3 x\u1eed l\u00fd ri\u00eang hai tr\u01b0\u1eddng h\u1ee3p n\u00e0y). N\u00ean k\u1ef3 v\u1ecdng s\u1ed1 \u0111\u1ec9nh c\u1ee7a bao l\u1ed3i c\u0169ng s\u1ebd l\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 c\u1ea1nh c\u1ee7a bao l\u1ed3i. M\u00e0 nh\u01b0 b\u00e0i 6 th\u00ec v\u1edbi m\u1ed7i c\u1ea1nh, \u0111\u01b0\u1eddng th\u1eb3ng \u1ee9ng v\u1edbi c\u1ea1nh s\u1ebd chia m\u1eb7t ph\u1eb3ng ra l\u00e0m 2 ph\u1ea7n, tr\u00e1i (\\(L\\)) v\u00e0 ph\u1ea3i (\\(R\\)). X\u00e1c su\u1ea5t \u0111\u1ec3 c\u1ea1nh \\(ij\\) \u0111\u00f3 n\u1eb1m trong bao l\u1ed3i (c\u00f3 \u00edt nh\u1ea5t 3 \u0111\u1ec9nh l\u00e0):</p> \\[P_{ij} = \\frac{1}{4} \\cdot \\left( (\\frac{1}{2})^L \\cdot \\frac{2^R-1}{2^R} + (\\frac{1}{2})^R \\cdot \\frac{2^L-1}{2^L} \\right)\\] <p>\u0110\u1ec3 t\u00ednh \\(L\\) v\u00e0 \\(R\\) th\u00ec b\u1ea1n c\u00f3 th\u1ec3 l\u00e0m c\u00e1ch tr\u00e2u v\u1edbi \\(O(N^3)\\), ho\u1eb7c v\u1edbi \\(O(N^2 \\log N)\\) b\u1eb1ng c\u00e1ch sau, v\u1edbi m\u1ed7i \u0111\u1ec9nh \\(i\\), s\u1eafp x\u1ebfp c\u00e1c \u0111\u1ec9nh c\u00f2n l\u1ea1i theo g\u00f3c v\u00e0 duy\u1ec7t \\(j\\) theo g\u00f3c, nh\u01b0 v\u1eady \\(L\\) v\u00e0 \\(R\\) s\u1ebd kh\u00f4ng c\u1ea7n ph\u1ea3i t\u00ednh l\u1ea1i.</p> <p>M\u1ed9t c\u00e1ch gi\u1ea3i kh\u00e1c cho b\u00e0i n\u00e0y l\u00e0 v\u1edbi m\u1ed7i \u0111\u1ec9nh, ta t\u00ednh x\u00e1c su\u1ea5t c\u1ee7a \u0111\u1ec9nh \u0111\u00f3 tr\u1edf th\u00e0nh m\u1ed9t \u0111\u1ec9nh tr\u00ean bao l\u1ed3i (c\u0169ng l\u00e0 k\u1ef3 v\u1ecdng lu\u00f4n), m\u00e0 c\u00e1ch n\u00e0y th\u00ec h\u01a1i kh\u00f3 m\u1ed9t t\u00ed, ta s\u1ebd kh\u00f4ng b\u00e0n \u0111\u1ebfn \u1edf \u0111\u00e2y.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-8_1","title":"B\u00e0i 8","text":"<p>Cho d\u00e3y \u0111\u1ed9 d\u00e0i \\(N\\) (\\(N \\le 2000\\) hay \\(N \\le 10^5\\)). Ta s\u1ebd th\u1ef1c hi\u1ec7n thao t\u00e1c sau \\(N-1\\) l\u1ea7n: xo\u00e1 ph\u1ea7n t\u1eed \u0111\u1ea7u ho\u1eb7c cu\u1ed1i, x\u00e1c su\u1ea5t 50% \u0111\u1ea7u v\u00e0 50% cu\u1ed1i. T\u00ecm k\u1ef3 v\u1ecdng gi\u00e1 tr\u1ecb c\u1ee7a s\u1ed1 c\u00f2n l\u1ea1i.</p> L\u1eddi gi\u1ea3i <p>D\u1ec5 th\u1ea5y k\u1ef3 v\u1ecdng gi\u00e1 tr\u1ecb c\u1ee7a s\u1ed1 c\u00f2n l\u1ea1i b\u1eb1ng t\u1ed5ng k\u1ef3 v\u1ecdng t\u1eebng s\u1ed1 xu\u1ea5t hi\u1ec7n trong \u0111\u00e1p \u00e1n. Hay n\u00f3i c\u00e1ch kh\u00e1c, \\(E = \\sum_{i} P_i \\cdot a_i\\). Trong \u0111\u00f3 \\(P_i\\) l\u00e0 x\u00e1c su\u1ea5t m\u00e0 s\u1ed1 th\u1ee9 \\(i\\) \u0111\u01b0\u1ee3c ch\u1ecdn. V\u1eady l\u00e0m sao t\u00ednh \u0111\u01b0\u1ee3c s\u1ed1 n\u00e0y, g\u1ecdi \\(L\\) l\u00e0 s\u1ed1 s\u1ed1 b\u00ean tr\u00e1i \\(i\\), \\(R\\) l\u00e0 s\u1ed1 s\u1ed1 b\u00ean ph\u1ea3i \\(i\\). Th\u00ec s\u1ed1 c\u00e1ch xo\u00e1 \u0111\u1ec3 sau c\u00f9ng c\u00f3 \u0111\u01b0\u1ee3c \\(i\\) l\u00e0 \\(\\binom{L+R}{L}\\), ngh\u00eda l\u00e0 ta ti\u1ebfn h\u00e0nh xo\u00e1 \\(L + R\\) l\u1ea7n, trong \u0111\u00f3 c\u00f3 \\(L\\) l\u1ea7n xo\u00e1 b\u00ean tr\u00e1i. V\u1edbi \\(i\\) th\u00ec ta \u0111\u00e3 bi\u1ebft \\(L\\) v\u00e0 \\(R\\) l\u00e0 bao nhi\u00eau r\u1ed3i, n\u00ean \\(P_i = \\frac{\\binom{N-1}{i-1}}{2^{N-1}}\\). X\u00e1c su\u1ea5t n\u00e0y c\u00f3 ph\u1ea7n t\u1eed s\u1ed1 h\u01a1i l\u1edbn n\u00ean b\u1ea1n c\u1ea7n c\u1ea9n th\u1eadn khi code.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#ly-thuyet-ky-vong-phan-2","title":"L\u00fd thuy\u1ebft k\u1ef3 v\u1ecdng, ph\u1ea7n 2","text":"<p>Tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t. Nh\u1edb r\u1eb1ng, k\u1ef3 v\u1ecdng b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a s\u1ed1 tr\u00ean x\u00fac x\u1eafc kh\u00e1c b\u1edbi b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a k\u1ef3 v\u1ecdng:</p> \\[E(X^2) = \\frac{1 + 4 + 9 + 16 + 25 + 36}{6} = 15.1666...\\] \\[E(X)^2 = (\\frac{1 + 2 + 3 + 4 + 5 + 6}{6})^2 = 3.5^2 = 12.25\\] <p>Hai bi\u1ebfn c\u1ed1 g\u1ecdi l\u00e0 \u0111\u1ed9c l\u1eadp khi k\u1ebft qu\u1ea3 c\u1ee7a m\u1ed9t bi\u1ebfn c\u1ed1 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn ph\u00e2n b\u1ed1 x\u00e1c su\u1ea5t c\u1ee7a bi\u1ebfn c\u1ed1 c\u00f2n l\u1ea1i. K\u1ebft qu\u1ea3 tung hai x\u00fac x\u1eafc (ho\u1eb7c tung m\u1ed9t x\u00fac x\u1eafc hai l\u1ea7n) l\u00e0 \u0111\u1ed9c l\u1eadp, nh\u01b0ng l\u01b0\u1ee3ng m\u01b0a v\u00e0 s\u1ee9c gi\u00f3 th\u00ec ph\u1ee5 thu\u1ed9c nhau. Tuy nhi\u00ean, t\u00ednh tuy\u1ebfn t\u00ednh th\u00ec lu\u00f4n \u0111\u00fang:</p> \\[E(X + Y) = E(X) + E(Y)\\] <p>C\u00f4ng th\u1ee9c quan tr\u1ecdng kh\u00e1c l\u00e0 \\(E(X \\cdot Y) = E(X) \\cdot E(Y)\\) ch\u1ec9 \u0111\u00fang v\u1edbi bi\u1ebfn c\u1ed1 \u0111\u1ed9c l\u1eadp. N\u00ean k\u1ef3 v\u1ecdng c\u1ee7a t\u00edch c\u00e1c s\u1ed1 sau hai l\u1ea7n tung x\u00fac x\u1eafc l\u00e0 \\(3.5^2\\), nh\u01b0ng kh\u00f4ng th\u1ec3 s\u1eed d\u1ee5ng \\(E(X \\cdot X) = E(X) \\cdot E(X)\\), v\u00ec \\(X\\) v\u00e0 \\(X\\) kh\u00f4ng \u0111\u1ed9c l\u1eadp.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#ordered-pairs-giai-thich-binh-phuong","title":"Ordered pairs (gi\u1ea3i th\u00edch b\u00ecnh ph\u01b0\u01a1ng)","text":"<p>B\u00ecnh ph\u01b0\u01a1ng k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed9t t\u1eadp b\u1eb1ng v\u1edbi s\u1ed1 ordered pairs c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong t\u1eadp. N\u00ean ta c\u00f3 th\u1ec3 duy\u1ec7t c\u00e1c c\u1eb7p v\u00e0 v\u1edbi m\u1ed7i c\u1eb7p ta t\u00ednh g\u00f3p c\u1ee7a n\u00f3 v\u00e0o k\u1ebft qu\u1ea3.</p> <p>C\u1ee5 th\u1ec3, g\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0o \u0111\u00f3 cho m\u1ed9t bi\u1ebfn c\u1ed1 \\(i\\) n\u00e0o \u0111\u00f3. Ta mu\u1ed1n t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a t\u1ed5ng t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0y, hay n\u00f3i c\u00e1ch kh\u00e1c, ta c\u1ea7n t\u00ednh \\(E[(X_1 + X_2 + X_3 + \\ldots + X_N)^2]\\).</p> <p>Theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, ta l\u1ea1i c\u00f3:</p> \\[\\begin{align} E[(X_1 + X_2 + X_3 + \\ldots + X_N)^2] &amp;= E[(X_1 + X_2 + X_3 + \\ldots + X_N) \\cdot (X_1 + X_2 + X_3 + \\ldots + X_N)]\\\\ &amp;= E[X_1 \\cdot X_1 + \\ldots + X_1 \\cdot X_N + X_2 \\cdot X_1 + \\ldots + X_2 \\cdot X_N + \\ldots + X_N \\cdot X_1 + \\ldots + X_N \\cdot X_N]\\\\ &amp;= E[X_1 \\cdot X_1] + \\ldots + E[X_1 \\cdot X_N] + E[X_2 \\cdot X_1] + \\ldots + E[X_2 \\cdot X_N] + \\ldots + E[X_N \\cdot X_1] + \\ldots + E[X_N \\cdot X_N]\\\\ \\end{align}\\] <p>Nh\u01b0 v\u1eady ta c\u00f3 th\u1ec3 t\u00ednh k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed7i c\u1eb7p v\u00e0 g\u00f3p v\u00e0o k\u1ebft qu\u1ea3.</p> <p>T\u01b0\u01a1ng t\u1ef1, m\u0169 \\(k\\) th\u00ec b\u1eb1ng s\u1ed1 d\u00e3y \u0111\u1ed9 d\u00e0i \\(k\\), ta c\u00f3 th\u1ec3 l\u00e0m gi\u1ed1ng nh\u01b0 tr\u00ean l\u00e0 t\u00ednh k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed7i b\u1ed9 t\u00edch \\(k\\) ph\u1ea7n t\u1eed v\u00e0 g\u00f3p n\u00f3 v\u00e0o k\u1ebft qu\u1ea3.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#ky-thuat-mu","title":"K\u1ef9 thu\u1eadt m\u0169","text":"<p>N\u1ebfu mu\u1ed1n duy tr\u00ec t\u1ed5ng c\u00e1c s\u1ed1 m\u0169 \\(k\\), ta c\u1ea7n duy tr\u00ec t\u1ed5ng c\u00e1c s\u1ed1 m\u0169 nh\u1ecf h\u01a1n. V\u00ed d\u1ee5, t\u1ed5ng c\u1ee7a c\u00e1c m\u0169 \\(0\\), m\u0169 \\(1\\) v\u00e0 m\u0169 \\(2\\) l\u1ea7n l\u01b0\u1ee3t l\u00e0 \\(S_0\\), \\(S_1\\) v\u00e0 \\(S_2\\), v\u00e0 n\u1ebfu t\u0103ng m\u1ed7i ph\u1ea7n t\u1eed l\u00ean \\(x\\). C\u00e1c t\u1ed5ng m\u1edbi s\u1ebd l\u00e0 \\(S_0\\), \\(S_1 + S_0 \\cdot x\\) v\u00e0 \\(S_2 + 2 \\cdot x \\cdot S_1 + x^2 \\cdot S_0\\). Ta s\u1ebd t\u1eadp trung v\u00e0o k\u1ef9 thu\u1eadt \"ordered pairs\".</p>"},{"location":"Codeforces/math/sums-and-expected-value/#cac-bai-tap","title":"C\u00e1c b\u00e0i t\u1eadp","text":""},{"location":"Codeforces/math/sums-and-expected-value/#bai-1_2","title":"B\u00e0i 1","text":"<p>Gi\u00e1 c\u1ee7a m\u1ed9t chi\u1ebfc TV l\u00e0 1000 \u0111\u00f4. Trong \\(N\\) ng\u00e0y ti\u1ebfp theo, m\u1ed7i ng\u00e0y gi\u00e1 c\u1ee7a TV t\u0103ng 1% ho\u1eb7c 2% (x\u00e1c su\u1ea5t nh\u01b0 nhau l\u00e0 50%). T\u00ednh k\u1ef3 v\u1ecdng gi\u00e1 TV sau \\(N\\) ng\u00e0y.</p> L\u1eddi gi\u1ea3i <p>Ta c\u00f3 c\u00f4ng th\u1ee9c t\u00ednh gi\u00e1 TV s\u1ebd l\u00e0 \\(1000 \\cdot (1 + \\Delta_1) \\cdot (1 + \\Delta_2) \\cdot (1 + \\Delta_3) \\ldots\\). V\u1edbi \\(\\Delta_i\\) l\u00e0 ph\u1ea7n tr\u0103m gi\u00e1 t\u0103ng v\u00e0o ng\u00e0y th\u1ee9 \\(i\\)</p> <p>N\u1ebfu t\u00ednh theo gi\u00e1, ta th\u1ea5y s\u1ed1 ti\u1ec1n t\u0103ng l\u00ean s\u1ebd ph\u1ee5 thu\u1ed9c v\u00e0o gi\u00e1 hi\u1ec7n t\u1ea1i c\u1ee7a chi\u1ebfc TV. Tuy nhi\u00ean, n\u1ebfu x\u00e9t vi\u1ec7c t\u0103ng c\u1ee7a gi\u00e1 TV, th\u00ec bi\u1ebfn c\u1ed1 n\u00e0y cho c\u00e1c ng\u00e0y kh\u00e1c nhau l\u1ea1i \u0111\u1ed9c l\u1eadp v\u1edbi nhau. Ta d\u1ec5 d\u00e0ng t\u00ednh \u0111\u01b0\u1ee3c k\u1ef3 v\u1ecdng ph\u1ea7n tr\u0103m gi\u00e1 t\u0103ng c\u1ee7a TV l\u00e0 \\(0.01 \\cdot 0.5 + 0.02 \\cdot 0.5 = 0.015\\) hay 1.5%.</p> <p>Nh\u01b0 v\u1eady, sau \\(N\\) ng\u00e0y, k\u1ef3 v\u1ecdng gi\u00e1 c\u1ee7a TV s\u1ebd l\u00e0 \\(E = 1000 \\cdot (1 + 0.015)^N\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-2_2","title":"B\u00e0i 2","text":"<p>B\u1ea1n mua \\(N\\) (\\(N \\le 10^5\\)) v\u00e9 s\u1ed1. C\u00e1i th\u1ee9 \\(i\\) c\u00f3 x\u00e1c su\u1ea5t tr\u00fang l\u00e0 \\(p_i\\). Bi\u1ebfn c\u1ed1 \u0111\u1ed9c l\u1eadp (quan tr\u1ecdng!). T\u00ecm k\u1ef3 v\u1ecdng b\u00ecnh ph\u01b0\u01a1ng s\u1ed1 v\u00e9 th\u1eafng.</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean cho bi\u1ebfn c\u1ed1 v\u00e9 s\u1ed1 th\u1ee9 \\(i\\) tr\u00fang th\u01b0\u1edfng. Nh\u01b0 v\u1eady \\(E[X_i]\\) s\u1ebd l\u00e0 k\u1ef3 v\u1ecdng v\u00e9 s\u1ed1 \\(i\\) tr\u00fang th\u01b0\u1edfng. Do \u0111\u00e2y l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o n\u00ean \\(E[X_i] = p_i\\) t\u1ee9c l\u00e0 k\u1ef3 v\u1ecdng c\u0169ng l\u00e0 x\u00e1c su\u1ea5t v\u00e9 \\(i\\) tr\u00fang th\u01b0\u1edfng.</p> <p>Ta c\u00f3 k\u1ebft qu\u1ea3 c\u1ea7n t\u00ecm s\u1ebd l\u00e0 \\(E[(X_1 + X_2 + X_3 + \\ldots + X_N)^2]\\). Khai tri\u1ec3n ra nh\u01b0 trong ph\u1ea7n gi\u1ea3i th\u00edch Ordered pairs th\u00ec ta s\u1ebd c\u1ea7n ph\u1ea3i t\u00ednh t\u1ed5ng t\u1ea5t c\u1ea3 c\u00e1c \\(E[X_i \\cdot X_j]\\) v\u1edbi m\u1ecdi \\(i\\) v\u00e0 \\(j\\). C\u00f3 2 tr\u01b0\u1eddng h\u1ee3p x\u1ea3y ra:</p> <ol> <li>Khi \\(i \\ne j\\), ta c\u0169ng bi\u1ebft r\u1eb1ng c\u00e1c bi\u1ebfn c\u1ed1 \\(X_i\\) v\u00e0 \\(X_j\\) \u0111\u1ed9c l\u1eadp v\u1edbi nhau, n\u00ean \\(E[X_i \\cdot X_j] = E[X_i] \\cdot E[X_j] = p_i \\cdot p_j\\).</li> <li>Khi \\(i = j\\), ta bi\u1ebft r\u1eb1ng \\(X_i\\) v\u00e0 \\(X_i\\) kh\u00f4ng \u0111\u1ed9c l\u1eadp v\u1edbi nhau, \u1edf \u0111\u00e2y \u0111\u01a1n gi\u1ea3n l\u00e0 \\(E[X_i \\cdot X_i] = p_i\\). V\u00ec k\u1ef3 v\u1ecdng cho v\u00e9 \\(i\\) tr\u00fang v\u00e0 v\u00e9 \\(i\\) c\u0169ng tr\u00fang \u0111\u1ec1u quy v\u1ec1 m\u1ed9t kh\u1ea3 n\u0103ng.</li> </ol> <p>N\u00f3i th\u00eam m\u1ed9t ch\u00fat \u0111\u1ec3 \u0111\u1ee1 nh\u1ea7m l\u1eabn, ta th\u1ea5y r\u1eb1ng \\(E[X_i \\cdot X_i] = E[X_i^2] = p_i * 1^2\\), ngh\u0129a l\u00e0 x\u00e1c su\u1ea5t c\u00f3 \u0111\u01b0\u1ee3c bi\u1ebfn c\u1ed1 v\u1eabn l\u00e0 \\(p_i\\), v\u00e0 gi\u00e1 tr\u1ecb nh\u1eadn \u0111\u01b0\u1ee3c l\u00e0 \\(1^2 = 1\\). B\u1ea1n s\u1ebd hi\u1ec3u r\u00f5 v\u1ea5n \u0111\u1ec1 khi gi\u1ea3i b\u00e0i Codeforces - A granite of science.</p> <p>G\u1ecdi \\(S = p_1 + p_2 + \\ldots + p_N\\). Nh\u01b0 v\u1eady \\(E[(X_1 + X_2 + X_3 + \\ldots + X_N)^2] = \\sum_i (p_i \\cdot S - p_i^2 + p_i)\\). Ta c\u00f3 th\u1ec3 t\u00ednh k\u1ebft qu\u1ea3 n\u00e0y trong \\(O(N)\\).</p> <p>N\u1ebfu b\u1ea1n mu\u1ed1n g\u1ecdn h\u01a1n, ta g\u1ecdi th\u00eam \\(S_2 = p_1^2 + p_2^2 + \\ldots + p_N^2\\). Ta s\u1ebd \u0111\u01b0\u1ee3c \\(E = S^2 - S_2 + S\\). K\u1ebft qu\u1ea3 n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh trong \\(O(N)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-3_2","title":"B\u00e0i 3","text":"<p>T\u01b0\u01a1ng t\u1ef1 b\u00e0i 2 nh\u01b0ng t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a m\u0169 3 ho\u1eb7c 4.</p> L\u1eddi gi\u1ea3i <p>Tu\u01a1ng t\u1ef1 b\u00e0i tr\u00ean, vi\u1ec7c c\u1ee7a ta s\u1ebd l\u00e0m l\u00e0 v\u1edbi m\u1ed7i b\u1ed9 3 \\(\\{i, j, k\\}\\), ta g\u00f3p \\(p_i \\cdot p_j \\cdot p_k\\) v\u00e0o k\u1ebft qu\u1ea3, ta c\u00f3 c\u00e1c tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t sau:</p> <ul> <li>N\u1ebfu \\(i = j = k\\), ta ch\u1ec9 g\u00f3p \\(p_i\\) v\u00e0o k\u1ebft qu\u1ea3.</li> <li>N\u1ebfu \\(i = j \\ne k\\), ta g\u00f3p \\(p_i \\cdot p_k\\) v\u00e0o k\u1ebft qu\u1ea3.</li> <li>N\u1ebfu \\(i = k \\ne j\\), ta g\u00f3p \\(p_i \\cdot p_j\\) v\u00e0o k\u1ebft qu\u1ea3.</li> <li>N\u1ebfu \\(k = j \\ne i\\), ta g\u00f3p \\(p_i \\cdot p_k\\) v\u00e0o k\u1ebft qu\u1ea3.</li> <li>T\u1ed5ng qu\u00e1t th\u00ec n\u1ebfu c\u00f3 nhi\u1ec1u ph\u1ea7n t\u1eed gi\u1ed1ng nhau (v\u1ec1 v\u1ecb tr\u00ed), ta ch\u1ec9 d\u00f9ng 1 l\u1ea7n ph\u1ea7n t\u1eed \u0111\u00f3.</li> </ul> <p>B\u00e2y gi\u1edd g\u1ecdi l\u1ea7n l\u01b0\u1ee3t:</p> <ul> <li>\\(S = p_1 + p_2 + \\ldots + p_N\\)</li> <li>\\(S_2 = p_1^2 + p_2^2 + \\ldots + p_N^2\\)</li> <li>\\(S_3 = p_1^3 + p_2^3 + \\ldots + p_N^3\\).</li> </ul> <p>Gi\u1edd ta s\u1ebd duy\u1ec7t \\(i\\) v\u00e0 \\(j\\), ta c\u00f3 hai tr\u01b0\u1eddng h\u1ee3p sau:</p> <ul> <li>N\u1ebfu \\(i = j\\), ta s\u1ebd g\u00f3p v\u00e0o t\u1ed5ng l\u00e0 \\(p_i \\cdot (S - p_i) + p_i\\) (1). L\u00fd do l\u00e0 v\u00ec s\u1ebd c\u00f3 tr\u01b0\u1eddng h\u1ee3p \\(k = i\\), khi \u0111\u00f3 \\(i = j = k\\), n\u00ean ta ch\u1ec9 th\u00eam \\(p_i\\), c\u00f2n l\u1ea1i \\(i = j \\ne k\\), n\u00ean ta th\u00eam \\(p_i \\cdot (S - p_i)\\) v\u00e0o t\u1ed5ng.</li> <li>N\u1ebfu \\(i \\ne j\\), ta s\u1ebd g\u00f3p v\u00e0o t\u1ed5ng l\u00e0 \\(p_i \\cdot p_j \\cdot (S - p_i - p_j) + 2 \\cdot p_i \\cdot p_j\\) (2). Gi\u1ea3i th\u00edch th\u00ec c\u0169ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean nh\u01b0ng \u1edf \u0111\u00e2y \\(k\\) c\u00f3 th\u1ec3 b\u1eb1ng \\(i\\) ho\u1eb7c \\(j\\) n\u00ean ta c\u00f3 \\(2 \\cdot p_i \\cdot p_j\\).</li> </ul> <p>\u0110\u1ebfn \u0111\u00e2y th\u00ec ta s\u1ebd c\u00f3 k\u1ebft qu\u1ea3 l\u00e0:</p> \\[p_i \\cdot p_j \\cdot (S - p_i - p_j) + 2 \\cdot p_i \\cdot p_j + p_i \\cdot (S - p_i) + p_i\\] <p>Ta c\u00f3 th\u1ec3 t\u00ednh t\u1ed5ng n\u00e0y trong \\(O(N^2)\\). Tuy nhi\u00ean nh\u01b0 th\u1ebf v\u1eabn ch\u01b0a \u0111\u1ee7.</p> <p>X\u00e9t ph\u1ea7n (1): \\(p_i \\cdot (S - p_i) + p_i\\). Ph\u1ea7n n\u00e0y kh\u00f4ng ph\u1ee5 thu\u1ed9c \\(j\\) n\u00ean ta c\u00f3 th\u1ec3 t\u00ednh th\u1eb3ng ra t\u1ed5ng sau c\u00f9ng, n\u00f3 s\u1ebd gi\u1ed1ng nh\u01b0 b\u00e0i 2 \u1edf tr\u00ean v\u00e0 t\u1ed5ng \u0111\u00f3 s\u1ebd l\u00e0 \\(S^2 + S - S_2\\).</p> <p>X\u00e9t ph\u1ea7n (2): \\(p_i \\cdot p_j \\cdot (S - p_i - p_j) + 2 \\cdot p_i \\cdot p_j\\). B\u1ecf h\u1ebft ngo\u1eb7c \u0111i th\u00ec ta s\u1ebd \u0111\u01b0\u1ee3c</p> \\[p_i \\cdot p_j \\cdot S - p_i^2 \\cdot p_j - p_i \\cdot p_j^2 + 2 \\cdot p_i \\cdot p_j\\] <p>T\u00ednh t\u1ed5ng h\u1ebft c\u00e1c \\(p_j\\) \u0111\u1ec3 lo\u1ea1i b\u1ecf bi\u1ebfn n\u00e0y th\u00ec ta c\u00f3, l\u01b0u \u00fd th\u00eam l\u00e0 \\(i \\ne j\\) trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y:</p> \\[S \\cdot p_i \\cdot (S - p_i) - p_i^2 \\cdot (S - p_i) - p_i \\cdot (S_2 - p_i^2) + 2 \\cdot p_i \\cdot (S - p_i)\\] <p>M\u1edf ngo\u1eb7c ra th\u00ec ta c\u00f3:</p> \\[S^2 \\cdot p_i - S \\cdot p_i^2 - S \\cdot p_i^2 + p_i^3 - S_2 \\cdot p_i + p_i^3 + 2 \\cdot S \\cdot p_i - 2 \\cdot p_i^2\\] <p>Thu g\u1ecdn l\u1ea1i th\u00ec ta c\u00f3:</p> \\[2 \\cdot p_i^3 - (2S + 2) \\cdot p_i^2 + (S^2 + 2S - S_2) \\cdot p_i\\] <p>T\u00ednh t\u1ed5ng h\u1ebft c\u00e1c \\(p_i\\) \u0111\u1ec3 lo\u1ea1i b\u1ecf bi\u1ebfn n\u00e0y th\u00ec ta \u0111\u01b0\u1ee3c:</p> \\[2S_3 - (2S + 2) \\cdot S_2 + (S^2 + 2S - S_2) \\cdot S\\] <p>Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 t\u1ed5ng c\u1ed9ng s\u1ebd l\u00e0</p> \\[S^2 + S - S_2 + 2S_3 - (2S + 2) \\cdot S_2 + (S^2 + 2S - S_2) \\cdot S\\] <p>V\u00e0 b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh c\u00e1i n\u00e0y trong \\(O(N)\\).</p> <p>Vi\u1ec7c gi\u1ea3i s\u1ebd ph\u1ee9c t\u1ea1p h\u01a1n khi ta c\u1ea7n t\u00ednh m\u0169 4, hay th\u1eadm ch\u00ed \u0111\u1ebfn m\u0169 \\(k\\), nh\u01b0ng v\u1eabn c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c.</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-4_2","title":"B\u00e0i 4","text":"<p>C\u00f3 \\(N\\) (\\(N \\le 50\\)) b\u00f3ng \u0111\u00e8n v\u00e0 \\(M\\) (\\(M \\le 50\\)) c\u00f4ng t\u1eafc. V\u1edbi m\u1ed7i c\u00f4ng t\u1eafc, ta bi\u1ebft c\u00e1c b\u00f3ng \u0111\u00e8n k\u1ebft n\u1ed1i v\u1edbi n\u00f3 (ngh\u0129a l\u00e0 khi g\u1ea1t c\u00f4ng t\u1eafc, c\u00e1c b\u00f3ng \u0111\u00e8n s\u00e1ng th\u00ec t\u1eaft, t\u1eaft th\u00ec s\u00e1ng). T\u1ea5t c\u1ea3 c\u00e1c b\u00f3ng \u0111\u1ec1u \u0111ang t\u1eaft, v\u00e0 ta g\u1ea1t c\u00e1c c\u00f4ng t\u1eafc v\u1edbi x\u00e1c su\u1ea5t 50%. T\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a m\u0169 3 s\u1ed1 c\u00e1c b\u00f3ng \u0111\u00e8n b\u1eadt.</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn c\u1ed1 b\u00f3ng \u0111\u00e8n th\u1ee9 \\(i\\) s\u00e1ng. Nh\u01b0 v\u1eady k\u1ef3 v\u1ecdng s\u1ed1 b\u00f3ng \u0111\u00e8n s\u00e1ng sau c\u00f9ng s\u1ebd l\u00e0 \\(E[X_1 + X_2 + \\ldots + X_N]\\). Tuy nhi\u00ean \u1edf \u0111\u00e2y ta c\u1ea7n t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a m\u0169 3, ngh\u0129a l\u00e0 \\(E[(X_1 + X_2 + \\ldots + X_N)^3]\\).</p> <p>Nh\u01b0 trong b\u00e0i tr\u00ean th\u00ec ta \u0111\u00e3 bi\u1ebft l\u00e0 k\u1ef3 v\u1ecdng \u1edf tr\u00ean s\u1ebd l\u00e0 t\u1ed5ng c\u00e1c \\(E[X_i \\cdot X_j \\cdot X_k]\\), ngh\u0129a l\u00e0 k\u1ef3 v\u1ecdng b\u00f3ng \u0111\u00e8n \\(i\\), \\(j\\) v\u00e0 \\(k\\) \u0111\u1ec1u s\u00e1ng, c\u0169ng l\u00e0 x\u00e1c su\u1ea5t c\u00e1c b\u00f3ng \u0111\u00e8n n\u00e0y \u0111\u1ec1u s\u00e1ng (do l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o). Ta duy\u1ec7t m\u1ed7i b\u1ed9 ba n\u00e0y trong \\(O(N^3)\\).</p> <p>V\u1edbi m\u1ed7i b\u1ed9 ba, ta c\u1ea7n t\u00ednh x\u00e1c su\u1ea5t c\u00e1c b\u00f3ng \u0111\u00e8n trong b\u1ed9 ba n\u00e0y \u0111\u1ec1u s\u00e1ng. Ta g\u1ecdi \\(dp[x][y][z]\\) l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i \\((x, y, z)\\) v\u1edbi \\(0 \\le x, y, z \\le 1\\), \u1ee9ng l\u1ea7n l\u01b0\u1ee3t v\u1edbi b\u00f3ng \u0111\u00e8n th\u1ee9 \\(i\\), \\(j\\) v\u00e0 \\(k\\), trong \u0111\u00f3 \\(0\\) l\u00e0 tr\u1ea1ng th\u00e1i t\u1eaft, \\(1\\) l\u00e0 tr\u1ea1ng th\u00e1i s\u00e1ng. Ban \u0111\u1ea7u ta c\u00f3 \\(dp[0][0][0] = 1\\), do c\u1ea3 ba b\u00f3ng \u0111\u00e8n ban \u0111\u1ea7u \u0111\u1ec1u t\u1eaft. V\u1edbi m\u1ed7i c\u00f4ng t\u1eafc, ta s\u1ebd c\u1eadp nh\u1eadt m\u1ea3ng \\(dp\\) n\u00e0y (l\u01b0u \u00fd l\u00e0 t\u1eeb m\u1ea3ng \\(dp\\) c\u0169 b\u1ea1n ph\u1ea3i t\u00ednh v\u00e0o m\u1ed9t m\u1ea3ng \\(dp\\) m\u1edbi nh\u00e9, v\u00ec tr\u01b0\u1edbc khi x\u1eed l\u00fd c\u00f4ng t\u1eafc v\u00e0 sau khi x\u1eed l\u00fd c\u00f4ng t\u1eafc l\u00e0 hai tr\u1ea1ng th\u00e1i kh\u00e1c nhau). Ta duy\u1ec7t h\u1ebft \\(M\\) c\u00f4ng t\u1eafc v\u00e0 t\u00ednh to\u00e1n trong \\(O(M)\\).</p> <p>Cu\u1ed1i c\u00f9ng \\(E[X_i \\cdot X_j \\cdot X_k] = dp[1][1][1]\\). Ta gi\u1ea3i \u0111\u01b0\u1ee3c b\u00e0i n\u00e0y trong \\(O(N^3 \\cdot M)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-5_2","title":"B\u00e0i 5","text":"<p>Cho d\u00e3y s\u1ed1 \\(a\\) \u0111\u1ed9 d\u00e0i \\(N\\) (\\(N \\le 10^5\\)), t\u00ednh t\u1ed5ng \\(sum \\cdot len^3\\) tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n con. In ra \u0111\u00e1p \u00e1n l\u1ea5y d\u01b0 v\u1edbi \\(10^9 + 7\\).</p> L\u1eddi gi\u1ea3i <p>Ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng k\u1ef9 thu\u1eadt \"g\u00f3p v\u00e0o t\u1ed5ng\" cho b\u00e0i n\u00e0y. Ngh\u0129a l\u00e0, v\u1edbi m\u1ed7i \u0111\u1ed9 d\u00e0i \\(len\\), ta t\u00ednh t\u1ed5ng \\(sum\\) c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111o\u1ea1n con \u0111\u1ed9 d\u00e0i nh\u01b0 th\u1ebf, r\u1ed3i l\u1ea5y t\u00edch \\(sum \\cdot len^3\\), th\u00eam v\u00e0o k\u1ebft qu\u1ea3.</p> <p>\u0110\u1ea7u ti\u00ean \\(len = 1\\), \\(sum_1\\) \u1edf \u0111\u00e2y s\u1ebd l\u00e0 \\(\\sum_{i=1}^N a_i\\).</p> <p>Ti\u1ebfp theo \\(len = 2\\), ta th\u1ea5y m\u1ed7i \u0111o\u1ea1n con tr\u01b0\u1edbc \u0111\u00f3 c\u1ea7n th\u00eam gi\u00e1 tr\u1ecb ph\u00eda b\u00ean ph\u1ea3i c\u1ee7a \u0111o\u1ea1n, tr\u1eeb \u0111o\u1ea1n con cu\u1ed1i c\u00f9ng (\u0111o\u1ea1n ch\u1ee9a \\(a_N\\), v\u00ec kh\u00f4ng th\u1ec3 k\u00e9o d\u00e0i \u0111o\u1ea1n n\u00e0y, ta ph\u1ea3i b\u1ecf n\u00f3 \u0111i), v\u1eady \\(sum_2 = sum_1 + \\sum_{i=2}^N a_i - \\sum_{i=N}^N a_i\\).</p> <p>Ti\u1ebfp theo \\(len = 3\\), ta th\u1ea5y m\u1ed7i \u0111o\u1ea1n con tr\u01b0\u1edbc \u0111\u00f3 c\u1ea7n th\u00eam gi\u00e1 tr\u1ecb ph\u00eda b\u00ean ph\u1ea3i c\u1ee7a \u0111o\u1ea1n, tr\u1eeb \u0111o\u1ea1n con cu\u1ed1i c\u00f9ng (\u0111o\u1ea1n ch\u1ee9a \\(a_{N-1} v\u00e0 a_N\\), v\u00ec kh\u00f4ng th\u1ec3 k\u00e9o d\u00e0i \u0111o\u1ea1n n\u00e0y, ta ph\u1ea3i b\u1ecf n\u00f3 \u0111i), v\u1eady \\(sum_3 = sum_2 + \\sum_{i=3}^N a_i - \\sum_{i=N-1}^N a_i\\).</p> <p>V\u00e0 c\u1ee9 nh\u01b0 th\u1ebf, t\u1ed5ng qu\u00e1t th\u00ec \\(sum_j = sum_{j-1} + \\sum_{i=j}^N a_i - \\sum_{i=N-j+2}^N a_i\\).</p> <p>Ta c\u00f3 th\u1ec3 t\u00ednh c\u00e1c t\u1ed5ng ti\u1ec1n t\u1ed1 v\u00e0 h\u1eadu t\u1ed1 trong \\(O(N)\\).</p> <p>V\u1eady ta c\u00f3 th\u1ec3 t\u00ednh b\u00e0i n\u00e0y trong \\(O(N)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-6_2","title":"B\u00e0i 6","text":"<p>Cho m\u1ed9t c\u00e2y \\(N\\) \u0111\u1ec9nh (\\(N \\le 10^5\\)) v\u00e0 s\u1ed1 nguy\u00ean \\(k\\) (\\(k \\le 10\\)). T\u00ecm t\u1ed5ng c\u1ee7a \\(\\text{k\u00edch th\u01b0\u1edbc}^k\\) c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng. In \u0111\u00e1p \u00e1n l\u1ea5y d\u01b0 v\u1edbi \\(10^9+7\\).</p> L\u1eddi gi\u1ea3i <p>Ta b\u1eaft \u0111\u1ea7u v\u1edbi h\u01b0\u1edbng l\u00e0 v\u1edbi m\u1ed7i k\u00edch th\u01b0\u1edbc \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng, t\u00ecm s\u1ed1 c\u00e1c \u0111\u1ed3 th\u1ecb con c\u00f3 k\u00edch th\u01b0\u1edbc nh\u01b0 v\u1eady. Tuy nhi\u00ean l\u00e0m th\u1ebf r\u1ea5t l\u00e0 kh\u00f3 v\u00e0 ta s\u1ebd kh\u00f4ng \u0111i theo h\u01b0\u1edbng n\u00e0y.</p> <p>C\u00e1i ta c\u1ea7n l\u00e0 \\(size^k\\), v\u00ed d\u1ee5 \\(size = 3\\), \\(k = 5\\) v\u00e0 ta c\u00f3 3 node trong \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng l\u00e0 A, B, C. Th\u00ec v\u1edbi hi\u1ec3u bi\u1ebft \u1edf tr\u00ean v\u1ec1 m\u0169, ta c\u1ea7n th\u00eam s\u1ed1 \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng ch\u1ee9a AAAAA, AAAAB, AAAAC, AAABA, ...., CCCCC. V\u00ec v\u1eady n\u00ean ta c\u00f3 th\u1ec3 \u0111\u1ed5i b\u00e0i to\u00e1n n\u00e0y th\u00e0nh, t\u00ecm s\u1ed1 c\u00e1ch ch\u1ecdn m\u1ed9t \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng v\u00e0 ch\u1ecdn \\(k\\) node trong c\u00e1i \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng n\u00e0y, v\u00ec m\u1ed7i d\u00e3y \\(k\\) ph\u1ea7n t\u1eed s\u1ebd g\u00f3p \\(1\\) v\u00e0o \u0111\u00e1p \u00e1n.</p> <p>Ta s\u1ebd c\u1ea7n duy tr\u00ec m\u1ed9t m\u1ea3ng \\(dp[v][i]\\), trong \u0111\u00f3 \\(v\\) l\u00e0 g\u1ed1c c\u1ee7a c\u00e2y con \u0111ang x\u00e9t, \\(i\\) l\u00e0 s\u1ed1 node \u0111\u01b0\u1ee3c ch\u1ecdn trong c\u00e2y con n\u00e0y (kh\u00f4ng c\u1ea7n ph\u1ea3i l\u00e0 \\(i\\) node kh\u00e1c nhau). M\u1ea3ng n\u00e0y c\u00f3 ngh\u0129a l\u00e0 s\u1ed1 c\u00e1ch ch\u1ecdn ra \\(i\\) node (kh\u00f4ng c\u1ea7n ph\u00e2n bi\u1ec7t) trong m\u1ed9t \u0111\u1ed3 th\u1ecb con li\u00ean th\u00f4ng n\u00e0o \u0111\u00f3 trong c\u00e2y con g\u1ed1c \\(v\\).</p> <p>X\u00e9t node cha \\(u\\) c\u1ee7a \\(v\\), gi\u1ea3 s\u1eed \\(v\\) l\u00e0 node con \u0111\u1ea7u ti\u00ean c\u1ee7a \\(u\\) theo th\u1ee9 t\u1ef1 c\u00e1c node con c\u1ee7a \\(u\\) khi DFS, v\u00e0 ta \u0111\u00e3 c\u00f3 c\u00e1c \\(dp[v][i]\\), vi\u1ec7c ta c\u1ea7n l\u00e0m l\u00e0 th\u00eam node \\(u\\) v\u00e0o \u0111\u00e2y, ho\u1eb7c kh\u00f4ng th\u00eam. N\u1ebfu th\u00eam, ta c\u00f3 th\u1ec3 th\u00eam nhi\u1ec1u node \\(u\\) ch\u1ee9 kh\u00f4ng ph\u1ea3i ch\u1ec9 m\u1ed9t l\u1ea7n, v\u00ec th\u1ebf v\u1edbi m\u1ed7i \\(dp[v][i]\\) ta c\u00f3 th\u1ec3 th\u00eam k\u1ebft qu\u1ea3 cho \\(dp[u][i]\\), dp[u][i+1], dp[u][i+2], \\ldots$. N\u1ebfu th\u00eam \\(j\\) node \\(u\\), ta s\u1ebd c\u00f3 \\(\\binom{i+j}{j}\\) c\u00e1ch th\u00eam, v\u00ec ta c\u00f3 th\u1ec3 th\u00eam v\u00e0o b\u1ea5t k\u1ef3 v\u1ecb tr\u00ed n\u00e0o.</p> <p>N\u1ebfu \\(v\\) kh\u00f4ng ph\u1ea3i l\u00e0 node con \u0111\u1ea7u ti\u00ean, ta c\u1ea7n m\u1ed9t c\u00e1ch \u0111\u1ec3 ch\u1eadp 2 k\u1ebft qu\u1ea3 l\u1ea1i v\u1edbi nhau, \u1edf \u0111\u00e2y l\u00e0 \\(dp[u]\\) hi\u1ec7n t\u1ea1i v\u00e0 \\(dp[v]\\). Ta x\u00e9t \\(i\\) node \u0111\u01b0\u1ee3c ch\u1ecdn trong c\u00e2y g\u1ed1c \\(u\\) hi\u1ec7n t\u1ea1i, v\u00e0 \\(j\\) node \u0111\u01b0\u1ee3c ch\u1ecdn trong c\u00e2y g\u1ed1c \\(v\\), ta s\u1ebd th\u00eam v\u00e0o \\(\\binom{i+j}{j}\\) t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean \u0111\u1ec3 t\u00ednh \\(dp[u]\\) m\u1edbi.</p> <p>K\u1ebft qu\u1ea3 c\u1ee7a b\u00e0i n\u00e0y s\u1ebd l\u00e0 \\(dp[root][k]\\), trong \u0111\u00f3 \\(root\\) l\u00e0 node g\u1ed1c c\u1ee7a c\u00e2y. \u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a b\u00e0i n\u00e0y s\u1ebd t\u1ea7m kho\u1ea3ng \\(O(nk^2)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#bai-7_2","title":"B\u00e0i 7","text":"<p>B\u00e0i n\u00e0y l\u00e0 b\u00e0i DoubleLive c\u1ee7a TopCoder SRM 727.</p> <p>Cho m\u1ed9t \u0111\u1ed9i qu\u00e2n g\u1ed3m \\(B\\) g\u1ea5u v\u00e0 \\(H\\) ng\u01b0\u1eddi (\\(B, H \\le 2000\\)). G\u1ea5u th\u00ec c\u00f3 2 m\u00e1u, ng\u01b0\u1eddi th\u00ec 1 m\u00e1u. \u0110\u1ed9i cung th\u1ee7 c\u1ee7a \u0111\u1ecbch c\u00f3 \\(T\\) m\u0169i t\u00ean (\\(T \\le 2 \\cdot B + H\\)). M\u1ed7i m\u0169i t\u00ean ti\u1ebfp theo s\u1ebd \u0111\u00e2m v\u00e0o m\u1ed9t trong s\u1ed1 qu\u00e2n c\u1ee7a b\u1ea1n m\u1ed9t c\u00e1ch ng\u1eabu nhi\u00ean, gi\u1ea3m 1 m\u00e1u c\u1ee7a \u0111\u1ed1i t\u01b0\u1ee3ng \u0111\u00f3. N\u1ebfu \u0111\u1ed1i t\u01b0\u1ee3ng c\u00f2n 0 m\u00e1u, \u0111\u1ed1i t\u01b0\u1ee3ng \u0111\u00f3 ch\u1ebft.</p> <p>S\u1ee9c m\u1ea1nh \u0111\u1ed9i qu\u00e2n \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 \\(\\text{s\u1ed1 g\u1ea5u} \\cdot \\text{s\u1ed1 ng\u01b0\u1eddi} \\cdot \\text{t\u1ed5ng s\u1ed1}\\), v\u00ed d\u1ee5 \\(3 \\cdot 7 \\cdot 10 = 210\\) v\u1edbi m\u1ed9t \u0111\u1ed9i qu\u00e2n 3 g\u1ea5u 7 ng\u01b0\u1eddi. Kh\u00f4ng quan tr\u1ecdng m\u1ed9t s\u1ed1 g\u1ea5u ch\u1ec9 c\u00f2n 1 m\u00e1u trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y.</p> <p>T\u00ednh k\u1ef3 v\u1ecdng s\u1ee9c m\u1ea1nh \u0111\u1ed9i qu\u00e2n sau khi \u0111\u1ed9i cung th\u1ee7 \u0111\u1ecbch d\u00f9ng h\u1ebft m\u0169i t\u00ean c\u1ee7a ch\u00fang.</p> L\u1eddi gi\u1ea3i <p>Ta s\u1ebd c\u1ea7n t\u00ednh \\(E[B \\cdot H \\cdot (B + H)]\\), trong \u0111\u00f3 \\(B\\) l\u00e0 s\u1ed1 g\u1ea5u sau cu\u1ed9c t\u1ea5n c\u00f4ng v\u00e0 \\(H\\) l\u00e0 s\u1ed1 ng\u01b0\u1eddi sau cu\u1ed9c t\u1ea5n c\u00f4ng. Ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng ta k\u00ec v\u1ecdng c\u1ea7n t\u00ecm l\u00e0 t\u1ed5ng k\u00ec v\u1ecdng khi ta ch\u1ecdn 1 g\u1ea5u, 1 ng\u01b0\u1eddi v\u00e0 m\u1ed9t trong c\u00e1c chi\u1ebfn binh c\u00f2n l\u1ea1i (sau khi k\u1ebft th\u00fac cu\u1ed9c t\u1ea5n c\u00f4ng), \u1edf \u0111\u00e2y n\u00f3 c\u0169ng l\u00e0 x\u00e1c su\u1ea5t ch\u1ecdn ra.</p> <p>Th\u1eed g\u1ecdi \\(dp[one][two]\\) l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c \\(one\\) chi\u1ebfn binh 1 m\u00e1u (kh\u00f4ng quan t\u00e2m n\u00f3 l\u00e0 g\u1ea5u hay ng\u01b0\u1eddi), \\(two\\) l\u00e0 s\u1ed1 chi\u1ebfn binh 2 m\u00e1u. V\u1edbi c\u00e1ch n\u00e0y, ta c\u00f3 th\u1ec3 \u0111i ti\u1ebfp \u0111\u1ebfn \\(dp[one-1][two]\\) v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{one}{one+two}\\), v\u00e0 \u0111\u1ebfn \\(dp[one+1][two-1]\\) v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{two}{one+two}\\). Tuy nhi\u00ean, \u0111\u1ebfn cu\u1ed1i c\u00f9ng ta l\u1ea1i kh\u00f4ng th\u1ec3 ph\u00e2n bi\u1ec7t \u0111\u01b0\u1ee3c s\u1ed1 ng\u01b0\u1eddi v\u00e0 s\u1ed1 g\u1ea5u.</p> <p>X\u00e9t m\u1ed9t c\u1eb7p ng\u01b0\u1eddi - g\u1ea5u n\u00e0o \u0111\u00f3, l\u00e0m sao \u0111\u1ec3 t\u00ednh \u0111\u01b0\u1ee3c x\u00e1c su\u1ea5t ch\u00fang \u0111\u1ec1u c\u00f2n s\u1ed1ng sau cu\u1ed9c t\u1ea5n c\u00f4ng? Ta g\u1ecdi \\(dp[one][two][hp1][hp2]\\) l\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 sau cu\u1ed9c t\u1ea5n c\u00f4ng, ta c\u00f3 \\(one\\) chi\u1ebfn binh 1 m\u00e1u, \\(two\\) chi\u1ebfn binh 2 m\u00e1u, v\u1edbi c\u1eb7p ng\u01b0\u1eddi - g\u1ea5u c\u00f3 s\u1ed1 m\u00e1u l\u1ea7n l\u01b0\u1ee3t l\u00e0 \\(hp1\\) (\\(0 \\le hp1 \\le 1\\)) v\u00e0 \\(hp2\\) (\\(0 \\le hp2 \\le 2\\)). C\u00e1ch t\u00ednh c\u0169ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean. K\u1ebft qu\u1ea3 ta c\u1ea7n l\u00e0 \\(X = dp[one][two][1][1] + dp[one][two][1][2]\\), v\u1edbi \\(one\\) v\u00e0 \\(two\\) l\u00fac n\u00e0y l\u00e0 sau cu\u1ed9c t\u1ea5n c\u00f4ng. Do c\u00e1c con g\u1ea5u l\u00e0 nh\u01b0 nhau v\u00e0 ng\u01b0\u1eddi c\u0169ng nh\u01b0 nhau, vi\u1ec7c t\u00ednh l\u1ea1i cho c\u00e1c c\u1eb7p ng\u01b0\u1eddi - g\u1ea5u kh\u00e1c l\u00e0 kh\u00f4ng c\u1ea7n thi\u1ebft, v\u00ec v\u1eady x\u00e1c su\u1ea5t ch\u1ecdn ra \u0111\u01b0\u1ee3c 1 ng\u01b0\u1eddi 1 g\u1ea5u l\u00e0 \\(X \\cdot B \\cdot H\\) v\u1edbi \\(B\\), \\(H\\) l\u00e0 s\u1ed1 g\u1ea5u v\u00e0 s\u1ed1 ng\u01b0\u1eddi ban \u0111\u1ea7u.</p> <p>Nh\u01b0ng c\u00f2n t\u1ed5ng s\u1ed1 chi\u1ebfn binh th\u00ec sao? Ta bi\u1ebft r\u1eb1ng t\u1ed5ng s\u1ed1 chi\u1ebfn binh s\u1ebd l\u00e0 \\(one + two\\) sau cu\u1ed9c t\u1ea5n c\u00f4ng, nh\u01b0 v\u1eady \u0111\u00e1p \u00e1n s\u1ebd c\u1ea7n nh\u00e2n th\u00eam v\u1edbi \\(one + two\\). Gi\u1ea3i th\u00edch th\u00eam l\u00e0 b\u1edfi v\u00ec b\u1ea1n \u0111\u00e3 \u0111\u1ebfn \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i v\u1edbi \\(one\\) chi\u1ebfn binh 1 m\u00e1u v\u00e0 \\(two\\) chi\u1ebfn binh 2 m\u00e1u, n\u00ean x\u00e1c su\u1ea5t ch\u1ecdn ra \u0111\u01b0\u1ee3c m\u1ed9t trong c\u00e1c chi\u1ebfn binh c\u00f2n l\u1ea1i s\u1ebd l\u00e0 \\(1\\). Ta mu\u1ed1n ch\u1ecdn h\u1ebft ch\u00fang, n\u00ean ta c\u1ea7n \\(one + two\\) l\u1ea7n.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a b\u00e0i n\u00e0y l\u00e0 \\(O((B+H)^2)\\).</p>"},{"location":"Codeforces/math/sums-and-expected-value/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date Codeforces - Little Pony and Expected Maximum Submission Code 18/05/2023 Google Kickstart 2017 Round B - Math Encoder Unavailable public link Code 30/05/2023 Codeforces - Imbalanced Array Submission Code 18/05/2023 Codeforces - Randomizer Submission Code 30/05/2023 Codeforces - Andrey and Problem Submission Code 24/07/2023 Google Kickstart 2020 Round D \u2014 Beauty of Tree Unavailable public link Code 24/07/2023 Codeforces - Score of a Tree Submission Code 25/07/2023 Codeforces - Two Arrays and Sum of Functions Submission Code 26/07/2023 Codedrills - Bob and Random Exploration Unavailable public link Code 28/07/2023 Atcoder ABC 189 F - Sugoroku2 Submission Code 29/07/2023 Codechef - KALADIN Submission Code 31/07/2023 Codeforces - Game on Tree Submission Code 01/08/2023 E-Olymp - Difficult path Unavailable public link Code 01/08/2023 E-Olymp - A coincidence Unavailable public link Code 06/08/2023 E-Olymp - A full set Unavailable public link Code 04/08/2023 Codeforces - A fish lunch  Unavailable public link Code 03/08/2023 Codeforces - The secret code Unavailable public link Code 07/08/2023 Codeforces - Dura Lex Unavailable public link Code 11/08/2023 Codeforces - A path to knowledge Unavailable public link Code 08/08/2023 Codeforces - A granite of science Unavailable public link Code 10/08/2023 Codeforces - Probable diagnosis Unavailable public link Code 11/08/2023 Codeforces - Zoological experiment Unavailable public link Code 14/08/2023 Codeforces - A game (High) Unavailable public link Code 08/08/2023 Codeforces - A dangerous game (High) Unavailable public link Code 21/08/2023 Codeforces - Hash-table (High) Codechef - MARTING1 Submission Code 10/09/2023 Codeforces - Lipshitz Sequence Submission Code 24/08/2023 Topcoder SRM 727 - DoubleLive Unavailable public link Code 20/07/2023 Codechef - CUTTREE Submission Code 01/10/2023 Codeforces - Rikka with Subsequences Unavailable public link Code 19/09/2023 Codechef - FSSYNC Submission Code 07/09/2023 Topcoder TCO Algorithm Round 1C 2013 - TheKnights Unavailable public link Code 12/09/2023 Codeforces - Graph Game Submission Code 15/09/2023"},{"location":"Codeforces/randomized-algorithms/hacking-randomized-solutions/","title":"L\u00e0m sao hack c\u00e1c solution ng\u1eabu nhi\u00ean v\u00e0 c\u00e1ch ng\u0103n ch\u1eb7n n\u00f3","text":""},{"location":"Codeforces/randomized-algorithms/hacking-randomized-solutions/#lam-sao-hack-cac-solution-ngau-nhien-va-cach-ngan-chan-no","title":"L\u00e0m sao hack c\u00e1c solution ng\u1eabu nhi\u00ean v\u00e0 c\u00e1ch ng\u0103n ch\u1eb7n n\u00f3","text":""},{"location":"Codeforces/randomized-algorithms/hacking-randomized-solutions/#nguon","title":"Ngu\u1ed3n","text":"<p> How randomized solutions can be hacked, and how to make your solution unhackable</p>"},{"location":"Codeforces/randomized-algorithms/hacking-randomized-solutions/#tinh-huong","title":"T\u00ecnh hu\u1ed1ng","text":"<p>Trong Round 507 tr\u00ean Codeforces, c\u00f3 m\u1ed9t c\u01a1 s\u1ed1 c\u00e1c solution ng\u1eabu nhi\u00ean g\u1ea7n \u0111\u00fang trong b\u00e0i 1039B - Subway Pursuit b\u1ecb hack. M\u00ecnh mu\u1ed1n gi\u1ea3i th\u00edch nhanh v\u00ec sao n\u00f3 l\u1ea1i c\u00f3 th\u1ec3 b\u1ecb hack v\u00e0 c\u00e1ch \u0111\u1ec3 vi\u1ebft code sao cho n\u00f3 tr\u00e1nh b\u1ecb hack.</p> <p>\u0110\u1ea7u ti\u00ean ta c\u1ea7n xem \u0111\u00e1p \u00e1n c\u1ee7a b\u00e0i nh\u01b0 n\u00e0o nh\u00e9: ta c\u00f3 th\u1ec3 d\u00f9ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u1ec3 thu nh\u1ecf ph\u1ea1m vi c\u00e1c v\u1ecb tr\u00ed c\u00f3 th\u1ec3 cho t\u00e0u xu\u1ed1ng th\u00e0nh m\u1ed9t b\u1ed9i s\u1ed1 c\u1ee7a \\(K\\), v\u00ed d\u1ee5 nh\u01b0 \\(6K\\). Ch\u1ec9 c\u1ea7n \u0111\u1ea3m b\u1ea3o m\u1edf r\u1ed9ng c\u1ea3 hai \u0111\u1ea7u c\u1ee7a ph\u1ea1m vi n\u00e0y th\u00eam \\(K\\) sau m\u1ed7i l\u1ea7n l\u1eb7p. Khi ph\u1ea1m vi t\u1ed1i \u0111a l\u00e0 \\(6K\\), ta c\u00f3 th\u1ec3 l\u1eb7p l\u1ea1i c\u00e1c b\u01b0\u1edbc nh\u01b0 sau:</p> <ol> <li>\u0110o\u00e1n ng\u1eabu nhi\u00ean c\u00e1c s\u1ed1 c\u00f2n l\u1ea1i. X\u00e1c su\u1ea5t th\u00e0nh c\u00f4ng \u00edt nh\u1ea5t l\u00e0 \\(\\frac{1}{6K}\\).</li> <li>T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n cho \u0111\u1ebfn khi ph\u1ea1m vi l\u1ea1i v\u1ec1 t\u1ed1i \u0111a \\(6K\\). Ho\u00e1 ra ch\u1ec9 c\u1ea7n m\u1ed9t truy v\u1ea5n th\u00f4i, v\u00ec sau l\u1ea7n \u0111o\u00e1n tr\u01b0\u1edbc th\u00ec \u0111o\u1ea1n \\(6K\\) c\u1ee7a ta s\u1ebd th\u00e0nh \u0111o\u1ea1n \\(8K\\), v\u00e0 m\u1ed9t truy v\u1ea5n s\u1ebd thu nh\u1ecf \u0111o\u1ea1n n\u00e0y v\u1ec1 \\(\\frac{8K}{2} + 2K = 6K\\).</li> </ol> <p>V\u00ec \\(K \\leq 10\\) v\u00e0 ta c\u00f3 4500 truy v\u1ea5n, solution n\u00e0y s\u1ebd ok v\u00ec x\u00e1c su\u1ea5t th\u1ea5t b\u1ea1i trong b\u1ea5t c\u1ee9 test case n\u00e0o s\u1ebd kh\u00f4ng qu\u00e1 \\((\\frac{59}{60})^{2200} \\approx 8 \\cdot 10^{-17}\\), c\u1ef1c nh\u1ecf.</p> <p>Tuy nhi\u00ean, \u0111i\u1ec1u n\u00e0y \u0111\u01b0a ra gi\u1ea3 \u0111\u1ecbnh quan tr\u1ecdng r\u1eb1ng c\u00e1c v\u1ecb tr\u00ed t\u00e0u \u0111\u1ed9c l\u1eadp v\u1edbi truy v\u1ea5n c\u1ee7a ch\u00fang ta. V\u1ea5n \u0111\u1ec1 ch\u00ednh c\u1ee7a c\u00e1c solution b\u1ecb hack l\u00e0 ch\u00fang \u0111\u1ec1u \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh ho\u00e0n to\u00e0n, ngh\u0129a l\u00e0 ch\u00fang \u0111\u1ec1u truy v\u1ea5n c\u00f9ng m\u1ed9t chu\u1ed7i s\u1ed1 trong m\u1ed7i l\u1ea7n ch\u1ea1y, cho ra c\u00f9ng m\u1ed9t k\u1ebft qu\u1ea3. H\u1ea7u h\u1ebft m\u1ecdi ng\u01b0\u1eddi g\u1eb7p ph\u1ea3i v\u1ea5n \u0111\u1ec1 n\u00e0y do d\u00f9ng <code>rand()</code> m\u00e0 kh\u00f4ng bao gi\u1edd d\u00f9ng <code>srand()</code>. Ngo\u00e0i ra c\u00f2n m\u1ed9t s\u1ed1 nguy\u00ean nh\u00e2n kh\u00e1c: <code>random_device</code> kh\u00e1 k\u00ec l\u1ea1 khi c\u0169ng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh tr\u00ean Codeforces, gi\u1ed1ng <code>mt19937</code> khi kh\u00f4ng c\u00f3 seed. G\u1ecdi <code>srand()</code> v\u1edbi m\u1ed9t gi\u00e1 tr\u1ecb c\u1ed1 \u0111\u1ecbnh c\u0169ng s\u1ebd d\u1eabn \u0111\u1ebfn k\u1ebft qu\u1ea3 gi\u1ed1ng nhau, l\u00e0m cho ch\u01b0\u01a1ng tr\u00ecnh c\u1ee7a b\u1ea1n d\u1ec5 \u0111o\u00e1n v\u00e0 n\u00f3i chung c\u0169ng kh\u00f4ng t\u1ed1t.</p> <p>Do c\u00f3 th\u1ec3 d\u1ef1 \u0111o\u00e1n \u0111\u01b0\u1ee3c n\u00ean c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh n\u00e0y kh\u00e1 d\u1ec5 b\u1ecb hack: ch\u1ec9 c\u1ea7n t\u1ea1o ra c\u00f9ng m\u1ed9t chu\u1ed7i truy v\u1ea5n m\u00e0 ch\u01b0\u01a1ng tr\u00ecnh s\u1ebd th\u1ef1c hi\u1ec7n, v\u00e0 \u0111\u1eb7t t\u00e0u \u1edf m\u1ed9t v\u1ecb tr\u00ed kh\u00e1c \u1edf m\u1ed7i truy v\u1ea5n. \u0110\u1ec3 l\u00e0m cho vi\u1ec7c n\u00e0y d\u1ec5 h\u01a1n khi b\u1ea1n hack ng\u01b0\u1eddi ta, b\u1ea1n ch\u1ec9 c\u1ea7n ch\u1ecdn \\(N = 2\\) v\u00e0 \\(K = 1\\), n\u00f3 s\u1ebd b\u1ecf qua giai \u0111o\u1ea1n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n ban \u0111\u1ea7u, r\u1ed3i \u0111\u1eb7t t\u00e0u v\u00e0o ch\u1ed7 kh\u00f4ng \u0111\u01b0\u1ee3c truy v\u1ea5n gi\u1eefa 1 v\u00e0 2 m\u1ed7i l\u1ea7n truy v\u1ea5n.</p>"},{"location":"Codeforces/randomized-algorithms/hacking-randomized-solutions/#cach-giai-quyet","title":"C\u00e1ch gi\u1ea3i quy\u1ebft?","text":"<p>\u0110\u1ec3 tr\u00e1nh hack th\u00ec nhi\u1ec1u b\u1ea1n seed RNG v\u1edbi th\u1eddi gian hi\u1ec7n t\u1ea1i b\u1eb1ng c\u00e1ch g\u1ecdi <code>srand(time(NULL));</code>. N\u00f3 s\u1ebd gi\u00fap code tr\u00e1nh b\u1ecb x\u00e1c \u0111\u1ecbnh v\u00e0 \u00edt c\u00f3 kh\u1ea3 n\u0103ng b\u1ecb hack h\u01a1n, nh\u01b0ng c\u00e1i n\u00e0y v\u1eabn c\u00f3 kh\u1ea3 n\u0103ng l\u1edbn b\u1ecb hack. V\u1ea5n \u0111\u1ec1 ch\u00ednh \u1edf \u0111\u00e2y l\u00e0 <code>time(NULL)</code> ch\u1ec9 \u0111\u00fang \u0111\u1ebfn \u0111\u01a1n v\u1ecb gi\u00e2y th\u00f4i. N\u1ebfu m\u00ecnh \u0111o\u00e1n \u0111\u01b0\u1ee3c ch\u01b0\u01a1ng tr\u00ecnh c\u1ee7a b\u1ea1n \u0111\u01b0\u1ee3c ch\u1ea1y \u1edf th\u1eddi \u0111i\u1ec3m n\u00e0o, code c\u1ee7a b\u1ea1n v\u1eabn c\u00f3 th\u1ec3 b\u1ecb \u0111o\u00e1n \u0111\u01b0\u1ee3c.</p> <p>C\u0169ng ch\u1ea3 c\u1ea7n \u0111o\u00e1n lu\u00f4n \u1ea5y. N\u1ebfu m\u00ecnh \u0111\u1eb7t \\(N = 11\\) v\u00e0 \\(K = 10\\), m\u00ecnh c\u00f3 th\u1ec3 sinh ra t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y truy v\u1ea5n m\u00e0 b\u1ea1n c\u00f3 th\u1ec3 sinh ra trong 10 gi\u00e2y ti\u1ebfp theo, v\u00ec code c\u1ee7a b\u1ea1n g\u1ea7n nh\u01b0 ch\u1eafc ch\u1eafn s\u1ebd ch\u1ea1y sau tr\u00ecnh t\u1ea1o c\u1ee7a m\u00ecnh v\u00e0i gi\u00e2y. Sau \u0111\u00f3, v\u1edbi m\u1ed7i truy v\u1ea5n, \u00edt nh\u1ea5t m\u1ed9t trong 11 v\u1ecb tr\u00ed s\u1ebd kh\u00f4ng b\u1ecb ch\u1ecdn b\u1edfi b\u1ea5t k\u1ef3 chu\u1ed7i n\u00e0o trong s\u1ed1 10 chu\u1ed7i, v\u00e0 m\u00ecnh c\u00f3 th\u1ec3 di chuy\u1ec3n t\u00e0u \u0111\u1ebfn v\u1ecb tr\u00ed \u0111\u00f3 m\u1ed7i l\u1ea7n. Kh\u00f4ng may (cho m\u00ecnh, may cho b\u1ea1n) l\u00e0 m\u00ecnh ch\u1eb3ng c\u00f3 th\u1eddi gian l\u00e0m v\u1eady trong contest.</p>"},{"location":"Codeforces/randomized-algorithms/hacking-randomized-solutions/#ap-an","title":"\u0110\u00e1p \u00e1n","text":"<p>S\u1eeda th\u00ec c\u0169ng d\u1ec5 th\u00f4i. <code>time(NULL)</code> c\u0169ng c\u00f3 \u00fd t\u1ed1t \u0111\u1ea5y, nh\u01b0ng ta c\u1ea7n m\u1ed9t clock c\u00f3 \u0111\u1ed9 ch\u00ednh x\u00e1c cao h\u01a1n:</p> <p><code>mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());</code></p> <p>Sau \u0111\u00f3 sinh s\u1ed1 ng\u1eabu nhi\u00ean b\u1eb1ng c\u00e1ch d\u00f9ng <code>rng()</code>. Nh\u1edb th\u00eam header <code>&lt;chrono&gt;</code> v\u00e0 <code>&lt;random&gt;</code>. \u1ee6a sao kh\u00f4ng d\u00f9ng <code>rand()</code> v\u00e0 <code>srand()</code>? \u0110\u1ecdc b\u00e0i n\u00e0y nh\u00e9.</p> <p>M\u1ed9t c\u00e1ch kh\u00e1c l\u00e0 d\u00f9ng \u0111\u1ecba ch\u1ec9 c\u1ee7a m\u1ed9t bi\u1ebfn m\u1edbi t\u1ea1o trong heap:</p> <p><code>mt19937 rng((uint64_t) new char);</code></p> <p>N\u00f3 s\u1ebd kh\u00e1c nhau trong m\u1ed7i l\u1ea7n ch\u1ea1y. L\u01b0u \u00fd r\u1eb1ng n\u00f3 s\u1ebd t\u1ea1o ra m\u1ed9t \u00edt memory leak trong v\u00f2ng \u0111\u1eddi c\u1ee7a ch\u01b0\u01a1ng tr\u00ecnh v\u00ec ta kh\u00f4ng bao gi\u1edd g\u1ecdi l\u1ec7nh xo\u00e1, nh\u01b0ng v\u00ec \u0111\u00f3 ch\u1ec9 l\u00e0 m\u1ed9t bi\u1ebfn n\u00ean c\u0169ng kh\u00f4ng sao c\u1ea3.</p> <p>C\u00e1 nh\u00e2n m\u00ecnh th\u00edch k\u1ebft h\u1ee3p c\u1ea3 hai ph\u01b0\u01a1ng ph\u00e1p n\u00e0y nh\u01b0ng c\u0169ng kh\u00f4ng c\u1ea7n thi\u1ebft. M\u1ed9t trong hai c\u00e1ch s\u1ebd khi\u1ebfn ch\u01b0\u01a1ng tr\u00ecnh c\u1ee7a b\u1ea1n tr\u1edf n\u00ean kh\u00f3 \u0111o\u00e1n h\u01a1n nhi\u1ec1u, khi\u1ebfn n\u00f3 kh\u00f4ng th\u1ec3 b\u1ecb hack m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3.</p> <p>N\u1ebfu b\u1ea1n mu\u1ed1n \u0111\u1ecdc th\u00eam, h\u00e3y \u0111\u1ecdc b\u00e0i c\u1ee7a b\u1ea1n dacin21 v\u1ec1 sinh anti-hash test.</p>"},{"location":"LeetCode/basic-calculator/","title":"T\u00ednh to\u00e1n bi\u1ec3u th\u1ee9c t\u1eeb x\u00e2u","text":""},{"location":"LeetCode/basic-calculator/#tinh-toan-bieu-thuc-tu-xau","title":"T\u00ednh to\u00e1n bi\u1ec3u th\u1ee9c t\u1eeb x\u00e2u","text":""},{"location":"LeetCode/basic-calculator/#nguon","title":"Ngu\u1ed3n","text":"<p> LeetCode 224 -  Basic Calculator - Editorial</p> <p>L\u01b0u \u00fd: Editorial n\u00e0y ch\u1ec9 nh\u1eefng ng\u01b0\u1eddi c\u00f3 account LeetCode Premium m\u1edbi \u0111\u1ecdc \u0111\u01b0\u1ee3c.</p>"},{"location":"LeetCode/basic-calculator/#e-bai","title":"\u0110\u1ec1 b\u00e0i","text":"<p>Cho m\u1ed9t x\u00e2u <code>s</code> bi\u1ec3u di\u1ec5n m\u1ed9t bi\u1ec3u th\u1ee9c h\u1ee3p l\u1ec7, c\u00e0i \u0111\u1eb7t m\u1ed9t h\u00e0m t\u00ednh to\u00e1n n\u00f3, v\u00e0 tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 c\u1ee7a bi\u1ec3u th\u1ee9c. L\u01b0u \u00fd l\u00e0 b\u1ea1n kh\u00f4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng c\u00e1c h\u00e0m cho s\u1eb5n c\u1ee7a ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh \u0111\u1ec3 t\u00ednh to\u00e1n bi\u1ec3u th\u1ee9c, v\u00ed d\u1ee5 nh\u01b0 <code>eval()</code>.</p> <p>V\u00ed d\u1ee5 1:</p> <pre><code>Input: s = \"1 + 1\"\nOutput: 2\n</code></pre> <p>V\u00ed d\u1ee5 2:</p> <pre><code>Input: s = \" 2-1 + 2 \"\nOutput: 3\n</code></pre> <p>V\u00ed d\u1ee5 3:</p> <pre><code>Input: s = \"(1+(4+5+2)-3)+(6+8)\"\nOutput: 23\n</code></pre> <p>Gi\u1edbi h\u1ea1n:</p> <ul> <li><code>1 &lt;= s.length &lt;= 3 * 10^5</code></li> <li><code>s</code> bao g\u1ed3m c\u00e1c ch\u1eef s\u1ed1, <code>'+'</code>, <code>'-'</code>, <code>'('</code>, <code>')'</code>, v\u00e0 <code>' '</code>.</li> <li><code>s</code> bi\u1ec3u di\u1ec5n m\u1ed9t bi\u1ec3u th\u1ee9c h\u1ee3p l\u1ec7.</li> <li><code>'+'</code> kh\u00f4ng \u0111\u01b0\u1ee3c d\u00f9ng nh\u01b0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n (v\u00ed d\u1ee5, <code>\"+1\"</code> v\u00e0 <code>\"+(2 + 3)\"</code> \u0111\u1ec1u kh\u00f4ng h\u1ee3p l\u1ec7).</li> <li><code>'-'</code> c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng nh\u01b0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n (v\u00ed d\u1ee5, <code>\"-1\"</code> v\u00e0 <code>\"-(2 + 3)\"</code> \u0111\u1ec1u h\u1ee3p l\u1ec7).</li> <li>S\u1ebd kh\u00f4ng c\u00f3 hai to\u00e1n t\u1eed li\u1ec1n nhau trong input.</li> <li>T\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 v\u00e0 m\u1ecdi t\u00ednh to\u00e1n \u0111\u1ec1u n\u1eb1m trong ki\u1ec3u s\u1ed1 nguy\u00ean c\u00f3 d\u1ea5u 32-bit.</li> </ul>"},{"location":"LeetCode/basic-calculator/#tong-quat","title":"T\u1ed5ng qu\u00e1t","text":"<p>\u0110\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c b\u00e0i n\u00e0y c\u1ea7n hi\u1ec3u nh\u1eefng \u0111i\u1ec1u sau:</p> <ul> <li>Input lu\u00f4n l\u00e0 x\u00e2u h\u1ee3p l\u1ec7.</li> <li>Lu\u1eadt c\u1ee7a ph\u00e9p c\u1ed9ng v\u00e0 tr\u1eeb.</li> <li>Th\u1ee9 t\u1ef1 \u01b0u ti\u00ean v\u1edbi d\u1ea5u ngo\u1eb7c \u0111\u01a1n.</li> <li>C\u00e1c d\u1ea5u c\u00e1ch (space) kh\u00f4ng l\u00e0m \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn vi\u1ec7c t\u00ednh to\u00e1n bi\u1ec3u th\u1ee9c.</li> </ul> <p></p>"},{"location":"LeetCode/basic-calculator/#cach-giai-1-stack-va-ao-xau","title":"C\u00e1ch gi\u1ea3i 1: Stack v\u00e0 \u0110\u1ea3o x\u00e2u","text":""},{"location":"LeetCode/basic-calculator/#y-tuong","title":"\u00dd t\u01b0\u1edfng","text":"<p>B\u00e0i n\u00e0y r\u1ea5t h\u1ee3p cho vi\u1ec7c d\u00f9ng stack. V\u00ec bi\u1ec3u th\u1ee9c c\u00f3 th\u1ec3 c\u00f3 ngo\u1eb7c, ta c\u00f3 th\u1ec3 d\u00f9ng m\u1ed9t stack \u0111\u1ec3 t\u00ecm gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed7i bi\u1ec3u th\u1ee9c con trong ngo\u1eb7c. Quan tr\u1ecdng l\u00e0, ta ph\u1ea3i tr\u00ec ho\u00e3n vi\u1ec7c x\u1eed l\u00fd bi\u1ec3u th\u1ee9c ch\u00ednh cho \u0111\u1ebfn khi ho\u00e0n th\u00e0nh vi\u1ec7c t\u00ednh c\u00e1c bi\u1ec3u th\u1ee9c con trong ngo\u1eb7c \u0111\u01a1n, v\u00e0 \u0111\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y, ta d\u00f9ng stack.</p> <p>Ta \u0111\u1ea9y t\u1eebng ph\u1ea7n t\u1eed c\u1ee7a bi\u1ec3u th\u1ee9c v\u00e0o stack cho \u0111\u1ebfn khi nh\u1eadn \u0111\u01b0\u1ee3c d\u1ea5u ngo\u1eb7c \u0111\u00f3ng <code>)</code>. Sau \u0111\u00f3 ta l\u1ea5y t\u1eebng ph\u1ea7n t\u1eed ra kh\u1ecfi stack v\u00e0 t\u00ednh bi\u1ec3u th\u1ee9c lu\u00f4n. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n cho \u0111\u1ebfn khi ta th\u1ea5y d\u1ea5u m\u1edf ngo\u1eb7c <code>(</code> t\u01b0\u01a1ng \u1ee9ng. C\u00e1ch t\u00ednh n\u00e0y r\u1ea5t ph\u1ed5 bi\u1ebfn khi d\u00f9ng stack. Tuy nhi\u00ean, n\u1ebfu b\u1ea1n \u0111\u1ec3 \u00fd \u0111\u1ebfn c\u00e1ch ta s\u1ebd t\u00ednh ra \u0111\u00e1p \u00e1n, b\u1ea1n s\u1ebd nh\u1eadn ra r\u1eb1ng ta s\u1ebd x\u1eed l\u00fd c\u00e1c gi\u00e1 tr\u1ecb t\u1eeb ph\u1ea3i sang tr\u00e1i trong khi l\u1ebd ra ph\u1ea3i l\u00e0 ng\u01b0\u1ee3c l\u1ea1i.</p> <p></p> <p>V\u1edbi v\u00ed d\u1ee5 tr\u00ean, ta nh\u1eadn ra r\u1eb1ng d\u00f9ng push v\u00e0 pop \u0111\u01a1n gi\u1ea3n s\u1ebd kh\u00f4ng th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c. Ta c\u1ea7n hi\u1ec3u <code>+</code> v\u00e0 <code>-</code> ho\u1ea1t \u0111\u1ed9ng nh\u01b0 th\u1ebf n\u00e0o. <code>+</code> c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p. V\u1edbi bi\u1ec3u th\u1ee9c \\(A + B + C\\), ta c\u00f3 \\((A + B) + C = A + (B + C)\\). Tuy nhi\u00ean, <code>-</code> kh\u00f4ng c\u00f3 t\u00ednh ch\u1ea5t n\u00e0y, \u0111\u00e2y l\u00e0 nguy\u00ean nh\u00e2n v\u00ec sao kh\u00f4ng th\u1ec3 l\u00e0m nh\u01b0 v\u1eady.</p> <p>N\u1ebfu ta d\u00f9ng stack v\u00e0 \u0111\u1ecdc c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a bi\u1ec3u th\u1ee9c t\u1eeb tr\u00e1i sang ph\u1ea3i, ta s\u1ebd ph\u1ea3i \u0111i t\u00ednh to\u00e1n bi\u1ec3u th\u1ee9c t\u1eeb ph\u1ea3i sang tr\u00e1i. Ngh\u0129a l\u00e0 ta \u0111ang hi\u1ec3u l\u00e0 \\((A - B) - C\\) l\u1ea1i b\u1eb1ng \\((C - B) - A\\), \u0111i\u1ec1u n\u00e0y kh\u00f4ng \u0111\u00fang. Ph\u00e9p tr\u1eeb kh\u00f4ng c\u00f3 t\u00ednh k\u1ebft h\u1ee3p hay giao ho\u00e1n g\u00ec c\u1ea3.</p> <p>B\u00e0i n\u00e0y c\u00f3 th\u1ec3 gi\u1ea3i r\u1ea5t d\u1ec5 d\u00e0ng b\u1eb1ng c\u00e1ch \u0111\u1ea3o x\u00e2y v\u00e0 d\u00f9ng stack. \u0110\u1ea3o x\u00e2u hi\u1ec7u qu\u1ea3 v\u00ec gi\u1edd ta cho c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a bi\u1ec3u th\u1ee9c v\u00e0o stack t\u1eeb ph\u1ea3i sang tr\u00e1i v\u00e0 vi\u1ec7c t\u00ednh to\u00e1n s\u1ebd \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u0111\u00fang t\u1eeb tr\u00e1i sang ph\u1ea3i.</p> <p></p>"},{"location":"LeetCode/basic-calculator/#thuat-toan","title":"Thu\u1eadt to\u00e1n","text":"<ol> <li>Duy\u1ec7t t\u1eebng k\u00fd t\u1ef1 trong bi\u1ec3u th\u1ee9c. Ch\u00fa \u00fd c\u1ea9n th\u1eadn khi ta \u0111\u1ecdc c\u00e1c ch\u1eef s\u1ed1 v\u00e0 c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng ph\u1ea3i ch\u1eef s\u1ed1.</li> <li>C\u00e1c to\u00e1n h\u1ea1ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh t\u1eeb nhi\u1ec1u k\u00fd t\u1ef1. M\u1ed9t x\u00e2u <code>123</code> ngh\u0129a l\u00e0 s\u1ed1 \\(123\\), \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh nh\u01b0 sau: <code>123</code> &gt;&gt; <code>120 + 3</code> &gt;&gt; <code>100 + 20 + 3</code>. V\u00ec v\u1eady, n\u1ebfu k\u00fd t\u1ef1 \u0111ang \u0111\u1ecdc l\u00e0 ch\u1eef s\u1ed1, ta c\u1ea7n t\u1ea1o to\u00e1n h\u1ea1ng b\u1eb1ng c\u00e1ch nh\u00e2n n\u00f3 v\u1edbi m\u1ed9t s\u1ed1 m\u0169 c\u1ee7a <code>10</code> v\u1edbi ch\u1eef s\u1ed1 hi\u1ec7n t\u1ea1i v\u00e0 th\u00eam n\u00f3 v\u00e0o to\u00e1n h\u1ea1ng \u0111ang t\u1ea1o. Ta l\u00e0m \u0111i\u1ec1u n\u00e0y v\u00ec ta \u0111ang x\u1eed l\u00fd x\u00e2u theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i. Khi ta \u0111\u1ecdc m\u1ed9t k\u00fd t\u1ef1 m\u00e0 n\u00f3 kh\u00f4ng ph\u1ea3i ch\u1eef s\u1ed1, ta cho to\u00e1n h\u1ea1ng v\u00e0o stack.</li> <li> <p>Khi ta g\u1eb7p m\u1ed9t d\u1ea5u m\u1edf ngo\u1eb7c, n\u00f3 c\u00f3 ngh\u0129a l\u00e0 m\u1ed9t bi\u1ec3u th\u1ee9c \u0111\u00e3 k\u1ebft th\u00fac. Nh\u1edb l\u1ea1i r\u1eb1ng ta c\u00f3 m\u1ed9t bi\u1ec3u th\u1ee9c b\u1ecb \u0111\u1ea3o. V\u00ec v\u1eady d\u1ea5u m\u1edf ngo\u1eb7c s\u1ebd l\u00e0 h\u1ebft m\u1ed9t bi\u1ec3u th\u1ee9c. \u0110\u1ebfn \u0111\u00e2y ta c\u00f3 th\u1ec3 t\u00ednh bi\u1ec3u th\u1ee9c n\u00e0y b\u1eb1ng c\u00e1ch l\u1ea5y ra c\u00e1c to\u00e1n h\u1ea1ng v\u00e0 to\u00e1n t\u1eed t\u1eeb stack cho \u0111\u1ebfn khi \u0111\u1ebfn ngo\u1eb7c \u0111\u00f3ng. K\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng c\u1ee7a bi\u1ec3u th\u1ee9c \u0111\u00f3 s\u1ebd \u0111\u01b0\u1ee3c cho l\u1ea1i v\u00e0o stack. </p> <p>L\u01b0u \u00fd: ta \u0111ang t\u00ednh to\u00e1n t\u1ea5t c\u1ea3 c\u00e1c bi\u1ec3u th\u1ee9c con trong bi\u1ec3u th\u1ee9c ch\u00ednh. C\u00e1c bi\u1ec3u th\u1ee9c con b\u00ean ph\u1ea3i \u0111\u01b0\u1ee3c t\u00ednh tr\u01b0\u1edbc nh\u01b0ng bi\u1ec3u th\u1ee9c ch\u00ednh \u0111\u01b0\u1ee3c t\u00ednh t\u1eeb tr\u00e1i sang ph\u1ea3i khi t\u1ea5t c\u1ea3 c\u00e1c bi\u1ec3u th\u1ee9c con \u0111\u01b0\u1ee3c t\u00ednh, \u0111i\u1ec1u n\u00e0y r\u1ea5t quan trong \u0111\u1ec3 t\u00ednh \u0111\u00fang. </p> <p>V\u00ed d\u1ee5, cho bi\u1ec3u th\u1ee9c \\(A - (B + C) + (D + E - F)\\), \\(D + E - F\\) \u0111\u01b0\u1ee3c t\u00ednh tr\u01b0\u1edbc \\(B + C\\). Khi t\u00ednh \\(D + E - F\\), th\u1ee9 t\u1ef1 l\u00e0 t\u1eeb tr\u00e1i sang ph\u1ea3i. T\u01b0\u01a1ng t\u1ef1 v\u1edbi bi\u1ec3u th\u1ee9c cha, c\u00e1c bi\u1ec3u th\u1ee9c con \u0111\u01b0\u1ee3c t\u00ednh v\u00e0 l\u01b0u trong stack \u0111\u1ec3 ph\u00e9p t\u00ednh cu\u1ed1i l\u00e0 t\u1eeb tr\u00e1i sang ph\u1ea3i.</p> </li> <li> <p>L\u00e0m \u0111\u1ebfn khi c\u00f3 k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng. S\u1ebd c\u00f3 tr\u01b0\u1eddng h\u1ee3p ta kh\u00f4ng c\u00f2n k\u00fd t\u1ef1 n\u00e0o \u0111\u1ec3 x\u1eed l\u00fd nh\u01b0ng stack v\u1eabn kh\u00f4ng r\u1ed7ng. Tr\u01b0\u1eddng h\u1ee3p n\u00e0y x\u1ea3y ra khi bi\u1ec3u th\u1ee9c ch\u00ednh kh\u00f4ng n\u1eb1m trong ngo\u1eb7c. V\u00ec v\u1eady, khi ta t\u00ednh xong to\u00e0n b\u1ed9 bi\u1ec3u th\u1ee9c, ta s\u1ebd xem stack c\u00f3 r\u1ed7ng kh\u00f4ng. N\u1ebfu v\u1eabn c\u00f2n g\u00ec \u0111\u00f3 trong stack, ta t\u00ednh l\u1ea7n cu\u1ed1i bi\u1ec3u th\u1ee9c trong stack. Ta c\u0169ng c\u00f3 th\u1ec3 cho bi\u1ec3u th\u1ee9c ban \u0111\u1ea7u v\u00e0o c\u1eb7p ngo\u1eb7c \u0111\u1ec3 kh\u1ecfi t\u00ednh \u0111\u1ebfn tr\u01b0\u1eddng h\u1ee3p n\u00e0y.</p> </li> </ol> <pre><code>class Solution {\npublic:\n    // ta mu\u1ed1n l\u01b0u c\u1ea3 s\u1ed1 v\u00e0 k\u00fd t\u1ef1 nh\u01b0ng C++ kh\u00f4ng h\u1ed7 tr\u1ee3 nhi\u1ec1u n\u00ean ta t\u1ef1 t\u1ea1o m\u1ed9t struct\n    struct Obj {\n        int num = 0;\n        char ch = ' ';\n    };\n\n    int evaluate(vector&lt;Obj&gt; &amp;st) {\n        // N\u1ebfu stack r\u1ed7ng ho\u1eb7c b\u1eaft \u0111\u1ea7u v\u1edbi k\u00fd t\u1ef1 kh\u00f4ng ph\u1ea3i s\u1ed1, th\u00eam 0 v\u00e0o stack\n        // v\u00ed d\u1ee5 [1, '-', 2, '-'] tr\u1edf th\u00e0nh [1, '-', 2, '-', 0]\n        if (st.empty() || st.back().ch != ' ') {\n            st.push_back({0, ' '});\n        }\n\n        int res = st.back().num;\n        st.pop_back();\n\n        // t\u00ednh bi\u1ec3u th\u1ee9c cho \u0111\u1ebfn khi g\u1eb7p ')'\n        while (!st.empty() &amp;&amp; st.back().ch != ')') {\n            int x = st.back().ch; st.pop_back();\n            if (x == '+') {\n                res += st.back().num; st.pop_back();\n            } else {\n                res -= st.back().num; st.pop_back();\n            }\n        }\n\n        return res;\n    }\n\n    int calculate(string s) {\n        int n = s.size();\n        long long pow10 = 1;\n        int operand = 0;\n        // stack ta s\u1ebd d\u00f9ng vector \u0111\u1ec3 debug cho ti\u1ec7n\n        vector&lt;Obj&gt; st;\n\n        for (int i = n-1; i &gt;= 0; i--) {\n            if (s[i] &gt;= '0' &amp;&amp; s[i] &lt;= '9') {\n                // t\u1ea1o to\u00e1n h\u1ea1ng theo chi\u1ec1u ng\u01b0\u1ee3c l\u1ea1i\n                operand += pow10 * (s[i] - '0');\n                pow10 *= 10;\n            } else if (s[i] != ' ') {\n                if (pow10 != 1) {\n                    // l\u01b0u to\u00e1n h\u1ea1ng v\u00e0o stack khi g\u1eb7p k\u00fd t\u1ef1 kh\u00f4ng ph\u1ea3i s\u1ed1\n                    st.push_back({operand, ' '});\n                    operand = 0;\n                    pow10 = 1;\n                }\n                if (s[i] == '(') {\n                    int res = evaluate(st);\n                    st.pop_back();\n\n                    // l\u01b0u k\u1ebft qu\u1ea3 bi\u1ec3u th\u1ee9c hi\u1ec7n t\u1ea1i v\u00e0o stack\n                    st.push_back({res, ' '});\n                } else {\n                    // v\u1edbi c\u00e1c k\u00fd t\u1ef1 kh\u00e1c th\u00ec c\u1ee9 cho v\u00e0o stack\n                    st.push_back({0, s[i]});\n                }\n            }\n        }\n\n        // cho to\u00e1n h\u1ea1ng cu\u1ed1i c\u00f9ng (n\u1ebfu c\u00f3) v\u00e0o stack\n        if (pow10 != 1) {\n            st.push_back({operand, ' '});\n        }\n\n        // t\u00ednh nh\u1eefng th\u1ee9 c\u00f2n l\u1ea1i trong stack\n        return evaluate(st);\n    }\n};\n</code></pre>"},{"location":"LeetCode/basic-calculator/#o-phuc-tap","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p","text":"<ul> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> </ul>"},{"location":"LeetCode/basic-calculator/#cach-giai-2-stack-va-khong-ao-xau","title":"C\u00e1ch gi\u1ea3i 2: Stack v\u00e0 Kh\u00f4ng \u0111\u1ea3o x\u00e2u","text":""},{"location":"LeetCode/basic-calculator/#y-tuong_1","title":"\u00dd t\u01b0\u1edfng","text":"<p>M\u1ed9t c\u00e1ch r\u1ea5t \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 gi\u1ea3i b\u00e0i n\u00e0y v\u1edbi t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p cho <code>-</code>, l\u00e0 d\u00f9ng to\u00e1n t\u1eed <code>-</code> l\u00e0m \u0111\u1ed9 l\u1edbn cho to\u00e1n h\u1ea1ng b\u00ean ph\u1ea3i to\u00e1n t\u1eed. Khi ta b\u1eaft \u0111\u1ea7u d\u00f9ng <code>-</code> l\u00e0m \u0111\u1ed9 l\u1edbn cho to\u00e1n h\u1ea1ng, ta ch\u1ec9 c\u00f2n l\u1ea1i m\u1ed9t to\u00e1n t\u1eed <code>+</code> v\u00e0 n\u00f3 c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p.</p> <p>V\u00ed d\u1ee5, \\(A - B - C\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u00e0 \\(A + (-B) + (-C)\\).</p> <p>Vi\u1ebft l\u1ea1i bi\u1ec3u th\u1ee9c nh\u01b0 th\u1ebf s\u1ebd c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p. V\u00ec v\u1eady vi\u1ec7c t\u00ednh bi\u1ec3u th\u1ee9c t\u1eeb ph\u1ea3i sang tr\u00e1i s\u1ebd kh\u00f4ng thay \u0111\u1ed5i k\u1ebft qu\u1ea3.</p> <p>C\u1ea7n l\u01b0u \u00fd l\u00e0 l\u00e0m th\u1ebf s\u1ebd l\u00e0m cho bi\u1ec3u th\u1ee9c ph\u1ee9c t\u1ea1p h\u01a1n, ngh\u0129a l\u00e0 c\u00f3 nhi\u1ec1u bi\u1ec3u th\u1ee9c con h\u01a1n. Ngay c\u1ea3 khi ta c\u00f3 v\u00ed d\u1ee5 nh\u01b0 \\((A - (B - C))\\), ta c\u1ea7n k\u1ebft h\u1ee3p d\u1ea5u tr\u1eeb ngo\u00e0i \\(B - C\\) v\u1edbi k\u1ebft qu\u1ea3 c\u1ee7a \\(B - C\\) thay v\u00ec ch\u1ec9 v\u1edbi \\(B\\).</p> <p>Ta c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y b\u1eb1ng c\u00e1ch l\u00e0m c\u01a1 b\u1ea3n, v\u00e0 k\u1ebft h\u1ee3p d\u1ea5u v\u1edbi bi\u1ec3u th\u1ee9c b\u00ean ph\u1ea3i n\u00f3. Tuy nhi\u00ean, c\u00e1ch n\u00e0y s\u1ebd gi\u00fap ta t\u00ednh h\u1ea7u h\u1ebft c\u00e1c bi\u1ec3u th\u1ee9c ngay l\u1eadp t\u1ee9c. \u0110i\u1ec1u n\u00e0y gi\u00fap gi\u1ea3m s\u1ed1 l\u1ea7n push v\u00e0 pop.</p> <p></p>"},{"location":"LeetCode/basic-calculator/#thuat-toan_1","title":"Thu\u1eadt to\u00e1n","text":"<ol> <li>Duy\u1ec7t t\u1eebng k\u00fd t\u1ef1 trong bi\u1ec3u th\u1ee9c. Ch\u00fa \u00fd c\u1ea9n th\u1eadn khi ta \u0111\u1ecdc c\u00e1c ch\u1eef s\u1ed1 v\u00e0 c\u00e1c k\u00fd t\u1ef1 kh\u00f4ng ph\u1ea3i ch\u1eef s\u1ed1.</li> <li>C\u00e1c to\u00e1n h\u1ea1ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh t\u1eeb nhi\u1ec1u k\u00fd t\u1ef1. M\u1ed9t x\u00e2u <code>123</code> ngh\u0129a l\u00e0 s\u1ed1 \\(123\\), \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh nh\u01b0 sau: <code>123</code> &gt;&gt; <code>120 + 3</code> &gt;&gt; <code>100 + 20 + 3</code>. V\u00ec v\u1eady, n\u1ebfu k\u00fd t\u1ef1 \u0111ang \u0111\u1ecdc l\u00e0 ch\u1eef s\u1ed1, ta c\u1ea7n t\u1ea1o to\u00e1n h\u1ea1ng b\u1eb1ng c\u00e1ch nh\u00e2n to\u00e1n h\u1ea1ng v\u1edbi <code>10</code> th\u00eam ch\u1eef s\u1ed1 v\u00e0o to\u00e1n h\u1ea1ng \u0111ang t\u1ea1o. Ta l\u00e0m \u0111i\u1ec1u n\u00e0y v\u00ec ta \u0111ang x\u1eed l\u00fd x\u00e2u theo h\u01b0\u1edbng ng\u01b0\u1ee3c l\u1ea1i. Khi ta \u0111\u1ecdc m\u1ed9t k\u00fd t\u1ef1 m\u00e0 n\u00f3 kh\u00f4ng ph\u1ea3i ch\u1eef s\u1ed1, ta cho to\u00e1n h\u1ea1ng v\u00e0o stack.</li> <li> <p>Khi ta g\u1eb7p to\u00e1n t\u1eed <code>+</code> hay <code>-</code>, ta t\u00ednh bi\u1ec3u th\u1ee9c b\u00ean tr\u00e1i v\u00e0 l\u01b0u d\u1ea5u cho l\u1ea7n t\u00ednh ti\u1ebfp theo.</p> <p></p> </li> <li> <p>N\u1ebfu k\u00fd t\u1ef1 l\u00e0 d\u1ea5u m\u1edf ngo\u1eb7c, ta cho k\u1ebft qu\u1ea3 \u0111\u00e3 t\u00ednh v\u00e0 d\u1ea5u v\u00e0o stack (d\u1ea5u v\u00e0 \u0111\u1ed9 l\u1edbn), v\u00e0 t\u00ednh bi\u1ec3u th\u1ee9c m\u1edbi.</p> </li> <li>N\u1ebfu k\u00fd t\u1ef1 l\u00e0 d\u1ea5u \u0111\u00f3ng ngo\u1eb7c, ta t\u00ednh bi\u1ec3u th\u1ee9c b\u00ean tr\u00e1i. K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 k\u1ebft qu\u1ea3 c\u1ee7a bi\u1ec3u th\u1ee9c trong c\u1eb7p ngo\u1eb7c v\u1eeba k\u1ebft th\u00fac. K\u1ebft qu\u1ea3 sau \u0111\u00f3 s\u1ebd \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi d\u1ea5u, n\u1ebfu c\u00f3 tr\u00ean \u0111\u1ec9nh c\u1ee7a stack. Nh\u1edb r\u1eb1ng ta l\u01b0u d\u1ea5u tr\u00ean \u0111\u1ec9nh stack khi m\u1edf ngo\u1eb7c kh\u00f4ng? D\u1ea5u n\u00e0y s\u1ebd k\u1ebft h\u1ee3p v\u1edbi d\u1ea5u m\u1edf ngo\u1eb7c sau n\u00f3, v\u00ec v\u1eady n\u00ean khi bi\u1ec3u th\u1ee9c k\u1ebft th\u00fac, ta l\u1ea5y d\u1ea5u v\u00e0 nh\u00e2n n\u00f3 v\u1edbi k\u1ebft qu\u1ea3 c\u1ee7a bi\u1ec3u th\u1ee9c. Sau \u0111\u00f3 n\u00f3 \u0111\u01b0\u1ee3c c\u1ed9ng v\u00e0o ph\u1ea7n t\u1eed ti\u1ebfp theo tr\u00ean \u0111\u1ec9nh stack.</li> </ol> <pre><code>class Solution {\npublic:\n    int calculate(string s) {\n        vector&lt;int&gt; st;\n        int operand = 0;\n        int res = 0; // k\u1ebft qu\u1ea3 hi\u1ec7n t\u1ea1i\n        int sign = 1; // 1 l\u00e0 d\u01b0\u01a1ng, -1 l\u00e0 \u00e2m\n        int n = s.size();\n\n        for (int i = 0; i &lt; n; i++) {\n            if (s[i] &gt;= '0' &amp;&amp; s[i] &lt;= '9') {\n                // t\u1ea1o to\u00e1n h\u1ea1ng\n                operand = operand * 10 + (s[i] - '0');\n            } else if (s[i] == '+') {\n                // t\u00ednh bi\u1ec3u th\u1ee9c b\u00ean tr\u00e1i\n                res += sign * operand;\n                // g\u1eb7p d\u1ea5u + n\u00ean l\u01b0u n\u00f3\n                sign = 1;\n                // reset to\u00e1n h\u1ea1ng\n                operand = 0;\n            } else if (s[i] == '-') {\n                // t\u00ednh bi\u1ec3u th\u1ee9c b\u00ean tr\u00e1i\n                res += sign * operand;\n                // g\u1eb7p d\u1ea5u - n\u00ean l\u01b0u n\u00f3\n                sign = -1;\n                // reset to\u00e1n h\u1ea1ng\n                operand = 0;\n            } else if (s[i] == '(') {\n                // cho k\u1ebft qu\u1ea3 b\u00e2y gi\u1edd v\u00e0 d\u1ea5u v\u00e0o stack \u0111\u1ec3 t\u00ednh sau\n                st.push_back(res);\n                st.push_back(sign);\n\n                // reset to\u00e1n h\u1ea1ng v\u00e0 k\u1ebft qu\u1ea3, v\u00ec ta \u0111\u00e3 \u0111\u1ebfn bi\u1ec3u th\u1ee9c con m\u1edbi\n                sign = 1;\n                res = 0;\n            } else if (s[i] == ')') {\n                // t\u00ednh bi\u1ec3u th\u1ee9c b\u00ean tr\u00e1i\n                res += sign * operand;\n\n                // ')' \u0111\u00e1nh d\u1ea5u k\u1ebft th\u00fac bi\u1ec3u th\u1ee9c, k\u1ebft qu\u1ea3 c\u1ee7a n\u00f3 s\u1ebd nh\u00e2n v\u1edbi d\u1ea5u \u1edf \u0111\u00ednh stack\n                res *= st.back(); st.pop_back();\n                // sau \u0111\u00f3 th\u00eam v\u00e0o to\u00e1n h\u1ea1ng ti\u1ebfp theo tr\u00ean d\u1ec9nh stack.\n                // ngh\u0129a l\u00e0 (to\u00e1n h\u1ea1ng trong stack) + (d\u1ea5u tr\u00ean stack * (k\u1ebft qu\u1ea3 trong ngo\u1eb7c))\n                res += st.back(); st.pop_back();\n\n                // reset to\u00e1n h\u1ea1ng\n                operand = 0;\n            }\n        }\n\n        return res + sign * operand;\n    }\n};\n</code></pre>"},{"location":"LeetCode/basic-calculator/#o-phuc-tap_1","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p","text":"<ul> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input. S\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa c\u00e1ch n\u00e0y v\u00e0 c\u00e1ch \u0111\u1ea7u ti\u00ean l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c k\u00fd t\u1ef1 trong c\u00e1ch n\u00e0y \u0111\u01b0\u1ee3c x\u1eed l\u00fd \u0111\u00fang m\u1ed9t l\u1ea7n. Tuy nhi\u00ean, trong c\u00e1ch gi\u1ea3i tr\u01b0\u1edbc, m\u1ed7i k\u00fd t\u1ef1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\u00fd hai l\u1ea7n, m\u1ed9t khi cho v\u00e0o stack, v\u00e0 m\u1ed9t khi l\u1ea5y ra \u0111\u1ec3 t\u00ednh bi\u1ec3u th\u1ee9c. \u0110\u00f3 l\u00e0 l\u00fd do v\u00ec sao c\u00e1ch n\u00e0y nhanh h\u01a1n.</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> </ul>"},{"location":"LeetCode/basic-calculator/#mo-rong-1-co-phep-nhan-chia-nhung-khong-co-dau-ngoac","title":"M\u1edf r\u1ed9ng 1: C\u00f3 ph\u00e9p nh\u00e2n chia nh\u01b0ng kh\u00f4ng c\u00f3 d\u1ea5u ngo\u1eb7c","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i LeetCode 227 - Basic Calculator II. S\u01a1 qua v\u1ec1 \u0111\u1ec1 b\u00e0i th\u00ec n\u00f3 t\u01b0\u01a1ng t\u1ef1 b\u00e0i g\u1ed1c, ch\u1ec9 c\u00f3 \u0111i\u1ec1u l\u00e0 kh\u00f4ng c\u00f3 d\u1ea5u ngo\u1eb7c v\u00e0 c\u00f3 th\u00eam hai ph\u00e9p nh\u00e2n v\u00e0 chia.</p> <p>B\u00e0i n\u00e0y kh\u00f4ng c\u00f3 ngo\u1eb7c n\u00ean s\u1ebd d\u1ec5 h\u01a1n m\u1ed9t ch\u00fat. Ta s\u1ebd \u0111i v\u00e0o c\u00e1c c\u00e1ch gi\u1ea3i ngay sau \u0111\u00e2y.</p>"},{"location":"LeetCode/basic-calculator/#cach-giai-1-dung-stack","title":"C\u00e1ch gi\u1ea3i 1: D\u00f9ng stack","text":"<p>Ta c\u00f3 4 to\u00e1n t\u1eed <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>. Khi kh\u00f4ng c\u00f3 ngo\u1eb7c, ta bi\u1ebft r\u1eb1ng <code>*</code> v\u00e0 <code>/</code> \u0111\u01b0\u1ee3c \u01b0u ti\u00ean h\u01a1n <code>+</code> v\u00e0 <code>-</code>. V\u00ec th\u1ebf ta c\u00f3 thu\u1eadt to\u00e1n sau:</p> <ol> <li>Duy\u1ec7t x\u00e2u t\u1eeb tr\u00e1i sang ph\u1ea3i.</li> <li>N\u1ebfu g\u1eb7p s\u1ed1, ta th\u00eam s\u1ed1 v\u00e0o to\u00e1n h\u1ea1ng hi\u1ec7n t\u1ea1i.</li> <li>N\u1ebfu to\u00e1n t\u1eed l\u00e0 <code>+</code> ho\u1eb7c <code>-</code>, ta ph\u1ea3i t\u00ednh bi\u1ec3u th\u1ee9c sau, d\u1ef1a v\u00e0o to\u00e1n t\u1eed ti\u1ebfp theo, n\u00ean ta ph\u1ea3i l\u01b0u to\u00e1n h\u1ea1ng hi\u1ec7n t\u1ea1i v\u00e0o stack.</li> <li>N\u1ebfu to\u00e1n t\u1eed l\u00e0 <code>*</code> ho\u1eb7c <code>/</code>, ta l\u1ea5y to\u00e1n h\u1ea1ng \u1edf \u0111\u1ec9nh stack v\u00e0 t\u00ednh bi\u1ec3u th\u1ee9c hi\u1ec7n t\u1ea1i, sau \u0111\u00f3 cho gi\u00e1 tr\u1ecb sau c\u00f9ng v\u00e0o l\u1ea1i stack.</li> <li>Sau khi duy\u1ec7t h\u1ebft x\u00e2u, l\u1ea5y l\u1ea7n l\u01b0\u1ee3t c\u00e1c gi\u00e1 tr\u1ecb t\u1eeb stack v\u00e0 th\u00eam v\u00e0o k\u1ebft qu\u1ea3.</li> </ol> <pre><code>class Solution {\npublic:\n    int calculate(string s) {\n        int len = s.length();\n        if (len == 0) return 0;\n        stack&lt;int&gt; stack;\n        int currentNumber = 0;\n        char operation = '+';\n        for (int i = 0; i &lt; len; i++) {\n            char currentChar = s[i];\n            if (isdigit(currentChar)) {\n                currentNumber = (currentNumber * 10) + (currentChar - '0');\n            }\n            if (!isdigit(currentChar) &amp;&amp; !iswspace(currentChar) || i == len - 1) {\n                if (operation == '-') {\n                    stack.push(-currentNumber);\n                } else if (operation == '+') {\n                    stack.push(currentNumber);\n                } else if (operation == '*') {\n                    int stackTop = stack.top();\n                    stack.pop();\n                    stack.push(stackTop * currentNumber);\n                } else if (operation == '/') {\n                    int stackTop = stack.top();\n                    stack.pop();\n                    stack.push(stackTop / currentNumber);\n                }\n                operation = currentChar;\n                currentNumber = 0;\n            }\n        }\n        int result = 0;\n        while (stack.size() != 0) {\n            result += stack.top();\n            stack.pop();\n        }\n        return result;\n    }\n};\n</code></pre> <ul> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input. Ta duy\u1ec7t x\u00e2u <code>s</code> nhi\u1ec1u nh\u1ea5t hai l\u1ea7n.</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> </ul>"},{"location":"LeetCode/basic-calculator/#cach-giai-2-khong-dung-stack","title":"C\u00e1ch gi\u1ea3i 2: Kh\u00f4ng d\u00f9ng stack","text":"<p>Th\u1ef1c ra ta ch\u1ec9 c\u1ea7n to\u00e1n h\u1ea1ng hi\u1ec7n t\u1ea1i c\u00f9ng v\u1edbi to\u00e1n h\u1ea1ng ngay tr\u01b0\u1edbc n\u00f3, n\u00ean ta s\u1ebd kh\u00f4ng nh\u1ea5t thi\u1ebft c\u1ea7n stack \u1edf \u0111\u00e2y. V\u1eady l\u00e0m c\u1ee5 th\u1ec3 nh\u01b0 th\u1ebf n\u00e0o?</p> <ul> <li>Thay v\u00ec d\u00f9ng stack, ta d\u00f9ng bi\u1ebfn <code>lastNumber</code> \u0111\u1ec3 l\u01b0u gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c \u0111\u01b0\u1ee3c t\u00ednh tr\u01b0\u1edbc \u0111\u00f3.</li> <li>N\u1ebfu to\u00e1n t\u1eed l\u00e0 <code>+</code> ho\u1eb7c <code>-</code>, th\u00eam <code>lastNumber</code> v\u00e0o k\u1ebft qu\u1ea3 thay v\u00ec cho v\u00e0o stack. <code>currentNumber</code> s\u1ebd th\u00e0nh <code>lastNumber</code>.</li> <li>N\u1ebfu to\u00e1n t\u1eed l\u00e0 <code>*</code> ho\u1eb7c <code>/</code>, ta t\u00ednh <code>lastNumber = lastNumber  * currentNumber</code>. K\u1ebft qu\u1ea3 n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng sau khi c\u1ea3 x\u00e2u \u0111\u01b0\u1ee3c x\u1eed l\u00fd h\u1ebft.</li> </ul> <pre><code>class Solution {\npublic:\n    int calculate(string s) {\n        int length = s.length();\n        if (length == 0) return 0;\n        int currentNumber = 0, lastNumber = 0, result = 0;\n        char sign = '+';\n        for (int i = 0; i &lt; length; i++) {\n            char currentChar = s[i];\n            if (isdigit(currentChar)) {\n                currentNumber = (currentNumber * 10) + (currentChar - '0');\n            }\n            if (!isdigit(currentChar) &amp;&amp; !iswspace(currentChar) || i == length - 1) {\n                if (sign == '+' || sign == '-') {\n                    result += lastNumber;\n                    lastNumber = (sign == '+') ? currentNumber : -currentNumber;\n                } else if (sign == '*') {\n                    lastNumber = lastNumber * currentNumber;\n                } else if (sign == '/') {\n                    lastNumber = lastNumber / currentNumber;\n                }\n                sign = currentChar;\n                currentNumber = 0;\n            }\n        }\n        result += lastNumber;\n        return result;  \n    }\n};\n</code></pre> <ul> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input. Ta duy\u1ec7t x\u00e2u <code>s</code> nhi\u1ec1u nh\u1ea5t hai l\u1ea7n.</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> </ul>"},{"location":"LeetCode/basic-calculator/#mo-rong-2-co-phep-nhan-chia-va-ngoac","title":"M\u1edf r\u1ed9ng 2: C\u00f3 ph\u00e9p nh\u00e2n chia v\u00e0 ngo\u1eb7c","text":"<p>\u0110\u00e2y l\u00e0 b\u00e0i LeetCode 772 - Basic Calculator III. S\u01a1 qua v\u1ec1 \u0111\u1ec1 b\u00e0i th\u00ec n\u00f3 t\u01b0\u01a1ng t\u1ef1 b\u00e0i g\u1ed1c, v\u1edbi th\u00eam hai ph\u00e9p nh\u00e2n v\u00e0 chia (v\u1eabn c\u00f3 d\u1ea5u ngo\u1eb7c).</p> <p>Code c\u1ee7a b\u00e0i n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng cho c\u1ea3 hai b\u00e0i Basic Calculator tr\u01b0\u1edbc.</p> <p>\u0110\u1ec3 gi\u1ea3i m\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n, ta s\u1ebd d\u00f9ng \u0111\u1ec7 quy k\u1ebft h\u1ee3p v\u1edbi c\u00e1ch gi\u1ea3i 1 c\u1ee7a b\u00e0i Basic Calculator II. Ta s\u1ebd cho n\u00f3 v\u00e0o m\u1ed9t h\u00e0m c\u00f3 t\u00ean l\u00e0 <code>parseExpression</code>. \u1ede \u0111\u00e2y, n\u00f3 s\u1ebd x\u1eed l\u00fd cho \u0111\u1ebfn khi g\u1eb7p d\u1ea5u ngo\u1eb7c \u0111\u00f3ng ho\u1eb7c h\u1ebft x\u00e2u. N\u1ebfu g\u1eb7p m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, ta s\u1ebd g\u1ecdi l\u1ea1i h\u00e0m \u0111\u1ec3 t\u00ednh bi\u1ec3u th\u1ee9c ph\u00eda trong. Ta c\u00f3 th\u00eam m\u1ed9t h\u00e0m <code>parseNum</code> \u0111\u1ec3 t\u00ednh to\u00e1n h\u1ea1ng khi g\u1eb7p s\u1ed1. Code s\u1ebd nh\u01b0 sau:</p> <pre><code>class Solution {\npublic:\n    int parseExpression(string &amp;s, int &amp;i) {\n        int n = s.size();\n        // v l\u00e0 m\u1ed9t stack\n        vector&lt;int&gt; v;\n        // to\u00e1n h\u1ea1ng hi\u1ec7n t\u1ea1i\n        char op = '+';\n\n        // duy\u1ec7t \u0111\u1ebfn h\u1ebft x\u00e2u ho\u1eb7c \u0111\u1ebfn ngo\u1eb7c \u0111\u00f3ng t\u01b0\u01a1ng \u1ee9ng\n        for (;i &lt; n &amp;&amp; op != ')'; i++) {\n            // b\u1ecf qua d\u1ea5u c\u00e1ch\n            if (s[i] == ' ') {\n                continue;\n            }\n            int num = 0;\n            if (s[i] == '(') {\n                // khi g\u1eb7p ngo\u1eb7c m\u1edf, t\u00ednh bi\u1ec3u th\u1ee9c trong \u0111\u00f3\n                num = parseExpression(s, ++i);\n            } else {\n                // khi g\u1eb7p s\u1ed1, t\u00ednh to\u00e1n h\u1ea1ng\n                num = parseNum(s, i);\n            }\n            // \u0111i\u1ec1u ch\u1ec9nh stack theo to\u00e1n t\u1eed tr\u01b0\u1edbc \u0111\u00f3\n            if (op == '+') {\n                v.push_back(num);\n            } else if (op == '-') {\n                v.push_back(-num);\n            } else if (op == '*') {\n                v.back() *= num;\n            } else if (op == '/') {\n                v.back() /= num;\n            }\n            // c\u1eadp nh\u1eadt to\u00e1n t\u1eed\n            op = s[i];\n        }\n\n        // t\u1ed5ng t\u1ea5t c\u1ea3 ph\u1ea7n t\u1eed trong stack\n        int res = 0;\n        for (auto x : v) res += x;\n        return res;\n    }\n\n    // parse cho \u0111\u1ebfn khi kh\u00f4ng g\u1eb7p s\u1ed1 n\u1eefa, tr\u1ea3 v\u1ec1 to\u00e1n h\u1ea1ng \u0111\u00e3 t\u00ecm ra\n    int parseNum(string &amp;s, int &amp;i) {\n        int res = 0;\n        while (i &lt; s.length() &amp;&amp; isdigit(s[i]))\n            res = s[i++] - '0' + 10 * res;\n        return res;\n    }\n\n    int calculate(string s) {\n        int i = 0;\n        return parseExpression(s, i);\n    }\n};\n</code></pre> <ul> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb: \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 \u0111\u1ed9 d\u00e0i x\u00e2u input.</li> </ul>"},{"location":"LeetCode/quickselect/","title":"Quickselect","text":""},{"location":"LeetCode/reservoir-sampling/","title":"L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a (Reservoir Sampling)","text":""},{"location":"LeetCode/reservoir-sampling/#lay-mau-ho-chua-reservoir-sampling","title":"L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a (Reservoir Sampling)","text":""},{"location":"LeetCode/reservoir-sampling/#nguon","title":"Ngu\u1ed3n","text":"<p> LeetCode 382 -  Linked List Random Node - Editorial</p>"},{"location":"LeetCode/reservoir-sampling/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>M\u00ecnh g\u1eb7p m\u1ed9t b\u00e0i t\u1eadp kh\u00e1 th\u00fa v\u1ecb tr\u00ean LeetCode m\u00e0 m\u00ecnh ngh\u0129 l\u00e0 \u00edt ng\u01b0\u1eddi g\u1eb7p khi thi Competitive Programming, c\u00f3 \u0111i\u1ec1u m\u00ecnh th\u1ea5y n\u00f3 kh\u00e1 hay. \u0110\u00f3 l\u00e0 b\u00e0i t\u1eadp v\u1ec1 l\u1ea5y m\u1eabu trong m\u1ed9t list (m\u1ea3ng, linked list g\u00ec \u0111\u00f3). Nghe c\u00f3 v\u1ebb \u0111\u01a1n gi\u1ea3n nh\u01b0ng v\u1edbi c\u00e1c gi\u1edbi h\u1ea1n \u0111i k\u00e8m, n\u00f3 th\u1ef1c s\u1ef1 \u0111\u00e1ng \u0111\u1ec3 l\u01b0u l\u1ea1i.</p> <p>L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a (Reservoir Sampling) l\u00e0 m\u1ed9t l\u1edbp c\u1ee7a c\u00e1c thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean \u0111\u1ec3 l\u1ea5y m\u1eabu trong m\u1ed9t kh\u00f4ng gian m\u1eabu kh\u00f4ng x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c s\u1ed1 l\u01b0\u1ee3ng.</p>"},{"location":"LeetCode/reservoir-sampling/#e-bai","title":"\u0110\u1ec1 b\u00e0i","text":"<p>Cho m\u1ed9t linked list \u0111\u01a1n, tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t node ng\u1eabu nhi\u00ean n\u00e0o \u0111\u00f3 tr\u00ean linked list n\u00e0y. Tuy nhi\u00ean, m\u1ed7i node ph\u1ea3i c\u00f3 c\u00f9ng x\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c ch\u1ecdn.</p> <p>B\u1ea1n c\u1ea7n c\u00e0i class <code>Solution</code> nh\u01b0 sau:</p> <ul> <li><code>Solution(ListNode head)</code>: Kh\u1edfi t\u1ea1o object v\u1edbi m\u1ed9t tham s\u1ed1 l\u00e0 head c\u1ee7a linked list.</li> <li><code>int getRandom()</code>: Ch\u1ecdn m\u1ed9t node t\u1eeb linked list v\u00e0 tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3. T\u1ea5t c\u1ea3 c\u00e1c node c\u1ee7a linked list c\u1ea7n c\u00f3 t\u1ec9 l\u1ec7 \u0111\u01b0\u1ee3c ch\u1ecdn b\u1eb1ng nhau.</li> </ul> <p>Follow up:</p> <ul> <li>Gi\u1ea3i nh\u01b0 n\u00e0o khi linked list c\u1ef1c l\u1edbn v\u00e0 \u0111\u1ed9 d\u00e0i b\u1ea1n kh\u00f4ng bi\u1ebft \u0111\u01b0\u1ee3c?</li> <li>Gi\u1ea3i nh\u01b0 n\u00e0o \u0111\u1ec3 kh\u00f4ng ph\u1ea3i d\u00f9ng th\u00eam b\u1ed9 nh\u1edb?</li> </ul>"},{"location":"LeetCode/reservoir-sampling/#cac-cach-tiep-can","title":"C\u00e1c c\u00e1ch ti\u1ebfp c\u1eadn","text":""},{"location":"LeetCode/reservoir-sampling/#cach-tiep-can-1-lay-mau-co-inh","title":"C\u00e1ch ti\u1ebfp c\u1eadn 1: L\u1ea5y m\u1eabu c\u1ed1 \u0111\u1ecbnh","text":"<p>N\u1ebfu ta \u0111\u01b0\u1ee3c cho m\u1ed9t m\u1ea3ng ho\u1eb7c linked list m\u00e0 \u0111\u00e3 bi\u1ebft k\u00edch th\u01b0\u1edbc, ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng gi\u1ea3i \u0111\u01b0\u1ee3c b\u00e0i n\u00e0y.</p> <p>N\u1ebfu \u0111\u01b0\u1ee3c cho m\u1ed9t linked list, ta c\u00f3 th\u1ec3 chuy\u1ec3n n\u00f3 th\u00e0nh m\u1ed9t m\u1ea3ng. V\u1edbi m\u1ea3ng, ta c\u00f3 th\u1ec3 bi\u1ebft \u0111\u01b0\u1ee3c k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3 v\u00e0 c\u00f3 th\u1ec3 truy c\u1eadp v\u00e0o t\u1eebng ph\u1ea7n t\u1eed ngay l\u1eadp t\u1ee9c.</p> <p>Ta \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u c\u00e0i 2 h\u00e0m trong object, bao g\u1ed3m h\u00e0m <code>init(head)</code> v\u00e0 <code>getRandom()</code>.</p> <p>H\u00e0m <code>init(head)</code> s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi khi kh\u1edfi t\u1ea1o object. Ta s\u1ebd chuy\u1ec3n \u0111\u1ed5i linked list \u0111\u00e3 cho th\u00e0nh m\u1ed9t m\u1ea3ng.</p> <p>H\u00e0m <code>getRandom()</code> s\u1ebd ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 l\u1ea5y m\u1eabu t\u1eeb m\u1ea3ng \u1edf tr\u00ean.</p> <pre><code>/**\n * Definition for singly-linked list.\n * struct ListNode {\n *     int val;\n *     ListNode *next;\n *     ListNode() : val(0), next(nullptr) {}\n *     ListNode(int x) : val(x), next(nullptr) {}\n *     ListNode(int x, ListNode *next) : val(x), next(next) {}\n * };\n */\nclass Solution {\npublic:\n    vector&lt;int&gt; range;\n\n    Solution(ListNode* head) {\n        srand(time(NULL));\n        while (head != NULL) {\n            range.push_back(head-&gt;val);\n            head = head-&gt;next;\n        }\n    }\n\n    int getRandom() {\n        int pick = rand() % range.size();\n        return range[pick];\n    }\n};\n/**\n * Your Solution object will be instantiated and called as such:\n * Solution* obj = new Solution(head);\n * int param_1 = obj-&gt;getRandom();\n */\n</code></pre> <p>C\u00e1ch gi\u1ea3i tr\u00ean r\u1ea5t \u0111\u01a1n gi\u1ea3n v\u00e0 nhanh. Nh\u01b0ng n\u00f3 \u0111i k\u00e8m v\u1edbi hai nh\u01b0\u1ee3c \u0111i\u1ec3m:</p> <ul> <li>N\u00f3 c\u1ea7n th\u00eam b\u1ed9 nh\u1edb \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c ph\u1ea7n t\u1eed cho vi\u1ec7c l\u1ea5y m\u1eabu, n\u00ean kh\u00f4ng tho\u1ea3 m\u00e3n \u0111i\u1ec1u ki\u1ec7n trong follow up (m\u1ed9t c\u00e1ch gi\u1ea3i v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 h\u1eb1ng s\u1ed1).</li> <li>N\u00f3 kh\u00f4ng th\u1ec3 gi\u1ea3i quy\u1ebft tr\u01b0\u1eddng h\u1ee3p khi ta c\u00f3 m\u1ed9t danh s\u00e1ch v\u1edbi c\u00e1c ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c th\u00eam v\u00e0o, ngh\u0129a l\u00e0 ta kh\u00f4ng c\u00f3 \u0111\u1ee7 b\u1ed9 nh\u1edb \u0111\u1ec3 l\u01b0u t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed. Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t lu\u1ed3ng s\u1ed1, ta mu\u1ed1n ch\u1ecdn ng\u1eabu nhi\u00eau m\u1ed9t s\u1ed1 \u1edf b\u1ea5t c\u1ee9 th\u1eddi \u0111i\u1ec3m n\u00e0o. V\u1edbi c\u00e1ch gi\u1ea3i tr\u00ean th\u00ec ta ph\u1ea3i l\u01b0u t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong b\u1ed9 nh\u1edb, n\u00ean kh\u00f4ng th\u1ec3 m\u1edf r\u1ed9ng \u0111\u01b0\u1ee3c.</li> </ul> <p>Ta s\u1ebd gi\u1ea3i quy\u1ebft 2 nh\u01b0\u1ee3c \u0111i\u1ec3m n\u00e0y trong c\u00e1ch ti\u1ebfp c\u1eadn 2.</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian:</p> <ul> <li>V\u1edbi h\u00e0m <code>init(head)</code>, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 s\u1ed1 ph\u1ea7n t\u1eed trong linked list.</li> <li>V\u1edbi h\u00e0m <code>getRandom()</code>, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(1)\\). Sinh s\u1ed1 ng\u1eabu nhi\u00ean t\u1ed1n \\(O(1)\\) v\u00e0 truy c\u1eadp v\u00e0o ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng c\u0169ng v\u1eady.</li> </ul> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb:</p> <ul> <li>\\(O(N)\\), v\u00ec ta ph\u1ea3i l\u01b0u th\u00eam c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a linked list v\u00e0o m\u1ed9t m\u1ea3ng.</li> </ul>"},{"location":"LeetCode/reservoir-sampling/#cach-tiep-can-2-lay-mau-ho-chua","title":"C\u00e1ch ti\u1ebfp c\u1eadn 2: L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a","text":"<p>\u0110\u1ec3 l\u1ea5y m\u1eabu ng\u1eabu nhi\u00ean m\u00e0 kh\u00f4ng bi\u1ebft k\u00edch th\u01b0\u1edbc m\u1eabu v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb h\u1eb1ng s\u1ed1, ta d\u00f9ng L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a. N\u00f3 c\u00f3 th\u1ec3 gi\u1ea3i quy\u1ebft \u0111\u01b0\u1ee3c hai nh\u01b0\u1ee3c \u0111i\u1ec3m c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn 1.</p> <p>Thu\u1eadt to\u00e1n L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a d\u00f9ng \u0111\u1ec3 l\u1ea5y m\u1eabu \\(k\\) ph\u1ea7n t\u1eed t\u1eeb m\u1ed9t qu\u1ea7n th\u1ec3 c\u00f3 k\u00edch th\u01b0\u1edbc kh\u00f4ng x\u00e1c \u0111\u1ecbnh. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, \\(k = 1\\).</p> <p>L\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a l\u00e0 m\u1ed9t h\u1ecd c\u00e1c thu\u1eadt to\u00e1n bao g\u1ed3m nhi\u1ec1u bi\u1ebfn th\u1ec3 qua th\u1eddi gian. \u1ede \u0111\u00e2y ta s\u1ebd n\u00f3i v\u1ec1 m\u1ed9t thu\u1eadt to\u00e1n \u0111\u01a1n gi\u1ea3n, nh\u01b0ng ch\u1eadm, c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Thu\u1eadt to\u00e1n R c\u1ee7a Alan Waterman.</p> <pre><code># S ch\u1ee9a c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ec3 l\u1ea5y m\u1eabu, R ch\u1ee9a k\u1ebft qu\u1ea3 l\u1ea5y m\u1eabu k ph\u1ea7n t\u1eed\ndef ReservoirSample(S[1..n], R[1..k])\n    # l\u00e0m \u0111\u1ea7y h\u1ed3 ch\u1ee9a tr\u01b0\u1edbc \u0111\u00e3\n    for i := 1 to k\n        R[i] := S[i]\n\n    # thay th\u1ebf c\u00e1c ph\u1ea7n t\u1eed v\u1edbi x\u00e1c su\u1ea5t gi\u1ea3m d\u1ea7n\n    for i := k+1 to n\n        # randomInteger(a, b) tr\u1ea3 v\u1ec1 m\u1ed9t s\u1ed1 nguy\u00ean trong \u0111o\u1ea1n [a, b]\n        # c\u00e1c s\u1ed1 c\u00f3 x\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c ch\u1ecdn b\u1eb1ng nhau\n        j := randomInteger(1, i)\n        # n\u1ebfu j n\u1eb1m trong h\u1ed3 ch\u1ee9a th\u00ec cho n\u00f3 v\u00e0o h\u1ed3 ch\u1ee9a\n        if j &lt;= k\n            R[j] := S[i]\n</code></pre> <p></p> <p>Ta t\u00f3m t\u1eaft \u00fd t\u01b0\u1edfng thu\u1eadt to\u00e1n nh\u01b0 sau:</p> <ul> <li>\u0110\u1ea7u ti\u00ean, ta l\u00e0m \u0111\u1ea7y h\u1ed3 ch\u1ee9a \\(R[]\\) v\u1edbi c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1eabu \\(S[]\\). \u0110\u1ebfn cu\u1ed1i c\u00f9ng, h\u1ed3 ch\u1ee9a s\u1ebd bao g\u1ed3m c\u00e1c ph\u1ea7n t\u1eed m\u00e0 ta \u0111\u00e3 l\u1ea5y t\u1eeb m\u1eabu.</li> <li>Sau \u0111\u00f3 ta duy\u1ec7t c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i c\u1ee7a m\u1eabu. V\u1edbi m\u1ed7i ph\u1ea7n t\u1eed, ta c\u1ea7n x\u00e1c \u0111\u1ecbnh xem ta c\u00f3 mu\u1ed1n cho n\u00f3 v\u00e0o h\u1ed3 ch\u1ee9a hay kh\u00f4ng. N\u1ebfu c\u00f3, ta thay th\u1ebf ph\u1ea7n t\u1eed trong h\u1ed3 ch\u1ee9a v\u1edbi ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i.</li> </ul> <p>C\u00e2u h\u1ecfi \u0111\u1eb7t ra \u1edf \u0111\u00e2y l\u00e0 l\u00e0m sao bi\u1ebft ch\u1eafc r\u1eb1ng m\u1ed7i ph\u1ea7n t\u1eed c\u00f3 x\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c ch\u1ecdn b\u1eb1ng nhau?</p> <p>Thu\u1eadt to\u00e1n tr\u00ean \u0111\u1ea3m b\u1ea3o r\u1eb1ng v\u1edbi m\u1ed7i ph\u1ea7n t\u1eed \u0111\u00e3 \u0111\u01b0\u1ee3c duy\u1ec7t, ch\u00fang s\u1ebd c\u00f3 x\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0o h\u1ed3 ch\u1ee9a b\u1eb1ng nhau.</p> <p>Ch\u1ee9ng minh nh\u01b0 sau:</p> <ul> <li>Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \\(i\\) (v\u00e0 \\(i &gt; k\\)), khi ta duy\u1ec7t \u0111\u1ebfn ph\u1ea7n t\u1eed \u0111\u00f3, x\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0o h\u1ed3 ch\u1ee9a c\u1ee7a n\u00f3 s\u1ebd l\u00e0 \\(\\frac{k}{i}\\), nh\u01b0 ta th\u1ea5y trong thu\u1eadt to\u00e1n.</li> <li>Sau \u0111\u00f3, c\u00f3 kh\u1ea3 n\u0103ng ph\u1ea7n t\u1eed \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0o h\u1ed3 ch\u1ee9a s\u1ebd b\u1ecb thay th\u1ebf b\u1edfi m\u1ed9t trong c\u00e1c ph\u1ea7n t\u1eed sau n\u00f3. C\u1ee5 th\u1ec3 h\u01a1n, khi ta \u0111\u1ebfn ph\u1ea7n t\u1eed \\(x\\) (\\(x &gt; i\\)), \\(\\frac{1}{x}\\) s\u1ebd l\u00e0 x\u00e1c su\u1ea5t cho b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o trong h\u1ed3 ch\u1ee9a b\u1ecb thay th\u1ebf. V\u00ec v\u1edbi b\u1ea5t k\u1ef3 v\u1ecb tr\u00ed n\u00e0o trong h\u1ed3 ch\u1ee9a, s\u1ebd c\u00f3 \\(\\frac{1}{x}\\) c\u01a1 h\u1ed9i n\u00f3 s\u1ebd b\u1ecb ch\u1ecdn b\u1edfi h\u00e0m sinh s\u1ed1 ng\u1eabu nhi\u00ean. Ng\u01b0\u1ee3c l\u1ea1i, x\u00e1c su\u1ea5t s\u1ebd l\u00e0 \\(\\frac{x-1}{x}\\) cho b\u1ea5t c\u1ee9 ph\u1ea7n t\u1eed n\u00e0o \u1edf l\u1ea1i trong h\u1ed3 ch\u1ee9a sau khi duy\u1ec7t xong \\(x\\).</li> <li>T\u1ed5ng k\u1ebft l\u1ea1i, \u0111\u1ec3 b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o trong m\u1eabu c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0o h\u1ed3 ch\u1ee9a k\u1ebft qu\u1ea3, m\u1ed9t d\u00e3y c\u00e1c bi\u1ebfn c\u1ed1 \u0111\u1ed9c l\u1eadp s\u1ebd ph\u1ea3i x\u1ea3y ra nh\u01b0 sau:<ul> <li>Th\u1ee9 nh\u1ea5t, ph\u1ea7n t\u1eed c\u1ea7n \u0111\u01b0\u1ee3c ch\u1ecdn v\u00e0o h\u1ed3 ch\u1ee9a khi duy\u1ec7t \u0111\u1ebfn ph\u1ea7n t\u1eed \u0111\u00f3.</li> <li>Th\u1ee9 hai, khi duy\u1ec7t c\u00e1c ph\u1ea7n t\u1eed ti\u1ebfp theo, ph\u1ea7n t\u1eed c\u1ea7n \u0111\u01b0\u1ee3c ch\u1ecdn ph\u1ea3i \u1edf l\u1ea1i, ngh\u0129a l\u00e0 kh\u00f4ng b\u1ecb thay b\u1edfi c\u00e1c ph\u1ea7n t\u1eed ti\u1ebfp theo.</li> </ul> </li> <li>Nh\u01b0 v\u1eady, v\u1edbi m\u1ed9t d\u00e3y s\u1ed1 \u0111\u1ed9 d\u00e0i \\(n\\), x\u00e1c su\u1ea5t \u0111\u1ec3 b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o n\u1eb1m trong h\u1ed3 ch\u1ee9a k\u1ebft qu\u1ea3 s\u1ebd theo c\u00f4ng th\u1ee9c sau:</li> </ul> \\[ \\frac{k}{i} \\cdot \\frac{i}{i+1} \\cdot \\frac{i+1}{i+2} \\dots \\frac{n-1}{n} = \\frac{k}{n} \\] <p>V\u1edbi ph\u00e2n t\u00edch tr\u00ean, ta c\u00f3 th\u1ec3 c\u00e0i nh\u01b0 sau:</p> <ul> <li>Trong h\u00e0m <code>init()</code>, ta ch\u1ec9 c\u1ea7n l\u01b0u l\u1ea1i head c\u1ee7a linked list, thay v\u00ec chuy\u1ec3n n\u00f3 th\u00e0nh m\u1ea3ng.</li> <li>Trong h\u00e0m <code>getRandom()</code>, ta l\u1ea5y m\u1eabu h\u1ed3 ch\u1ee9a b\u1eaft \u0111\u1ea7u t\u1eeb head c\u1ee7a linked list. C\u1ee5 th\u1ec3 h\u01a1n l\u00e0 ta duy\u1ec7t t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed l\u1ea7n l\u01b0\u1ee3t \u0111\u1ec3 xem th\u1eed ta c\u00f3 c\u1ea7n cho n\u00f3 v\u00e0o h\u1ed3 ch\u1ee9a hay kh\u00f4ng (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y h\u1ed3 ch\u1ee9a c\u00f3 \\(1\\) ph\u1ea7n t\u1eed).</li> </ul> <pre><code>/**\n * Definition for singly-linked list.\n * struct ListNode {\n *     int val;\n *     ListNode *next;\n *     ListNode() : val(0), next(nullptr) {}\n *     ListNode(int x) : val(x), next(nullptr) {}\n *     ListNode(int x, ListNode *next) : val(x), next(next) {}\n * };\n */\nclass Solution {\npublic:\n    ListNode *head;\n\n    Solution(ListNode* head) {\n        this-&gt;head = head;\n        // seed cho h\u00e0m sinh s\u1ed1 ng\u1eabu nhi\u00ean\n        std::srand(std::time(0));\n    }\n\n    int getRandom() {\n        // \u1edf \u0111\u00e2y k = 1\n        // chosenVal l\u00e0 k\u1ebft qu\u1ea3\n        // scope l\u00e0 s\u1ed1 ph\u1ea7n t\u1eed \u0111\u00e3 v\u00e0 \u0111ang duy\u1ec7t qua\n        int chosenVal = 0, scope = 1;\n        ListNode *cur = head;\n        while (cur != NULL) {\n            // n\u1ebfu random tr\u00fang ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean th\u00ec thay th\u1ebf n\u00f3\n            // \u1edf \u0111\u00e2y ta d\u00f9ng chia l\u1ea5y d\u01b0 trong scope cho ti\u1ec7n\n            if (std::rand() % scope == 0) {\n                chosenVal = cur-&gt;val;\n            }\n            scope++;\n            cur = cur-&gt;next;\n        }\n        return chosenVal;\n    }\n};\n\n/**\n * Your Solution object will be instantiated and called as such:\n * Solution* obj = new Solution(head);\n * int param_1 = obj-&gt;getRandom();\n */\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian:</p> <ul> <li>V\u1edbi h\u00e0m <code>init(head)</code>, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(1)\\).</li> <li>V\u1edbi h\u00e0m <code>getRandom()</code>, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N)\\), v\u1edbi \\(N\\) l\u00e0 s\u1ed1 ph\u1ea7n t\u1eed trong linked list.</li> </ul> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb:</p> <ul> <li>\\(O(1)\\), v\u00ec c\u00e1c s\u1ed1 c\u00e1c bi\u1ebfn l\u00e0 h\u1eb1ng s\u1ed1, kh\u00f4ng t\u00ednh linked list ban \u0111\u1ea7u.</li> </ul>"},{"location":"LeetCode/reservoir-sampling/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date LC 382 - Linked List Random Node Unavailable public link Code 17/03/2023 LC 398 - Random Pick Index Unavailable public link Code 17/03/2023 LC 519 - Random Flip Matrix Unavailable public link Code 17/03/2023 LC 497 - Random Point in Non-overlapping Rectangles Unavailable public link Code 18/03/2023"},{"location":"LeetCode/search-in-rotated-sorted-array/","title":"T\u00ecm ki\u1ebfm tr\u00ean m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp nh\u01b0ng \u0111\u00e3 xoay","text":""},{"location":"LeetCode/search-in-rotated-sorted-array/#tim-kiem-tren-mang-a-sap-xep-nhung-a-xoay","title":"T\u00ecm ki\u1ebfm tr\u00ean m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp nh\u01b0ng \u0111\u00e3 xoay","text":""},{"location":"LeetCode/search-in-rotated-sorted-array/#nguon","title":"Ngu\u1ed3n","text":"<p> LeetCode 81 -  Search in Rotated Sorted Array II - Editorial</p>"},{"location":"LeetCode/search-in-rotated-sorted-array/#e-bai","title":"\u0110\u1ec1 b\u00e0i","text":"<p>C\u00f3 m\u1ed9t m\u1ea3ng <code>nums</code> \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp kh\u00f4ng gi\u1ea3m (c\u00f3 th\u1ec3 c\u00f3 hai ph\u1ea7n t\u1eed tr\u00f9ng nhau).</p> <p>M\u1ea3ng <code>nums</code> \u0111\u01b0\u1ee3c xoay \u1edf m\u1ed9t v\u1ecb tr\u00ed pivot <code>k</code> (<code>0 &lt;= k &lt; nums.length</code>) sao cho m\u1ea3ng k\u1ebft qu\u1ea3 l\u00e0 <code>[nums[k], nums[k+1], ..., nums[n-1], nums[0], nums[1], ..., nums[k-1]]</code> (\u0111\u00e1nh s\u1ed1 t\u1eeb 0). V\u00ed d\u1ee5, <code>[0,1,2,4,4,4,5,6,6,7]</code> c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xoay \u1edf v\u1ecb tr\u00ed pivot <code>5</code> v\u00e0 tr\u1edf th\u00e0nh <code>[4,5,6,6,7,0,1,2,4,4]</code>.</p> <p>Cho m\u1ea3ng <code>nums</code> sau khi xoay v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean <code>target</code>, tr\u1ea3 v\u1ec1 <code>true</code> n\u1ebfu <code>target</code> n\u1eb1m trong <code>nums</code>, ng\u01b0\u1ee3c l\u1ea1i tr\u1ea3 v\u1ec1 <code>false</code>.</p> <p>B\u1ea1n ph\u1ea3i gi\u1ea3m s\u1ed1 thao t\u00e1c t\u00ecm ki\u1ebfm \u0111\u1ebfn m\u1ee9c t\u1ed1i thi\u1ec3u.</p>"},{"location":"LeetCode/search-in-rotated-sorted-array/#tim-kiem-nhi-phan","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n","text":"<p>\u0110\u00e2y l\u00e0 m\u1edf r\u1ed9ng c\u1ee7a b\u00e0i 33 - Search in Rotated Sorted Array. \u0110i\u1ec3m kh\u00e1c bi\u1ec7t \u1edf \u0111\u00e2y l\u00e0 b\u00e0i n\u00e0y c\u00f3 th\u1ec3 c\u00f3 c\u00e1c ph\u1ea7n t\u1eed gi\u1ed1ng nhau.</p>"},{"location":"LeetCode/search-in-rotated-sorted-array/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>Sau khi xoay m\u1ed9t m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp, ta s\u1ebd c\u00f3 2 m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp ch\u1eadp v\u00e0o nhau.</p> <p></p> <p>G\u1ecdi m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp \u0111\u1ea7u ti\u00ean l\u00e0 <code>F</code>, c\u00f2n m\u1ea3ng th\u1ee9 hai l\u00e0 <code>S</code>.</p> <p></p> <p>Ta c\u00f3 th\u1ec3 th\u1ea5y l\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng th\u1ee9 hai <code>S</code> s\u1ebd nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean <code>start</code> c\u1ee7a <code>F</code> (c\u0169ng l\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng ban \u0111\u1ea7u).</p> <p></p> <p>V\u1edbi observation n\u00e0y, ta c\u00f3 th\u1ec3 bi\u1ebft \u0111\u01b0\u1ee3c ph\u1ea7n t\u1eed <code>target</code> n\u1eb1m trong m\u1ea3ng <code>F</code> hay <code>S</code> b\u1eb1ng c\u00e1ch so s\u00e1nh n\u00f3 v\u1edbi ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a m\u1ea3ng.</p> <p>Gi\u1ea3 s\u1eed ta \u0111ang t\u00ecm ph\u1ea7n t\u1eed <code>target</code> trong m\u1ea3ng <code>arr</code>:</p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 1: N\u1ebfu <code>target &gt; arr[start]</code>: <code>target</code> n\u1eb1m trong m\u1ea3ng <code>F</code></li> </ul> <p></p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 2: N\u1ebfu <code>target &lt; arr[start]</code>: <code>target</code> n\u1eb1m trong m\u1ea3ng <code>S</code></li> </ul> <p></p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 3: N\u1ebfu <code>target == arr[start]</code>: <code>target</code> r\u00f5 r\u00e0ng n\u1eb1m trong m\u1ea3ng <code>F</code>, nh\u01b0ng c\u0169ng c\u00f3 th\u1ec3 n\u1eb1m trong m\u1ea3ng <code>S</code>.</li> </ul> <p></p> <p>H\u00e0m d\u01b0\u1edbi \u0111\u00e2y cho ta bi\u1ebft ph\u1ea7n t\u1eed <code>target</code> c\u00f3 th\u1ec3 n\u1eb1m trong m\u1ea3ng <code>F</code> hay kh\u00f4ng:</p> <pre><code>// tr\u1ea3 v\u1ec1 true n\u1ebfu element n\u1eb1m trong m\u1ea3ng \u0111\u1ea7u ti\u00ean, false n\u1ebfu n\u00f3 n\u1eb1m trong m\u1ea3ng th\u1ee9 hai\nbool existsInFirst(vector&lt;int&gt;&amp; nums, int start, int element) {\n    return nums[start] &lt;= element;\n}\n</code></pre>"},{"location":"LeetCode/search-in-rotated-sorted-array/#thuat-toan","title":"Thu\u1eadt to\u00e1n","text":"<p>Nh\u1edb l\u1ea1i r\u1eb1ng trong t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n b\u00ecnh th\u01b0\u1eddng, ta c\u00f3 hai con tr\u1ecf (<code>start</code> v\u00e0 <code>end</code>) \u0111\u1ec3 gi\u1eef ph\u1ea1m vi t\u00ecm ki\u1ebfm trong m\u1ea3ng <code>arr</code>. Ta chia kh\u00f4ng gian t\u00ecm ki\u1ebfm th\u00e0nh 3 ph\u1ea7n: <code>[start, mid)</code>, <code>[mid, mid]</code>, <code>(mid, end]</code>. Ta ti\u1ebfp t\u1ee5c t\u00ecm ki\u1ebfm <code>target</code> trong m\u1ed9t trong c\u00e1c kh\u00f4ng gian t\u00ecm ki\u1ebfm \u0111\u00f3.</p> <p>B\u1eb1ng c\u00e1ch x\u00e1c \u0111\u1ecbnh v\u1ecb tr\u00ed c\u1ee7a <code>arr[mid]</code> v\u00e0 <code>target</code> trong <code>F</code> v\u00e0 <code>S</code>, ta c\u00f3 th\u1ec3 gia gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm b\u1eb1ng c\u00e1ch t\u01b0\u01a1ng t\u1ef1 v\u1edbi t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n b\u00ecnh th\u01b0\u1eddng:</p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 1: <code>arr[mid]</code> n\u1eb1m trong <code>F</code>, <code>target</code> n\u1eb1m trong <code>S</code>: V\u00ec m\u1ea3ng <code>S</code> b\u1eaft \u0111\u1ea7u khi <code>F</code> h\u1ebft, ta bi\u1ebft <code>target</code> n\u1eb1m trong \u0111o\u1ea1n <code>(mid, end]</code>.</li> </ul> <p></p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 2: <code>arr[mid]</code> n\u1eb1m trong <code>S</code>, <code>target</code> n\u1eb1m trong <code>F</code>: T\u01b0\u01a1ng t\u1ef1, ta bi\u1ebft <code>target</code> n\u1eb1m trong \u0111o\u1ea1n <code>[start, mid)</code>.</li> </ul> <p></p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 3: <code>arr[mid]</code> v\u00e0 <code>target</code> n\u1eb1m trong <code>F</code>: V\u00ec c\u1ea3 hai n\u1eb1m trong c\u00f9ng m\u1ed9t m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp, ta c\u00f3 th\u1ec3 so s\u00e1nh <code>arr[mid]</code> v\u00e0 <code>target</code> \u0111\u1ec3 bi\u1ebft l\u00e0m sao gia gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm.</li> </ul> <p></p> <ul> <li>Tr\u01b0\u1eddng h\u1ee3p 4: <code>arr[mid]</code> v\u00e0 <code>target</code> n\u1eb1m trong <code>S</code>: T\u01b0\u01a1ng t\u1ef1, v\u00ec c\u1ea3 hai n\u1eb1m trong c\u00f9ng m\u1ed9t m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp, ta c\u00f3 th\u1ec3 so s\u00e1nh <code>arr[mid]</code> v\u00e0 <code>target</code> \u0111\u1ec3 bi\u1ebft l\u00e0m sao gia gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm.</li> </ul> <p></p> <p>Nh\u01b0ng c\u00f3 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t, n\u1ebfu <code>arr[mid]</code> b\u1eb1ng <code>arr[start]</code>, ta bi\u1ebft r\u1eb1ng <code>arr[mid]</code> c\u00f3 th\u1ec3 n\u1eb1m trong c\u1ea3 <code>F</code> l\u1eabn <code>S</code>, n\u00ean ta kh\u00f4ng th\u1ec3 t\u00ecm v\u1ecb tr\u00ed t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a <code>target</code> t\u1eeb \u0111\u00f3.</p> <p></p> <pre><code>// tr\u1ea3 v\u1ec1 true n\u1ebfu ta c\u00f3 th\u1ec3 gia gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm v\u1edbi kh\u00f4ng gian t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n hi\u1ec7n t\u1ea1i\nbool isBinarySearchHelpful(vector&lt;int&gt;&amp; nums, int start, int element) {\n    return nums[start] != element;\n}\n</code></pre> <p>Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, ta kh\u00f4ng c\u00f2n c\u00e1ch n\u00e0o kh\u00e1c ngo\u00e0i vi\u1ec7c di chuy\u1ec3n con tr\u1ecf <code>start</code> \u0111i ti\u1ebfp m\u1ed9t b\u01b0\u1edbc. V\u00ec v\u1eady, c\u00f3 nh\u1eefng kh\u00f4ng gian t\u00ecm ki\u1ebfm cho ph\u00e9p t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, v\u00e0 m\u1ed9t s\u1ed1 kh\u00e1c kh\u00f4ng cho ph\u00e9p.</p> <pre><code>class Solution {\npublic:\n    bool search(vector&lt;int&gt;&amp; nums, int target) {\n        int n = nums.size();\n        if (n == 0) return false;\n        int end = n - 1;\n        int start = 0;\n\n        while (start &lt;= end) {\n            int mid = start + (end - start) / 2;\n\n            if (nums[mid] == target) {\n                return true;\n            }\n\n            if (!isBinarySearchHelpful(nums, start, nums[mid])) {\n                start++;\n                continue;\n            }\n\n            // pivot n\u1eb1m trong m\u1ea3ng \u0111\u1ea7u ti\u00ean hay kh\u00f4ng\n            bool pivotArray = existsInFirst(nums, start, nums[mid]);\n\n            // target n\u1eb1m trong m\u1ea3ng \u0111\u1ea7u ti\u00ean hay kh\u00f4ng\n            bool targetArray = existsInFirst(nums, start, target);\n            if (pivotArray ^ targetArray) { // target v\u00e0 pivot n\u1eb1m kh\u00e1c m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp, nh\u1edb l\u1ea1i xor ch\u1ec9 true khi hai to\u00e1n t\u1eed kh\u00e1c nhau\n                if (pivotArray) {\n                    start = mid + 1; // pivot n\u1eb1m \u1edf m\u1ea3ng \u0111\u1ea7u, target n\u1eb1m \u1edf m\u1ea3ng sau\n                } else {\n                    end = mid - 1; // target n\u1eb1m \u1edf m\u1ea3ng \u0111\u1ea7u, pivot n\u1eb1m \u1edf m\u1ea3ng sau\n                }\n            } else { // target v\u00e0 pivot n\u1eb1m c\u00f9ng m\u1ea3ng \u0111\u00e3 s\u1eafp x\u1ebfp\n                if (nums[mid] &lt; target) {\n                    start = mid + 1;\n                } else {\n                    end = mid - 1;\n                }\n            }\n        }\n        return false;\n    }\n\n    // tr\u1ea3 v\u1ec1 true n\u1ebfu ta c\u00f3 th\u1ec3 gia gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm v\u1edbi kh\u00f4ng gian t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n hi\u1ec7n t\u1ea1i\n    bool isBinarySearchHelpful(vector&lt;int&gt;&amp; nums, int start, int element) {\n        return nums[start] != element;\n    }\n\n    // tr\u1ea3 v\u1ec1 true n\u1ebfu element n\u1eb1m trong m\u1ea3ng \u0111\u1ea7u ti\u00ean, false n\u1ebfu n\u00f3 n\u1eb1m trong m\u1ea3ng th\u1ee9 hai\n    bool existsInFirst(vector&lt;int&gt;&amp; nums, int start, int element) {\n        return nums[start] &lt;= element;\n    }\n};\n</code></pre>"},{"location":"LeetCode/search-in-rotated-sorted-array/#phan-tich-o-phuc-tap","title":"Ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p","text":"<p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian: \\(O(N)\\) trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, \\(O(\\log N)\\) trong tr\u01b0\u1eddng h\u1ee3p t\u1ed1t nh\u1ea5t, v\u1edbi N l\u00e0 \u0111\u1ed9 d\u00e0i m\u1ea3ng ban \u0111\u1ea7u.</p> <p>Tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t: Tr\u01b0\u1eddng h\u1ee3p n\u00e0y x\u1ea3y ra khi t\u1ea5t c\u1ea3 ph\u1ea7n t\u1eed gi\u1ed1ng nhau v\u00e0 ta t\u00ecm m\u1ed9t s\u1ed1 kh\u00e1c. \u1ede m\u1ed7i b\u01b0\u1edbc, ta ch\u1ec9 c\u00f3 th\u1ec3 gia gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm \u0111i 1 \u0111\u01a1n v\u1ecb, v\u00ec <code>arr[mid]</code> b\u1eb1ng <code>arr[start]</code> v\u00e0 kh\u00f4ng th\u1ec3 t\u00ecm v\u1ecb tr\u00ed t\u01b0\u01a1ng \u0111\u1ed1i c\u1ee7a <code>target</code> t\u1eeb <code>arr[mid]</code>. V\u00ed d\u1ee5: <code>[1, 1, 1, 1, 1, 1, 1], target = 2</code>.</p> <p>Tr\u01b0\u1eddng h\u1ee3p t\u1ed1t nh\u1ea5t: Tr\u01b0\u1eddng h\u1ee3p n\u00e0y x\u1ea3y ra khi t\u1ea5t c\u1ea3 ph\u1ea7n t\u1eed kh\u00e1c nhau. \u1ede m\u1ed7i b\u01b0\u1edbc, ta c\u00f3 th\u1ec3 chia kh\u00f4ng gian t\u00ecm ki\u1ebfm l\u00e0m \u0111\u00f4i nh\u01b0 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n b\u00ecnh th\u01b0\u1eddng</p> <p>\u0110i\u1ec1u n\u00e0y c\u0169ng gi\u1ea3i th\u00edch c\u00e2u h\u1ecfi follow-up. Ta c\u00f3 th\u1ec3 th\u1ea5y, v\u00ec c\u00f3 th\u1ec3 c\u00e1c ph\u1ea7n t\u1eed gi\u1ed1ng nhau, ta c\u00f3 th\u1ec3 l\u1ee1 m\u1ea5t c\u01a1 h\u1ed9i t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean m\u1ed9t s\u1ed1 kh\u00f4ng gian t\u00ecm ki\u1ebfm c\u1ee5 th\u1ec3. V\u00ec v\u1eady, ta t\u1ed3n \\(O(N)\\) trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t (v\u1edbi c\u00e1c ph\u1ea7n t\u1eed tr\u00f9ng nhau), v\u00e0 \\(O(\\log N)\\) trong tr\u01b0\u1eddng h\u1ee3p t\u1ed1t nh\u1ea5t (kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed tr\u00f9ng nhau).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb: \\(O(1)\\).</p>"},{"location":"LeetCode/search-in-rotated-sorted-array/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date LC 81 - Search in Rotated Sorted Array II Unavailable public link Code 08/03/2022"},{"location":"LeetCode/sorting/","title":"C\u00e1c thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp","text":""},{"location":"LeetCode/sorting/#cac-thuat-toan-sap-xep","title":"C\u00e1c thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp","text":""},{"location":"LeetCode/sorting/#nguon","title":"Ngu\u1ed3n","text":""},{"location":"LeetCode/sorting/#bubble-sort","title":"Bubble Sort","text":""},{"location":"LeetCode/sorting/#insertion-sort","title":"Insertion Sort","text":""},{"location":"LeetCode/sorting/#selection-sort","title":"Selection Sort","text":""},{"location":"LeetCode/sorting/#merge-sort","title":"Merge Sort","text":""},{"location":"LeetCode/sorting/#heap-sort","title":"Heap Sort","text":""},{"location":"LeetCode/sorting/#quick-sort","title":"Quick Sort","text":""},{"location":"LeetCode/sorting/#counting-sort","title":"Counting Sort","text":""},{"location":"LeetCode/sorting/#radix-sort","title":"Radix Sort","text":""},{"location":"LeetCode/two-sum/","title":"L\u1edbp b\u00e0i t\u1eadp Two-Sum","text":""},{"location":"LeetCode/two-sum/#lop-bai-tap-two-sum","title":"L\u1edbp b\u00e0i t\u1eadp Two-Sum","text":""},{"location":"LeetCode/two-sum/#nguon","title":"Ngu\u1ed3n","text":"<p>B\u00e0i vi\u1ebft n\u00e0y \u0111\u01b0\u1ee3c d\u1ef1a tr\u00ean editorial c\u00e1c b\u00e0i t\u1eadp c\u00f3 d\u1ea1ng Two-Sum tr\u00ean LeetCode, ngh\u0129a l\u00e0 c\u00e1c b\u00e0i to\u00e1n c\u00f3 d\u1ea1ng: Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean <code>target</code>, h\u00e3y t\u00ecm \\(X\\) s\u1ed1 trong m\u1ea3ng c\u00f3 t\u1ed5ng theo m\u1ed9t ti\u00eau ch\u00ed n\u00e0o \u0111\u00f3 so v\u1edbi <code>target</code>.</p> <p>Code c\u1ee7a c\u00e1c b\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 xem t\u1ea1i ph\u1ea7n Luy\u1ec7n t\u1eadp \u1edf d\u01b0\u1edbi c\u00f9ng.</p>"},{"location":"LeetCode/two-sum/#leetcode-1-two-sum","title":"LeetCode 1 - Two Sum","text":"<p>Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean <code>nums</code> c\u00f3 \\(N\\) ph\u1ea7n t\u1eed v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean <code>target</code>, h\u00e3y tr\u1ea3 v\u1ec1 ch\u1ec9 s\u1ed1 c\u1ee7a hai s\u1ed1 trong m\u1ea3ng c\u00f3 t\u1ed5ng b\u1eb1ng <code>target</code>. B\u1ea1n c\u00f3 th\u1ec3 gi\u1ea3 s\u1eed r\u1eb1ng m\u1ed7i input ch\u1ec9 c\u00f3 m\u1ed9t l\u1eddi gi\u1ea3i duy nh\u1ea5t v\u00e0 b\u1ea1n kh\u00f4ng th\u1ec3 d\u00f9ng c\u00f9ng m\u1ed9t ph\u1ea7n t\u1eed hai l\u1ea7n. B\u1ea1n c\u00f3 th\u1ec3 tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 theo b\u1ea5t k\u00ec th\u1ee9 t\u1ef1 n\u00e0o.</p> <p>Gi\u1edbi h\u1ea1n: \\(2 \\le N \\le 10^4\\), \\(-10^9 \\le nums_i \\le 10^9\\), \\(-10^9 \\le target \\le 10^9\\).</p> <p>Chi ti\u1ebft \u0111\u1ec1 b\u00e0i c\u00f3 th\u1ec3 xem t\u1ea1i \u0111\u00e2y.</p> L\u1eddi gi\u1ea3i <p>Ngo\u00e0i c\u00e1ch duy\u1ec7t tr\u00e2u \\(O(N^2)\\) ra, ta c\u00f3 th\u1ec3 \u0111\u1ec3 \u00fd r\u1eb1ng khi x\u00e9t m\u1ed9t s\u1ed1 \\(x\\) (\u1edf v\u1ecb tr\u00ed \\(i\\)) trong m\u1ea3ng, ta ch\u1ec9 c\u1ea7n t\u00ecm xem c\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t s\u1ed1 \\(y\\) trong m\u1ea3ng sao cho \\(x + y = target\\) hay \\(y = target - x\\). Ta c\u00f3 th\u1ec3 duy tr\u00ec m\u1ed9t hash table ch\u1ee9a c\u00e1c s\u1ed1 n\u1eb1m tr\u01b0\u1edbc v\u1ecb tr\u00ed \\(i\\) \u0111\u1ec3 t\u00ecm ki\u1ebfm \\(y\\) trong \\(O(1)\\), n\u00ean nh\u1edb l\u00e0 trung b\u00ecnh \\(O(1)\\). Nh\u01b0 v\u1eady, v\u1edbi c\u00e1ch n\u00e0y \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N)\\).</p> <p>Ngo\u00e0i ra ta c\u00f2n c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t m\u1ea3ng kh\u00e1c l\u01b0u gi\u00e1 tr\u1ecb v\u00e0 v\u1ecb tr\u00ed c\u1ee7a c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng ban \u0111\u1ea7u, s\u1eafp x\u1ebfp n\u00f3 theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n gi\u00e1 tr\u1ecb, sau \u0111\u00f3 \u0111\u1eb7t 2 con tr\u1ecf \u1edf \u0111\u1ea7u v\u00e0 cu\u1ed1i m\u1ea3ng, n\u1ebfu t\u1ed5ng gi\u00e1 tr\u1ecb c\u1ee7a hai con tr\u1ecf nh\u1ecf h\u01a1n <code>target</code> th\u00ec ta t\u0103ng con tr\u1ecf \u1edf \u0111\u1ea7u, ng\u01b0\u1ee3c l\u1ea1i ta gi\u1ea3m con tr\u1ecf \u1edf cu\u1ed1i. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N \\log N)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N)\\).</p>"},{"location":"LeetCode/two-sum/#leetcode-15-3sum","title":"LeetCode 15 - 3Sum","text":"<p>Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean <code>nums</code> c\u00f3 \\(N\\) ph\u1ea7n t\u1eed, h\u00e3y tr\u1ea3 v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9 ba s\u1ed1 kh\u00f4ng tr\u00f9ng v\u1ecb tr\u00ed v\u1edbi nhau trong m\u1ea3ng c\u00f3 t\u1ed5ng b\u1eb1ng 0. K\u1ebft qu\u1ea3 kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ee9a c\u00e1c b\u1ed9 ba s\u1ed1 tr\u00f9ng nhau v\u1ec1 m\u1eb7t gi\u00e1 tr\u1ecb, v\u00ed d\u1ee5 n\u1ebfu c\u00f3 hai b\u1ed9 ba \\([1, 2, 3]\\) th\u00ec ch\u1ec9 t\u00ednh m\u1ed9t l\u1ea7n.</p> <p>Gi\u1edbi h\u1ea1n: \\(3 \\le N \\le 3000\\), \\(-10^5 \\le nums_i \\le 10^5\\).</p> <p>Chi ti\u1ebft \u0111\u1ec1 b\u00e0i c\u00f3 th\u1ec3 xem t\u1ea1i \u0111\u00e2y.</p> L\u1eddi gi\u1ea3i <p>V\u1edbi m\u1ed7i s\u1ed1 \\(x\\) (\u1edf v\u1ecb tr\u00ed \\(i\\)) trong m\u1ea3ng, ta t\u00ecm ki\u1ebfm xem b\u00ean ph\u1ea3i n\u00f3 c\u00f3 t\u1ed3n t\u1ea1i m\u1ed9t b\u1ed9 \u0111\u00f4i \\((y, z)\\) trong m\u1ea3ng sao cho \\(y + z = -x\\) hay kh\u00f4ng. \u0110\u1ebfn \u0111\u00e2y b\u00e0i to\u00e1n l\u1ea1i tr\u1edf v\u1ec1 v\u1edbi b\u00e0i to\u00e1n Two Sum. Tuy nhi\u00ean, ta kh\u00f4ng x\u00e9t c\u00e1c s\u1ed1 \\(x\\) b\u1eb1ng nhau v\u00ec n\u00f3 s\u1ebd t\u1ea1o ra c\u00e1c b\u1ed9 ba gi\u1ed1ng nhau. \u0110\u1ec3 b\u1edbt th\u1eddi gian x\u00e9t b\u1eb1ng nhau th\u00ec ta c\u00f3 th\u1ec3 s\u1eafp x\u1ebfp m\u1ea3ng tr\u01b0\u1edbc, sau \u0111\u00f3 ta ch\u1ec9 x\u00e9t s\u1ed1 \\(x\\) m\u1ed9t l\u1ea7n khi n\u00f3 kh\u00e1c s\u1ed1 \\(x\\) \u1edf v\u1ecb tr\u00ed tr\u01b0\u1edbc \u0111\u00f3. C\u00f2n v\u1ec1 vi\u1ec7c t\u00ecm \\(y\\) v\u00e0 \\(z\\). Ta c\u00f3 th\u1ec3 t\u00ecm b\u1eb1ng hash table ho\u1eb7c 2 con tr\u1ecf nh\u01b0 \u1edf b\u00e0i Two Sum, tuy nhi\u00ean sau khi t\u00ecm \u0111\u01b0\u1ee3c m\u1ed9t b\u1ed9 ba, ta ph\u1ea3i tr\u00e1nh tr\u00f9ng l\u1eb7p b\u1eb1ng c\u00e1ch cho di chuy\u1ec3n \\(y\\) ho\u1eb7c \\(z\\) (tu\u1ef3 theo c\u00e1ch l\u00e0m) sang m\u1ed9t gi\u00e1 tr\u1ecb m\u1edbi. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N)\\).</p> <p>Ta c\u0169ng c\u00f3 th\u1ec3 l\u00e0m c\u00e1ch kh\u00f4ng s\u1eafp x\u1ebfp. \u0110\u00e1p \u00e1n c\u1ee7a ch\u00fang ta s\u1ebd l\u00e0 m\u1ed9t <code>set</code> lu\u00f4n, ta c\u0169ng duy tr\u00ec m\u1ed9t hashset \u0111\u1ec3 tr\u00e1nh tr\u00f9ng l\u1eb7p \\(x\\). Khi duy\u1ec7t t\u00ecm \\(z\\) \u1edf b\u00ean ph\u1ea3i \\(x\\), ta l\u01b0u l\u1ea1i xem ta c\u00f3 th\u1ea5y \\(y = -x - z\\) trong m\u1ed9t hash table <code>seen</code> hay ch\u01b0a, trick \u1edf \u0111\u00e2y l\u00e0 ta l\u01b0u <code>seen[nums[j]] = i</code> \u0111\u1ec3 kh\u00f4ng ph\u1ea3i xo\u00e1 hash table sau m\u1ed7i l\u1ea7n duy\u1ec7t \\(x\\). Ta c\u0169ng kh\u00f4ng c\u1ea7n ph\u1ea3i \u0111\u1ec3 \u00fd xem \\(y\\) v\u00e0 \\(z\\) c\u00f3 kh\u1ea3 n\u0103ng tr\u00f9ng kh\u00f4ng v\u00ec n\u1ebfu tr\u00f9ng th\u00ec set \u0111\u00e1p \u00e1n s\u1ebd lo. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N)\\).</p>"},{"location":"LeetCode/two-sum/#leetcode-16-3sum-closest","title":"LeetCode 16 - 3Sum Closest","text":"<p>Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean <code>nums</code> c\u00f3 \\(N\\) ph\u1ea7n t\u1eed v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean <code>target</code>, h\u00e3y tr\u1ea3 v\u1ec1 t\u1ed5ng c\u1ee7a 3 s\u1ed1 trong m\u1ea3ng c\u00f3 t\u1ed5ng g\u1ea7n nh\u1ea5t v\u1edbi <code>target</code>. Gi\u1ea3 s\u1eed r\u1eb1ng m\u1ed7i input ch\u1ec9 c\u00f3 m\u1ed9t l\u1eddi gi\u1ea3i duy nh\u1ea5t.</p> <p>Gi\u1edbi h\u1ea1n: \\(3 \\le N \\le 500\\), \\(-10^3 \\le nums_i \\le 10^3\\), \\(-10^4 \\le target \\le 10^4\\).</p> L\u1eddi gi\u1ea3i <p>\u0110\u1ea7u ti\u00ean ta s\u1eafp x\u1ebfp l\u1ea1i m\u1ea3ng, sau \u0111\u00f3 v\u1edbi m\u1ed7i gi\u00e1 tr\u1ecb \\(x\\) (\u1edf v\u1ecb tr\u00ed \\(i\\)), ta t\u00ecm xem trong ph\u1ea7n b\u00ean ph\u1ea3i c\u1ee7a \\(x\\) c\u00f3 \\(y\\) v\u00e0 \\(z\\) sao cho \\(y + z\\) g\u1ea7n nh\u1ea5t v\u1edbi \\(target - x\\) hay kh\u00f4ng. \u0110\u1ec3 t\u00ecm \\(y\\) v\u00e0 \\(z\\) ta c\u00f3 th\u1ec3 d\u00f9ng 2 con tr\u1ecf nh\u01b0 \u1edf b\u00e0i Two Sum. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(\\log N)\\) ho\u1eb7c \\(O(N)\\), tu\u1ef3 v\u00e0o thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp.</p> <p>Ngo\u00e0i ra, ta c\u0169ng c\u00f3 th\u1ec3 ch\u1eb7t nh\u1ecb ph\u00e2n t\u00ecm \\(y\\) gi\u1eefa \\(x\\) v\u00e0 \\(z\\) sau khi s\u1eafp x\u1ebfp m\u1ea3ng. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2 \\log N)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(\\log N)\\) ho\u1eb7c \\(O(N)\\), tu\u1ef3 v\u00e0o thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp.</p>"},{"location":"LeetCode/two-sum/#leetcode-259-3sum-smaller","title":"LeetCode 259 - 3Sum Smaller","text":"<p>Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean <code>nums</code> c\u00f3 \\(N\\) ph\u1ea7n t\u1eed v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean <code>target</code>, h\u00e3y tr\u1ea3 v\u1ec1 s\u1ed1 b\u1ed9 ba s\u1ed1 trong m\u1ea3ng c\u00f3 t\u1ed5ng nh\u1ecf h\u01a1n <code>target</code>.</p> <p>Gi\u1edbi h\u1ea1n: \\(0 \\le N \\le 3500\\), \\(-100 \\le nums_i \\le 100\\), \\(-100 \\le target \\le 100\\).</p> L\u1eddi gi\u1ea3i <p>Ta c\u0169ng c\u00f3 hai c\u00e1ch nh\u01b0 b\u00e0i tr\u01b0\u1edbc, v\u00e0 \u0111\u1ec1u ph\u1ea3i s\u1eafp x\u1ebfp m\u1ea3ng tr\u01b0\u1edbc khi t\u00ednh to\u00e1n.</p> <p>\u0110\u1ea7u ti\u00ean, v\u1edbi ch\u1eb7t nh\u1ecb ph\u00e2n, ta t\u00ecm \\(y\\) l\u1edbn nh\u1ea5t l\u00e0m t\u1ed5ng nh\u1ecf h\u01a1n <code>target</code>, r\u1ed3i th\u00eam \u0111o\u1ea1n t\u1eeb \\(i+1\\) \u0111\u1ebfn v\u1ecb tr\u00ed c\u1ee7a \\(y\\) v\u00e0o k\u1ebft qu\u1ea3. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2 \\log N)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(\\log N)\\) ho\u1eb7c \\(O(N)\\), tu\u1ef3 v\u00e0o thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp.</p> <p>V\u1edbi 2 con tr\u1ecf, ta \u0111\u1eb7t ch\u00fang \u1edf \\(i+1\\) v\u00e0 cu\u1ed1i m\u1ea3ng, n\u1ebfu t\u1ed5ng 3 s\u1ed1 nh\u1ecf h\u01a1n target th\u00ec ta c\u00f3 th\u1ec3 th\u00eam \u0111o\u1ea1n t\u1eeb con tr\u1ecf tr\u00e1i \u0111\u1ebfn con tr\u1ecf ph\u1ea3i v\u00e0o k\u1ebft qu\u1ea3, sau \u0111\u00f3 ta t\u0103ng con tr\u1ecf tr\u00e1i, ng\u01b0\u1ee3c l\u1ea1i ta gi\u1ea3m con tr\u1ecf ph\u1ea3i. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(\\log N)\\) ho\u1eb7c \\(O(N)\\), tu\u1ef3 v\u00e0o thu\u1eadt to\u00e1n s\u1eafp x\u1ebfp.</p>"},{"location":"LeetCode/two-sum/#leetcode-18-4sum","title":"LeetCode 18 - 4Sum","text":"<p>Cho m\u1ed9t m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean <code>nums</code> c\u00f3 \\(N\\) ph\u1ea7n t\u1eed v\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean <code>target</code>, h\u00e3y tr\u1ea3 v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c b\u1ed9 4 s\u1ed1 (ri\u00eang bi\u1ec7t v\u1ec1 v\u1ecb tr\u00ed) trong m\u1ea3ng c\u00f3 t\u1ed5ng b\u1eb1ng <code>target</code>. K\u1ebft qu\u1ea3 kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ee9a c\u00e1c b\u1ed9 4 s\u1ed1 tr\u00f9ng nhau v\u1ec1 m\u1eb7t gi\u00e1 tr\u1ecb.</p> <p>Gi\u1edbi h\u1ea1n: \\(4 \\le N \\le 200\\), \\(-10^9 \\le nums_i \\le 10^9\\), \\(-10^9 \\le target \\le 10^9\\).</p> L\u1eddi gi\u1ea3i <p>Ta gi\u1ea3i y h\u1ec7t b\u00e0i 3Sum, c\u00f3 \u0111i\u1ec1u ta c\u1ea7n duy\u1ec7t 2 v\u00f2ng l\u1eb7p ngo\u00e0i nhau \u0111\u1ec3 x\u00e9t \\(x\\) v\u00e0 \\(y\\). Hai s\u1ed1 c\u00f2n l\u1ea1i ta c\u00f3 th\u1ec3 t\u00ecm b\u1eb1ng hash table ho\u1eb7c 2 con tr\u1ecf. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^3)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N)\\).</p>"},{"location":"LeetCode/two-sum/#leetcode-454-4sum-ii","title":"LeetCode 454 - 4Sum II","text":"<p>Cho 4 m\u1ea3ng c\u00e1c s\u1ed1 nguy\u00ean <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code> c\u00f3 \\(N\\) ph\u1ea7n t\u1eed, h\u00e3y tr\u1ea3 v\u1ec1 s\u1ed1 b\u1ed9 4 v\u1ecb tr\u00ed trong 4 m\u1ea3ng c\u00f3 t\u1ed5ng b\u1eb1ng 0.</p> <p>Gi\u1edbi h\u1ea1n: \\(0 \\le N \\le 200\\), \\(-2^{28} \\le A_i, B_i, C_i, D_i \\le 2^{28}\\).</p> L\u1eddi gi\u1ea3i <p>Ta d\u00f9ng hash table \u0111\u1ec3 l\u01b0u s\u1ed1 c\u00e1c t\u1ed5ng c\u1ee7a 2 s\u1ed1 trong 2 m\u1ea3ng \u0111\u1ea7u ti\u00ean. Sau \u0111\u00f3 l\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi 2 m\u1ea3ng c\u00f2n l\u1ea1i, khi x\u00e9t th\u00ec ta t\u00ecm xem trong hash table c\u00f3 \u00e2m c\u1ee7a t\u1ed5ng \u0111ang x\u00e9t hay kh\u00f4ng, n\u1ebfu c\u00f3 th\u00ec th\u00eam v\u00e0o \u0111\u00e1p \u00e1n. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^2)\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N^2)\\).</p> <p>N\u1ebfu ng\u01b0\u1eddi ta h\u1ecfi \\(k\\) m\u1ea3ng th\u00ec sao? Ta chia s\u1ed1 m\u1ea3ng n\u00e0y ra hai ph\u1ea7n, m\u1ed9t ph\u1ea7n c\u00f3 \\(\\lfloor k/2 \\rfloor\\) m\u1ea3ng, m\u1ed9t ph\u1ea7n c\u00f3 \\(\\lceil k/2 \\rceil\\) m\u1ea3ng. Sau \u0111\u00f3 ta d\u00f9ng hash table cho m\u1ed9t ph\u1ea7n, r\u1ed3i duy\u1ec7t ph\u1ea7n c\u00f2n l\u1ea1i y h\u1ec7t nh\u01b0 tr\u00ean. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(N^{\\lceil k/2 \\rceil})\\), \u0111\u1ed9 ph\u1ee9c t\u1ea1p b\u1ed9 nh\u1edb l\u00e0 \\(O(N^{\\lceil k/2 \\rceil})\\).</p>"},{"location":"LeetCode/two-sum/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"<p>D\u01b0\u1edbi \u0111\u00e2y l\u00e0 code m\u1eabu c\u1ee7a to\u00e0n b\u1ed9 c\u00e1c c\u00e1ch gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n tr\u00ean.</p> Problem Status Submission Code Date LC 1 - Two Sum - Hash Table Approach Unavailable public link Code 20/12/2023 LC 1 - Two Sum - 2-pointer Approach Unavailable public link Code 20/12/2023 LC 15 - 3Sum - Hash Table Approach Unavailable public link Code 20/12/2023 LC 15 - 3Sum - 2-pointer Approach Unavailable public link Code 20/12/2023 LC 15 - 3Sum - No-sort Approach Unavailable public link Code 20/12/2023 LC 16 - 3Sum Closest - 2-pointer Approach Unavailable public link Code 20/12/2023 LC 16 - 3Sum Closest - Binary Search Approach Unavailable public link Code 20/12/2023 LC 259 - 3Sum Smaller - 2-pointer Approach Unavailable public link Code 20/12/2023 LC 259 - 3Sum Smaller - Binary Search Approach Unavailable public link Code 20/12/2023 LC 18 - 4Sum - Hash Table Approach Unavailable public link Code 20/12/2023 LC 18 - 4Sum - 2-pointer Approach Unavailable public link Code 20/12/2023 LC 454 - 4Sum II - 4Sum Approach Unavailable public link Code 20/12/2023 LC 454 - 4Sum II - k-Sum Approach Unavailable public link Code 20/12/2023"},{"location":"cp-algorithms/algebra/binary-exponentiation/","title":"Lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n","text":""},{"location":"cp-algorithms/algebra/binary-exponentiation/#luy-thua-nhi-phan","title":"Lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n","text":""},{"location":"cp-algorithms/algebra/binary-exponentiation/#nguon","title":"Ngu\u1ed3n","text":"<p> Binary Exponentiation</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#khai-niem","title":"Kh\u00e1i ni\u1ec7m","text":"<p>Lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n (c\u00f2n \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn l\u00e0 lu\u1ef9 th\u1eeba b\u1eb1ng b\u00ecnh ph\u01b0\u01a1ng) l\u00e0 m\u1ed9t th\u1ee7 thu\u1eadt \u0111\u1ec3 t\u00ednh \\(a^n\\) m\u00e0 ch\u1ec9 s\u1eed d\u1ee5ng \\(O(\\log n)\\) ph\u00e9p nh\u00e2n (thay v\u00ec \\(O(n)\\) ph\u00e9p nh\u00e2n nh\u01b0 trong c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u0111\u01a1n gi\u1ea3n).</p> <p>N\u00f3 c\u00f2n c\u00f3 nh\u1eefng \u1ee9ng d\u1ee5ng quan tr\u1ecdng trong r\u1ea5t nhi\u1ec1u v\u1ea5n \u0111\u1ec1 kh\u00f4ng li\u00ean quan \u0111\u1ebfn s\u1ed1 h\u1ecdc, v\u00ec n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong b\u1ea5t k\u00ec ph\u00e9p to\u00e1n n\u00e0o c\u00f3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p:</p> \\[(X \\cdot Y) \\cdot Z = X \\cdot (Y \\cdot Z)\\] <p>R\u00f5 r\u00e0ng nh\u1ea5t l\u00e0 n\u00f3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng cho ph\u00e9p nh\u00e2n modulo, ph\u00e9p nh\u00e2n ma tr\u1eadn v\u00e0 c\u00e1c b\u00e0i to\u00e1n kh\u00e1c m\u00e0 ch\u00fang ta s\u1ebd th\u1ea3o lu\u1eadn d\u01b0\u1edbi \u0111\u00e2y.</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#thuat-toan","title":"Thu\u1eadt to\u00e1n","text":"<p>\\(a^n\\) \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ecb \u0111\u01a1n gi\u1ea3n l\u00e0 nh\u00e2n \\(a\\) \\(n-1\\) l\u1ea7n: \\(a^{n} = a \\cdot a \\cdot \\ldots \\cdot a\\). Nh\u01b0ng r\u00f5 r\u00e0ng c\u00e1ch n\u00e0y kh\u00f4ng h\u1eefu d\u1ee5ng v\u1edbi \\(a\\) l\u1edbn ho\u1eb7c \\(n\\) l\u1edbn.</p> <p>\\(a^{b+c} = a^b \\cdot a^c\\) v\u00e0 \\(a^{2b} = a^b \\cdot a^b = (a^b)^2\\).</p> <p>\u00dd t\u01b0\u1edfng c\u1ee7a lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n l\u00e0 vi\u1ec7c ch\u00fang ta bi\u1ec3u di\u1ec5n s\u1ed1 m\u0169 th\u00e0nh d\u1ea1ng nh\u1ecb ph\u00e2n c\u1ee7a n\u00f3, ti\u1ebfn h\u00e0nh t\u00ednh t\u1eebng bit 1 theo h\u1ec7 th\u1eadp ph\u00e2n v\u00e0 nh\u00e2n l\u1ea1i v\u1edbi nhau.</p> <p>V\u00ed d\u1ee5 ta bi\u1ec3u di\u1ec5n \\(n\\) theo h\u1ec7 nh\u1ecb ph\u00e2n, ta c\u00f3:</p> \\[3^{13} = 3^{1101_2} = 3^8 \\cdot 3^4 \\cdot 3^1\\] <p>V\u00ec s\u1ed1 \\(n\\) c\u00f3 \\(\\lfloor \\log_2 n \\rfloor + 1\\) ch\u1eef s\u1ed1 khi bi\u1ec3u di\u1ec5n \u1edf h\u1ec7 nh\u1ecb ph\u00e2n, ta ch\u1ec9 c\u1ea7n d\u00f9ng \\(O(\\log n)\\) ph\u00e9p nh\u00e2n, n\u1ebfu ta bi\u1ebft k\u1ebft qu\u1ea3 c\u1ee7a \\(a^1, a^2, a^4, a^8, \\dots, a^{2^{\\lfloor \\log n \\rfloor}}\\).</p> <p>V\u1eady ta ch\u1ec9 c\u1ea7n bi\u1ebft c\u00e1ch t\u00ednh nhanh c\u1ee7a nh\u1eefng s\u1ed1 m\u0169 tr\u00ean. Th\u1eadt may \u0111i\u1ec1u n\u00e0y r\u1ea5t \u0111\u01a1n gi\u1ea3n, v\u00ec m\u1ed7i s\u1ed1 trong d\u00e3y tr\u00ean l\u00e0 b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a s\u1ed1 ngay tr\u01b0\u1edbc n\u00f3 trong d\u00e3y.</p> \\[\\begin{align} 3^1 &amp;= 3 \\\\ 3^2 &amp;= \\left(3^1\\right)^2 = 3^2 = 9 \\\\ 3^4 &amp;= \\left(3^2\\right)^2 = 9^2 = 81 \\\\ 3^8 &amp;= \\left(3^4\\right)^2 = 81^2 = 6561 \\end{align}\\] <p>V\u1eady \u0111\u1ec3 t\u00ednh \\(3^{13}\\), ta ch\u1ec9 c\u1ea7n nh\u00e2n 3 trong s\u1ed1 c\u00e1c s\u1ed1 tr\u00ean (b\u1ecf qua \\(3^2\\) v\u00ec bit t\u01b0\u01a1ng \u1ee9ng trong \\(n\\) kh\u00f4ng c\u00f3): \\(3^{13} = 6561 \\cdot 81 \\cdot 3 = 1594323\\)</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(\\log n)\\): ta c\u1ea7n t\u00ednh \\(\\log n\\) s\u1ed1 m\u0169 c\u1ee7a \\(a\\), v\u00e0 sau \u0111\u00f3 ta ph\u1ea3i th\u1ef1c hi\u1ec7n nhi\u1ec1u nh\u1ea5t \\(\\log n\\) ph\u00e9p nh\u00e2n \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng.</p> <p>C\u00f4ng th\u1ee9c sau c\u0169ng bi\u1ec3u th\u1ecb \u00fd t\u01b0\u1edfng \u1edf tr\u00ean:</p> \\[a^n = \\begin{cases} 1 &amp;\\text{n\u1ebfu } n == 0 \\\\ \\left(a^{\\frac{n}{2}}\\right)^2 &amp;\\text{n\u1ebfu } n &gt; 0 \\text{ v\u00e0 } n \\text{ ch\u1eb5n}\\\\ \\left(a^{\\frac{n - 1}{2}}\\right)^2 \\cdot a &amp;\\text{n\u1ebfu } n &gt; 0 \\text{ v\u00e0 } n \\text{ l\u1ebb}\\\\ \\end{cases}\\]"},{"location":"cp-algorithms/algebra/binary-exponentiation/#cai-at","title":"C\u00e0i \u0111\u1eb7t","text":"<p>\u0110\u1ea7u ti\u00ean l\u00e0 c\u00e1ch c\u00e0i \u0111\u1ec7 quy, c\u0169ng l\u00e0 \u0111\u1ec3 bi\u1ec3u th\u1ecb cho c\u00f4ng th\u1ee9c \u0111\u1ec7 quy \u1edf tr\u00ean</p> <pre><code>long long binpow(long long a, long long b) {\n    if (b == 0)\n        return 1;\n    long long res = binpow(a, b / 2);\n    if (b % 2)\n        return res * res * a;\n    else\n        return res * res;\n}\n</code></pre> <p>C\u00e1ch th\u1ee9 2 ch\u00fang ta l\u00e0m kh\u00f4ng d\u00f9ng \u0111\u1ec7 quy. N\u00f3 t\u00ednh t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 m\u0169 trong m\u1ed9t v\u00f2ng l\u1eb7p, v\u00e0 nh\u00e2n v\u00e0o k\u1ebft qu\u1ea3 khi bit t\u01b0\u01a1ng \u1ee9ng c\u1ee7a \\(n\\) \u0111\u01b0\u1ee3c set. M\u1eb7c d\u00f9 \u0111\u1ed9 ph\u1ee9c t\u1ea1p nh\u01b0 nhau, c\u00e1ch n\u00e0y s\u1ebd nhanh h\u01a1n c\u00e1ch \u0111\u1ea7u ti\u00ean m\u1ed9t ch\u00fat trong th\u1ef1c t\u1ebft v\u00ec n\u00f3 kh\u00f4ng c\u00f3 c\u00e1c hao ph\u00ed c\u1ee7a vi\u1ec7c g\u1ecdi \u0111\u1ec7 quy.</p> <pre><code>long long binpow(long long a, long long b) {\n    long long res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1)\n            res = res * a;\n        a = a * a;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#ung-dung","title":"\u1ee8ng d\u1ee5ng","text":""},{"location":"cp-algorithms/algebra/binary-exponentiation/#tinh-nhanh-so-mu-modulo-mot-so-khac","title":"T\u00ednh nhanh s\u1ed1 m\u0169 modulo m\u1ed9t s\u1ed1 kh\u00e1c","text":"<p>B\u00e0i to\u00e1n: T\u00ednh \\(x^n \\bmod m\\). \u0110\u00e2y l\u00e0 m\u1ed9t b\u00e0i r\u1ea5t ph\u1ed5 bi\u1ebfn. V\u00ed d\u1ee5 nh\u01b0 n\u00f3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 t\u00ednh ngh\u1ecbch \u0111\u1ea3o modulo.</p> <p>L\u1eddi gi\u1ea3i: V\u00ec ta bi\u1ebft r\u1eb1ng to\u00e1n t\u1eed modulo kh\u00f4ng can thi\u1ec7p v\u00e0o c\u00e1c ph\u00e9p nh\u00e2n (\\(a \\cdot b \\equiv (a \\bmod m) \\cdot (b \\bmod m) \\pmod m\\)), ta c\u00f3 th\u1ec3 d\u00f9ng l\u1ea1i code \u1edf tr\u00ean, ch\u1ec9 c\u1ea7n thay th\u1ebf m\u1ed7i ph\u00e9p nh\u00e2n b\u1eb1ng ph\u00e9p nh\u00e2n modulo:</p> <pre><code>long long binpow(long long a, long long b, long long m) {\n    a %= m;\n    long long res = 1;\n    while (b &gt; 0) {\n        if (b &amp; 1)\n            res = res * a % m;\n        a = a * a % m;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre> <p>L\u01b0u \u00fd: N\u1ebfu \\(m\\) l\u00e0 s\u1ed1 nguy\u00ean t\u1ed1, ta c\u00f3 th\u1ec3 t\u0103ng t\u1ed1c t\u00ednh to\u00e1n m\u1ed9t ch\u00fat b\u1eb1ng c\u00e1ch t\u00ednh \\(x^{n \\bmod (m-1)}\\) thay v\u00ec t\u00ednh \\(x ^ n\\). \u0110\u00e2y l\u00e0 \u1ee9ng d\u1ee5ng c\u1ee7a \u0110\u1ecbnh l\u00fd Fermat nh\u1ecf</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#tinh-nhanh-so-fibonacci","title":"T\u00ednh nhanh s\u1ed1 Fibonacci","text":"<p>B\u00e0i to\u00e1n: T\u00ednh s\u1ed1 Fibonacci th\u1ee9 \\(n\\) (\\(F_n\\)).</p> <p>L\u1eddi gi\u1ea3i:  \u1ede \u0111\u00e2y ch\u00fang ta s\u1ebd ch\u1ec9 \u0111i s\u01a1 l\u01b0\u1ee3c v\u1ec1 thu\u1eadt to\u00e1n. N\u1ebfu b\u1ea1n mu\u1ed1n t\u00ecm hi\u1ec3u th\u00eam, xin h\u00e3y \u0111\u1ecdc b\u00e0i S\u1ed1 Fibonacci. \u0110\u1ec3 t\u00ednh s\u1ed1 Fibonacci ti\u1ebfp theo, ta ch\u1ec9 c\u1ea7n 2 s\u1ed1 tr\u01b0\u1edbc \u0111\u00f3, v\u00ec \\(F_n = F_{n-1} + F_{n-2}\\). Ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t ma tr\u1eadn \\(2 \\times 2\\) \u0111\u1ec3 m\u00f4 t\u1ea3 s\u1ef1 bi\u1ebfn \u0111\u1ed5i nh\u01b0 sau: s\u1ef1 chuy\u1ec3n ti\u1ebfp t\u1eeb \\(F_i\\) v\u00e0 \\(F_{i+1}\\) sang \\(F_{i+1}\\) v\u00e0 \\(F_{i+2}\\). V\u00ed d\u1ee5, sau khi d\u00f9ng ph\u00e9p bi\u1ebfn \u0111\u1ed5i n\u00e0y, c\u1eb7p \\(F_0\\) v\u00e0 \\(F_1\\) s\u1ebd chuy\u1ec3n th\u00e0nh \\(F_1\\) v\u00e0 \\(F_2\\). V\u00ec v\u1eady, ta c\u00f3 th\u1ec3 lu\u1ef9 th\u1eeba ph\u00e9p bi\u1ebfn \u0111\u1ed5i n\u00e0y l\u00ean m\u0169 \\(n\\) \u0111\u1ec3 t\u00ecm \\(F_n\\) trong \u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(\\log n)\\).</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#hoan-vi-k-lan","title":"Ho\u00e1n v\u1ecb \\(k\\) l\u1ea7n","text":"<p>B\u00e0i to\u00e1n: Cho d\u00e3y \u0111\u1ed9 d\u00e0i \\(n\\). Ho\u00e1n v\u1ecb \\(k\\) l\u1ea7n d\u00e3y \u0111\u00f3 b\u1eb1ng m\u1ed9t ho\u00e1n v\u1ecb kh\u00e1c</p> <p>L\u1eddi gi\u1ea3i: Ho\u00e1n v\u1ecb c\u00e1i ho\u00e1n v\u1ecb \u0111\u01b0\u1ee3c cho l\u00ean \\(k\\) l\u1ea7n d\u00f9ng lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n, sau \u0111\u00f3 \u00e1p d\u1ee5ng l\u00ean d\u00e3y \u0111\u1ed9 d\u00e0i \\(n\\) \u0111\u00e3 cho. \u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a l\u1eddi gi\u1ea3i n\u00e0y l\u00e0 \\(O(n \\log k)\\).</p> <pre><code>vector&lt;int&gt; applyPermutation(vector&lt;int&gt; sequence, vector&lt;int&gt; permutation) {\n    vector&lt;int&gt; newSequence(sequence.size());\n    for(int i = 0; i &lt; sequence.size(); i++) {\n        newSequence[permutation[i]] = sequence[i];\n    }\n    return newSequence;\n}\n\nvector&lt;int&gt; permute(vector&lt;int&gt; sequence, vector&lt;int&gt; permutation, long long b) {\n    while (b &gt; 0) {\n        if (b &amp; 1) {\n            sequence = applyPermutation(sequence, permutation);\n        }\n        permutation = applyPermutation(permutation, permutation);\n        b &gt;&gt;= 1;\n    }\n    return sequence;\n}\n</code></pre> <p>L\u01b0u \u00fd: B\u00e0i to\u00e1n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 h\u01a1n v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p tuy\u1ebfn t\u00ednh b\u1eb1ng c\u00e1ch t\u1ea1o m\u1ed9t \u0111\u1ed3 th\u1ecb ho\u00e1n v\u1ecb v\u00e0 x\u00e9t t\u1eebng chu tr\u00ecnh ri\u00eang l\u1ebb. Sau \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 t\u00ednh modulo \\(k\\) k\u00edch th\u01b0\u1edbc c\u1ee7a chu k\u1ef3 v\u00e0 t\u00ecm v\u1ecb tr\u00ed cu\u1ed1i c\u00f9ng c\u1ee7a m\u1ed7i s\u1ed1 n\u1eb1m trong chu tr\u00ecnh \u0111\u00f3.</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#ap-dung-nhanh-mot-nhom-cac-phep-toan-hinh-hoc-len-mot-nhom-cac-iem","title":"\u00c1p d\u1ee5ng nhanh m\u1ed9t nh\u00f3m c\u00e1c ph\u00e9p to\u00e1n h\u00ecnh h\u1ecdc l\u00ean m\u1ed9t nh\u00f3m c\u00e1c \u0111i\u1ec3m","text":"<p>B\u00e0i to\u00e1n: Cho \\(n\\) \u0111i\u1ec3m \\(p_i\\), \u00e1p d\u1ee5ng \\(m\\) ph\u00e9p bi\u1ebfn \u0111\u1ed5i cho m\u1ed7i \u0111i\u1ec3m n\u00e0y. M\u1ed7i ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 l\u00e0 ph\u00e9p d\u1ecbch chuy\u1ec3n, ph\u00e9p nh\u00e2n to\u1ea1 \u0111\u1ed9, ho\u1eb7c ph\u00e9p xoay quanh m\u1ed9t tr\u1ee5c to\u1ea1 \u0111\u1ed9 theo m\u1ed9t g\u00f3c cho tr\u01b0\u1edbc. Ngo\u00e0i ra c\u0169ng c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t \"v\u00f2ng l\u1eb7p\" bao g\u1ed3m m\u1ed9t s\u1ed1 ph\u00e9p bi\u1ebfn \u0111\u1ed5i v\u00e0 v\u00f2ng l\u1eb7p \u0111\u00f3 \u0111\u01b0\u1ee3c l\u1eb7p \\(k\\) l\u1ea7n (th\u1eadm ch\u00ed c\u00e1c v\u00f2ng l\u1eb7p c\u00f3 th\u1ec3 l\u1ed3ng nhau). \u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a b\u00e0i to\u00e1n n\u00ean l\u00e0 \\(O(n \\cdot length)\\) trong \u0111\u00f3 \\(length\\) l\u00e0 t\u1ed5ng s\u1ed1 c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n (sau khi m\u1edf c\u00e1c v\u00f2ng l\u1eb7p).</p> <p>Solution: Ch\u00fang ta h\u00e3y xem c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i thay \u0111\u1ed5i to\u1ea1 \u0111\u1ed9 c\u1ee7a m\u1ed9t \u0111i\u1ec3m nh\u01b0 th\u1ebf n\u00e0o</p> <ul> <li>Ph\u00e9p d\u1ecbch chuy\u1ec3n: Th\u00eam m\u1ed9t h\u1eb1ng s\u1ed1 v\u00e0o m\u1ed7i to\u1ea1 \u0111\u1ed9.</li> <li>Ph\u00e9p nh\u00e2n to\u1ea1 \u0111\u1ed9: Nh\u00e2n m\u1ed7i to\u1ea1 \u0111\u1ed9 v\u1edbi m\u1ed9t h\u1eb1ng s\u1ed1 kh\u00e1c nhau.</li> <li>Ph\u00e9p xoay: ph\u00e9p n\u00e0y s\u1ebd h\u01a1i ph\u1ee9c t\u1ea1p m\u1ed9t ch\u00fat (ch\u00fang ta s\u1ebd kh\u00f4ng \u0111i s\u00e2u v\u00e0o n\u00f3), nh\u01b0ng m\u1ed7i to\u1ea1 \u0111\u1ed9 c\u1ee7a \u0111i\u1ec3m s\u1ebd \u0111\u01b0\u1ee3c th\u1ec3 hi\u1ec7n b\u1eb1ng m\u1ed9t h\u00e0m tuy\u1ebfn t\u00ednh c\u1ee7a to\u1ea1 \u0111\u1ed9 tr\u01b0\u1edbc.</li> </ul> <p>Nh\u01b0 c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y, m\u1ed7i ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ec3 hi\u1ec7n b\u1eb1ng m\u1ed9t h\u00e0m tuy\u1ebfn t\u00ednh tr\u00ean c\u00e1c to\u1ea1 \u0111\u1ed9 \u0111i\u1ec3m. V\u00ec v\u1eady, m\u1ed9t ph\u00e9p bi\u1ebfn \u0111\u1ed5i c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft ra m\u1ed9t ma tr\u1eadn \\(4 \\times 4\\) nh\u01b0 sau:</p> \\[\\begin{pmatrix} a_{11} &amp; a_ {12} &amp; a_ {13} &amp; a_ {14} \\\\ a_{21} &amp; a_ {22} &amp; a_ {23} &amp; a_ {24} \\\\ a_{31} &amp; a_ {32} &amp; a_ {33} &amp; a_ {34} \\\\ a_{41} &amp; a_ {42} &amp; a_ {43} &amp; a_ {44} \\end{pmatrix}\\] <p>L\u00fac \u0111\u00f3, khi \u0111\u01b0\u1ee3c nh\u00e2n v\u1edbi m\u1ed9t vector v\u1edbi c\u00e1c to\u1ea1 \u0111\u1ed9 \u0111i\u1ec3m v\u00e0 m\u1ed9t s\u1ed1 \u0111\u01a1n v\u1ecb (1) th\u00ec ta c\u0169ng nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t vector m\u1edbi v\u1edbi to\u1ea1 \u0111\u1ed9 \u0111i\u1ec3m m\u1edbi v\u00e0 m\u1ed9t s\u1ed1 \u0111\u01a1n v\u1ecb.</p> \\[\\begin{pmatrix} x &amp; y &amp; z &amp; 1 \\end{pmatrix} \\cdot \\begin{pmatrix} a_{11} &amp; a_ {12} &amp; a_ {13} &amp; a_ {14} \\\\ a_{21} &amp; a_ {22} &amp; a_ {23} &amp; a_ {24} \\\\ a_{31} &amp; a_ {32} &amp; a_ {33} &amp; a_ {34} \\\\ a_{41} &amp; a_ {42} &amp; a_ {43} &amp; a_ {44} \\end{pmatrix}  = \\begin{pmatrix} x' &amp; y' &amp; z' &amp; 1 \\end{pmatrix}\\] <p>(T\u1ea1i sao c\u1ea7n chi\u1ec1u th\u1ee9 4 v\u00e2y? V\u00ec n\u1ebfu kh\u00f4ng c\u00f3 n\u00f3, ch\u00f9ng ta kh\u00f4ng th\u1ec3 l\u00e0m ph\u00e9p d\u1ecbch chuy\u1ec3n \u0111\u01b0\u1ee3c. Ph\u00e9p n\u00e0y y\u00eau c\u1ea7u ch\u00fang ta th\u00eam m\u1ed9t h\u1eb1ng s\u1ed1 v\u00e0o c\u00e1c to\u1ea1 \u0111\u1ed9 \u0111i\u1ec3m. N\u1ebfu kh\u00f4ng c\u00f3 chi\u1ec1u th\u1ee9 4, ch\u00f9ng ta s\u1ebd ch\u1ec9 \u00e1p d\u1ee5ng \u0111\u01b0\u1ee3c c\u00e1c ph\u00e9p k\u1ebft h\u1ee3p tuy\u1ebfn t\u00ednh v\u00e0o th\u00f4i, kh\u00f4ng th\u00eam h\u1eb1ng s\u1ed1 v\u00e0o \u0111\u01b0\u1ee3c.)</p> <p>Sau \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 chuy\u1ec3n ph\u00e9p bi\u1ebfn \u0111\u1ed5i th\u00e0nh ma tr\u1eadn:</p> <ul> <li>Ph\u00e9p d\u1ecbch chuy\u1ec3n: d\u1ecbch chuy\u1ec3n \\(x\\) l\u00ean \\(5\\), \\(y\\) l\u00ean \\(7\\) v\u00e0 \\(z\\) l\u00ean \\(9\\).</li> </ul> \\[\\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 \\\\ 5 &amp; 7 &amp; 9 &amp; 1 \\end{pmatrix}\\] <ul> <li>Ph\u00e9p nh\u00e2n to\u1ea1 \u0111\u1ed9: nh\u00e2n to\u1ea1 \u0111\u1ed9 \\(x\\) l\u00ean \\(10\\) v\u00e0 \\(y\\), \\(z\\) l\u00ean \\(5\\).</li> </ul> \\[\\begin{pmatrix} 10 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 5 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 5 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}\\] <ul> <li>Ph\u00e9p xoay: xoay \\(\\theta\\) \u0111\u1ed9 quanh tr\u1ee5c \\(x\\) theo quy t\u1eafc b\u00e0n tay ph\u1ea3i (h\u01b0\u1edbng ng\u01b0\u1ee3c chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3).</li> </ul> \\[\\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; \\cos \\theta &amp; -\\sin \\theta &amp; 0 \\\\ 0 &amp; \\sin \\theta &amp; \\cos \\theta &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}\\] <p>B\u00e2y gi\u1edd, m\u1ed9t ph\u00e9p bi\u1ebfn \u0111\u1ed5i \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi m\u1ed9t ma tr\u1eadn, d\u00e3y ph\u00e9p bi\u1ebfn \u0111\u1ed5i s\u1ebd \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi t\u00edch c\u00e1c ma tr\u1eadn \u0111\u00f3, v\u00e0 m\u1ed9t v\u00f2ng l\u1eb7p \\(k\\) \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1edfi ma tr\u1eadn lu\u1ef9 th\u1eeba \\(k\\) (d\u1ec5 d\u00e0ng t\u00ednh \u0111\u01b0\u1ee3c n\u1ebfu d\u00f9ng lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n trong \\(O(\\log{k})\\)). B\u1eb1ng c\u00e1ch n\u00e0y, ma tr\u1eadn bi\u1ec3u di\u1ec5n t\u1ea5t c\u1ea3 c\u00e1c ph\u00e9p bi\u1ebfn \u0111\u1ed5i s\u1ebd \u0111\u01b0\u1ee3c t\u00ednh trong \\(O(m \\log{k})\\), sau \u0111\u00f3 n\u00f3 s\u1ebd \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng v\u00e0o t\u1eebng \u0111i\u1ec3m trong s\u1ed1 \\(n\\) \u0111i\u1ec3m trong \\(O(n)\\) v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng l\u00e0 \\(O(n + m \\log{k})\\).</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#so-uong-i-o-dai-k-trong-o-thi","title":"S\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u1ed9 d\u00e0i \\(k\\) trong \u0111\u1ed3 th\u1ecb","text":"<p>B\u00e0i to\u00e1n: Cho \u0111\u1ed3 th\u1ecb c\u00f3 h\u01b0\u1edbng kh\u00f4ng tr\u1ecdng s\u1ed1 g\u1ed3m \\(n\\) \u0111\u1ec9nh, t\u00ecm s\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u1ed9 d\u00e0i \\(k\\) t\u1eeb b\u1ea5t k\u1ef3 \u0111\u1ec9nh \\(u\\) n\u00e0o \u0111\u1ebfn b\u1ea5t k\u1ef3 \u0111\u1ec9nh \\(v\\) n\u00e0o.</p> <p>L\u1eddi gi\u1ea3i: B\u00e0i n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ec3 c\u1eadp k\u1ef9 h\u01a1n trong m\u1ed9t b\u00e0i vi\u1ebft kh\u00e1c. Thu\u1eadt to\u00e1n bao g\u1ed3m vi\u1ec7c lu\u1ef9 th\u1eeba ma tr\u1eadn k\u1ec1 \\(M\\) c\u1ee7a \u0111\u1ed3 th\u1ecb (ma tr\u1eadn c\u00f3 \\(m_{ij} = 1\\) n\u1ebfu c\u00f3 c\u1ea1nh t\u1eeb \\(i\\) \u0111\u1ebfn \\(j\\), ho\u1eb7c \\(0\\) n\u1ebfu kh\u00f4ng c\u00f3) l\u00ean m\u0169 \\(k\\). Gi\u1edd \\(m_{ij}\\) s\u1ebd l\u00e0 s\u1ed1 \u0111\u01b0\u1eddng \u0111i \u0111\u1ed9 d\u00e0i \\(k\\) t\u1eeb \\(i\\) \u0111\u1ebfn \\(j\\). \u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y l\u00e0 \\(O(n^3 \\log k)\\).</p> <p>L\u01b0u \u00fd: Trong c\u00f9ng b\u00e0i vi\u1ebft \u0111\u00f3, m\u1ed9t bi\u1ebfn th\u1ec3 kh\u00e1c c\u1ee7a b\u00e0i n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c nh\u1eafc \u0111\u1ebfn: khi c\u00e1c c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 v\u00e0 b\u1ea1n c\u1ea7n ph\u1ea3i t\u00ecm \u0111\u01b0\u1eddng \u0111i c\u00f3 tr\u1ecdng s\u1ed1 nh\u1ecf nh\u1ea5t m\u00e0 c\u00f3 \\(k\\) c\u1ea1nh. B\u00e0i n\u00e0y c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng vi\u1ec7c lu\u1ef9 th\u1eeba ma tr\u1eadn k\u1ec1. Ma tr\u1eadn s\u1ebd c\u00f3 tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh t\u1eeb \\(i\\) \u0111\u1ebfn \\(j\\), ho\u1eb7c \\(\\infty\\) n\u1ebfu kh\u00f4ng c\u00f3 c\u1ea1nh nh\u01b0 v\u1eady. B\u1ea1n c\u0169ng ph\u1ea3i d\u00f9ng m\u1ed9t to\u00e1n t\u1eed kh\u00e1c \u0111\u1ec3 nh\u00e2n 2 ma tr\u1eadn: 2 gi\u00e1 tr\u1ecb \u0111\u01b0\u1ee3c c\u1ed9ng v\u00e0o nhau v\u00e0 sau \u0111\u00f3 l\u1ea5y min (thay v\u00ec nh\u00e2n v\u00e0 c\u1ed9ng nh\u01b0 nh\u00e2n ma tr\u1eadn b\u00ecnh th\u01b0\u1eddng). Ngh\u0129a l\u00e0: \\(result_{ij} = \\min\\limits_{1\\ \\leq\\ k\\ \\leq\\ n}(a_{ik} + b_{kj})\\).</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#bien-the-cua-luy-thua-nhi-phan-nhan-2-so-modulo-m","title":"Bi\u1ebfn th\u1ec3 c\u1ee7a lu\u1ef9 th\u1eeba nh\u1ecb ph\u00e2n: nh\u00e2n 2 s\u1ed1 modulo \\(m\\)","text":"<p>B\u00e0i to\u00e1n: Nh\u00e2n 2 s\u1ed1 \\(a\\) v\u00e0 \\(b\\) modulo \\(m\\). Cho \\(a\\) v\u00e0 \\(b\\) n\u1eb1m trong c\u00e1c ki\u1ec3u d\u1eef li\u1ec7u c\u00f3 s\u1eb5n trong ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh, nh\u01b0ng t\u00edch c\u1ee7a ch\u00fang to h\u01a1n s\u1ed1 64-bit. \u00dd t\u01b0\u1edfng l\u00e0 t\u00ednh \\(a \\cdot b \\pmod m\\) m\u00e0 kh\u00f4ng d\u00f9ng x\u1eed l\u00fd s\u1ed1 l\u1edbn.</p> <p>L\u1eddi gi\u1ea3i: Ch\u00fang ta s\u1ebd d\u00f9ng c\u00e1ch x\u00e2y d\u1ef1ng nh\u1ecb ph\u00e2n \u1edf tr\u00ean, v\u00e0 ch\u1ec9 d\u00f9ng ph\u00e9p c\u1ed9ng thay v\u00ec ph\u00e9p nh\u00e2n. N\u00f3i c\u00e1ch kh\u00e1c, ch\u00fang ta m\u1edf r\u1ed9ng ph\u00e9p nh\u00e2n 2 s\u1ed1 th\u00e0nh \\(O (\\log m)\\) ph\u00e9p c\u1ed9ng v\u00e0 nh\u00e2n \u0111\u00f4i (m\u00e0 th\u1ef1c ra v\u1eabn l\u00e0 ph\u00e9p c\u1ed9ng 2 s\u1ed1 gi\u1ed1ng nhau th\u00f4i).</p> \\[a \\cdot b = \\begin{cases} 0 &amp;\\text{n\u1ebfu }a = 0 \\\\ 2 \\cdot \\frac{a}{2} \\cdot b &amp;\\text{n\u1ebfu }a &gt; 0 \\text{ v\u00e0 }a \\text{ ch\u1eb5n} \\\\ 2 \\cdot \\frac{a-1}{2} \\cdot b + b &amp;\\text{n\u1ebfu }a &gt; 0 \\text{ v\u00e0 }a \\text{ l\u1ebb} \\end{cases}\\] <p>L\u01b0u \u00fd: B\u1ea1n c\u00f3 th\u1ec3 gi\u1ea3i b\u00e0i n\u00e0y b\u1eb1ng c\u00e1ch d\u00f9ng c\u00e1c ph\u00e9p to\u00e1n li\u00ean quan \u0111\u1ebfn d\u1ea5u ch\u1ea5m \u0111\u1ed9ng. \u0110\u1ea7u ti\u00ean t\u00ednh \\(\\frac{a \\cdot b}{m}\\) d\u00f9ng s\u1ed1 th\u1ef1c v\u00e0 \u00e9p ki\u1ec3u n\u00f3 v\u1ec1 s\u1ed1 nguy\u00ean (unsigned) \\(q\\). L\u1ea5y \\(a \\cdot b\\) tr\u1eeb \\(q \\cdot m\\) d\u00f9ng c\u00e1c to\u00e1n t\u1eed s\u1ed1 nguy\u00ean (unsigned) v\u00e0 modulo \\(m\\) k\u1ebft qu\u1ea3 \u0111\u1ec3 t\u00ecm ra \u0111\u00e1p \u00e1n. L\u1eddi gi\u1ea3i n\u00e0y nghe c\u00f3 v\u1ebb kh\u00f4ng \u0111\u00e1ng tin l\u1eafm, nh\u01b0ng n\u00f3 r\u1ea5t nhanh v\u00e0 r\u1ea5t d\u1ec5 c\u00e0i \u0111\u1eb7t. \u0110\u1ecdc \u1edf \u0111\u00e2y \u0111\u1ec3 bi\u1ebft th\u00eam th\u00f4ng tin.</p>"},{"location":"cp-algorithms/algebra/binary-exponentiation/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date UVa 1230 - MODEX Unavailable public link Code 03/10/2019 UVa 374 - Big Mod Unavailable public link Code 03/10/2019 UVa 11029 - Leading and Trailing Unavailable public link Code 04/10/2019 Codeforces - Parking Lot Submission Code 09/10/2019 SPOJ - LASTDIG Unavailable public link Code 04/10/2019 SPOJ - LOCKER Unavailable public link Code 12/10/2019 LA - 3722 Jewel-eating Monsters Unavailable public link Code 21/03/2020 SPOJ - ZSUM Unavailable public link Code 21/03/2020 Codechef RIFFLES Submission Code 11/10/2022 Leetcode - Count good numbers Unavailable public link Code 11/10/2022"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/","title":"Minimum Stack / Minimum Queue","text":""},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#minimum-stack-minimum-queue","title":"Minimum Stack / Minimum Queue","text":""},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#nguon","title":"Ngu\u1ed3n","text":"<p> Minimum stack / Minimum queue</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y ch\u00fang ta s\u1ebd xem x\u00e9t 3 b\u00e0i to\u00e1n: b\u00e0i \u0111\u1ea7u ti\u00ean ta s\u1ebd bi\u1ebfn \u0111\u1ed5i m\u1ed9t stack sao cho n\u00f3 c\u00f3 th\u1ec3 t\u00ecm min c\u1ee7a stack trong \\(O(1)\\), sau \u0111\u00f3 ta l\u00e0m \u0111i\u1ec1u t\u01b0\u01a1ng t\u1ef1 v\u1edbi queue, cu\u1ed1i c\u00f9ng ta s\u1ebd d\u00f9ng nh\u1eefng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u00f3 \u0111\u1ec3 t\u00ecm min c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y con \u0111\u1ed9 d\u00e0i \\(M\\) kh\u00f4ng \u0111\u1ed5i c\u1ee7a m\u1ea3ng trong \\(O(n)\\).</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#bien-oi-stack","title":"Bi\u1ebfn \u0111\u1ed5i stack","text":"<p>Ta mu\u1ed1n bi\u1ebfn \u0111\u1ed5i c\u1ea5u tr\u00fac d\u1eef li\u1ec7u stack m\u00e0 n\u00f3 c\u00f3 th\u1ec3 t\u00ecm min c\u1ee7a stack trong th\u1eddi gian \\(O(1)\\) m\u00e0 v\u1eabn gi\u1eef c\u00e1c t\u00ednh ch\u1ea5t t\u01b0\u01a1ng t\u1ef1 stack b\u00ecnh th\u01b0\u1eddng trong vi\u1ec7c th\u00eam v\u00e0 b\u1edbt \u0111i ph\u1ea7n t\u1eed. M\u1ed9t l\u01b0u \u00fd nh\u1ecf l\u00e0 trong stack ta ch\u1ec9 th\u00eam v\u00e0 b\u1edbt ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng.</p> <p>\u0110\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c vi\u1ec7c n\u00e0y, ta s\u1ebd kh\u00f4ng ch\u1ec9 l\u01b0u c\u00e1c ph\u1ea7n t\u1eed trong stack, m\u00e0 s\u1ebd l\u01b0u ch\u00fang theo c\u1eb7p: ph\u1ea7n t\u1eed \u0111\u00f3 v\u00e0 min c\u1ee7a stack t\u1eeb ph\u1ea7n t\u1eed n\u00e0y tr\u1edf v\u1ec1 tr\u01b0\u1edbc.</p> <pre><code>stack&lt;pair&lt;int, int&gt;&gt; st;\n</code></pre> <p>R\u00f5 r\u00e0ng l\u00e0 t\u00ecm min c\u1ee7a c\u1ea3 stack ch\u1ec9 l\u00e0 gi\u00e1 tr\u1ecb <code>stack.top().second</code>.</p> <p>C\u0169ng r\u1ea5t r\u00f5 r\u00e0ng l\u00e0 vi\u1ec7c th\u00eam v\u00e0 b\u1edbt ph\u1ea7n t\u1eed c\u1ee7a stack c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian h\u1eb1ng s\u1ed1.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#cai-at","title":"C\u00e0i \u0111\u1eb7t","text":"<p>Th\u00eam ph\u1ea7n t\u1eed:</p> <pre><code>int new_min = st.empty() ? new_elem : min(new_elem, st.top().second);\nst.push({new_elem, new_min});\n</code></pre> <p>Xo\u00e1 ph\u1ea7n t\u1eed:</p> <pre><code>int removed_element = st.top().first;\nst.pop();\n</code></pre> <p>T\u00ecm min:</p> <pre><code>int minimum = st.top().second;\n</code></pre>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#bien-oi-queue-phuong-phap-1","title":"Bi\u1ebfn \u0111\u1ed5i queue (ph\u01b0\u01a1ng ph\u00e1p 1)","text":"<p>Gi\u1edd ta mu\u1ed1n c\u00f3 k\u1ebft qu\u1ea3 t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean nh\u01b0ng v\u1edbi m\u1ed9t c\u00e1i queue, ngh\u0129a l\u00e0 ta mu\u1ed1n th\u00eam ph\u1ea7n t\u1eed v\u00e0o ph\u00eda sau v\u00e0 xo\u00e1 ph\u1ea7n t\u1eed \u1edf ph\u00eda tr\u01b0\u1edbc.</p> <p>\u1ede \u0111\u00e2y ta x\u00e9t m\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 bi\u1ebfn \u0111\u1ed5i queue. N\u00f3 c\u00f3 m\u1ed9t y\u1ebfu \u0111i\u1ec3m l\u1edbn, v\u00ec queue sau khi bi\u1ebfn \u0111\u1ed5i s\u1ebd kh\u00f4ng l\u01b0u t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed.</p> <p>M\u1ea5u ch\u1ed1t l\u00e0 ch\u1ec9 l\u01b0u c\u00e1c ph\u1ea7n t\u1eed quy\u1ebft \u0111\u1ecbnh min trong queue m\u00e0 th\u00f4i. Ta s\u1ebd gi\u1eef l\u1ea1i c\u00e1c ph\u1ea7n t\u1eed trong queue theo th\u1eed t\u1ef1 kh\u00f4ng gi\u1ea3m (min s\u1ebd n\u1eb1m \u1edf \u0111\u1ea7u queue). V\u1edbi c\u00e1ch n\u00e0y th\u00ec min s\u1ebd lu\u00f4n n\u1eb1m \u1edf \u0111\u1ea7u queue. Tr\u01b0\u1edbc khi th\u00eam ph\u1ea7n t\u1eed v\u00e0o queue, ta s\u1ebd l\u00e0m nh\u01b0 sau: ta xo\u00e1 t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed t\u00ednh t\u1eeb sau c\u00f9ng v\u1ec1 tr\u01b0\u1edbc m\u00e0 n\u00f3 l\u1edbn h\u01a1n ph\u1ea7n t\u1eeb m\u1edbi n\u00e0y, v\u00e0 th\u00eam ph\u1ea7n t\u1eed n\u00e0y v\u00e0o queue. V\u1edbi c\u00e1ch n\u00e0y ta s\u1ebd kh\u00f4ng ph\u00e1 v\u1ee1 th\u1ee9 t\u1ef1 c\u1ee7a queue, v\u00e0 s\u1ebd kh\u00f4ng l\u00e0m m\u1ea5t \u0111i ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i n\u1ebfu n\u00f3 l\u00e0 min \u1edf b\u1ea5t k\u1ef3 b\u01b0\u1edbc n\u00e0o. T\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed b\u1ecb xo\u00e1 kh\u00f4ng th\u1ec3 l\u00e0 min \u0111\u01b0\u1ee3c. Khi ta mu\u1ed1n xem m\u1ed9t ph\u1ea7n t\u1eed \u1edf \u0111\u1ea7u queue, n\u00f3 c\u00f3 th\u1ec3 kh\u00f4ng c\u00f3 \u1edf \u0111\u00f3 v\u00ec ta \u0111\u00e3 xo\u00e1 n\u00f3 khi th\u00eam v\u00e0o m\u1ed9t ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n r\u1ed3i. V\u00ec v\u1eady khi xo\u00e1 m\u1ed9t ph\u1ea7n t\u1eed trong queue, ta c\u1ea7n bi\u1ebft gi\u00e1 tr\u1ecb c\u1ee7a ph\u1ea7n t\u1eed \u0111\u00f3. N\u1ebfu ph\u1ea7n t\u1eed \u0111\u1ea7u queue c\u00f3 c\u00f9ng gi\u00e1 tr\u1ecb, ta c\u00f3 th\u1ec3 xo\u00e1 n\u00f3 m\u1ed9t c\u00e1ch an to\u00e0n, ng\u01b0\u1ee3c l\u1ea1i ta kh\u00f4ng l\u00e0m g\u00ec c\u1ea3.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#cai-at_1","title":"C\u00e0i \u0111\u1eb7t","text":"<pre><code>deque&lt;int&gt; q;\n</code></pre> <p>T\u00ecm min: </p><pre><code>int minimum = q.front();\n</code></pre><p></p> <p>Th\u00eam ph\u1ea7n t\u1eed:</p> <pre><code>while (!q.empty() &amp;&amp; q.back() &gt; new_element)\n    q.pop_back();\nq.push_back(new_element);\n</code></pre> <p>Xo\u00e1 ph\u1ea7n t\u1eed:</p> <pre><code>if (!q.empty() &amp;&amp; q.front() == remove_element)\n    q.pop_front();\n</code></pre> <p>Ta th\u1ea5y r\u00f5 r\u1eb1ng trung b\u00ecnh th\u00ec c\u00e1c thao t\u00e1c n\u00e0y t\u1ed1n th\u1eddi gian \\(O(1)\\) v\u00ec m\u1ecdi ph\u1ea7n t\u1eed ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c th\u00eam v\u00e0 b\u1edbt \u0111i \u0111\u00fang m\u1ed9t l\u1ea7n.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#bien-oi-queue-phuong-phap-2","title":"Bi\u1ebfn \u0111\u1ed5i queue (ph\u01b0\u01a1ng ph\u00e1p 2)","text":"<p>\u0110\u00e2y l\u00e0 ph\u01b0\u01a1ng ph\u00e1p 1 v\u1edbi m\u1ed9t ch\u00fat bi\u1ebfn \u0111\u1ed5i. Ta mu\u1ed1n xo\u00e1 ph\u1ea7n t\u1eed m\u00e0 kh\u00f4ng mu\u1ed1n bi\u1ebft ph\u1ea3i xo\u00e1 ph\u1ea7n t\u1eed n\u00e0o. Ta c\u00f3 th\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch l\u01b0u ch\u1ec9 s\u1ed1 c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed c\u1ee7a queue. V\u00e0 ta c\u0169ng l\u01b0u s\u1ed1 ph\u1ea7n t\u1eed ta \u0111\u00e3 th\u00eam v\u00e0 xo\u00e1 \u0111i.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#cai-at_2","title":"C\u00e0i \u0111\u1eb7t","text":"<pre><code>deque&lt;pair&lt;int, int&gt;&gt; q;\nint cnt_added = 0;\nint cnt_removed = 0;\n</code></pre> <p>T\u00ecm min:</p> <pre><code>int minimum = q.front().first;\n</code></pre> <p>Th\u00eam ph\u1ea7n t\u1eed:</p> <pre><code>while (!q.empty() &amp;&amp; q.back().first &gt; new_element)\n    q.pop_back();\nq.push_back({new_element, cnt_added});\ncnt_added++;\n</code></pre> <p>Xo\u00e1 ph\u1ea7n t\u1eed:</p> <pre><code>if (!q.empty() &amp;&amp; q.front().second == cnt_removed) \n    q.pop_front();\ncnt_removed++;\n</code></pre>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#bien-oi-queue-phuong-phap-3","title":"Bi\u1ebfn \u0111\u1ed5i queue (ph\u01b0\u01a1ng ph\u00e1p 3)","text":"<p>Ta x\u00e9t m\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 bi\u1ebfn \u0111\u1ed5i queue \u0111\u1ec3 t\u00ecm min trong \\(O(1)\\). C\u00e1ch n\u00e0y c\u00e0i \u0111\u1eb7t kh\u00e1 ph\u1ee9c t\u1ea1p, nh\u01b0ng ta l\u01b0u t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed. V\u00e0 ta c\u0169ng c\u00f3 th\u1ec3 xo\u00e1 m\u1ed9t ph\u1ea7n t\u1eed \u1edf \u0111\u1ea7u m\u00e0 kh\u00f4ng c\u1ea7n bi\u1ebft gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3.</p> <p>\u00dd t\u01b0\u1edfng l\u00e0 quy b\u00e0i to\u00e1n v\u1ec1 stack. Gi\u1edd ta ch\u1ec9 c\u1ea7n bi\u1ebft c\u00e1ch m\u00f4 ph\u1ecfng m\u1ed9t queue v\u1edbi 2 stack.</p> <p>Ta t\u1ea1o 2 stack, <code>s1</code> v\u00e0 <code>s2</code>. T\u1ea5t nhi\u00ean 2 stack n\u00e0y s\u1ebd \u1edf d\u1ea1ng \u0111\u00e3 bi\u1ebfn \u0111\u1ed5i, n\u1ebfn ta t\u00ecm min \u0111\u01b0\u1ee3c trong \\(O(1)\\). Ta s\u1ebd th\u00eam c\u00e1c ph\u1ea7n t\u1eed m\u1edbi v\u00e0o trong <code>s1</code> v\u00e0 xo\u00e1 ph\u1ea7n t\u1eed kh\u1ecfi <code>s2</code>. N\u1ebfu \u1edf b\u1ea5t c\u1ee9 th\u1eddi \u0111i\u1ec3m n\u00e0o <code>s2</code> r\u1ed7ng, ta di chuy\u1ec3n t\u1ea5t c\u1ea3 ph\u1ea7n t\u1eed t\u1eeb <code>s1</code> sang <code>s2</code> (l\u00fac n\u00e0y th\u1ee9 t\u1ef1 s\u1ebd \u0111\u1ea3o ng\u01b0\u1ee3c). Cu\u1ed1i c\u00f9ng t\u00ecm min c\u1ee7a queue s\u1ebd l\u00e0 t\u00ecm min c\u1ee7a 2 stack.</p> <p>V\u1eady ta th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c trong trung b\u00ecnh l\u00e0 \\(O(1)\\) (m\u1ed7i ph\u1ea7n t\u1eed s\u1ebd \u0111\u01b0\u1ee3c th\u00eam v\u00e0o stack <code>s1</code> m\u1ed9t l\u1ea7n, chuy\u1ec3n v\u00e0o <code>s2</code> m\u1ed9t l\u1ea7n, xo\u00e1 kh\u1ecfi <code>s2</code> m\u1ed9t l\u1ea7n).</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#cai-at_3","title":"C\u00e0i \u0111\u1eb7t:","text":"<pre><code>stack&lt;pair&lt;int, int&gt;&gt; s1, s2;\n</code></pre> <p>T\u00ecm min:</p> <pre><code>if (s1.empty() || s2.empty()) \n    minimum = s1.empty() ? s2.top().second : s1.top().second;\nelse\n    minimum = min(s1.top().second, s2.top().second);\n</code></pre> <p>Th\u00eam ph\u1ea7n t\u1eed:</p> <pre><code>int minimum = s1.empty() ? new_element : min(new_element, s1.top().second);\ns1.push({new_element, minimum});\n</code></pre> <p>Xo\u00e1 ph\u1ea7n t\u1eed:</p> <pre><code>if (s2.empty()) {\n    while (!s1.empty()) {\n        int element = s1.top().first;\n        s1.pop();\n        int minimum = s2.empty() ? element : min(element, s2.top().second);\n        s2.push({element, minimum});\n    }\n}\nint remove_element = s2.top().first;\ns2.pop();\n</code></pre>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#tim-min-cua-tat-ca-day-con-o-dai-m-khong-oi","title":"T\u00ecm min c\u1ee7a t\u1ea5t c\u1ea3 d\u00e3y con \u0111\u1ed9 d\u00e0i \\(M\\) kh\u00f4ng \u0111\u1ed5i","text":"<p>Cho m\u1ed9t m\u1ea3ng \\(A\\) \u0111\u1ed9 d\u00e0i \\(N\\) v\u00e0 s\u1ed1 \\(M \\leq N\\). Ta t\u00ecm min c\u1ee7a m\u1ed7i d\u00e3y con \u0111\u1ed9 d\u00e0i \\(M\\) trong m\u1ea3ng n\u00e0y, ngh\u0129a l\u00e0 t\u00ecm:</p> \\[ \\min_{0 \\le i \\le M-1} A[i], \\min_{1 \\le i \\le M} A[i], \\min_{2 \\le i \\le M+1} A[i],~\\dots~, \\min_{N-M \\le i \\le N-1} A[i] \\] <p>Ta c\u1ea7n gi\u1ea3i b\u00e0i n\u00e0y trong th\u1eddi gian \\(O(N)\\).</p> <p>Ta c\u00f3 th\u1ec3 d\u00f9ng m\u1ed9t trong 3 c\u00e1ch bi\u1ebfn \u0111\u1ed5i queue \u1edf tr\u00ean \u0111\u1ec3 gi\u1ea3i. Ta th\u00eam v\u00e0o queue \\(M\\) ph\u1ea7n t\u1eed \u0111\u1ea7u c\u1ee7a m\u1ea3ng, t\u00ecm v\u00e0 in ra min c\u1ee7a ch\u00fang, sau \u0111\u00f3 th\u00eam ph\u1ea7n t\u1eed ti\u1ebfp theo v\u00e0o queue v\u00e0 xo\u00e1 ph\u1ea7n t\u1eed \u0111\u1ea7u c\u1ee7a m\u1ea3ng ra, t\u00ecm v\u00e0 in min c\u1ee7a s\u1ed1 c\u00f2n l\u1ea1i, v\u00e2n v\u00e2n. V\u00ec t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n trong th\u1eddi gian trung b\u00ecnh h\u1eb1ng s\u1ed1, \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n l\u00e0 \\(O(N)\\).</p>"},{"location":"cp-algorithms/data-structures/fundamentals/min-stack-min-queue/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date HackerRank - Queries with Fixed Length Unavailable public link Code 13/11/2022 Codechef - Binary Land Submission Code 14/11/2022"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/","title":"Sparse Table","text":""},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#sparse-table","title":"Sparse Table","text":""},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#nguon","title":"Ngu\u1ed3n","text":"<p> Sparse Table</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>Sparse Table l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u cho ph\u00e9p tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n tr\u00ean \u0111o\u1ea1n. N\u00f3 c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi h\u1ea7u h\u1ebft c\u00e1c truy v\u1ea5n \u0111o\u1ea1n trong \\(O(\\log n)\\), nh\u01b0ng s\u1ee9c m\u1ea1nh th\u1ef1c s\u1ef1 c\u1ee7a n\u00f3 n\u1eb1m \u1edf vi\u1ec7c tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n t\u00ecm min ho\u1eb7c max c\u1ee7a \u0111o\u1ea1n trong th\u1eddi gian \\(O(1)\\).</p> <p>\u0110i\u1ec3m y\u1ebfu duy nh\u1ea5t c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y l\u00e0 n\u00f3 ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng tr\u00ean m\u1ea3ng kh\u00f4ng thay \u0111\u1ed5i gi\u00e1 tr\u1ecb. Ngh\u0129a l\u00e0 m\u1ea3ng kh\u00f4ng th\u1ec3 thay \u0111\u1ed5i gi\u00e1 tr\u1ecb c\u1ee7a b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o gi\u1eefa 2 truy v\u1ea5n. N\u1ebfu c\u00f3 \u0111i\u1ec1u \u0111\u00f3 x\u1ea3y ra, c\u1ea3 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ph\u1ea3i \u0111\u01b0\u1ee3c t\u00ednh l\u1ea1i.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#y-tuong","title":"\u00dd t\u01b0\u1edfng","text":"<p>B\u1ea5t k\u1ef3 s\u1ed1 kh\u00f4ng \u00e2m n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng duy nh\u1ea5t m\u1ed9t t\u1ed5ng gi\u1ea3m d\u1ea7n c\u00e1c s\u1ed1 m\u0169 c\u1ee7a \\(2\\). \u0110\u00e2y ch\u1ec9 l\u00e0 m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a m\u1ed9t s\u1ed1. V\u00ed d\u1ee5 \\(13 = (1101)_2 = 8 + 4 + 1\\). Ta c\u00f3 nhi\u1ec1u nh\u1ea5t \\(\\lceil \\log_2 x \\rceil\\) s\u1ed1 h\u1ea1ng v\u1edbi m\u1ed7i s\u1ed1 \\(x\\).</p> <p>T\u01b0\u01a1ng t\u1ef1 th\u00ec b\u1ea5t k\u1ef3 \u0111o\u1ea1n n\u00e0o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n b\u1eb1ng duy nh\u1ea5t h\u1ee3p c\u1ee7a c\u00e1c \u0111o\u1ea1n con v\u1edbi \u0111\u1ed9 d\u00e0i gi\u1ea3m d\u1ea7n c\u00e1c s\u1ed1 m\u0169 c\u1ee7a \\(2\\). V\u00ed d\u1ee5 \\([2, 14] = [2, 9] \\cup [10, 13] \\cup [14, 14]\\), v\u1edbi \u0111o\u1ea1n ban \u0111\u1ea7u c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 \\(13\\), c\u00e1c \u0111o\u1ea1n con s\u1ebd c\u00f3 \u0111\u1ed9 d\u00e0i t\u01b0\u01a1ng \u1ee9ng l\u00e0 \\(8\\), \\(4\\) v\u00e0 \\(1\\). V\u00e0 t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean th\u00ec ta c\u00f3 nhi\u1ec1u nh\u1ea5t \\(\\lceil \\log_2(\\text{\u0111\u1ed9 d\u00e0i \u0111o\u1ea1n ban \u0111\u1ea7u}) \\rceil\\) \u0111o\u1ea1n con.</p> <p>\u00dd t\u01b0\u1edfng c\u1ee7a Sparse Table ch\u00ednh l\u00e0 vi\u1ec7c t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c \u0111\u00e1p \u00e1n c\u1ee7a c\u00e1c truy v\u1ea5n \u0111o\u1ea1n v\u1edbi c\u00e1c \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 lu\u1ef9 th\u1eeba c\u1ee7a \\(2\\). Sau \u0111\u00f3 m\u1ed9t truy v\u1ea5n \u0111o\u1ea1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c tr\u1ea3 l\u1eddi b\u1eb1ng vi\u1ec7c chia \u0111o\u1ea1n \u0111\u00f3 ra th\u00e0nh c\u00e1c \u0111o\u1ea1n con \u0111\u1ed9 d\u00e0i lu\u1ef9 th\u1eeba \\(2\\), l\u1ea5y k\u1ebft qu\u1ea3 c\u00e1c \u0111o\u1ea1n con \u0111\u00f3 v\u1edbi gi\u00e1 tr\u1ecb t\u00ednh tr\u01b0\u1edbc, sau \u0111\u00f3 k\u1ebft h\u1ee3p ch\u00fang l\u1ea1i v\u1edbi nhau \u0111\u1ec3 t\u1ea1o ra k\u1ebft qu\u1ea3 cu\u1ed1i c\u00f9ng.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#tien-xu-ly","title":"Ti\u1ec1n x\u1eed l\u00fd","text":"<p>Ta s\u1ebd d\u00f9ng m\u1ed9t m\u1ea3ng 2 chi\u1ec1u \u0111\u1ec3 l\u01b0u \u0111\u00e1p \u00e1n c\u00e1c truy v\u1ea5n t\u00ednh tr\u01b0\u1edbc. \\(\\text{st}[i][j]\\) l\u01b0u \u0111\u00e1p \u00e1n c\u00e1c \u0111o\u1ea1n \\([j, j + 2^i - 1]\\) v\u1edbi \u0111\u1ed9 d\u00e0i \\(2^i\\). K\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ea3ng 2 chi\u1ec1u s\u1ebd b\u1eb1ng \\((K + 1) \\times \\text{MAXN}\\) v\u1edbi \\(\\text{MAXN}\\) l\u00e0 \u0111\u1ed9 d\u00e0i l\u1edbn nh\u1ea5t c\u1ee7a m\u1ea3ng ban \u0111\u1ea7u. \\(\\text{K}\\) ph\u1ea3i tho\u1ea3 m\u00e3n \\(\\text{K} \\ge \\lfloor \\log_2 \\text{MAXN} \\rfloor\\), v\u00ec \\(2^{\\lfloor \\log_2 \\text{MAXN} \\rfloor}\\) l\u00e0 \u0111\u1ed9 d\u00e0i l\u1edbn nh\u1ea5t ta c\u1ea7n h\u1ed7 tr\u1ee3 truy v\u1ea5n. V\u1edbi m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c (t\u1ea7m \\(\\le 10^7\\) ph\u1ea7n t\u1eed), ta c\u00f3 th\u1ec3 d\u00f9ng \\(K = 25\\).</p> <p>Chi\u1ec1u ch\u1ee9a \\(\\text{MAXN}\\) n\u00ean n\u1eb1m sau chi\u1ec1u ch\u1ee9a \\(K\\) \u0111\u1ec3 ti\u1ec7n cho vi\u1ec7c truy c\u1eadp c\u00e1c v\u00f9ng nh\u1edb li\u00ean ti\u1ebfp (cache friendly).</p> <pre><code>int st[K + 1][MAXN];\n</code></pre> <p>V\u00ec \u0111o\u1ea1n \\([j, j + 2^i - 1]\\) c\u00f3 \u0111\u1ed9 d\u00e0i \\(2^i\\) \u0111\u01b0\u1ee3c chia th\u00e0nh c\u00e1c \u0111o\u1ea1n \\([j, j + 2^{i - 1} - 1]\\) v\u00e0 \\([j + 2^{i - 1}, j + 2^i - 1]\\), c\u00f3 \u0111\u1ed9 d\u00e0i \u0111\u1ec1u l\u00e0 \\(2^{i - 1}\\), ta c\u00f3 th\u1ec3 sinh b\u1ea3ng b\u1eb1ng c\u00e1ch d\u00f9ng quy ho\u1ea1ch \u0111\u1ed9ng.</p> <pre><code>std::copy(array.begin(), array.end(), st[0]);\n\nfor (int i = 1; i &lt;= K; i++)\n    for (int j = 0; j + (1 &lt;&lt; i) &lt;= N; j++)\n        st[i][j] = f(st[i - 1][j], st[i - 1][j + (1 &lt;&lt; (i - 1))]);\n</code></pre> <p>H\u00e0m \\(f\\) s\u1ebd tu\u1ef3 thu\u1ed9c v\u00e0o lo\u1ea1i truy v\u1ea5n. V\u1edbi truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n, \\(f\\) l\u00e0 h\u00e0m t\u1ed5ng 2 s\u1ed1, c\u00f2n v\u1edbi truy v\u1ea5n min \u0111o\u1ea1n, \\(f\\) l\u00e0 min 2 s\u1ed1.</p> <p>Ti\u1ec1n x\u1eed l\u00fd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(\\text{N} \\log \\text{N})\\).</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#truy-van-tong-oan-range-sum-queries","title":"Truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n (Range Sum Queries)","text":"<p>V\u1edbi c\u00e1c truy v\u1ea5n d\u1ea1ng n\u00e0y, ta mu\u1ed1n t\u00ecm t\u1ed5ng t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb trong \u0111o\u1ea1n. V\u00ec v\u1eady n\u00ean h\u00e0m \\(f\\) r\u00f5 r\u00e0ng s\u1ebd l\u00e0 \\(f(x, y) = x + y\\). Ta c\u00f3 th\u1ec3 x\u00e2y d\u1ef1ng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u nh\u01b0 th\u1ebf n\u00e0y:</p> <pre><code>long long st[K + 1][MAXN];\n\nstd::copy(array.begin(), array.end(), st[0]);\n\nfor (int i = 1; i &lt;= K; i++)\n    for (int j = 0; j + (1 &lt;&lt; i) &lt;= N; j++)\n        st[i][j] = st[i - 1][j] + st[i - 1][j + (1 &lt;&lt; (i - 1))];\n</code></pre> <p>\u0110\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n t\u1ed5ng tr\u00ean \u0111o\u1ea1n \\([L, R]\\), ta duy\u1ec7t t\u1ea5t c\u1ea3 c\u00e1c lu\u1ef9 th\u1eeba 2, t\u00ednh t\u1eeb lu\u1ef9 th\u1eeba l\u1edbn nh\u1ea5t. Ngay khi ta g\u1eb7p lu\u1ef9 th\u1eeba \\(2^i\\) nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng d\u1ed9 d\u00e0i \u0111o\u1ea1n (\\(= R - L + 1\\)), ta t\u00ednh \u0111o\u1ea1n con \u0111\u1ea7u ti\u00ean c\u1ee7a \u0111o\u1ea1n \\([L, L + 2^i - 1]\\), sau \u0111\u00f3 ti\u1ebfp t\u1ee5c v\u1edbi \u0111o\u1ea1n c\u00f2n l\u1ea1i \\([L + 2^i, R]\\).</p> <pre><code>long long sum = 0;\nfor (int i = K; i &gt;= 0; i--) {\n    if ((1 &lt;&lt; i) &lt;= R - L + 1) {\n        sum += st[i][L];\n        L += 1 &lt;&lt; i;\n    }\n}\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n l\u00e0 \\(O(K) = O(\\log \\text{MAXN})\\).</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#truy-van-min-oan-range-minimum-queries-rmq","title":"Truy v\u1ea5n min \u0111o\u1ea1n (Range Minimum Queries - RMQ)","text":"<p>C\u00f3 nh\u1eefng truy v\u1ea5n khi\u1ebfn Sparse Table tr\u1edf n\u00ean th\u01b0\u1ee3ng \u0111\u1eb3ng h\u01a1n c\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00e1c. Khi ta t\u00ednh min c\u1ee7a m\u1ed9t \u0111o\u1ea1n, kh\u00f4ng quan tr\u1ecdng l\u00e0 ta x\u00e9t m\u1ed9t gi\u00e1 tr\u1ecb m\u1ed9t ho\u1eb7c hai l\u1ea7n. V\u00ec v\u1eady thay v\u00ec chia \u0111o\u1ea1n ban \u0111\u1ea7u ra th\u00e0nh nhi\u1ec1u \u0111o\u1ea1n nh\u1ecf, ta c\u00f3 th\u1ec3 chia \u0111o\u1ea1n ban \u0111\u1ea7u th\u00e0nh 2 \u0111o\u1ea1n c\u00f3 th\u1ec3 ch\u1ed3ng l\u00ean nhau c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 lu\u1ef9 th\u1eeba c\u1ee7a \\(2\\). V\u00ed d\u1ee5, ta c\u00f3 th\u1ec3 chia \u0111o\u1ea1n \\([1, 6]\\) th\u00e0nh 2 \u0111o\u1ea1n \\([1, 4]\\) v\u00e0 \\([3, 6]\\). K\u1ebft qu\u1ea3 truy v\u1ea5n min tr\u00ean \u0111o\u1ea1n \\([1, 6]\\) r\u00f5 r\u00e0ng l\u00e0 y h\u1ec7t nh\u01b0 min c\u1ee7a k\u1ebft qu\u1ea3 truy v\u1ea5n tr\u00ean \u0111o\u1ea1n \\([1, 4]\\) v\u00e0 k\u1ebft qu\u1ea3 truy v\u1ea5n tr\u00ean \u0111o\u1ea1n \\([3, 6]\\). N\u00ean ta c\u00f3 th\u1ec3 t\u00ednh min \u0111o\u1ea1n \\([L, R]\\) nh\u01b0 sau:</p> \\[\\min(\\text{st}[i][L], \\text{st}[i][R - 2^i + 1]) \\quad \\text{ v\u1edbi } i = \\log_2(R - L + 1)\\] <p>\u0110i\u1ec1u n\u00e0y y\u00eau c\u1ea7u ta ph\u1ea3i t\u00ednh \u0111\u01b0\u1ee3c \\(\\log_2(R - L + 1)\\) nhanh. Ta c\u00f3 th\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c b\u1eb1ng c\u00e1ch t\u00ednh tr\u01b0\u1edbc t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb logarit:</p> <pre><code>int lg[MAXN+1];\nlg[1] = 0;\nfor (int i = 2; i &lt;= MAXN; i++)\n    lg[i] = lg[i/2] + 1;\n</code></pre> <p>N\u1ebfu b\u1ea1n kh\u00f4ng mu\u1ed1n l\u00e0m nh\u01b0 tr\u00ean th\u00ec logarit c\u0169ng c\u00f3 th\u1ec3 t\u00ednh \u0111\u01b0\u1ee3c tr\u1ef1c ti\u1ebfp v\u1edbi th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb h\u1eb1ng s\u1ed1:</p> <p></p><pre><code>// C++20\n#include &lt;bit&gt;\nint log2_floor(unsigned long i) {\n    return std::bit_width(i) - 1;\n}\n\n// pre C++20\nint log2_floor(unsigned long long i) {\n    return i ? __builtin_clzll(1) - __builtin_clzll(i) : -1;\n}\n</code></pre> Benchmark n\u00e0y cho th\u1ea5y d\u00f9ng m\u1ea3ng <code>lg</code> ch\u1eadm h\u01a1n v\u00ec cache miss.<p></p> <p>Sau \u0111\u00f3 ta c\u1ea7n ti\u1ec1n x\u1eed l\u00fd Sparse Table. Ta \u0111\u1ecbnh ngh\u0129a \\(f\\) l\u00e0 \\(f(x, y) = \\min(x, y)\\).</p> <pre><code>int st[K + 1][MAXN];\n\nstd::copy(array.begin(), array.end(), st[0]);\n\nfor (int i = 1; i &lt;= K; i++)\n    for (int j = 0; j + (1 &lt;&lt; i) &lt;= N; j++)\n        st[i][j] = min(st[i - 1][j], st[i - 1][j + (1 &lt;&lt; (i - 1))]);\n</code></pre> <p>V\u00e0 min c\u1ee7a \u0111o\u1ea1n \\([L, R]\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh nh\u01b0 sau:</p> <pre><code>int i = lg[R - L + 1];\nint minimum = min(st[i][L], st[i][R - (1 &lt;&lt; i) + 1]);\n</code></pre> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p v\u1ec1 th\u1eddi gian c\u1ee7a m\u1ed9t Range Minimum Query l\u00e0 \\(O(1)\\).</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#cac-cau-truc-du-lieu-tuong-tu-e-ho-tro-nhieu-loai-truy-van-hon","title":"C\u00e1c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u01b0\u01a1ng t\u1ef1 \u0111\u1ec3 h\u1ed7 tr\u1ee3 nhi\u1ec1u lo\u1ea1i truy v\u1ea5n h\u01a1n","text":"<p>M\u1ed9t trong nh\u1eefng \u0111i\u1ec3m y\u1ebfu ch\u00ednh c\u1ee7a c\u00e1ch ti\u1ebfp c\u1eadn \\(O(1)\\) \u1edf tr\u00ean l\u00e0 n\u00f3 ch\u1ec9 h\u1ed7 tr\u1ee3 c\u00e1c truy v\u1ea5n tr\u00ean c\u00e1c h\u00e0m idempotent. V\u00ed d\u1ee5 n\u00f3 hi\u1ec7u qu\u1ea3 tr\u00ean c\u00e1c truy v\u1ea5n min \u0111o\u1ea1n, nh\u01b0ng kh\u00f4ng d\u00f9ng \u0111\u01b0\u1ee3c tr\u00ean c\u00e1c truy v\u1ea5n t\u1ed5ng \u0111o\u1ea1n.</p> <p>Ta c\u0169ng c\u00f3 nh\u1eefng c\u1ea5u tr\u00fac d\u1eef li\u1ec7u t\u01b0\u01a1ng t\u1ef1 c\u00f3 th\u1ec3 x\u1eed l\u00fd b\u1ea5t k\u1ef3 lo\u1ea1i h\u00e0m k\u1ebft h\u1ee3p v\u00e0 truy v\u1ea5n \u0111o\u1ea1n n\u00e0o trong \\(O(1)\\). M\u1ed9t trong s\u1ed1 ch\u00fang l\u00e0 Disjoint Sparse Table. M\u1ed9t c\u00e1i kh\u00e1c l\u00e0 Sqrt Tree.</p>"},{"location":"cp-algorithms/data-structures/fundamentals/sparse-table/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date SPOJ - RMQSQ Unavailable public link Code 15/11/2022 SPOJ - THRBL Unavailable public link Code 15/11/2022 Codechef - MSTICK Submission Code 15/11/2022 Codechef - SEAD Submission Code 15/11/2022 Codeforces - CGCDSSQ Submission Code 19/11/2022 Codeforces - R2D2 and Droid Army Submission Code 19/11/2022 Codeforces - Maximum of Maximums of Minimums Submission Code 19/11/2022 SPOJ - Miraculous Unavailable public link Code 19/11/2022 Codeforces - Animals and Puzzles Submission Code 21/11/2022 Codeforces - Trains and Statistics Submission Code 24/11/2022 SPOJ - Postering Unavailable public link Code 24/11/2022 SPOJ - Negative Score Unavailable public link Code 22/11/2022 SPOJ - A Famous City Unavailable public link Code 24/11/2022 SPOJ - Diferencija Unavailable public link Code 23/11/2022 Codeforces - Turn off the TV Submission Code 22/11/2022 Codeforces - Map Submission Code 23/11/2022 Codeforces - Awards for Contestants Submission Code 24/11/2022 Codeforces - Longest Regular Bracket Sequence Submission Code 22/11/2022"},{"location":"cp-algorithms/data-structures/trees/dsu/","title":"Disjoint Set Union","text":""},{"location":"cp-algorithms/data-structures/trees/dsu/#disjoint-set-union","title":"Disjoint Set Union","text":""},{"location":"cp-algorithms/data-structures/trees/dsu/#nguon","title":"Ngu\u1ed3n","text":"<p> Disjoint Set Union</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>B\u00e0i vi\u1ebft n\u00e0y n\u00f3i v\u1ec1 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u Disjoint Set Union, hay vi\u1ebft t\u1eaft l\u00e0 DSU. \u0110\u00f4i khi n\u00f3 c\u0169ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Union Find v\u00ec hai thao t\u00e1c ch\u00ednh c\u1ee7a n\u00f3.</p> <p>Ta c\u00f3 m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed, m\u1ed7i ph\u1ea7n t\u1eed l\u00e0 m\u1ed9t t\u1eadp h\u1ee3p ri\u00eang bi\u1ec7t. M\u1ed9t DSU s\u1ebd c\u00f3 m\u1ed9t ph\u00e9p to\u00e1n cho ph\u00e9p k\u1ebft h\u1ee3p (ch\u1eadp) hai t\u1eadp b\u1ea5t k\u1ef3 v\u00e0 c\u0169ng c\u00f3 th\u1ec3 cho bi\u1ebft m\u1ed9t ph\u1ea7n t\u1eed n\u00e0o \u0111\u00f3 n\u1eb1m trong t\u1eadp h\u1ee3p n\u00e0o. Phi\u00ean b\u1ea3n c\u1ed5 \u0111i\u1ec3n c\u1ee7a DSU c\u00f3 m\u1ed9t thao t\u00e1c th\u1ee9 ba, l\u00e0 t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p t\u1eeb m\u1ed9t ph\u1ea7n t\u1eed m\u1edbi.</p> <p>Do \u0111\u00f3, c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y v\u1ec1 c\u01a1 b\u1ea3n c\u00f3 ba thao t\u00e1c sau:</p> <ul> <li><code>make_set(v)</code> - t\u1ea1o m\u1ed9t t\u1eadp h\u1ee3p g\u1ed3m ch\u1ec9 m\u1ed9t ph\u1ea7n t\u1eed <code>v</code>.</li> <li><code>union_sets(a, b)</code> - h\u1ee3p nh\u1ea5t hai t\u1eadp ch\u1ec9 \u0111\u1ecbnh (t\u1eadp ch\u1ee9a <code>a</code> v\u00e0 t\u1eadp ch\u1ee9a <code>b</code>)</li> <li><code>find_set(v)</code> - tr\u1ea3 v\u1ec1 \u0111\u1ea1i di\u1ec7n (c\u00f2n g\u1ecdi l\u00e0 leader) c\u1ee7a t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed <code>v</code>. \u0110\u1ea1i di\u1ec7n n\u00e0y l\u00e0 m\u1ed9t ph\u1ea7n t\u1eed c\u1ee7a t\u1eadp \u0111\u00f3. N\u00f3 \u0111\u01b0\u1ee3c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ch\u1ecdn ra trong m\u1ed7i t\u1eadp (v\u00e0 c\u00f3 th\u1ec3 thay \u0111\u1ed5i theo th\u1eddi gian, c\u1ee5 th\u1ec3 l\u00e0 sau c\u00e1c l\u1eddi g\u1ecdi <code>union_sets</code>). \u0110\u1ea1i di\u1ec7n n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 ki\u1ec3m tra xem hai ph\u1ea7n t\u1eed c\u00f3 c\u00f9ng n\u1eb1m trong m\u1ed9t t\u1eadp hay kh\u00f4ng. <code>a</code> v\u00e0 <code>b</code> c\u00f9ng n\u1eb1m trong m\u1ed9t t\u1eadp khi <code>find_set(a) == find_set(b)</code>. Ng\u01b0\u1ee3c l\u1ea1i ch\u00fang n\u1eb1m kh\u00e1c t\u1eadp v\u1edbi nhau.</li> </ul> <p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y cho ph\u00e9p ta th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c \u0111\u00f3 trong th\u1eddi gian trung b\u00ecnh g\u1ea7n nh\u01b0 l\u00e0 \\(O(1)\\).</p> <p>Ngo\u00e0i ra, c\u00f3 m\u1ed9t ph\u1ea7n trong b\u00e0i vi\u1ebft n\u00f3i v\u1ec1 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u thay th\u1ebf cho DSU, v\u1edbi \u0111\u1ed9 ph\u1ee9c t\u1ea1p trung b\u00ecnh ch\u1eadm h\u01a1n l\u00e0 \\(O(\\log n)\\), nh\u01b0ng m\u1ea1nh h\u01a1n DSU b\u00ecnh th\u01b0\u1eddng.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#xay-dung-mot-cau-truc-du-lieu-manh-me","title":"X\u00e2y d\u1ef1ng m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u m\u1ea1nh m\u1ebd","text":"<p>Ta s\u1ebd l\u01b0u c\u00e1c t\u1eadp theo d\u1ea1ng c\u00e1c c\u00e2y: m\u1ed7i c\u00e2y s\u1ebd t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t t\u1eadp. V\u00e0 g\u1ed1c c\u1ee7a c\u00e2y s\u1ebd l\u00e0 \u0111\u1ea1i di\u1ec7n / leader c\u1ee7a t\u1eadp.</p> <p>H\u00ecnh sau s\u1ebd cho th\u1ea5y \u0111\u1ea1i di\u1ec7n c\u1ee7a nh\u1eefng c\u00e2y nh\u01b0 th\u1ebf.</p> <p></p> <p>Ban \u0111\u1ea7u, m\u1ed7i ph\u1ea7n t\u1eed l\u00e0 m\u1ed9t t\u1eadp, n\u00ean m\u1ed7i \u0111\u1ec9nh c\u0169ng l\u00e0 m\u1ed9t c\u00e2y. Sau \u0111\u00f3 ta h\u1ee3p nh\u1ea5t t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed 1 v\u00e0 t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed 2. Sau \u0111\u00f3 ta h\u1ee3p nh\u1ea5t t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed 3 v\u00e0 t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed 4. \u1ede b\u01b0\u1edbc cu\u1ed1i c\u00f9ng, h\u1ee3p nh\u1ea5t t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed 1 v\u00e0 t\u1eadp ch\u1ee9a ph\u1ea7n t\u1eed 3.</p> <p>V\u1ec1 m\u1eb7t c\u00e0i \u0111\u1eb7t, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ta ph\u1ea3i duy tr\u00ec m\u1ed9t m\u1ea3ng <code>parent</code> l\u01b0u tham chi\u1ebfu \u0111\u1ebfn \u0111\u1ec9nh cha c\u1ee7a \u0111\u1ec9nh hi\u1ec7n t\u1ea1i tr\u00ean c\u00e2y.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#cai-at-trau-bo","title":"C\u00e0i \u0111\u1eb7t tr\u00e2u b\u00f2","text":"<p>\u0110\u1ebfn \u0111\u00e2y ta \u0111\u00e3 c\u00f3 th\u1ec3 c\u00e0i s\u01a1 b\u1ed9 \u0111\u01b0\u1ee3c c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y. M\u1eb7c d\u00f9 ban \u0111\u1ea7u n\u00f3 s\u1ebd kh\u00f4ng hi\u1ec7u qu\u1ea3 l\u1eafm, nh\u01b0ng ta c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n n\u00f3 v\u1edbi 2 b\u01b0\u1edbc t\u1ed1i \u01b0u, l\u00e0m cho n\u00f3 ch\u1ec9 t\u1ed1n th\u1eddi gian g\u1ea7n nh\u01b0 l\u00e0 h\u1eb1ng s\u1ed1 v\u1edbi m\u1ed7i l\u1eddi g\u1ecdi h\u00e0m.</p> <p>Nh\u01b0 ta \u0111\u00e3 \u0111\u1ec1 c\u1eadp, t\u1ea5t c\u1ea3 th\u00f4ng tin v\u1ec1 t\u1eadp c\u00e1c ph\u1ea7n t\u1eed s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u trong m\u1ea3ng <code>parent</code>.</p> <p>\u0110\u1ec3 t\u1ea1o m\u1ed9t t\u1eadp m\u1edbi (thao t\u00e1c <code>make_set(v)</code>), ta ch\u1ec9 c\u1ea7n t\u1ea1o m\u1ed9t c\u00e2y v\u1edbi g\u1ed1c \u1edf node <code>v</code>, ngh\u0129a l\u00e0 n\u00f3 s\u1ebd l\u00e0 cha c\u1ee7a ch\u00ednh n\u00f3.</p> <p>\u0110\u1ec3 k\u1ebft h\u1ee3p 2 t\u1eadp (thao t\u00e1c <code>union_sets(a, b)</code>), \u0111\u1ea7u ti\u00ean ta t\u00ecm \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp m\u00e0 <code>a</code> n\u1eb1m trong t\u1eadp \u0111\u00f3, v\u00e0 \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp m\u00e0 <code>b</code> n\u1eb1m trong t\u1eadp \u0111\u00f3. N\u1ebfu hai \u0111\u1ea1i di\u1ec7n gi\u1ed1ng nhau, th\u00ec ta kh\u00f4ng l\u00e0m g\u00ec th\u00eam, v\u00ec hai t\u1eadp n\u00e0y l\u00e0 nh\u01b0 nhau, ch\u00fang ta \u0111\u01b0\u1ee3c gh\u00e9p l\u1ea1i v\u1edbi nhau s\u1eb5n r\u1ed3i. Ng\u01b0\u1ee3c l\u1ea1i, ta c\u00f3 th\u1ec3 cho m\u1ed9t \u0111\u1ea1i di\u1ec7n l\u00e0 node cha c\u1ee7a \u0111\u1ea1i di\u1ec7n c\u00f2n l\u1ea1i, sau \u0111\u00f3 gh\u00e9p 2 c\u00e2y l\u1ea1i.</p> <p>Cu\u1ed1i c\u00f9ng l\u00e0 vi\u1ec7c t\u00ecm \u0111\u1ea1i di\u1ec7n (thao t\u00e1c <code>find_set(v)</code>): ta ch\u1ec9 c\u1ea7n \u0111i theo c\u00e1c node cha c\u1ee7a <code>v</code> cho \u0111\u1ebfn node g\u1ed1c, ngh\u0129a l\u00e0 t\u00ecm node cha cho \u0111\u1ebfn khi cha c\u1ee7a m\u1ed9t node l\u00e0 ch\u00ednh node \u0111\u00f3. Ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng c\u00e0i \u0111\u1eb7t v\u1edbi \u0111\u1ec7 quy.</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n}\n\nint find_set(int v) {\n    if (v == parent[v])\n        return v;\n    return find_set(parent[v]);\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b)\n        parent[b] = a;\n}\n</code></pre> <p>Tuy nhi\u00ean, c\u00e1ch c\u00e0i n\u00e0y kh\u00f4ng hi\u1ec7u qu\u1ea3. Ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng suy ra m\u1ed9t v\u00ed d\u1ee5 sao cho c\u00e2y l\u00e0 m\u1ed9t d\u00e3y d\u00e0i c\u00e1c node. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, m\u1ed7i l\u1ea7n g\u1ecdi <code>find_set(v)</code> s\u1ebd t\u1ed1n th\u1eddi gian \\(O(n)\\), c\u00f2n xa m\u1edbi \u0111\u1ebfn \u0111\u01b0\u1ee3c th\u1eddi gian m\u00e0 ta mu\u1ed1n (g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1). V\u00ec v\u1eady, ta s\u1ebd xem x\u00e9t hai b\u01b0\u1edbc t\u1ed1i \u01b0u \u0111\u1ec3 t\u0103ng t\u1ed1c r\u00f5 r\u1ec7t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#toi-uu-nen-uong-i","title":"T\u1ed1i \u01b0u n\u00e9n \u0111\u01b0\u1eddng \u0111i","text":"<p>\u0110\u00e2y l\u00e0 b\u01b0\u1edbc t\u1ed1i \u01b0u cho h\u00e0m <code>find_set(v)</code>.</p> <p>N\u1ebfu ta g\u1ecdi <code>find_set(v)</code> cho m\u1ed9t node <code>v</code> n\u00e0o \u0111\u00f3, ta s\u1ebd t\u00ecm \u0111\u1ea1i di\u1ec7n <code>p</code> cho t\u1ea5t c\u1ea3 c\u00e1c node ta th\u0103m tr\u00ean \u0111\u01b0\u1eddng \u0111i t\u1eeb <code>v</code> \u0111\u1ebfn <code>p</code>. Trick \u1edf \u0111\u00e2y l\u00e0 l\u00e0m \u0111\u01b0\u1eddng \u0111i n\u00e0y ng\u1eafn h\u01a1n, b\u1eb1ng c\u00e1ch set node cha c\u1ee7a m\u1ed7i \u0111\u1ec9nh \u0111\u01b0\u1ee3c th\u0103m th\u1eb3ng l\u00ean <code>p</code>.</p> <p>B\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y thao t\u00e1c n\u00e0y trong h\u00ecnh d\u01b0\u1edbi. B\u00ean tr\u00e1i l\u00e0 m\u1ed9t c\u00e1i c\u00e2y, c\u00f2n b\u00ean ph\u1ea3i l\u00e0 c\u00e1i c\u00e2y \u0111\u01b0\u1ee3c n\u00e9n sau khi g\u1ecdi <code>find_set(7)</code>, n\u00f3 s\u1ebd l\u00e0m cho \u0111\u01b0\u1eddng \u0111i ng\u1eafn h\u01a1n cho c\u00e1c node 7, 5, 3 v\u00e0 2.</p> <p></p> <p>C\u00e0i \u0111\u1eb7t m\u1edbi cho <code>find_set</code> nh\u01b0 sau:</p> <pre><code>int find_set(int v) {\n    if (v == parent[v])\n        return v;\n    return parent[v] = find_set(parent[v]);\n}\n</code></pre> <p>\u0110\u1ea7u ti\u00ean n\u00f3 s\u1ebd t\u00ecm \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp (node g\u1ed1c), sau \u0111\u00f3 trong qu\u00e1 tr\u00ecnh th\u00e1o stack, c\u00e1c node \u0111\u00e3 th\u0103m s\u1ebd \u0111\u01b0\u1ee3c g\u1eafn tr\u1ef1c ti\u1ebfp v\u00e0o \u0111\u1ea1i di\u1ec7n.</p> <p>Thay \u0111\u1ed5i \u0111\u01a1n gi\u1ea3n n\u00e0y \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian \\(O(\\log n)\\) trong trung b\u00ecnh m\u1ed7i l\u1ea7n g\u1ecdi (\u1edf \u0111\u00e2y kh\u00f4ng c\u00f3 ch\u1ee9ng minh). C\u00f3 m\u1ed9t thay \u0111\u1ed5i ti\u1ebfp theo s\u1ebd l\u00e0m cho n\u00f3 c\u00f2n nhanh h\u01a1n.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#chap-theo-kich-thuoc-cap-bac","title":"Ch\u1eadp theo k\u00edch th\u01b0\u1edbc / c\u1ea5p b\u1eadc","text":"<p>Trong b\u01b0\u1edbc t\u1ed1i \u01b0u n\u00e0y, ta s\u1ebd thay \u0111\u1ed5i thao t\u00e1c <code>union_set</code>. N\u00f3i \u0111\u00fang h\u01a1n, ta s\u1ebd thay \u0111\u1ed5i c\u00e1ch c\u00e2y n\u00e0y \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o c\u00e2y kia. Trong c\u00e1ch c\u00e0i tr\u00e2u, c\u00e2y th\u1ee9 hai lu\u00f4n \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o c\u00e2y \u0111\u1ea7u ti\u00ean. Trong th\u1ef1c t\u1ebf, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn vi\u1ec7c c\u00e2y ch\u1ee9a 1 \u0111o\u1ea1n d\u00e0i \\(O(n)\\). V\u1edbi t\u1ed1i \u01b0u n\u00e0y, ta s\u1ebd tr\u00e1nh \u0111\u01b0\u1ee3c vi\u1ec7c \u0111\u00f3 b\u1eb1ng c\u00e1ch ch\u1ecdn c\u1ea9n th\u1eadn vi\u1ec7c g\u1eafn.</p> <p>C\u00f3 r\u1ea5t nhi\u1ec1u kinh nghi\u1ec7m c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng. Trong \u0111\u00f3 ph\u1ed5 bi\u1ebfn nh\u1ea5t l\u00e0 hai c\u00e1ch ti\u1ebfp c\u1eadn sau:</p> <p>Trong c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ea7u ti\u00ean, ta s\u1eed d\u1ee5ng k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e2y l\u00e0m c\u1ea5p b\u1eadc v\u00e0 trong c\u00e1ch ti\u1ebfp c\u1eadn th\u1ee9 hai, ta s\u1eed d\u1ee5ng \u0111\u1ed9 s\u00e2u c\u1ee7a c\u00e2y (ch\u00ednh x\u00e1c h\u01a1n l\u00e0 c\u1eadn tr\u00ean c\u1ee7a \u0111\u1ed9 s\u00e2u c\u1ee7a c\u00e2y, v\u00ec \u0111\u1ed9 s\u00e2u s\u1ebd nh\u1ecf h\u01a1n khi \u00e1p d\u1ee5ng n\u00e9n \u0111\u01b0\u1eddng d\u1eabn).</p> <p>Trong c\u1ea3 hai c\u00e1ch ti\u1ebfp c\u1eadn, b\u1ea3n ch\u1ea5t c\u1ee7a vi\u1ec7c t\u1ed1i \u01b0u h\u00f3a l\u00e0 gi\u1ed1ng nhau: ta g\u1eafn c\u00e2y c\u00f3 c\u1ea5p b\u1eadc th\u1ea5p h\u01a1n v\u1edbi c\u00e2y c\u00f3 c\u1ea5p b\u1eadc cao h\u01a1n.</p> <p>V\u00e0 \u0111\u00e2y l\u00e0 c\u00e1ch c\u00e0i \u0111\u1eb7t ch\u1eadp theo k\u00edch th\u01b0\u1edbc:</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n    size[v] = 1;\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (size[a] &lt; size[b])\n            swap(a, b);\n        parent[b] = a;\n        size[a] += size[b];\n    }\n}\n</code></pre> <p>V\u00e0 \u0111\u00e2y l\u00e0 c\u00e1ch c\u00e0i \u0111\u1eb7t ch\u1eadp theo c\u1ea5p b\u1eadc d\u1ef1a v\u00e0o \u0111\u1ed9 s\u00e2u c\u1ee7a c\u00e1c c\u00e2y con:</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n    rank[v] = 0;\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (rank[a] &lt; rank[b])\n            swap(a, b);\n        parent[b] = a;\n        if (rank[a] == rank[b])\n            rank[a]++;\n    }\n}\n</code></pre> <p>C\u1ea3 hai ki\u1ec3u t\u1ed1i \u01b0u \u0111\u1ec1u t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u00e0 kh\u00f4ng gian. V\u00ec v\u1eady trong th\u1ef1c t\u1ebf, b\u1ea1n c\u00f3 th\u1ec3 d\u00f9ng c\u00e1i n\u00e0o c\u0169ng \u0111\u01b0\u1ee3c.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#o-phuc-tap-thoi-gian","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian","text":"<p>Nh\u01b0 \u0111\u00e3 n\u00f3i, n\u1ebfu ta k\u1ebft h\u1ee3p hai b\u01b0\u1edbc t\u1ed1i \u01b0u (n\u00e9n \u0111\u01b0\u1eddng \u0111i v\u1edbi ch\u1eadp theo k\u00edch th\u01b0\u1edbc / c\u1ea5p b\u1eadc), ta s\u1ebd ti\u1ebfn s\u00e1t \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p h\u1eb1ng s\u1ed1 khi truy v\u1ea5n. H\u00f3a ra, \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian ph\u00e2n b\u1ed5 cu\u1ed1i c\u00f9ng l\u00e0 \\(O(\\alpha(n))\\), trong \u0111\u00f3 \\(\\alpha(n)\\) l\u00e0 h\u00e0m Ackermann ngh\u1ecbch \u0111\u1ea3o, h\u00e0m n\u00e0y t\u0103ng r\u1ea5t ch\u1eadm. Tr\u00ean th\u1ef1c t\u1ebf, n\u00f3 t\u0103ng c\u1ef1c ch\u1eadm, kh\u00f4ng qu\u00e1 \\(4\\) cho t\u1ea5t c\u1ea3 \\(n\\) kh\u00f4ng qu\u00e1 l\u1edbn (t\u1ea7m \\(n &lt; 10^{600}\\)).</p> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p ph\u00e2n b\u1ed5 (amortized time) l\u00e0 t\u1ed5ng th\u1eddi gian cho m\u1ed7i thao t\u00e1c, \u0111\u01b0\u1ee3c \u0111\u00e1nh gi\u00e1 qua m\u1ed9t chu\u1ed7i nhi\u1ec1u thao t\u00e1c. \u00dd t\u01b0\u1edfng l\u00e0 \u0111\u1ea3m b\u1ea3o t\u1ed5ng th\u1eddi gian c\u1ee7a to\u00e0n b\u1ed9 chu\u1ed7i, \u0111\u1ed3ng th\u1eddi cho ph\u00e9p c\u00e1c thao t\u00e1c \u0111\u01a1n l\u1ebb ch\u1eadm h\u01a1n nhi\u1ec1u so v\u1edbi th\u1eddi gian ph\u00e2n b\u1ed5. V\u00ed d\u1ee5, trong tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ch\u00fang ta, m\u1ed9t l\u1eddi g\u1ecdi n\u00e0o \u0111\u00f3 c\u00f3 th\u1ec3 t\u1ed1n \\(O(\\log n)\\) trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, nh\u01b0ng n\u1ebfu ta g\u1ecdi \\(m\\) l\u1ea7n nh\u01b0 v\u1eady li\u00ean ti\u1ebfp, ta s\u1ebd c\u00f3 th\u1eddi gian trung b\u00ecnh l\u00e0 \\(O(\\alpha(n))\\).</p> <p>Ch\u1ee9ng minh kh\u00e1 d\u00e0i v\u00e0 ph\u1ee9c t\u1ea1p n\u00ean ta s\u1ebd kh\u00f4ng nghi\u00ean c\u1ee9u \u1edf \u0111\u00e2y.</p> <p>Ngo\u00e0i ra, l\u01b0u \u00fd l\u00e0 DSU v\u1edbi ch\u1eadp theo k\u00edch th\u01b0\u1edbc / th\u1ee9 b\u1eadc m\u00e0 kh\u00f4ng d\u00f9ng n\u00e9n \u0111\u01b0\u1eddng \u0111i th\u00ec c\u00f3 th\u1eddi gian l\u00e0 \\(O(\\log n)\\) cho m\u1ed7i truy v\u1ea5n.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#lien-ket-theo-chi-so-lien-ket-tung-ong-xu","title":"Li\u00ean k\u1ebft theo ch\u1ec9 s\u1ed1 / Li\u00ean k\u1ebft tung \u0111\u1ed3ng xu","text":"<p>C\u1ea3 vi\u1ec7c ch\u1eadp theo c\u1ea5p b\u1eadc v\u00e0 ch\u1eadp theo k\u00edch th\u01b0\u1edbc \u0111\u1ec1u y\u00eau c\u1ea7u l\u01b0u tr\u1eef d\u1eef li\u1ec7u b\u1ed5 sung cho t\u1eebng t\u1eadp v\u00e0 duy tr\u00ec c\u00e1c gi\u00e1 tr\u1ecb n\u00e0y trong m\u1ed7i thao t\u00e1c ch\u1eadp. Ngo\u00e0i ra c\u00f2n t\u1ed3n t\u1ea1i m\u1ed9t thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean, gi\u00fap \u0111\u01a1n gi\u1ea3n h\u00f3a thao t\u00e1c ch\u1eadp m\u1ed9t ch\u00fat: ch\u1eadp theo ch\u1ec9 s\u1ed1.</p> <p>Ta g\u00e1n cho m\u1ed7i t\u1eadp m\u1ed9t gi\u00e1 tr\u1ecb ng\u1eabu nhi\u00ean \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 ch\u1ec9 s\u1ed1, v\u00e0 ta g\u1eafn t\u1eadp c\u00f3 ch\u1ec9 s\u1ed1 nh\u1ecf h\u01a1n v\u1edbi t\u1eadp c\u00f3 ch\u1ec9 s\u1ed1 l\u1edbn h\u01a1n. S\u1ebd c\u00f3 kh\u1ea3 n\u0103ng l\u00e0 m\u1ed9t t\u1eadp to h\u01a1n s\u1ebd c\u00f3 ch\u1ec9 s\u1ed1 l\u1edbn h\u01a1n t\u1eadp h\u1ee3p nh\u1ecf h\u01a1n, do \u0111\u00f3 thao t\u00e1c n\u00e0y c\u00f3 li\u00ean quan ch\u1eb7t ch\u1ebd v\u1edbi vi\u1ec7c ch\u1eadp theo k\u00edch th\u01b0\u1edbc. Th\u1ef1c ra, c\u00f3 th\u1ec3 ch\u1ee9ng minh r\u1eb1ng thao t\u00e1c n\u00e0y c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p v\u1ec1 th\u1eddi gian t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ph\u00e9p ch\u1eadp theo k\u00edch th\u01b0\u1edbc. Tuy nhi\u00ean, trong th\u1ef1c t\u1ebf, n\u00f3 ch\u1eadm h\u01a1n m\u1ed9t ch\u00fat so v\u1edbi ch\u1eadp theo k\u00edch th\u01b0\u1edbc.</p> <pre><code>void make_set(int v) {\n    parent[v] = v;\n    index[v] = rand();\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (index[a] &lt; index[b])\n            swap(a, b);\n        parent[b] = a;\n    }\n}\n</code></pre> <p>C\u00f3 m\u1ed9t quan ni\u1ec7m sai l\u1ea7m ph\u1ed5 bi\u1ebfn r\u1eb1ng ch\u1ec9 c\u1ea7n tung m\u1ed9t \u0111\u1ed3ng xu, \u0111\u1ec3 quy\u1ebft \u0111\u1ecbnh t\u1eadp n\u00e0o ch\u00fang ta g\u1eafn v\u1edbi t\u1eadp n\u00e0o, c\u0169ng c\u00f3 c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p v\u1edbi nh\u1eefng k\u0129 thu\u1eadt tr\u00ean. Tuy nhi\u00ean \u0111i\u1ec1u \u0111\u00f3 kh\u00f4ng \u0111\u00fang. B\u00e0i b\u00e1o khoa h\u1ecdc \u1edf tr\u00ean ph\u1ecfng \u0111o\u00e1n r\u1eb1ng ch\u1eadp ki\u1ec3u tung \u0111\u1ed3ng xu k\u1ebft h\u1ee3p v\u1edbi n\u00e9n \u0111\u01b0\u1eddng \u0111i c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(\\Omega\\left(n \\frac{\\log n}{\\log \\log n}\\right)\\). V\u00e0 trong c\u00e1c benchmark, n\u00f3 ho\u1ea1t \u0111\u1ed9ng k\u00e9m h\u01a1n nhi\u1ec1u so v\u1edbi ch\u1eadp theo k\u00edch th\u01b0\u1edbc / c\u1ea5p b\u1eadc ho\u1eb7c ch\u1eadp theo ch\u1ec9 s\u1ed1.</p> <pre><code>void union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (rand() % 2)\n            swap(a, b);\n        parent[b] = a;\n    }\n}\n</code></pre>"},{"location":"cp-algorithms/data-structures/trees/dsu/#cac-ung-dung-va-cai-tien","title":"C\u00e1c \u1ee9ng d\u1ee5ng v\u00e0 c\u1ea3i ti\u1ebfn","text":"<p>Trong ph\u1ea7n n\u00e0y, ch\u00fang ta xem x\u00e9t m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y, bao g\u1ed3m c\u00e1c \u1ee9ng d\u1ee5ng th\u00f4ng th\u01b0\u1eddng v\u00e0 m\u1ed9t s\u1ed1 c\u1ea3i ti\u1ebfn c\u1ee7a DSU.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#cac-thanh-phan-lien-thong-trong-o-thi","title":"C\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong \u0111\u1ed3 th\u1ecb","text":"<p>\u0110\u00e2y l\u00e0 m\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng d\u1ec5 th\u1ea5y nh\u1ea5t c\u1ee7a DSU.</p> <p>B\u00e0i to\u00e1n s\u1ebd nh\u01b0 sau: Ta c\u00f3 m\u1ed9t \u0111\u1ed3 th\u1ecb r\u1ed7ng, ta s\u1ebd ph\u1ea3i th\u00eam c\u00e1c \u0111\u1ec9nh v\u00e0 c\u1ea1nh v\u00f4 h\u01b0\u1edbng v\u00e0o, v\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n theo d\u1ea1ng \\((a, b)\\) - c\u00e1c \u0111\u1ec9nh \\(a\\) v\u00e0 \\(b\\) c\u00f3 n\u1eb1m trong c\u00f9ng m\u1ed9t th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ee7a \u0111\u1ed3 th\u1ecb kh\u00f4ng?</p> <p>\u1ede \u0111\u00e2y ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng tr\u1ef1c ti\u1ebfp DSU, v\u00e0 l\u1ea5y k\u1ebft qu\u1ea3 trong th\u1eddi gian trung b\u00ecnh g\u1ea7n nh\u01b0 l\u00e0 h\u1eb1ng s\u1ed1.</p> <p>\u1ee8ng d\u1ee5ng n\u00e0y kh\u00e1 quan tr\u1ecdng, v\u00ec b\u00e0i to\u00e1n g\u1ea7n nh\u01b0 t\u01b0\u01a1ng t\u1ef1 \u0111\u00e3 xu\u1ea5t hi\u1ec7n trong Thu\u1eadt to\u00e1n Kruskal t\u00ecm c\u00e2y khung nh\u1ecf nh\u1ea5t. V\u1edbi DSU ta c\u00f3 th\u1ec3 c\u1ea3i ti\u1ebfn n\u00f3 t\u1eeb \\(O(m \\log n + n^2)\\) l\u00ean \\(O(m \\log n)\\).</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#tim-cac-thanh-phan-lien-thong-trong-mot-hinh-anh","title":"T\u00ecm c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng trong m\u1ed9t h\u00ecnh \u1ea3nh","text":"<p>Ta c\u00f3 b\u00e0i to\u00e1n sau: cho m\u1ed9t h\u00ecnh \u1ea3nh c\u00f3 \\(n \\times m\\) pixel. Ban \u0111\u1ea7u c\u00e1c pixel \u0111\u1ec1u tr\u1eafng, nh\u01b0ng sau \u0111\u00f3 ng\u01b0\u1eddi ta v\u1ebd l\u00ean m\u1ed9t s\u1ed1 pixel \u0111en. Ta mu\u1ed1n t\u00ecm k\u00edch th\u01b0\u1edbc c\u1ee7a m\u1ed7i th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng tr\u1eafng trong h\u00ecnh sau c\u00f9ng.</p> <p>V\u1ec1 \u0111\u00e1p \u00e1n th\u00ec ta \u0111\u01a1n gi\u1ea3n duy\u1ec7t t\u1ea5t c\u1ea3 c\u00e1c pixel tr\u1eafng c\u1ee7a h\u00ecnh, v\u1edbi m\u1ed7i \u00f4 duy\u1ec7t 4 \u00f4 k\u1ec1 n\u00f3, v\u00e0 n\u1ebfu \u00f4 k\u1ec1 c\u0169ng tr\u1eafng th\u00ec g\u1ecdi <code>union_sets</code>. V\u1eady ta s\u1ebd c\u00f3 m\u1ed9t DSU v\u1edbi \\(n m\\) \u0111\u1ec9nh t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c pixel trong h\u00ecnh. C\u00e1c c\u00e2y k\u1ebft qu\u1ea3 trong DSU l\u00e0 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ea7n t\u00ecm.</p> <p>B\u00e0i n\u00e0y c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3i v\u1edbi DFS hay BFS, nh\u01b0ng c\u00e1ch tr\u00ean c\u00f3 m\u1ed9t \u01b0u \u0111i\u1ec3m: n\u00f3 c\u00f3 th\u1ec3 x\u1eed l\u00fd b\u1ea3ng theo t\u1eebng h\u00e0ng (ngh\u0129a l\u00e0 ta ch\u1ec9 c\u1ea7n h\u00e0ng hi\u1ec7n t\u1ea1i v\u00e0 h\u00e0ng tr\u01b0\u1edbc n\u00f3, v\u00e0 ch\u1ec9 c\u1ea7n x\u00e2y d\u1ef1ng m\u1ed9t DSU cho m\u1ed9t h\u00e0ng) trong kh\u00f4ng gian \\(O(\\min(n, m))\\).</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#luu-thong-tin-them-vao-moi-tap","title":"L\u01b0u th\u00f4ng tin th\u00eam v\u00e0o m\u1ed7i t\u1eadp","text":"<p>DSU cho ph\u00e9p ta l\u01b0u th\u00f4ng tin th\u00eam v\u00e0o c\u00e1c t\u1eadp m\u1ed9t c\u00e1ch d\u1ec5 d\u00e0ng.</p> <p>M\u1ed9t v\u00ed d\u1ee5 l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u00e1c t\u1eadp: l\u01b0u k\u00edch th\u01b0\u1edbc \u0111\u00e3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 trong ph\u1ea7n Ch\u1eadp theo k\u00edch th\u01b0\u1edbc (th\u00f4ng tin \u0111\u01b0\u1ee3c l\u01b0u v\u00e0o \u0111\u1ea1i di\u1ec7n hi\u1ec7n t\u1ea1i c\u1ee7a t\u1eadp).</p> <p>B\u1eb1ng c\u00e1ch t\u01b0\u01a1ng t\u1ef1 - ngh\u0129a l\u00e0 l\u01b0u theo \u0111\u1ec9nh \u0111\u1ea1i di\u1ec7n - ta c\u0169ng c\u00f3 th\u1ec3 l\u01b0u b\u1ea5t c\u1ee9 th\u00f4ng tin n\u00e0o c\u1ee7a t\u1eadp m\u00e0 ta mu\u1ed1n.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#nen-cac-buoc-nhay-tren-oan-to-mau-oan-con-offline","title":"N\u00e9n c\u00e1c b\u01b0\u1edbc nh\u1ea3y tr\u00ean \u0111o\u1ea1n / T\u00f4 m\u00e0u \u0111o\u1ea1n con offline","text":"<p>B\u00e0i to\u00e1n nh\u01b0 sau: C\u00f3 m\u1ed9t t\u1eadp c\u00e1c \u0111\u1ec9nh, v\u00e0 m\u1ed7i \u0111\u1ec9nh c\u00f3 m\u1ed9t c\u1ea1nh n\u1ed1i v\u1edbi m\u1ed9t \u0111\u1ec9nh kh\u00e1c. V\u1edbi DSU b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm \u0111\u1ec9nh cu\u1ed1i c\u00f9ng tr\u00ean d\u00e3y c\u00e1c \u0111\u1ec9nh m\u00e0 ta \u0111i theo c\u00e1c c\u1ea1nh t\u1eeb \u0111\u1ec9nh \u0111\u1ea7u ti\u00ean, trong th\u1eddi gian g\u1ea7n nh\u01b0 h\u1eb1ng s\u1ed1.</p> <p>M\u1ed9t v\u00ed d\u1ee5 c\u1ee7a \u1ee9ng d\u1ee5ng n\u00e0y l\u00e0 b\u00e0i to\u00e1n t\u00f4 m\u00e0u \u0111o\u1ea1n con. Ta c\u00f3 m\u1ed9t \u0111o\u1ea1n \u0111\u1ed9 d\u00e0i \\(L\\), m\u1ed7i ph\u1ea7n t\u1eed ban \u0111\u1ea7u c\u00f3 m\u00e0u \\(0\\). Ta ph\u1ea3i t\u00f4 l\u1ea1i \u0111o\u1ea1n \\([l, r]\\) v\u1edbi m\u00e0u \\(c\\) cho m\u1ed7i truy v\u1ea5n \\((l, r, c)\\). Cu\u1ed1i c\u00f9ng ta mu\u1ed1n t\u00ecm m\u00e0u c\u1ee7a m\u1ed7i \u00f4 sau khi t\u00f4 xong. Ta gi\u1ea3 s\u1eed r\u1eb1ng ta bi\u1ebft t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n r\u1ed3i, ngh\u0129a l\u00e0 ta c\u00f3 th\u1ec3 x\u1eed l\u00fd offline.</p> <p>V\u1ec1 \u0111\u00e1p \u00e1n, ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t DSU, v\u1edbi m\u1ed7i \u00f4, ta li\u00ean k\u1ebft n\u00f3 \u0111\u1ebfn m\u1ed9t \u00f4 ch\u01b0a t\u00f4 ti\u1ebfp theo. Nh\u01b0 v\u1eady ban \u0111\u1ea7u m\u1ed7i \u00f4 tr\u1ecf \u0111\u1ebfn ch\u00ednh n\u00f3. Sau khi t\u00f4 m\u00e0u m\u1ed9t \u0111o\u1ea1n, t\u1ea5t c\u1ea3 c\u00e1c \u00f4 trong \u0111o\u1ea1n \u0111\u00f3 s\u1ebd tr\u1ecf \u0111\u1ebfn \u00f4 n\u1eb1m sau \u0111o\u1ea1n \u0111\u00f3.</p> <p>Gi\u1edd \u0111\u1ec3 gi\u1ea3i b\u00e0i n\u00e0y, ta x\u00e9t c\u00e1c truy v\u1ea5n theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i: t\u1eeb cu\u1ed1i l\u00ean \u0111\u1ea7u. B\u1eb1ng c\u00e1ch n\u00e0y, khi th\u1ef1c hi\u1ec7n m\u1ed9t truy v\u1ea5n, ta ch\u1ec9 c\u1ea7n t\u00f4 nh\u1eefng \u00f4 ch\u01b0a t\u00f4 trong \u0111o\u1ea1n con \\([l, r]\\). C\u00e1c \u00f4 c\u00f2n l\u1ea1i \u0111\u00e3 \u0111\u01b0\u1ee3c t\u00f4 m\u00e0u tr\u00f9ng v\u1edbi m\u00e0u sau khi th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c truy v\u1ea5n. \u0110\u1ec3 duy\u1ec7t qua t\u1ea5t c\u1ea3 c\u00e1c \u00f4 ch\u01b0a t\u00f4, ta d\u00f9ng DSU. Ta t\u00ecm \u00f4 ch\u01b0a t\u00f4 b\u00ean tr\u00e1i nh\u1ea5t trong \u0111o\u1ea1n, t\u00f4 n\u00f3, v\u00e0 v\u1edbi con tr\u1ecf \u0111\u00e3 l\u01b0u th\u00ec ta \u0111i \u0111\u1ebfn \u00f4 ch\u01b0a t\u00f4 ti\u1ebfp theo.</p> <p>\u1ede \u0111\u00e2y ta c\u00f3 th\u1ec3 d\u00f9ng DSU v\u1edbi n\u00e9n \u0111\u01b0\u1eddng \u0111i, nh\u01b0ng ta kh\u00f4ng th\u1ec3 d\u00f9ng ch\u1eadp theo k\u00edch th\u01b0\u1edbc / th\u1ee9 b\u1eadc (v\u00ec \u0111\u1ea1i di\u1ec7n sau khi ch\u1eadp r\u1ea5t quan tr\u1ecdng). V\u1eady n\u00ean \u0111\u1ed9 ph\u1ee9c t\u1ea1p s\u1ebd l\u00e0 \\(O(\\log n)\\) m\u1ed7i l\u1ea7n ch\u1eadp (c\u0169ng kh\u00e1 nhanh).</p> <p>C\u00e0i \u0111\u1eb7t:</p> <pre><code>for (int i = 0; i &lt;= L; i++) {\n    make_set(i);\n}\n\nfor (int i = m-1; i &gt;= 0; i--) {\n    int l = query[i].l;\n    int r = query[i].r;\n    int c = query[i].c;\n    for (int v = find_set(l); v &lt;= r; v = find_set(v)) {\n        answer[v] = c;\n        parent[v] = v + 1;\n    }\n}\n</code></pre> <p>C\u00f3 m\u1ed9t b\u01b0\u1edbc t\u1ed1i \u01b0u \u1edf \u0111\u00e2y, ta c\u00f3 th\u1ec3 d\u00f9ng ch\u1eadp theo th\u1ee9 b\u1eadc, n\u1ebfu ta l\u01b0u \u00f4 ch\u01b0a t\u00f4 ti\u1ebfp theo trong m\u1ed9t m\u1ea3ng <code>end[]</code>. Nh\u01b0 th\u1ebf ta c\u00f3 th\u1ec3 ch\u1eadp 2 t\u1eadp th\u00e0nh m\u1ed9t d\u1ef1a v\u00e0o heuristic v\u00e0 ta c\u00f3 th\u1ec3 gi\u1ea3i trong \\(O(\\alpha(n))\\).</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#lay-khoang-cach-en-ai-dien","title":"L\u1ea5y kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n","text":"<p>\u0110\u00f4i khi trong m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng c\u1ee5 th\u1ec3 c\u1ee7a DSU, b\u1ea1n c\u1ea7n ph\u1ea3i duy tr\u00ec kho\u1ea3ng c\u00e1ch gi\u1eefa m\u1ed9t \u0111\u1ec9nh v\u00e0 \u0111\u1ea1i di\u1ec7n trong t\u1eadp ch\u1ee9a n\u00f3 (ngh\u0129a l\u00e0 \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i tr\u00ean c\u00e2y t\u1eeb \u0111\u1ec9nh hi\u1ec7n t\u1ea1i \u0111\u1ebfn g\u1ed1c c\u1ee7a c\u00e2y).</p> <p>N\u1ebfu kh\u00f4ng d\u00f9ng n\u00e9n \u0111\u01b0\u1eddng \u0111i, kho\u1ea3ng c\u00e1ch ch\u1ec9 l\u00e0 s\u1ed1 l\u1ea7n g\u1ecdi \u0111\u1ec7 quy, nh\u01b0ng n\u00f3 kh\u00f4ng hi\u1ec7u qu\u1ea3 l\u1eafm. Tuy nhi\u00ean, ta c\u00f3 th\u1ec3 d\u00f9ng n\u00e9n \u0111\u01b0\u1eddng \u0111i, n\u1ebfu ta l\u01b0u kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ec9nh cha v\u00e0o m\u1ed7i node.</p> <p>Trong c\u00e0i \u0111\u1eb7t n\u00f3 s\u1ebd ti\u1ec7n h\u01a1n khi d\u00f9ng m\u1ea3ng c\u00e1c pair cho <code>parent[]</code> v\u00e0 h\u00e0m <code>find_set</code> gi\u1edd s\u1ebd tr\u1ea3 v\u1ec1 hai s\u1ed1: d\u1ea1i di\u1ec7n v\u00e0 kho\u1ea3ng c\u00e1ch \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n.</p> <pre><code>void make_set(int v) {\n    parent[v] = make_pair(v, 0);\n    rank[v] = 0;\n}\n\npair&lt;int, int&gt; find_set(int v) {\n    if (v != parent[v].first) {\n        int len = parent[v].second;\n        parent[v] = find_set(parent[v].first);\n        parent[v].second += len;\n    }\n    return parent[v];\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a).first;\n    b = find_set(b).first;\n    if (a != b) {\n        if (rank[a] &lt; rank[b])\n            swap(a, b);\n        parent[b] = make_pair(a, 1);\n        if (rank[a] == rank[b])\n            rank[a]++;\n    }\n}\n</code></pre>"},{"location":"cp-algorithms/data-structures/trees/dsu/#lay-tinh-chan-le-cua-o-dai-uong-i-kiem-tra-tinh-hai-phia-online","title":"L\u1ea5y t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i / Ki\u1ec3m tra t\u00ednh hai ph\u00eda online","text":"<p>B\u1eb1ng c\u00e1ch t\u00ednh kho\u1ea3ng c\u00e1ch t\u1eeb \u0111\u1ec9nh \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n nh\u01b0 v\u1eady, ta c\u0169ng c\u00f3 th\u1ec3 duy tr\u00ec t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i. Nh\u01b0ng v\u00ec sao ta l\u1ea1i cho n\u00f3 m\u1ed9t m\u1ee5c \u1ee9ng d\u1ee5ng ri\u00eang v\u1eady?</p> <p>B\u00e0i to\u00e1n \u0111\u1eb7t ra nh\u01b0 sau: \u0110\u1ea7u ti\u00ean ta c\u00f3 m\u1ed9t \u0111\u1ed3 th\u1ecb r\u1ed7ng, sau \u0111\u00f3 ta c\u00f3 th\u1ec3 th\u00eam c\u1ea1nh, v\u00e0 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n d\u01b0\u1edbi d\u1ea1ng \"cho m\u1ed9t \u0111\u1ec9nh, th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a \u0111\u1ec9nh n\u00e0y c\u00f3 ph\u1ea3i l\u00e0 th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng hai ph\u00eda hay kh\u00f4ng?\".</p> <p>\u0110\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c b\u00e0i n\u00e0y, ta t\u1ea1o m\u1ed9t DSU l\u01b0u c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng v\u00e0 l\u01b0u t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a \u0111\u01b0\u1eddng \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a \u0111\u1ec9nh \u0111\u00f3. V\u1eady ta c\u00f3 th\u1ec3 ki\u1ec3m tra n\u1ebfu th\u00eam c\u1ea1nh l\u00e0m cho \u0111\u1ed3 th\u1ecb m\u1ea5t t\u00ednh hai ph\u00eda hay kh\u00f4ng: c\u1ee5 th\u1ec3 l\u00e0 n\u1ebfu hai \u0111\u1ec9nh c\u1ee7a c\u1ea1nh n\u1eb1m c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng v\u00e0 c\u00f3 c\u00f9ng t\u00ednh ch\u1eb5n l\u1ebb khi x\u00e9t \u0111\u1ed9 d\u00e0i \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n, th\u00ec th\u00eam c\u1ea1nh n\u00e0y s\u1ebd t\u1ea1o ra m\u1ed9t chu tr\u00ecnh l\u1ebb, l\u00e0m \u0111\u1ed3 th\u1ecb m\u1ea5t t\u00ednh hai ph\u00eda.</p> <p>C\u00e1i kh\u00f3 \u1edf \u0111\u00e2y l\u00e0 l\u00e0m sao t\u00ednh \u0111\u01b0\u1ee3c t\u00ednh ch\u1eb5n l\u1ebb trong h\u00e0m <code>union_find</code>.</p> <p>N\u1ebfu ta th\u00eam c\u1ea1nh \\((a, b)\\) n\u1ed1i hai th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng th\u00e0nh m\u1ed9t, th\u00ec khi g\u1eafn c\u00e2y n\u00e0y v\u00e0o c\u00e2y kia ta c\u1ea7n ph\u1ea3i t\u00ednh \u0111i\u1ec1u ch\u1ec9nh t\u00ednh ch\u1eb5n l\u1ebb.</p> <p>Ta s\u1ebd t\u00ecm c\u00f4ng th\u1ee9c t\u00ednh to\u00e1n t\u00ednh ch\u1eb5n l\u1ebb cho \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp s\u1ebd \u0111\u01b0\u1ee3c g\u1eafn v\u00e0o t\u1eadp kh\u00e1c. G\u1ecdi \\(x\\) l\u00e0 t\u00ednh ch\u1eb3n l\u1ebd c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i t\u1eeb \u0111\u1ec9nh \\(a\\) l\u00ean \u0111\u1ea1i di\u1ec7n \\(A\\), \\(y\\) l\u00e0 t\u00ednh ch\u1eb3n l\u1ebd c\u1ee7a \u0111\u1ed9 d\u00e0i \u0111\u01b0\u1eddng \u0111i t\u1eeb \u0111\u1ec9nh \\(b\\) l\u00ean \u0111\u1ea1i di\u1ec7n \\(B\\), v\u00e0 \\(t\\) l\u00e0 t\u00ednh ch\u1eb5n l\u1ebb c\u1ea7n m\u00e0 ta ph\u1ea3i g\u00e1n cho \\(B\\) sau khi ch\u1eadp. \u0110\u01b0\u1eddng \u0111i bao g\u1ed3m 3 ph\u1ea7n: t\u1eeb \\(B\\) \u0111\u1ebfn \\(b\\), t\u1eeb \\(b\\) \u0111\u1ebfn \\(a\\), \u0111\u01b0\u1ee3c n\u1ed1i v\u1edbi nhau b\u1eb1ng m\u1ed9t c\u1ea1nh v\u00e0 c\u00f3 t\u00ednh ch\u1eb5n l\u1ebb l\u00e0 \\(1\\), v\u00e0 t\u1eeb \\(a\\) \u0111\u1ebfn \\(A\\). Do \u0111\u00f3 ta c\u00f3 c\u00f4ng th\u1ee9c (\\(\\oplus\\) l\u00e0 bi\u1ec3u th\u1ecb ph\u00e9p to\u00e1n XOR):</p> \\[t = x \\oplus y \\oplus 1\\] <p>Nh\u01b0 v\u1eady, kh\u00f4ng quan tr\u1ecdng ta ch\u1eadp bao nhi\u00eau l\u1ea7n, t\u00ednh ch\u1eb5n l\u1ebb c\u1ee7a c\u00e1c c\u1ea1nh \u0111\u01b0\u1ee3c mang t\u1eeb \u0111\u1ea1i di\u1ec7n n\u00e0y sang \u0111\u1ea1i di\u1ec7n kh\u00e1c.</p> <p>\u1ede d\u01b0\u1edbi l\u00e0 c\u00e0i \u0111\u1eb7t DSU v\u1edbi t\u00ednh ch\u1eb5n l\u1ebb. Nh\u01b0 ph\u1ea7n tr\u01b0\u1edbc th\u00ec ta d\u00f9ng pair \u0111\u1ec3 l\u01b0u \u0111\u1ec9nh cha v\u00e0 t\u00ednh ch\u1eb5n l\u1ebb. Th\u00eam v\u00e0o \u0111\u00f3, v\u1edbi m\u1ed7i t\u1eadp ta l\u01b0u s\u1ebd trong m\u1ea3ng <code>bipartite[]</code> \u0111\u1ec3 xem n\u00f3 c\u00f3 hai ph\u00eda hay kh\u00f4ng.</p> <pre><code>void make_set(int v) {\n    parent[v] = make_pair(v, 0);\n    rank[v] = 0;\n    bipartite[v] = true;\n}\n\npair&lt;int, int&gt; find_set(int v) {\n    if (v != parent[v].first) {\n        int parity = parent[v].second;\n        parent[v] = find_set(parent[v].first);\n        parent[v].second ^= parity;\n    }\n    return parent[v];\n}\n\nvoid add_edge(int a, int b) {\n    pair&lt;int, int&gt; pa = find_set(a);\n    a = pa.first;\n    int x = pa.second;\n\n    pair&lt;int, int&gt; pb = find_set(b);\n    b = pb.first;\n    int y = pb.second;\n\n    if (a == b) {\n        if (x == y)\n            bipartite[a] = false;\n    } else {\n        if (rank[a] &lt; rank[b])\n            swap (a, b);\n        parent[b] = make_pair(a, x^y^1);\n        bipartite[a] &amp;= bipartite[b];\n        if (rank[a] == rank[b])\n            ++rank[a];\n    }\n}\n\nbool is_bipartite(int v) {\n    return bipartite[find_set(v).first];\n}\n</code></pre>"},{"location":"cp-algorithms/data-structures/trees/dsu/#arpa","title":"Offline RMQ (range minimum query) trong trung b\u00ecnh \\(O(\\alpha(n))\\) / Arpa's trick","text":"<p>Cho m\u1ea3ng <code>a[]</code> v\u00e0 ta ph\u1ea3i t\u00ednh min c\u1ee7a m\u1ed9t s\u1ed1 \u0111o\u1ea1n tr\u00ean m\u1ea3ng.</p> <p>\u00dd t\u01b0\u1edfng \u0111\u1ec3 gi\u1ea3i v\u1edbi DSU l\u00e0 nh\u01b0 sau: Duy\u1ec7t m\u1ea3ng v\u00e0 khi ta \u0111ang \u1edf ph\u1ea7n t\u1eed th\u1ee9 <code>i</code>, ta s\u1ebd tr\u1ea3 l\u1eddi t\u1ea5t c\u1ea3 truy v\u1ea5n <code>(L, R)</code> v\u1edbi <code>R == i</code>. \u0110\u1ec3 t\u00ednh m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, ta s\u1ebd d\u00f9ng DSU v\u1edbi <code>i</code> ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean v\u1edbi c\u1ea5u tr\u00fac nh\u01b0 sau: \u0111\u1ec9nh cha c\u1ee7a m\u1ed9t ph\u1ea7n t\u1eed l\u00e0 ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n n\u00f3 g\u1ea7n nh\u1ea5t b\u00ean ph\u1ea3i. Sau \u0111\u00f3 ta d\u00f9ng c\u1ea5u tr\u00fac n\u00e0y \u0111\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t truy v\u1ea5n s\u1ebd l\u00e0 <code>a[find_set(L)]</code>, s\u1ed1 nh\u1ecf nh\u1ea5t b\u00ean ph\u1ea3i <code>L</code>.</p> <p>C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y hi\u1ec7u qu\u1ea3 khi l\u00e0m offline, ngh\u0129a l\u00e0 khi ta bi\u1ebft t\u1ea5t c\u1ea3 truy v\u1ea5n tr\u01b0\u1edbc \u0111\u00f3.</p> <p>D\u1ec5 th\u1ea5y l\u00e0 ta c\u00f3 th\u1ec3 n\u00e9n \u0111\u01b0\u1eddng \u0111i \u1edf \u0111\u00e2y. V\u00e0 ta c\u0169ng c\u00f3 th\u1ec3 d\u00f9ng ch\u1eadp theo c\u1ea5p b\u1eadc, n\u1ebfu ta l\u01b0u \u0111\u1ea1i di\u1ec7n trong m\u1ed9t m\u1ea3ng ri\u00eang.</p> <pre><code>struct Query {\n    int L, R, idx;\n};\n\nvector&lt;int&gt; answer;\nvector&lt;vector&lt;Query&gt;&gt; container;\n</code></pre> <p><code>container[i]</code> ch\u1ee9a t\u1ea5t c\u1ea3 truy v\u1ea5n v\u1edbi <code>R == i</code>.</p> <pre><code>stack&lt;int&gt; s;\nfor (int i = 0; i &lt; n; i++) {\n    while (!s.empty() &amp;&amp; a[s.top()] &gt; a[i]) {\n        parent[s.top()] = i;\n        s.pop();\n    }\n    s.push(i);\n    for (Query q : container[i]) {\n        answer[q.idx] = a[find_set(q.L)];\n    }\n}\n</code></pre> <p>Thu\u1eadt n\u00e0y ng\u00e0y nay g\u1ecdi l\u00e0 Arpa's trick. N\u00f3 \u0111\u01b0\u1ee3c \u0111\u1eb7t theo t\u00ean c\u1ee7a AmirReza Poorakhavan, ng\u01b0\u1eddi \u0111\u00e3 t\u00ecm ra v\u00e0 ph\u1ed5 bi\u1ebfn k\u1ef9 thu\u1eadt n\u00e0y. M\u1eb7c d\u00f9 thu\u1eadt to\u00e1n n\u00e0y \u0111\u00e3 t\u1ed3n t\u1ea1i tr\u01b0\u1edbc khi anh n\u00e0y t\u00ecm ra n\u00f3.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#offline-lca-lowest-common-ancestor-in-a-tree-trong-trung-binh-oalphan","title":"Offline LCA (lowest common ancestor in a tree) trong trung b\u00ecnh \\(O(\\alpha(n))\\)","text":"<p>Thu\u1eadt to\u00e1n t\u00ecm LCA \u0111\u00e3 \u0111\u01b0\u1ee3c n\u00f3i \u0111\u1ebfn trong b\u00e0i Lowest Common Ancestor - Tarjan's off-line algorithm. Thu\u1eadt to\u00e1n n\u00e0y so s\u00e1nh thu\u1eadn l\u1ee3i v\u1edbi c\u00e1c thu\u1eadt to\u00e1n t\u00ecm LCA kh\u00e1c do t\u00ednh \u0111\u01a1n gi\u1ea3n c\u1ee7a n\u00f3 (\u0111\u1eb7c bi\u1ec7t l\u00e0 khi so v\u1edbi thu\u1eadt to\u00e1n t\u1ed1i \u01b0u nh\u01b0 thu\u1eadt to\u00e1n c\u1ee7a Farach-Colton v\u00e0 Bender).</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#luu-tuong-minh-dsu-vao-mot-set-list-ung-dung-cua-y-tuong-nay-khi-chap-nhieu-cau-truc-du-lieu","title":"L\u01b0u t\u01b0\u1eddng minh DSU v\u00e0o m\u1ed9t set list / \u1ee8ng d\u1ee5ng c\u1ee7a \u00fd t\u01b0\u1edfng n\u00e0y khi ch\u1eadp nhi\u1ec1u c\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<p>M\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 l\u01b0u DSU l\u00e0 l\u01b0u m\u1ed7i t\u1eadp theo d\u1ea1ng t\u01b0\u1eddng minh c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a t\u1eadp \u0111\u00f3. C\u00f9ng l\u00fac th\u00ec m\u1ed7i ph\u1ea7n t\u1eed c\u0169ng l\u01b0u tham chi\u1ebfu \u0111\u1ebfn \u0111\u1ea1i di\u1ec7n c\u1ee7a t\u1eadp ch\u1ee9a n\u00f3.</p> <p>Tho\u1ea1t nh\u00ecn th\u00ec \u0111\u00e2y c\u00f3 v\u1ebb nh\u01b0 l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u kh\u00f4ng hi\u1ec7u qu\u00e1: khi ch\u1eadp 2 t\u1eadp th\u00ec ta ph\u1ea3i th\u00eam m\u1ed9t d\u00e3y v\u00e0o sau d\u00e3y kia v\u00e0 c\u1eadp nh\u1eadt \u0111\u1ea1i di\u1ec7n c\u1ee7a m\u1ed9t trong hai t\u1eadp.</p> <p>Tuy nhi\u00ean, h\u00f3a ra, vi\u1ec7c s\u1eed d\u1ee5ng heuristic tr\u1ecdng s\u1ed1 (t\u01b0\u01a1ng t\u1ef1 nh\u01b0 ch\u1eadp theo k\u00edch th\u01b0\u1edbc) c\u00f3 th\u1ec3 l\u00e0m gi\u1ea3m \u0111\u00e1ng k\u1ec3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p ti\u1ec7m c\u1eadn: \\(O(m + n \\log n)\\) \u0111\u1ec3 th\u1ef1c hi\u1ec7n \\(m\\) truy v\u1ea5n tr\u00ean \\(n\\) ph\u1ea7n t\u1eed.</p> <p>Theo heuristic tr\u1ecdng s\u1ed1, ta s\u1ebd lu\u00f4n th\u00eam t\u1eadp nh\u1ecf h\u01a1n v\u00e0o t\u1eadp h\u1ee3p l\u1edbn h\u01a1n. Vi\u1ec7c th\u00eam m\u1ed9t t\u1eadp n\u00e0y v\u00e0o m\u1ed9t t\u1eadp kh\u00e1c r\u1ea5t d\u1ec5 th\u1ef1c hi\u1ec7n trong <code>union_sets</code> v\u00e0 s\u1ebd m\u1ea5t th\u1eddi gian t\u1ef7 l\u1ec7 thu\u1eadn v\u1edbi k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p \u0111\u00e3 th\u00eam. Vi\u1ec7c t\u00ecm ki\u1ebfm \u0111\u1ea1i di\u1ec7n trong <code>find_set</code> s\u1ebd m\u1ea5t \\(O(1)\\) v\u1edbi c\u00e1ch l\u01b0u tr\u1eef n\u00e0y.</p> <p>Gi\u1edd ta s\u1ebd ch\u1ee9ng minh \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian \\(O(m + n \\log n)\\) khi th\u1ef1c hi\u1ec7n \\(m\\) truy v\u1ea5n. Ta s\u1ebd c\u1ed1 m\u1ed9t ph\u1ea7n t\u1eed t\u00f9y \u00fd \\(x\\) v\u00e0 \u0111\u1ebfm s\u1ed1 l\u1ea7n n\u00f3 \u0111\u01b0\u1ee3c d\u00f9ng trong thao t\u00e1c ch\u1eadp <code>union_sets</code>. Khi ph\u1ea7n t\u1eed \\(x\\) \u0111\u01b0\u1ee3c d\u00f9ng l\u1ea7n \u0111\u1ea7u ti\u00ean, k\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp h\u1ee3p m\u1edbi s\u1ebd \u00edt nh\u1ea5t l\u00e0 \\(2\\). Khi n\u00f3 \u0111\u01b0\u1ee3c d\u00f9ng l\u1ea7n th\u1ee9 hai, t\u1eadp k\u1ebft qu\u1ea3 s\u1ebd c\u00f3 k\u00edch th\u01b0\u1edbc \u00edt nh\u1ea5t l\u00e0 \\(4\\), b\u1edfi v\u00ec t\u1eadp nh\u1ecf h\u01a1n \u0111\u01b0\u1ee3c th\u00eam v\u00e0o t\u1eadp l\u1edbn h\u01a1n, c\u1ee9 nh\u01b0 v\u1eady. \u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 \\(x\\) ch\u1ec9 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c di chuy\u1ec3n trong nhi\u1ec1u nh\u1ea5t \\(\\log n\\) thao t\u00e1c ch\u1eadp. Do \u0111\u00f3, t\u1ed5ng tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c \u0111\u1ec9nh cho ta \\(O(n \\log n)\\) c\u1ed9ng v\u1edbi \\(O(1)\\) cho m\u1ed7i truy v\u1ea5n.</p> <p>C\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>vector&lt;int&gt; lst[MAXN];\nint parent[MAXN];\n\nvoid make_set(int v) {\n    lst[v] = vector&lt;int&gt;(1, v);\n    parent[v] = v;\n}\n\nint find_set(int v) {\n    return parent[v];\n}\n\nvoid union_sets(int a, int b) {\n    a = find_set(a);\n    b = find_set(b);\n    if (a != b) {\n        if (lst[a].size() &lt; lst[b].size())\n            swap(a, b);\n        while (!lst[b].empty()) {\n            int v = lst[b].back();\n            lst[b].pop_back();\n            parent[v] = a;\n            lst[a].push_back (v);\n        }\n    }\n}\n</code></pre> <p>\u00dd t\u01b0\u1edfng th\u00eam ph\u1ea7n nh\u1ecf h\u01a1n v\u00e0o ph\u1ea7n l\u1edbn h\u01a1n c\u0169ng \u0111\u01b0\u1ee3c d\u00f9ng trong nhi\u1ec1u b\u00e0i t\u1eadp kh\u00f4ng li\u00ean quan g\u00ec \u0111\u1ebfn DSU.</p> <p>V\u00ed d\u1ee5, ta x\u00e9t b\u00e0i to\u00e1n sau: cho m\u1ed9t c\u00e2y, m\u1ed7i node l\u00e1 \u0111\u01b0\u1ee3c g\u1eafn m\u1ed9t s\u1ed1 (c\u00e1c node l\u00e1 kh\u00e1c nhau c\u00f3 th\u1ec3 c\u00f3 c\u00f9ng s\u1ed1). Ta mu\u1ed1n t\u00ednh s\u1ed1 s\u1ed1 kh\u00e1c nhau trong c\u00e2y con c\u1ee7a m\u1ecdi node tr\u00ean c\u00e2y.</p> <p>\u00c1p d\u1ee5ng \u00fd t\u01b0\u1edfng t\u01b0\u01a1ng t\u1ef1 cho b\u00e0i n\u00e0y, ta s\u1ebd c\u00f3 \u0111\u00e1p \u00e1n sau: ta c\u00f3 th\u1ec3 c\u00e0i DFS, n\u00f3 s\u1ebd tr\u1ea3 v\u1ec1 m\u1ed9t con tr\u1ecf \u0111\u1ebfn m\u1ed9t t\u1eadp c\u00e1c s\u1ed1 nguy\u00ean - d\u00e3y s\u1ed1 tr\u00ean c\u00e2y con. Sau \u0111\u00f3 \u0111\u1ec3 l\u1ea5y \u0111\u01b0\u1ee3c \u0111\u00e1p \u00e1n c\u1ee7a node hi\u1ec7n t\u1ea1i (t\u1ea5t nhi\u00ean tr\u1eeb khi n\u00f3 l\u00e0 node l\u00e1), ta g\u1ecdi DFS cho t\u1ea5t c\u1ea3 node con, v\u00e0 ch\u1eadp nh\u1eefng t\u1eadp nh\u1eadn \u0111\u01b0\u1ee3c v\u1edbi nhau. K\u00edch th\u01b0\u1edbc c\u1ee7a t\u1eadp k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \u0111\u00e1p \u00e1n c\u1ee7a node hi\u1ec7n t\u1ea1i. \u0110\u1ec3 ch\u1eadp hi\u1ec7u qu\u1ea3 nhi\u1ec1u t\u1eadp v\u1edbi nhau, ta ch\u1ec9 c\u1ea7n \u00e1p d\u1ee5ng c\u00e1ch \u1edf tr\u00ean: mang t\u1eadp nh\u1ecf ch\u1eadp v\u00e0o t\u1eadp to. Cu\u1ed1i c\u00f9ng ta s\u1ebd c\u00f3 m\u1ed9t c\u00e1ch gi\u1ea3i \\(O(n \\log^2 n)\\), v\u00ec m\u1ed9t s\u1ed1 s\u1ebd ch\u1ec9 \u0111\u01b0\u1ee3c th\u00eam v\u00e0o m\u1ed9t t\u1eadp t\u1ed1i \u0111a \\(O(\\log n)\\) l\u1ea7n.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#luu-dsu-bang-cach-duy-tri-cau-truc-cay-ro-rang-tim-cau-online-trong-trung-binh-oalphan","title":"L\u01b0u DSU b\u1eb1ng c\u00e1ch duy tr\u00ec c\u1ea5u tr\u00fac c\u00e2y r\u00f5 r\u00e0ng / T\u00ecm c\u1ea7u online trong trung b\u00ecnh \\(O(\\alpha(n))\\)","text":"<p>M\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng m\u1ea1nh m\u1ebd nh\u1ea5t c\u1ee7a DSU l\u00e0 n\u00f3 cho ph\u00e9p b\u1ea1n l\u01b0u c\u1ea3 d\u01b0\u1edbi d\u1ea1ng c\u00e2y n\u00e9n v\u00e0 c\u00e2y kh\u00f4ng n\u00e9n. D\u1ea1ng n\u00e9n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 ch\u1eadp c\u00e1c c\u00e2y v\u00e0 \u0111\u1ec3 xem hai \u0111\u1ec9nh c\u00f3 c\u00f9ng thu\u1ed9c m\u1ed9t c\u00e2y hay kh\u00f4ng. D\u1ea1ng kh\u00f4ng n\u00e9n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 t\u00ecm c\u00e1c \u0111\u01b0\u1eddng \u0111i gi\u1eefa hai \u0111\u1ec9nh, ho\u1eb7c nh\u1eefng c\u00e1ch duy\u1ec7t kh\u00e1c c\u1ee7a c\u1ea5u tr\u00fac c\u00e2y.</p> <p>Trong c\u00e0i \u0111\u1eb7t, \u0111i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0 ngo\u00e0i m\u1ea3ng cha <code>parent[]</code> ra th\u00ec ta s\u1ebd c\u1ea7n l\u01b0u m\u1ea3ng t\u1ed5 ti\u00ean kh\u00f4ng n\u00e9n <code>real_parent[]</code>. D\u1ec5 th\u1ea5y vi\u1ec7c duy tr\u00ec m\u1ea3ng th\u00eam n\u00e0y kh\u00f4ng l\u00e0m t\u0103ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p: thay \u0111\u1ed5i trong c\u1ea5u tr\u00fac ch\u1ec9 xu\u1ea5t hi\u1ec7n khi ta ch\u1eadp hai c\u00e2y, v\u00e0 ch\u1ec9 \u1edf m\u1ed9t ph\u1ea7n t\u1eed.</p> <p>M\u1eb7t kh\u00e1c khi \u00e1p d\u1ee5ng v\u00e0o th\u1ef1c t\u1ebf, ta th\u01b0\u1eddng c\u1ea7n k\u1ebft n\u1ed1i c\u00e1c c\u00e2y b\u1eb1ng m\u1ed9t c\u1ea1nh x\u00e1c \u0111\u1ecbnh kh\u00e1c v\u1edbi c\u00e1ch d\u00f9ng hai node g\u1ed1c. Ngh\u0129a l\u00e0 ta kh\u00f4ng c\u00f3 l\u1ef1a ch\u1ecdn n\u00e0o kh\u00e1c ngo\u00e0i vi\u1ec7c ch\u1ecdn root l\u1ea1i m\u1ed9t trong c\u00e1c c\u00e2y (bi\u1ebfn m\u1ed9t trong hai \u0111\u1ea7u c\u1ee7a c\u1ea1nh th\u00e0nh g\u1ed1c m\u1edbi c\u1ee7a c\u00e2y).</p> <p>Tho\u1ea1t nh\u00ecn, c\u00f3 v\u1ebb nh\u01b0 vi\u1ec7c ch\u1ecdn root l\u1ea1i r\u1ea5t t\u1ed1n k\u00e9m v\u00e0 l\u00e0m t\u0103ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p. Th\u1eadt v\u1eady, \u0111\u1ec3 t\u1ea1o g\u1ed1c cho c\u00e2y \u1edf \u0111\u1ec9nh \\(v\\) ta ph\u1ea3i \u0111i t\u1eeb \u0111\u1ec9nh n\u00e0y \u0111\u1ebfn g\u1ed1c c\u0169 v\u00e0 thay \u0111\u1ed5i h\u01b0\u1edbng trong <code>parent[]</code> v\u00e0 <code>real_parent[]</code> v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c node tr\u00ean \u0111\u01b0\u1eddng \u0111i.</p> <p>Tuy nhi\u00ean th\u1ef1c t\u1ebf th\u00ec kh\u00f4ng t\u1ec7 l\u1eafm, ta ch\u1ec9 c\u1ea7n root l\u1ea1i c\u00e2y nh\u1ecf h\u01a1n trong s\u1ed1 hai c\u00e2y, t\u01b0\u01a1ng t\u1ef1 nh\u01b0 \u00fd t\u01b0\u1edfng trong c\u00e1c ph\u1ea7n tr\u01b0\u1edbc v\u00e0 \u0111i\u1ec1u n\u00e0y s\u1ebd t\u1ed1n trung b\u00ecnh \\(O(\\log n)\\).</p> <p>B\u1ea1n c\u00f3 th\u1ec3 t\u00ecm th\u00eam chi ti\u1ebft (bao g\u1ed3m ch\u1ee9ng minh \u0111\u1ed9 ph\u1ee9c t\u1ea1p) trong b\u00e0i T\u00ecm c\u1ea7u online.</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#hoi-tuong","title":"H\u1ed3i t\u01b0\u1edfng","text":"<p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u DSU \u0111\u00e3 \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn t\u1eeb r\u1ea5t l\u00e2u.</p> <p>C\u00e1ch l\u01b0u c\u1ea5u tr\u00fac d\u1eef li\u1ec7u theo ki\u1ec3u r\u1eebng c\u00e2y n\u00e0y \u0111\u01b0\u1ee3c gi\u1edbi thi\u1ec7u l\u1ea7n \u0111\u1ea7u b\u1edfi Galler v\u00e0 Fisher n\u1eb1m 1964 (Galler, Fisher, \"An Improved Equivalence Algorithm\"), tuy nhi\u00ean ph\u00e2n t\u00edch ho\u00e0n ch\u1ec9nh v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p ch\u1ec9 \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n sau \u0111\u00f3 kh\u00e1 l\u00e2u.</p> <p>T\u1ed1i \u01b0u n\u00e9n \u0111\u01b0\u1eddng \u0111i v\u00e0 Ch\u1eadp theo c\u1ea5p b\u1eadc \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi McIlroy v\u00e0 Morris, v\u00e0 b\u1edfi Tritter (\u0111\u1ed9c l\u1eadp).</p> <p>Hopcroft v\u00e0 Ullman \u0111\u00e3 ch\u1ee9ng minh \u0111\u01b0\u1ee3c v\u00e0o n\u1eb1m 1973 r\u1eb1ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(\\log^\\star n)\\) (Hopcroft, Ullman \"Set-merging algorithms\") - \u1edf \u0111\u00e2y \\(\\log^\\star\\) l\u00e0 iterated logarithm (h\u00e0m t\u0103ng ch\u1eadm, nh\u01b0ng kh\u00f4ng ch\u1eadm nh\u01b0 h\u00e0m \u0111\u1ea3o Ackermann).</p> <p>L\u1ea7n \u0111\u1ea7u ti\u00ean vi\u1ec7c \u0111\u00e1nh gi\u00e1 \\(O(\\alpha(n))\\) \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y v\u00e0o n\u0103m 1975 (Tarjan \"Efficiency of a Good But Not Linear Set Union Algorithm\"). Sau \u0111\u00f3 v\u00e0o n\u0103m 1985, \u00f4ng c\u00f9ng v\u1edbi Leeuwen \u0111\u00e3 xu\u1ea5t b\u1ea3n nhi\u1ec1u ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p cho m\u1ed9t s\u1ed1 heuristics x\u1ebfp h\u1ea1ng v\u00e0 nh\u1eefng c\u00e1ch n\u00e9n \u0111\u01b0\u1eddng \u0111i (Tarjan, Leeuwen \"Worst-case Analysis of Set Union Algorithms\").</p> <p>Cu\u1ed1i c\u00f9ng v\u00e0o n\u1eb1m 1989, Fredman v\u00e0 Sachs ch\u1ee9ng minh r\u1eb1ng trong m\u00f4 h\u00ecnh t\u00ednh to\u00e1n \u0111\u01b0\u1ee3c ch\u1ea5p nh\u1eadn, b\u1ea5t k\u1ef3 thu\u1eadt to\u00e1n DSU n\u00e0o c\u0169ng ph\u1ea3i ho\u1ea1t \u0111\u1ed9ng trong th\u1eddi gian trung b\u00ecnh t\u1ed1i thi\u1ec3u \\(O(\\alpha(n))\\) (Fredman, Saks, \"The cell probe complexity of dynamic data structures\").</p>"},{"location":"cp-algorithms/data-structures/trees/dsu/#template","title":"Template","text":"<p>\u0110\u00e2y l\u00e0 template m\u00ecnh hay d\u00f9ng cho vi\u1ec7c c\u00e0i \u0111\u1eb7t DSU. Template n\u00e0y \u0111\u01b0\u1ee3c l\u1ea5y t\u1eeb code c\u1ee7a th\u01b0 vi\u1ec7n AtCoder.</p> <pre><code>struct DisjointSetUnion {\n  public:\n    // t\u1ea1o \u0111\u1ed3 th\u1ecb n \u0111\u1ec9nh 0 c\u1ea1nh\n    DisjointSetUnion() : _n(0) {}\n    DisjointSetUnion(int n) : _n(n), parent_or_size(n, -1) {}\n\n    // th\u00eam c\u1ea1nh (u, v)\n    // N\u1ebfu \u0111\u1ec9nh u v\u00e0 v n\u1eb1m trong c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng,\n    // h\u00e0m tr\u1ea3 v\u1ec1 \u0111\u1ea1i di\u1ec7n c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng \u0111\u00f3.\n    // Ng\u01b0\u1ee3c l\u1ea1i, h\u00e0m tr\u1ea3 v\u1ec1 \u0111\u1ea1i di\u1ec7n c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng m\u1edbi.\n    int merge(int u, int v) {\n        assert(0 &lt;= u &amp;&amp; u &lt; _n);\n        assert(0 &lt;= v &amp;&amp; v &lt; _n);\n        int x = leader(u), y = leader(v);\n        if (x == y) return x;\n        if (-parent_or_size[x] &lt; -parent_or_size[y]) swap(x, y);\n        parent_or_size[x] += parent_or_size[y];\n        parent_or_size[y] = x;\n        return x;\n    }\n\n    // H\u00e0m tr\u1ea3 v\u1ec1 true khi u v\u00e0 v n\u1eb1m trong c\u00f9ng th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng, ng\u01b0\u1ee3c l\u1ea1i tr\u1ea3 v\u1ec1 false\n    bool same(int u, int v) {\n        assert(0 &lt;= u &amp;&amp; u &lt; _n);\n        assert(0 &lt;= v &amp;&amp; v &lt; _n);\n        return leader(u) == leader(v);\n    }\n\n    // H\u00e0m tr\u1ea3 v\u1ec1 \u0111\u1ea1i di\u1ec7n c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a u\n    int leader(int u) {\n        assert(0 &lt;= u &amp;&amp; u &lt; _n);\n        if (parent_or_size[u] &lt; 0) return u;\n        return parent_or_size[u] = leader(parent_or_size[u]);\n    }\n\n    // H\u00e0m tr\u1ea3 v\u1ec1 k\u00edch th\u01b0\u1edbc c\u1ee7a th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng ch\u1ee9a u\n    int size(int u) {\n        assert(0 &lt;= u &amp;&amp; u &lt; _n);\n        return -parent_or_size[leader(u)];\n    }\n\n    // H\u00e0m tr\u1ea3 v\u1ec1 t\u1ea5t c\u1ea3 c\u00e1c th\u00e0nh ph\u1ea7n li\u00ean th\u00f4ng c\u1ee7a \u0111\u1ed3 th\u1ecb, m\u1ed7i th\u00e0nh ph\u1ea7n n\u1eb1m trong 1 m\u1ea3ng con\n    vector&lt;vector&lt;int&gt;&gt; groups() {\n        vector&lt;int&gt; leader_buf(_n), group_size(_n);\n        FOR(i,0,_n-1) {\n            leader_buf[i] = leader(i);\n            group_size[leader_buf[i]]++;\n        }\n        vector&lt;vector&lt;int&gt;&gt; result(_n);\n        FOR(i,0,_n-1) result[i].reserve(group_size[i]);\n        FOR(i,0,_n-1) result[leader_buf[i]].push_back(i);\n        result.erase(\n            std::remove_if(result.begin(), result.end(),\n                           [&amp;](const std::vector&lt;int&gt;&amp; v) { return v.empty(); }),\n            result.end());\n        return result;\n    }\n\n  private:\n    int _n;\n    vector&lt;int&gt; parent_or_size;\n};\n</code></pre>"},{"location":"cp-algorithms/data-structures/trees/dsu/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date TIMUS - Anansi's Cobweb Unavailable public link Code 10/05/2023 Codeforces - Roads not only in Berland Submission Code 10/05/2023 TIMUS - Parity Unavailable public link Code 11/05/2023 SPOJ - Strange Food Chain Unavailable public link Code 15/05/2023 SPOJ - COLORFUL ARRAY Unavailable public link Code 15/05/2023 SPOJ - Consecutive Letters Unavailable public link Code 16/05/2023 Toph - Unbelievable Array Unavailable public link Code 16/05/2023 HackerEarth - Lexicographically minimal string Unavailable public link Code 16/05/2023 HackerEarth - Fight in Ninja World Unavailable public link Code 16/05/2023"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/","title":"Sqrt Tree","text":""},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#sqrt-tree","title":"Sqrt Tree","text":""},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#nguon","title":"Ngu\u1ed3n","text":"<p> Sqrt Tree</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>Cho m\u1ed9t m\u1ea3ng \\(a\\) c\u00f3 \\(n\\) ph\u1ea7n t\u1eed v\u00e0 to\u00e1n t\u1eed \\(\\circ\\) tho\u1ea3 m\u00e3n t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p: \\((x \\circ y) \\circ z = x \\circ (y \\circ z)\\) \u0111\u00fang v\u1edbi m\u1ecdi \\(x\\), \\(y\\), \\(z\\).</p> <p>Cho n\u00ean, c\u00e1c to\u00e1n t\u1eed nh\u01b0 \\(gcd\\), \\(min\\), \\(max\\), \\(+\\), \\(and\\), \\(or\\), \\(xor\\), \\(\\ldots\\) \u0111\u1ec1u tho\u1ea3 t\u00ednh ch\u1ea5t k\u1ebft h\u1ee3p.</p> <p>Ta c\u0169ng \u0111\u01b0\u1ee3c cho th\u00eam c\u00e1c truy v\u1ea5n d\u1ea1ng \\(q(l, r)\\). V\u1edbi m\u1ed7i truy v\u1ea5n, ta c\u1ea7n t\u00ednh \\(a_l \\circ a_{l+1} \\circ \\dots \\circ a_r\\)</p> <p>Sqrt Tree c\u00f3 th\u1ec3 x\u1eed l\u00fd nh\u1eefng truy v\u1ea5n nh\u01b0 v\u1eady trong \\(O(1)\\) th\u1eddi gian v\u1edbi \\(O(n \\cdot \\log \\log n)\\) th\u1eddi gian ti\u1ec1n x\u1eed l\u00fd v\u00e0 \\(O(n \\cdot \\log \\log n)\\) b\u1ed9 nh\u1edb.</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#mo-ta","title":"M\u00f4 t\u1ea3","text":""},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#xay-dung-chia-can","title":"X\u00e2y d\u1ef1ng chia c\u0103n","text":"<p>Ta chia c\u0103n cho m\u1ea3ng. Chia m\u1ea3ng ra th\u00e0nh \\(\\sqrt{n}\\) block, m\u1ed7i block c\u00f3 k\u00edch th\u01b0\u1edbc \\(\\sqrt{n}\\). V\u1edbi m\u1ed7i block, ta t\u00ednh:</p> <ol> <li>Tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n n\u1eb1m trong block \u0111\u00f3, v\u1edbi \\(l\\) l\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a block (l\u01b0u v\u00e0o \\(\\text{prefixOp}\\)).</li> <li>Tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n n\u1eb1m trong block \u0111\u00f3, v\u1edbi \\(r\\) l\u00e0 ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng c\u1ee7a block (l\u01b0u v\u00e0o \\(\\text{suffixOp}\\)).</li> </ol> <p>Ta t\u00ednh th\u00eam m\u1ed9t m\u1ea3ng n\u1eefa</p> <ol> <li>\\(between_{i,j}\\) (v\u1edbi \\(i \\leq j\\)) - tr\u1ea3 l\u1eddi truy v\u1ea5n b\u1eaft \u0111\u1ea7u \u1edf ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a block th\u1ee9 \\(i\\) v\u00e0 k\u1ebft th\u00fac \u1edf ph\u1ea7n t\u1eed cu\u1ed1i c\u00f9ng c\u1ee7a block \\(j\\). L\u01b0u \u00fd r\u1eb1ng ta c\u00f3 \\(\\sqrt{n}\\) block, n\u00ean k\u00edch th\u01b0\u1edbc m\u1ea3ng n\u00e0y s\u1ebd l\u00e0 \\(O(\\sqrt{n}^2) = O(n)\\).</li> </ol> <p>X\u00e9t v\u00ed d\u1ee5 sau.</p> <p>Cho \\(\\circ\\) l\u00e0 ph\u00e9p \\(+\\) (ta t\u00ednh t\u1ed5ng m\u1ed9t \u0111o\u1ea1n) v\u00e0 c\u00f3 m\u1ea3ng \\(a\\) nh\u01b0 sau:</p> <p><code>{1, 2, 3, 4, 5, 6, 7, 8, 9}</code></p> <p>N\u00f3 s\u1ebd \u0111\u01b0\u1ee3c chia l\u00e0m ba block: <code>{1, 2, 3}</code>, <code>{4, 5, 6}</code>, v\u00e0 <code>{7, 8, 9}</code>.</p> <p>Trong block th\u1ee9 nh\u1ea5t, \\(\\text{prefixOp}\\) l\u00e0 <code>{1, 3, 6}</code> v\u00e0 \\(\\text{suffixOp}\\) l\u00e0 <code>{6, 5, 3}</code>.</p> <p>Trong block th\u1ee9 hai, \\(\\text{prefixOp}\\) l\u00e0 <code>{4, 9, 15}</code> v\u00e0 \\(\\text{suffixOp}\\) l\u00e0 <code>{15, 11, 6}</code>.</p> <p>Trong block th\u1ee9 ba, \\(\\text{prefixOp}\\) l\u00e0 <code>{7, 15, 24}</code> v\u00e0 \\(\\text{suffixOp}\\) l\u00e0 <code>{24, 17, 9}</code>.</p> <p>M\u1ea3ng \\(\\text{between}\\) l\u00e0:</p> <pre><code>{\n    {6, 21, 45},\n    {0, 15, 39},\n    {0, 0,  24}\n}\n</code></pre> <p>(\u1edf \u0111\u00e2y ta gi\u1ea3 s\u1eed n\u1ebfu \\(i &gt; j\\) th\u00ec \\(between_{i,j}\\) l\u00e0 \\(0\\))</p> <p>Ta \u0111\u00e3 c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi m\u1ed9t s\u1ed1 truy v\u1ea5n v\u1edbi nh\u1eefng m\u1ea3ng n\u00e0y. N\u1ebfu truy v\u1ea5n kh\u00f4ng n\u1eb1m g\u1ecdn trong m\u1ed9t block, ta c\u00f3 th\u1ec3 chia n\u00f3 th\u00e0nh ba ph\u1ea7n: h\u1eadu t\u1ed1 c\u1ee7a m\u1ed9t block, sau \u0111\u00f3 l\u00e0 m\u1ed9t s\u1ed1 \u0111o\u1ea1n c\u1ee7a c\u00e1c block k\u1ec1 nhau v\u00e0 cu\u1ed1i c\u00f9ng l\u00e0 ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ed9t block. Ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n b\u1eb1ng c\u00e1ch chia n\u00f3 ra th\u00e0nh ba ph\u1ea7n nh\u01b0 tr\u00ean r\u1ed3i l\u1ea5y m\u1ed9t gi\u00e1 tr\u1ecb t\u1eeb \\(\\text{suffixOp}\\), sau \u0111\u00f3 \u0111\u1ebfn m\u1ed9t s\u1ed1 gi\u00e1 tr\u1ecb t\u1eeb \\(\\text{between}\\), cu\u1ed1i c\u00f9ng l\u00e0 m\u1ed9t gi\u00e1 tr\u1ecb t\u1eeb \\(\\text{prefixOp}\\).</p> <p>Nh\u01b0ng n\u1ebfu truy v\u1ea5n n\u1eb1m g\u1ecdn trong m\u1ed9t block, ta kh\u00f4ng th\u1ec3 l\u00e0m nh\u01b0 th\u1ebf \u0111\u01b0\u1ee3c. V\u00ec v\u1eady ta c\u1ea7n ph\u1ea3i l\u00e0m m\u1ed9t c\u00e1i g\u00ec \u0111\u00f3 \u1edf \u0111\u00e2y.</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#tao-cay","title":"T\u1ea1o c\u00e2y","text":"<p>Ta kh\u00f4ng th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n n\u1eb1m g\u1ecdn trong m\u1ed9t block. Nh\u01b0ng s\u1ebd ra sao n\u1ebfu ta t\u1ea1o m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u y nh\u01b0 tr\u00ean cho m\u1ed7i block? Ta c\u00f3 th\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u \u0111\u00f3, v\u00e0 ta l\u00e0m m\u1ed9t c\u00e1ch \u0111\u1ec7 quy, cho \u0111\u1ebfn khi k\u00edch th\u01b0\u1edbc block l\u00e0 \\(1\\) ho\u1eb7c \\(2\\). Tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n cho c\u00e1c block nh\u1ecf nh\u01b0 v\u1eady ch\u1ec9 t\u1ed1n \\(O(1)\\).</p> <p>V\u1eady ta c\u00f3 m\u1ed9t c\u00e1i c\u00e2y. M\u1ed7i node tr\u00ean c\u00e2y qu\u1ea3n l\u00fd m\u1ed9t \u0111o\u1ea1n c\u1ee7a m\u1ea3ng. Node qu\u1ea3n l\u00fd \u0111o\u1ea1n k\u00edch th\u01b0\u1edbc b\u1eb1ng \\(k\\) s\u1ebd c\u00f3 \\(\\sqrt{k}\\) node con -- cho m\u1ed7i block. Th\u00eam n\u1eefa, m\u1ed7i node ch\u1ee9a ba m\u1ea3ng \\(\\text{prefixOp}\\), \\(\\text{suffixOp}\\) v\u00e0 \\(\\text{between}\\) nh\u01b0 tr\u00ean cho \u0111o\u1ea1n m\u00e0 n\u00f3 qu\u1ea3n l\u00fd. G\u1ed1c c\u1ee7a c\u00e2y qu\u1ea3n l\u00fd to\u00e0n b\u1ed9 m\u1ea3ng. Node c\u1ee7a c\u00e1c \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i \\(1\\) ho\u1eb7c \\(2\\) l\u00e0 c\u00e1c node l\u00e1.</p> <p>R\u00f5 r\u00e0ng l\u00e0 c\u00e2y s\u1ebd c\u00f3 chi\u1ec1u cao l\u00e0 \\(O(\\log \\log n)\\), v\u00ec n\u1ebfu m\u1ed9t node n\u00e0o \u0111\u00f3 qu\u1ea3n l\u00fd \u0111o\u1ea1n c\u00f3 \u0111\u1ed9 d\u00e0i l\u00e0 \\(k\\), th\u00ec c\u00e1c node con c\u1ee7a n\u00f3 l\u00e0 \\(\\sqrt{k}\\). Ta c\u00f3 \\(\\log(\\sqrt{k}) = \\frac{\\log{k}}{2}\\), n\u00ean \\(\\log k\\) gi\u1ea3m hai l\u1ea7n qua m\u1ed7i l\u1edbp c\u1ee7a c\u00e2y, n\u00ean chi\u1ec1u cao c\u00e2y l\u00e0 \\(O(\\log \\log n)\\). Th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb c\u1ea7n d\u00f9ng \u0111\u1ec3 x\u00e2y d\u1ef1ng c\u00e2y l\u00e0 \\(O(n \\cdot \\log \\log n)\\), b\u1edfi v\u00ec m\u1ed7i ph\u1ea7n t\u1eed trong m\u1ea3ng xu\u1ea5t hi\u1ec7n \u0111\u00fang m\u1ed9t l\u1ea7n tr\u00ean m\u1ed7i l\u1edbp c\u1ee7a c\u00e2y.</p> <p>Gi\u1edd ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong \\(O(\\log \\log n)\\). Ta c\u00f3 th\u1ec3 \u0111i xu\u1ed1ng c\u00e1c node cho \u0111\u1ebfn khi ta g\u1eb7p \u0111o\u1ea1n \u0111\u1ed9 d\u00e0i \\(1\\) ho\u1eb7c \\(2\\) (tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n cho \u0111o\u1ea1n n\u00e0y c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n trong \\(O(1)\\)), ho\u1eb7c \u0111\u1ebfn khi g\u1eb7p \u0111o\u1ea1n \u0111\u1ea7u ti\u00ean l\u00e0m cho truy v\u1ea5n kh\u00f4ng n\u1eb1m trong m\u1ed9t block. Xem ph\u1ea7n tr\u01b0\u1edbc \u0111\u1ec3 tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y.</p> <p>OK, \\(O(\\log \\log n)\\) c\u0169ng nhanh \u0111\u1ea5y. Nh\u01b0ng ta c\u00f3 th\u1ec3 l\u00e0m nhanh h\u01a1n \u0111\u01b0\u1ee3c kh\u00f4ng?</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#toi-uu-o-phuc-tap-truy-van","title":"T\u1ed1i \u01b0u \u0111\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n","text":"<p>M\u1ed9t trong nh\u1eefng vi\u1ec7c t\u1ed1i \u01b0u r\u00f5 r\u00e0ng nh\u1ea5t \u1edf \u0111\u00e2y ch\u00ednh l\u00e0 vi\u1ec7c t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n node ta c\u1ea7n. V\u1edbi t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, ta c\u00f3 th\u1ec3 truy v\u1ea5n trong \\(O(\\log \\log \\log n)\\). Nh\u01b0ng c\u00f3 th\u1ec3 nhanh h\u01a1n n\u1eefa kh\u00f4ng?</p> <p>C\u00e2u tr\u1ea3 l\u1eddi l\u00e0 c\u00f3. Gi\u1ea3 s\u1eed ta c\u00f3 nh\u1eefng \u0111i\u1ec1u sau:</p> <ol> <li>C\u00e1c k\u00edch th\u01b0\u1edbc block l\u00e0 lu\u1ef9 th\u1eeba c\u1ee7a \\(2\\).</li> <li>T\u1ea5t c\u1ea3 c\u00e1c block c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng nhau \u1edf m\u1ed7i l\u1edbp.</li> </ol> <p>\u0110\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c \u0111i\u1ec1u n\u00e0y, ta c\u1ea7n th\u00eam c\u00e1c ph\u1ea7n t\u1eed \\(0\\) v\u00e0o m\u1ea3ng sao cho k\u00edch th\u01b0\u1edbc c\u1ee7a n\u00f3 l\u00e0 m\u1ed9t lu\u1ef9 th\u1eeba c\u1ee7a \\(2\\).</p> <p>Khi l\u00e0m nh\u01b0 v\u1eady, k\u00edch th\u01b0\u1edbc block c\u00f3 th\u1ec3 t\u0103ng g\u1ea5p \u0111\u00f4i \u0111\u1ec3 tr\u1edf th\u00e0nh m\u1ed9t lu\u1ef9 th\u1eeba c\u1ee7a \\(2\\), nh\u01b0ng n\u00f3 v\u1eabn s\u1ebd l\u00e0 \\(O(\\sqrt{k})\\) v\u00e0 ta gi\u1eef \u0111\u1ed9 ph\u1ee9c t\u1ea1p tuy\u1ebfn t\u00ednh khi t\u1ea1o c\u00e1c m\u1ea3ng th\u00e0nh ph\u1ea7n trong \u0111o\u1ea1n.</p> <p>Gi\u1edd ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng ki\u1ec3m tra xem truy v\u1ea5n c\u00f3 n\u1eb1m h\u1eb3n trong block c\u00f3 k\u00edch th\u01b0\u1edbc \\(2^k\\) hay kh\u00f4ng. Vi\u1ebft \\(l\\) v\u00e0 \\(r\\) theo h\u1ec7 nh\u1ecb ph\u00e2n (ta \u0111\u00e1nh s\u1ed1 v\u1ecb tr\u00ed t\u1eeb \\(0\\)). V\u00ed d\u1ee5, cho \\(k=4, l=39, r=46\\). Bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a \\(l\\) v\u00e0 \\(r\\) l\u00e0:</p> \\[l = 39_{10} = 100111_2\\] \\[r = 46_{10} = 101110_2\\] <p>Nh\u1edb l\u1ea1i r\u1eb1ng m\u1ed9t l\u1edbp g\u1ed3m c\u00e1c \u0111o\u1ea1n c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng nhau, v\u00e0 c\u00e1c block tr\u00ean m\u1ed9t l\u1edbp c\u0169ng c\u00f3 k\u00edch th\u01b0\u1edbc b\u1eb1ng nhau (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y k\u00edch th\u01b0\u1edbc l\u00e0 \\(2^k = 2^4 = 16\\)). C\u00e1c block bao ph\u1ee7 to\u00e0n b\u1ed9 m\u1ea3ng, n\u00ean block \u0111\u1ea7u ti\u00ean qu\u1ea3n l\u00fd c\u00e1c ph\u1ea7n t\u1eed \\((0 - 15)\\) (\\((000000_2 - 001111_2)\\) theo h\u1ec7 nh\u1ecb ph\u00e2n), block th\u1ee9 hai qu\u1ea3n l\u00fd c\u00e1c ph\u1ea7n t\u1eed \\((16 - 31)\\) (\\((010000_2 - 011111_2)\\) theo h\u1ec7 nh\u1ecb ph\u00e2n) v\u00e0 c\u1ee9 nh\u01b0 th\u1ebf. Ta th\u1ea5y r\u1eb1ng c\u00e1c ch\u1ec9 s\u1ed1 v\u1ecb tr\u00ed trong m\u1ed9t block ch\u1ec9 kh\u00e1c nhau \u1edf \\(k\\) bit nh\u1ecf nh\u1ea5t (trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 \\(4\\)). N\u1ebfu \\(l\\) v\u00e0 \\(r\\) c\u00f3 c\u00e1c bit b\u1eb1ng nhau, tr\u1eeb \\(4\\) bit nh\u1ecf nh\u1ea5t, \u0111o\u1ea1n n\u00e0y s\u1ebd n\u1eb1m trong m\u1ed9t block.</p> <p>V\u1eady, ta ch\u1ec9 c\u1ea7n ki\u1ec3m tra \\(k\\) bit nh\u1ecf nh\u1ea5t c\u1ee7a hai s\u1ed1 c\u00f3 kh\u00e1c nhau hay kh\u00f4ng (hay n\u00f3i c\u00e1ch kh\u00e1c l\u00e0 \\(l\\ \\text{xor}\\ r\\) c\u00f3 v\u01b0\u1ee3t qu\u00e1 \\(2^k-1\\) hay kh\u00f4ng).</p> <p>V\u1edbi observation n\u00e0y, ta c\u00f3 th\u1ec3 t\u00ecm ra \u0111\u01b0\u1ee3c l\u1edbp th\u00edch h\u1ee3p \u0111\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n r\u1ea5t nhanh nh\u01b0 sau:</p> <ol> <li>V\u1edbi m\u1ed7i \\(i\\) kh\u00f4ng v\u01b0\u1ee3t qu\u00e1 k\u00edch th\u01b0\u1edbc m\u1ea3ng, ta t\u00ecm bit \\(1\\) l\u1edbn nh\u1ea5t. \u0110\u1ec3 l\u00e0m \u0111\u01b0\u1ee3c th\u00ec ta d\u00f9ng DP v\u00e0 m\u1ed9t m\u1ea3ng ti\u1ec1n x\u1eed l\u00fd.</li> <li>V\u1edbi m\u1ed7i truy v\u1ea5n \\(q(l,r)\\), ta t\u00ecm bit \\(1\\) l\u1edbn nh\u1ea5t c\u1ee7a \\(l\\ \\text{xor}\\ r\\) v\u00e0 d\u00f9ng th\u00f4ng tin n\u00e0y \u0111\u1ec3 ch\u1ecdn l\u1edbp tr\u00ean sqrt tree \u0111\u1ec3 x\u1eed l\u00fd truy v\u1ea5n. Ta c\u0169ng c\u00f3 th\u1ec3 d\u00f9ng m\u1ea3ng ti\u1ec1n x\u1eed l\u00fd \u1edf \u0111\u00e2y.</li> </ol> <p>C\u00f3 th\u1ec3 \u0111\u1ecdc code \u1edf d\u01b0\u1edbi c\u00f9ng c\u1ee7a b\u00e0i vi\u1ebft \u0111\u1ec3 hi\u1ec3u th\u00eam.</p> <p>Do v\u1eady, b\u1eb1ng c\u00e1ch n\u00e0y, ta c\u00f3 th\u1ec3 tr\u1ea3 l\u1eddi truy v\u1ea5n trong \\(O(1)\\).</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cap-nhat-gia-tri","title":"C\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb","text":"<p>Ta c\u0169ng c\u00f3 th\u1ec3 c\u1eadp nh\u1eadt c\u00e1c ph\u1ea7n t\u1eed tr\u00ean Sqrt Tree. C\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed ho\u1eb7c m\u1ed9t \u0111o\u1ea1n \u0111\u1ec1u \u0111\u01b0\u1ee3c.</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cap-nhat-gia-tri-mot-phan-tu","title":"C\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb m\u1ed9t ph\u1ea7n t\u1eed","text":"<p>X\u00e9t m\u1ed9t truy v\u1ea5n \\(\\text{update}(x, val)\\) th\u1ef1c hi\u1ec7n ph\u00e9p g\u00e1n \\(a_x = val\\). Ta c\u1ea7n th\u1ef1c hi\u1ec7n truy v\u1ea5n n\u00e0y \u0111\u1ee7 nhanh.</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cach-tiep-can-on-gian","title":"C\u00e1ch ti\u1ebfp c\u1eadn \u0111\u01a1n gi\u1ea3n","text":"<p>\u0110\u1ea7u ti\u00ean, ta x\u00e9t xem nh\u1eefng g\u00ec s\u1ebd x\u1ea3y ra tr\u00ean c\u00e2y khi m\u1ed9t ph\u1ea7n t\u1eed n\u00e0o \u0111\u00f3 thay \u0111\u1ed5i gi\u00e1 tr\u1ecb. X\u00e9t m\u1ed9t node tr\u00ean c\u00e2y qu\u1ea3n l\u00fd \u0111o\u1ea1n \u0111\u1ed9 d\u00e0i \\(l\\) v\u00e0 nh\u1eefng m\u1ea3ng th\u00e0nh ph\u1ea7n c\u1ee7a n\u00f3: \\(\\text{prefixOp}\\), \\(\\text{suffixOp}\\) v\u00e0 \\(\\text{between}\\). D\u1ec5 th\u1ea5y r\u1eb1ng ch\u1ec9 c\u00f3 \\(O(\\sqrt{l})\\) ph\u1ea7n t\u1eed trong \\(\\text{prefixOp}\\) v\u00e0 \\(\\text{suffixOp}\\) l\u00e0 thay \u0111\u1ed5i (trong block ch\u1ee9a ph\u1ea7n t\u1eed b\u1ecb thay \u0111\u1ed5i). \\(O(l)\\) ph\u1ea7n t\u1eed thay \u0111\u1ed5i trong m\u1ea3ng \\(\\text{between}\\). Suy ra r\u1eb1ng \\(O(l)\\) ph\u1ea7n t\u1eed tr\u00ean c\u00e2y thay \u0111\u1ed5i.</p> <p>Nh\u1edb r\u1eb1ng b\u1ea5t c\u1ee9 ph\u1ea7n t\u1eed \\(x\\) n\u00e0o s\u1ebd hi\u1ec7n di\u1ec7n tr\u00ean m\u1ed9t node tr\u00ean c\u00e2y tr\u00ean m\u1ed7i l\u1edbp. Node g\u1ed1c (l\u1edbp \\(0\\)) c\u00f3 \u0111\u1ed9 d\u00e0i \\(O(n)\\), c\u00e1c node tr\u00ean l\u1edbp \\(1\\) c\u00f3 \u0111\u1ed9 d\u00e0i \\(O(\\sqrt{n})\\), c\u00e1c node tr\u00ean l\u1edbp \\(2\\) c\u00f3 \u0111\u1ed9 d\u00e0i \\(O(\\sqrt{\\sqrt{n}})\\), v.v... V\u1eady \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian tr\u00ean m\u1ed7i l\u1ea7n c\u1eadp nh\u1eadt l\u00e0 \\(O(n + \\sqrt{n} + \\sqrt{\\sqrt{n}} + \\dots) = O(n)\\).</p> <p>Nh\u01b0ng nh\u01b0 v\u1eady l\u00e0 qu\u00e1 ch\u1eadm. C\u00f3 th\u1ec3 l\u00e0m nhanh h\u01a1n kh\u00f4ng?</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#mot-sqrt-tree-trong-sqrt-tree","title":"M\u1ed9t sqrt tree trong sqrt tree","text":"<p>L\u01b0u \u00fd r\u1eb1ng n\u00fat th\u1eaft \u1edf \u0111\u00e2y l\u00e0 vi\u1ec7c c\u1eadp nh\u1eadt l\u1ea1i m\u1ea3ng \\(\\text{between}\\) c\u1ee7a node g\u1ed1c qu\u00e1 m\u1ea5t th\u1eddi gian. \u0110\u1ec3 t\u1ed1i \u01b0u c\u00e2y, ta b\u1ecf c\u00e1i m\u1ea3ng n\u00e0y lu\u00f4n. Thay v\u00ec d\u00f9ng m\u1ea3ng \\(\\text{between}\\), ta l\u01b0u m\u1ed9t sqrt tree n\u1eefa cho node g\u1ed1c. G\u1ecdi n\u00f3 l\u00e0 \\(\\text{index}\\). N\u00f3 \u0111\u00f3ng vai tr\u00f2 y nh\u01b0 \\(\\text{between}\\) - tr\u1ea3 l\u1eddi c\u00e1c truy v\u1ea5n tr\u00ean d\u00e3y c\u00e1c block. Ch\u00fa \u00fd r\u1eb1ng c\u00e1c node c\u00f2n l\u1ea1i tr\u00ean c\u00e2y kh\u00f4ng c\u00f3 \\(\\text{index}\\), ch\u00fang v\u1eabn d\u00f9ng m\u1ea3ng \\(\\text{between}\\).</p> <p>M\u1ed9t sqrt tree \u0111\u01b0\u1ee3c xem l\u00e0 indexed, n\u1ebfu node g\u1ed1c c\u00f3 \\(\\text{index}\\). M\u1ed9t sqrt tree v\u1edbi m\u1ea3ng \\(\\text{between}\\) trong node g\u1ed1c \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 unindexed. L\u01b0u \u00fd r\u1eb1ng c\u00e2y \\(\\text{index}\\) th\u00ec unindexed.</p> <p>V\u1eady ta c\u00f3 thu\u1eadt to\u00e1n sau \u0111\u1ec3 c\u1eadp nh\u1eadt tr\u00ean c\u00e2y \u0111\u00e3 \u0111\u01b0\u1ee3c indexed:</p> <ul> <li>C\u1eadp nh\u1eadt \\(\\text{prefixOp}\\) v\u00e0 \\(\\text{suffixOp}\\) trong \\(O(\\sqrt{n})\\).</li> <li>C\u1eadp nh\u1eadt \\(\\text{index}\\). N\u00f3 c\u00f3 \u0111\u1ed9 d\u00e0i \\(O(\\sqrt{n})\\) v\u00e0 ta ch\u1ec9 c\u1ea7n c\u1eadp nh\u1eadt m\u1ed9t gi\u00e1 tr\u1ecb trong \u0111\u00f3 th\u00f4i (gi\u00e1 tr\u1ecb \u0111i theo block \u0111\u00e3 thay \u0111\u1ed5i). V\u1eady \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a b\u01b0\u1edbc n\u00e0y l\u00e0 \\(O(\\sqrt{n})\\). Ta c\u00f3 th\u1ec3 d\u00f9ng thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 \u1edf \u0111\u1ea7u ph\u1ea7n n\u00e0y (thu\u1eadt to\u00e1n \"ch\u1eadm\") \u0111\u1ec3 l\u00e0m.</li> <li>\u0110i \u0111\u1ebfn node con bi\u1ec3u di\u1ec5n block \u0111\u01b0\u1ee3c thay \u0111\u1ed5i v\u00e0 c\u1eadp nh\u1eadt n\u00f3 trong \\(O(\\sqrt{n})\\) v\u1edbi thu\u1eadt to\u00e1n \"ch\u1eadm\".</li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a vi\u1ec7c truy v\u1ea5n v\u1eabn l\u00e0 \\(O(1)\\): ta c\u1ea7n d\u00f9ng \\(\\text{index}\\) trong truy v\u1ea5n \u0111\u00fang m\u1ed9t l\u1ea7n, v\u00e0 s\u1ebd t\u1ed1n \\(O(1)\\) th\u1eddi gian.</p> <p>V\u1eady t\u1ed5ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho vi\u1ec7c c\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed l\u00e0 \\(O(\\sqrt{n})\\).</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cap-nhat-gia-tri-mot-oan","title":"C\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb m\u1ed9t \u0111o\u1ea1n","text":"<p>Sqrt tree c\u0169ng c\u00f3 th\u1ec3 g\u00e1n t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t \u0111o\u1ea1n b\u1eb1ng m\u1ed9t gi\u00e1 tr\u1ecb n\u00e0o \u0111\u00f3. G\u1ecdi h\u00e0m \\(\\text{massUpdate}(x, l, r)\\) ngh\u0129a l\u00e0 \\(a_i = x\\) v\u1edbi m\u1ecdi \\(l \\le i \\le r\\).</p> <p>C\u00f3 hai c\u00e1ch ti\u1ebfp c\u1eadn \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y: m\u1ed9t trong s\u1ed1 \u0111\u00f3 ch\u1ea1y \\(\\text{massUpdate}\\) trong \\(O(\\sqrt{n}\\cdot \\log \\log n)\\), v\u1edbi truy v\u1ea5n trong \\(O(1)\\). C\u00e1ch th\u1ee9 hai th\u00ec ch\u1ea1y \\(\\text{massUpdate}\\) trong \\(O(\\sqrt{n})\\), nh\u01b0ng l\u1ea1i truy v\u1ea5n trong \\(O(\\log \\log n)\\).</p> <p>Ta s\u1ebd c\u1eadp nh\u1eadt lazy y nh\u01b0 c\u00e1ch l\u00e0m v\u1edbi segment tree: \u0111\u00e1nh d\u1ea5u m\u1ed9t s\u1ed1 node l\u00e0 lazy, ngh\u0129a l\u00e0 ta s\u1ebd \u0111\u1ea9y c\u1eadp nh\u1eadt xu\u1ed1ng ch\u1ec9 khi c\u1ea7n thi\u1ebft. Nh\u01b0ng \u0111i\u1ec3m kh\u00e1c so v\u1edbi segment tree l\u00e0: \u0111\u1ea9y c\u1eadp nh\u1eadt r\u1ea5t t\u1ed1n t\u00e0i nguy\u00ean, n\u00ean s\u1ebd kh\u00f4ng l\u00e0m \u0111\u01b0\u1ee3c trong c\u00e1c truy v\u1ea5n. Tr\u00ean l\u1edbp \\(0\\), \u0111\u1ea9y c\u1eadp nh\u1eadt t\u1ed1n \\(O(\\sqrt{n})\\) th\u1eddi gian. V\u00ec th\u1ebf n\u00ean ta kh\u00f4ng \u0111\u1ea9y trong truy v\u1ea5n, ta ch\u1ec9 xem n\u1ebfu node hi\u1ec7n t\u1ea1i ho\u1eb7c cha c\u1ee7a node \u0111\u00f3 lazy, v\u00e0 ch\u1ec9 x\u00e9t n\u00f3 khi ch\u1ea1y truy v\u1ea5n.</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cach-1","title":"C\u00e1ch 1","text":"<p>Ta gi\u1ea3 s\u1eed r\u1eb1ng ch\u1ec9 c\u00f3 c\u00e1c node tr\u00ean l\u1edbp \\(1\\) (v\u1edbi \u0111\u1ed9 d\u00e0i \\(O(\\sqrt{n})\\)) l\u00e0 c\u00f3 th\u1ec3 lazy. Khi \u0111\u1ea9y node xu\u1ed1ng, n\u00f3 c\u1eadp nh\u1eadt t\u1ea5t c\u1ea3 c\u00e2y con k\u1ec3 c\u1ea3 n\u00f3 trong \\(O(\\sqrt{n}\\cdot \\log \\log n)\\). Qu\u00e1 tr\u00ecnh \\(\\text{massUpdate}\\) s\u1ebd nh\u01b0 sau:</p> <ul> <li>X\u00e9t c\u00e1c node tr\u00ean l\u1edbp \\(1\\) v\u00e0 c\u00e1c block t\u01b0\u01a1ng \u1ee9ng v\u1edbi ch\u00fang.</li> <li>M\u1ed9t s\u1ed1 block \u0111\u01b0\u1ee3c bao ph\u1ee7 ho\u00e0n to\u00e0n b\u1edfi \\(\\text{massUpdate}\\). Ta \u0111\u00e1nh d\u1ea5u ch\u00fang l\u00e0 lazy trong \\(O(\\sqrt{n})\\).</li> <li>M\u1ed9t s\u1ed1 block \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n. L\u01b0u \u00fd r\u1eb1ng kh\u00f4ng c\u00f3 nhi\u1ec1u h\u01a1n hai block nh\u01b0 v\u1eady. X\u00e2y d\u1ef1ng l\u1ea1i ch\u00fang trong \\(O(\\sqrt{n}\\cdot \\log \\log n)\\). N\u1ebfu ch\u00fang lazy, tranh th\u1ee7 x\u00e9t ch\u00fang.</li> <li>C\u1eadp nh\u1eadt \\(\\text{prefixOp}\\) v\u00e0 \\(\\text{suffixOp}\\) cho c\u00e1c block b\u1ecb bao ph\u1ee7 m\u1ed9t ph\u1ea7n trong \\(O(\\sqrt{n})\\) (v\u00ec ch\u1ec9 c\u00f3 hai block nh\u01b0 v\u1eady).</li> <li>X\u00e2y d\u1ef1ng l\u1ea1i \\(\\text{index}\\) trong \\(O(\\sqrt{n}\\cdot \\log \\log n)\\).</li> </ul> <p>Ta c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n \\(\\text{massUpdate}\\) nhanh ch\u00f3ng. Nh\u01b0ng c\u1eadp nh\u1eadt lazy th\u00ec \u1ea3nh h\u01b0\u1edfng g\u00ec \u0111\u1ebfn truy v\u1ea5n? N\u00f3 s\u1ebd t\u1ea1o ra c\u00e1c thay \u0111\u1ed5i sau:</p> <ul> <li>N\u1ebfu truy v\u1ea5n n\u1eb1m ho\u00e0n to\u00e0n trong m\u1ed9t lazy block, t\u00ednh k\u1ebft qu\u1ea3 v\u00e0 x\u00e9t c\u1ea3 lazy, \\(O(1)\\).</li> <li>N\u1ebfu truy v\u1ea5n g\u1ed3m nhi\u1ec1u block, m\u1ed9t s\u1ed1 trong \u0111\u00f3 lazy, ta c\u1ea7n quan t\u00e2m lazy n\u1eb1m b\u00ean tr\u00e1i ho\u1eb7c ph\u1ea3i ngo\u00e0i c\u00f9ng. C\u00e1c block c\u00f2n l\u1ea1i \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng \\(\\text{index}\\), ta \u0111\u00e3 bi\u1ebft \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 tr\u00ean c\u00e1c block lazy r\u1ed3i (v\u00ec \\(\\text{index}\\) \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng l\u1ea1i m\u1ed7i khi c\u00f3 thay \u0111\u1ed5i \u1edf m\u1ea3ng), \\(O(1)\\).</li> </ul> <p>\u0110\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a truy v\u1ea5n v\u1eabn l\u00e0 \\(O(1)\\).</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cach-2","title":"C\u00e1ch 2","text":"<p>\u1ede c\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y, m\u1ed7i node \u0111\u1ec1u c\u00f3 th\u1ec3 lazy (tr\u1eeb node g\u1ed1c). K\u1ec3 c\u1ea3 c\u00e1c node trong \\(\\text{index}\\) c\u0169ng c\u00f3 th\u1ec3 lazy. V\u00ec th\u1ebf n\u00ean khi ta th\u1ef1c hi\u1ec7n m\u1ed9t truy v\u1ea5n, ta c\u1ea7n ph\u1ea3i xem th\u1eed c\u00e1c bi\u1ebfn lazy tr\u00ean c\u00e1c node t\u1ed5 ti\u00ean, ngh\u0129a l\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p truy v\u1ea5n s\u1ebd l\u00e0 \\(O(\\log \\log n)\\).</p> <p>Nh\u01b0ng \\(\\text{massUpdate}\\)\u200al\u1ea1i nhanh h\u01a1n. N\u00f3 s\u1ebd tr\u00f4ng nh\u01b0 sau:</p> <ul> <li>M\u1ed9t s\u1ed1 block \u0111\u01b0\u1ee3c bao ph\u1ee7 ho\u00e0n to\u00e0n b\u1edfi\u200a \\(\\text{massUpdate}\\) n\u00ean lazy \u0111\u01b0\u1ee3c th\u00eam v\u00e0o ch\u00fang, \u0111\u1ed9 ph\u1ee9c t\u1ea1p\u200a \\(O(\\sqrt{n})\\).</li> <li>C\u1eadp nh\u1eadt \\(\\text{prefixOp}\\)\u200a v\u00e0 \\(\\text{suffixOp}\\) cho c\u00e1c block \u0111\u01b0\u1ee3c ph\u1ee7 m\u1ed9t ph\u1ea7n trong \\(O(\\sqrt{n})\\)\u200a(v\u00ec ch\u1ec9 c\u00f3 hai block nh\u01b0 v\u1eady th\u00f4i).</li> <li>\u0110\u1eebng qu\u00ean c\u1eadp nh\u1eadt \\(\\text{index}\\). N\u00f3 t\u1ed1n\u200a\\(O(\\sqrt{n})\\)\u200a(c\u0169ng d\u00f9ng thu\u1eadt \u200a\\(\\text{massUpdate}\\) \u200anh\u01b0 v\u1eady).</li> <li>C\u1eadp nh\u1eadt m\u1ea3ng \\(\\text{between}\\)\u200a cho c\u00e1c c\u00e2y con unindexed.</li> <li>\u0110i v\u00e0o c\u00e1c node \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n v\u00e0 ti\u1ebfp t\u1ee5c g\u1ecdi \\(\\text{massUpdate}\\) nh\u01b0 th\u1ebf.</li> </ul> <p>L\u01b0u \u00fd r\u1eb1ng khi g\u1ecdi \u0111\u1ec7 quy, ta \\(\\text{massUpdate}\\) ti\u1ec1n t\u1ed1 ho\u1eb7c h\u1eadu t\u1ed1. Nh\u01b0ng v\u1edbi vi\u1ec7c c\u1eadp nh\u1eadt ti\u1ec1n t\u1ed1 v\u00e0 h\u1eadu t\u1ed1, ta ch\u1ec9 c\u00f3 th\u1ec3 c\u00f3 m\u1ed9t node con \u0111\u01b0\u1ee3c bao ph\u1ee7 m\u1ed9t ph\u1ea7n th\u00f4i. N\u00ean ta th\u0103m m\u1ed9t node tr\u00ean l\u1edbp \\(1\\), hai node tr\u00ean l\u1edbp \\(2\\) v\u00e0 hai node tr\u00ean b\u1ea5t c\u1ee9 l\u1edbp ti\u1ebfp theo n\u00e0o. N\u00ean \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian l\u00e0 \\(O(\\sqrt{n} + \\sqrt{\\sqrt{n}} + \\dots) = O(\\sqrt{n})\\). C\u00e1ch ti\u1ebfp c\u1eadn n\u00e0y t\u01b0\u01a1ng t\u1ef1 v\u1edbi mass update tr\u00ean segment tree.</p>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#cai-at","title":"C\u00e0i \u0111\u1eb7t","text":"<p>Code sau \u0111\u00e2y c\u1ee7a Sqrt Tree c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c thao t\u00e1c sau: x\u00e2y d\u1ef1ng x\u00e2y trong \\(O(n \\cdot \\log \\log n)\\), tr\u1ea3 l\u1eddi truy v\u1ea5n trong \\(O(1)\\), c\u1eadp nh\u1eadt m\u1ed9t ph\u1ea7n t\u1eed trong \\(O(\\sqrt{n})\\).</p> <pre><code>struct SqrtTreeItem {\n    // t\u1ea1o item theo \u00fd th\u00edch c\u1ee7a b\u1ea1n\n};\n\n// nh\u1edb th\u00eam thao t\u00e1c v\u00e0o\nSqrtTreeItem op(const SqrtTreeItem &amp;a, const SqrtTreeItem &amp;b);\n\ninline int log2Up(int n) {\n    int res = 0;\n    while ((1 &lt;&lt; res) &lt; n) {\n        res++;\n    }\n    return res;\n}\n\nstruct SqrtTree {\n    int n, lg, indexSz;\n    vector&lt;SqrtTreeItem&gt; v;\n    vi clz, layers, onLayer;\n    vector&lt;vector&lt;SqrtTreeItem&gt;&gt; pref, suf, between;\n\n    inline void buildBlock(int layer, int l, int r) {\n        // block [l, r)\n        // t\u00ednh c\u00e1c m\u1ea3ng prefix v\u00e0 suffix\n        pref[layer][l] = v[l];\n        FOR(i,l+1,r-1) {\n            pref[layer][i] = op(pref[layer][i-1], v[i]);\n        }\n        suf[layer][r-1] = v[r-1];\n        FORE(i,r-2,l) {\n            suf[layer][i] = op(v[i], suf[layer][i+1]);\n        }\n    }\n\n    inline void buildBetween(int layer, int lBound, int rBound, int betweenOffs) {\n        // log c\u1ee7a block size\n        int bSzLog = (layers[layer]+1) &gt;&gt; 1;\n        // log of s\u1ed1 c\u00e1c block\n        int bCntLog = layers[layer] &gt;&gt; 1;\n        // block size\n        int bSz = 1 &lt;&lt; bSzLog;\n        // s\u1ed1 c\u00e1c block c\u1ee7a layer n\u00e0y, \u0111\u01a1n gi\u1ea3n n\u00f3 l\u00e0 ceilDiv(r - l, bSz)\n        int bCnt = (rBound - lBound + bSz - 1) &gt;&gt; bSzLog;\n\n        // build m\u1ea3ng \"between\"\n        for (int i = 0; i &lt; bCnt; i++) {\n            SqrtTreeItem ans;\n            for (int j = i; j &lt; bCnt; j++) {\n                SqrtTreeItem add = suf[layer][lBound + (j &lt;&lt; bSzLog)];\n                ans = (i == j) ? add : op(ans, add);\n                // between[i][j]\n                between[layer-1][betweenOffs + lBound + (i &lt;&lt; bCntLog) + j] = ans;\n            }\n        }\n    }\n\n    inline void buildBetweenZero() {\n        int bSzLog = (lg+1) &gt;&gt; 1;\n        // th\u00eam gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c block c\u1ee7a layer 0 v\u00e0o \"index\" c\u1ee7a sqrt tree v\u00e0 build c\u00e2y \u0111\u00f3\n        for (int i = 0; i &lt; indexSz; i++) {\n            v[n+i] = suf[0][i &lt;&lt; bSzLog];\n        }\n        build(1, n, n + indexSz, (1 &lt;&lt; lg) - n);\n    }\n\n    inline void updateBetweenZero(int bid) {\n        int bSzLog = (lg+1) &gt;&gt; 1;\n        // update block value c\u1ee7a \"index\" sqrt tree\n        v[n+bid] = suf[0][bid &lt;&lt; bSzLog];\n        // update \"index\" sqrt tree\n        update(1, n, n + indexSz, (1 &lt;&lt; lg) - n, n+bid);\n    }\n\n    void build(int layer, int lBound, int rBound, int betweenOffset) {\n        if (layer &gt;= SZ(layers)) {\n            // return khi layer index l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 layer\n            return;\n        }\n\n        // block size\n        int bSz = 1 &lt;&lt; ((layers[layer]+1) &gt;&gt; 1);\n        for (int l = lBound; l &lt; rBound; l += bSz) {\n            int r = min(l + bSz, rBound);\n            buildBlock(layer, l, r);\n            build(layer+1, l, r, betweenOffset);\n        }\n\n        // build \"index\" sqrt tree khi \u1edf layer 0, ng\u01b0\u1ee3c l\u1ea1i build \"between\"\n        if (layer == 0) {\n            buildBetweenZero();\n        } else {\n            buildBetween(layer, lBound, rBound, betweenOffset);\n        }\n    }\n\n    void update(int layer, int lBound, int rBound, int betweenOffset, int x) {\n        if (layer &gt;= (int)layers.size()) {\n            // return khi layer index l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 layer\n            return;\n        }\n\n        // log c\u1ee7a block size\n        int bSzLog = (layers[layer]+1) &gt;&gt; 1;\n        // block size\n        int bSz = 1 &lt;&lt; bSzLog;\n        // block index ch\u1ee9a x\n        int blockIdx = (x - lBound) &gt;&gt; bSzLog;\n        // [l, r) c\u1ee7a block ch\u1ee9a x\n        int l = lBound + (blockIdx &lt;&lt; bSzLog);\n        int r = min(l + bSz, rBound);\n        // update m\u1ea3ng pref v\u00e0 suf\n        buildBlock(layer, l, r);\n\n        // build \"index\" sqrt tree khi \u1edf layer 0, ng\u01b0\u1ee3c l\u1ea1i build \"between\"\n        if (layer == 0) {\n            updateBetweenZero(blockIdx);\n        } else {\n            buildBetween(layer, lBound, rBound, betweenOffset);\n        }\n        // update cho \u0111\u1ebfn n\u00fat l\u00e1\n        update(layer+1, l, r, betweenOffset, x);\n    }\n\n    inline SqrtTreeItem query(int l, int r, int betweenOffset, int base) {\n        // \u0111o\u1ea1n [l, r]\n        // \u0111\u1ed9 d\u00e0i 1\n        if (l == r) {\n            return v[l];\n        }\n        // \u0111\u1ed9 d\u00e0i 2\n        if (l + 1 == r) {\n            return op(v[l], v[r]);\n        }\n\n        // t\u00ecm ch\u1ec9 s\u1ed1 l\u1edbp l\u1edbn nh\u1ea5t bao b\u1ecdc \u0111o\u1ea1n [l, r]\n        int layer = onLayer[clz[(l - base) ^ (r - base)]];\n        // block size c\u1ee7a c\u00e1c blocks tr\u00ean layer n\u00e0y\n        int bSzLog = (layers[layer]+1) &gt;&gt; 1;\n        // number of blocks tr\u00ean layer n\u00e0y\n        int bCntLog = layers[layer] &gt;&gt; 1;\n        // lBound = s\u1ed1 ph\u1ea7n t\u1eed n\u1eb1m b\u00ean tr\u00e1i c\u1ee7a block ch\u1ee9a l\n        int lBound = (((l - base) &gt;&gt; layers[layer]) &lt;&lt; layers[layer]) + base;\n        // lBlock v\u00e0 rBlock l\u00e0 c\u00e1c block tr\u00e1i v\u00e0 ph\u1ea3i ngo\u00e0i c\u00f9ng kh\u00f4ng ch\u1ee9a l v\u00e0 r\n        int lBlock = ((l - lBound) &gt;&gt; bSzLog) + 1;\n        int rBlock = ((r - lBound) &gt;&gt; bSzLog) - 1;\n\n        // l\u1ea5y \u0111\u00e1p \u00e1n tr\u00ean block tr\u00e1i ngo\u00e0i c\u00f9ng\n        SqrtTreeItem ans = suf[layer][l];\n        if (lBlock &lt;= rBlock) {\n            SqrtTreeItem add = (layer == 0) ? (\n                // n\u1ebfu n\u00f3 n\u1eb1m tr\u00ean layer 0, ta truy v\u1ea5n v\u1edbi \"index\", v\u00ec n\u00f3 ch\u1ee9a th\u00f4ng tin c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c block c\u1ee7a layer 0\n                query(n + lBlock, n + rBlock, (1 &lt;&lt; lg) - n, n)\n            ) : (\n                // n\u1ebfu layer kh\u00f4ng l\u00e0 node g\u1ed1c, ta d\u1ec5 d\u00e0ng d\u00f9ng \"between\" \u0111\u1ec3 l\u1ea5y k\u1ebft qu\u00e1\n                between[layer-1][betweenOffset + lBound + (lBlock &lt;&lt; bCntLog) + rBlock]\n            );\n            // th\u00eam \u0111\u00e1p \u00e1n c\u1ee7a c\u00e1c block gi\u1eefa v\u00e0o \u0111\u00e1p \u00e1n cu\u1ed1i c\u00f9ng\n            ans = op(ans, add);\n        }\n        // l\u1ea5y \u0111\u00e1p \u00e1n tr\u00ean block ph\u1ea3i ngo\u00e0i c\u00f9ng\n        ans = op(ans, pref[layer][r]);\n        return ans;\n    }\n\n    inline SqrtTreeItem query(int l, int r) {\n        return query(l, r, 0, 0);\n    }\n\n    inline void update(int x, const SqrtTreeItem &amp;item) {\n        v[x] = item;\n        update(0, 0, n, 0, x);\n    }\n\n    SqrtTree(const vector&lt;SqrtTreeItem&gt; &amp;a) : n(SZ(a)), lg(log2Up(n)), v(a), clz(1 &lt;&lt; lg), onLayer(lg+1) {\n        // n = k\u00edch th\u01b0\u1edbc m\u1ea3ng ban \u0111\u1ea7u\n        // lg = ceil(log2(n))\n\n        // clz[i] = v\u1ecb tr\u00ed bit 1 nh\u1ecf nh\u1ea5t\n        clz[0] = 0;\n        FOR(i,1,SZ(clz)-1) clz[i] = clz[i &gt;&gt; 1] + 1;\n\n        // layers[i] l\u00e0 \u0111\u1ed9 d\u00e0i block \u1edf layer i\n        // onLayer[i] = x ngh\u0129a l\u00e0 n\u1ebfu d\u1ed9 d\u00e0i block l\u00e0 2^i th\u00ec n\u00f3 n\u00ean n\u1eb1m tr\u00ean layer x\n        int tlg = lg;\n        while (tlg &gt; 1) {\n            onLayer[tlg] = SZ(layers);\n            layers.push_back(tlg);\n            // sqrt(2^x) = 2^(x / 2)\n            tlg = (tlg + 1) &gt;&gt; 1;\n        }\n        FORE(i,lg-1,0) ckmax(onLayer[i], onLayer[i+1]);\n\n        int betweenLayers = max(0, SZ(layers) - 1);\n        int bSzLog = (lg + 1) &gt;&gt; 1;\n        int bSz = (1 &lt;&lt; bSzLog);\n        // indexSz l\u00e0 s\u1ed1 c\u1ea3c block \u0111\u1ed9 d\u00e0i bSz, chia n ph\u1ea7n t\u1eed ra th\u00e0nh ch\u1eebng \u0111\u00f3 block\n        // n\u00f3 \u0111\u01a1n gi\u1ea3n l\u00e0 ceilDiv(n, bSz)\n        indexSz = (n + bSz - 1) &gt;&gt; bSzLog;\n\n        v.resize(n + indexSz);\n        pref.assign(layers.size(), vector&lt;SqrtTreeItem&gt;(n + indexSz));\n        suf.assign(layers.size(), vector&lt;SqrtTreeItem&gt;(n + indexSz));\n        between.assign(betweenLayers, vector&lt;SqrtTreeItem&gt;((1 &lt;&lt; lg) + bSz));\n\n        build(0, 0, n, 0);\n    }\n};\n</code></pre>"},{"location":"cp-algorithms/data-structures/trees/sqrt-tree/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date Codechef - SEGPROD Submission Code 14/02/2023"},{"location":"cp-algorithms/graph/sssp/01-bfs/","title":"0-1 BFS","text":""},{"location":"cp-algorithms/graph/sssp/01-bfs/#0-1-bfs","title":"0-1 BFS","text":""},{"location":"cp-algorithms/graph/sssp/01-bfs/#nguon","title":"Ngu\u1ed3n","text":"<p> 0-1 BFS</p>"},{"location":"cp-algorithms/graph/sssp/01-bfs/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>B\u1ea1n ch\u1eafc h\u1eb3n \u0111\u00e3 quen thu\u1ed9c v\u1edbi vi\u1ec7c t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t ngu\u1ed3n \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c node kh\u00e1c trong \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1 trong th\u1eddi gian \\(O(|E|)\\) b\u1eb1ng thu\u1eadt to\u00e1n BFS (kho\u1ea3ng c\u00e1ch l\u00e0 s\u1ed1 c\u1ea1nh nh\u1ecf nh\u1ea5t t\u1eeb ngu\u1ed3n \u0111\u1ebfn \u0111\u00edch). Ta c\u00f3 th\u1ec3 xem \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1 nh\u01b0 m\u1ed9t \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1, trong \u0111\u00f3 m\u1ed7i c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 l\u00e0 \\(1\\). N\u1ebfu tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh kh\u00f4ng b\u1eb1ng nhau, ta c\u1ea7n m\u1ed9t thu\u1eadt to\u00e1n t\u1ed5ng qu\u00e1t h\u01a1n, nh\u01b0 Dijkstra, ch\u1ea1y trong th\u1eddi gian \\(O(|V|^2 + |E|)\\) ho\u1eb7c \\(O(|E| \\log |V|)\\).</p> <p>Tuy nhi\u00ean, n\u1ebfu tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh c\u00f3 m\u1ed9t s\u1ed1 r\u00e0ng bu\u1ed9c, ta c\u00f3 th\u1ec3 l\u00e0m t\u1ed1t h\u01a1n. Trong b\u00e0i vi\u1ebft n\u00e0y, ta s\u1ebd \u0111i v\u00e0o t\u00ecm hi\u1ec3u c\u00e1ch s\u1eed d\u1ee5ng BFS \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t t\u1eeb m\u1ed9t ngu\u1ed3n \u0111\u1ebfn t\u1ea5t c\u1ea3 c\u00e1c node kh\u00e1c trong \u0111\u1ed3 th\u1ecb c\u00f3 tr\u1ecdng s\u1ed1 \\(0\\) ho\u1eb7c \\(1\\) trong th\u1eddi gian \\(O(|E|)\\).</p>"},{"location":"cp-algorithms/graph/sssp/01-bfs/#thuat-toan","title":"Thu\u1eadt to\u00e1n","text":"<p>Tr\u01b0\u1edbc h\u1ebft ta \u0111i v\u00e0o nghi\u00ean c\u1ee9u thu\u1eadt to\u00e1n Dijkstra v\u00e0 xem th\u1eed \u0111\u1ed3 th\u1ecb \u0111\u1eb7c bi\u1ec7t c\u1ee7a ch\u00fang ta c\u00f3 th\u1ec3 c\u00f3 nh\u1eefng h\u1ec7 qu\u1ea3 n\u00e0o. D\u1ea1ng t\u1ed5ng qu\u00e1t c\u1ee7a thu\u1eadt to\u00e1n Dijkstra nh\u01b0 sau (\u1edf \u0111\u00e2y ta s\u1eed d\u1ee5ng <code>set</code> \u0111\u1ec3 l\u00e0m h\u00e0ng \u0111\u1ee3i \u01b0u ti\u00ean):</p> <pre><code>d.assign(n, INF);\nd[s] = 0;\nset&lt;pair&lt;int, int&gt;&gt; q;\nq.insert({0, s});\nwhile (!q.empty()) {\n    int v = q.begin()-&gt;second;\n    q.erase(q.begin());\n\n    for (auto edge : adj[v]) {\n        int u = edge.first;\n        int w = edge.second;\n\n        if (d[v] + w &lt; d[u]) {\n            q.erase({d[u], u});\n            d[u] = d[v] + w;\n            q.insert({d[u], u});\n        }\n    }\n}\n</code></pre> <p>Trong tr\u01b0\u1eddng h\u1ee3p \u0111\u1ed3 th\u1ecb c\u1ee7a ta (c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 b\u1eb1ng \\(0\\) ho\u1eb7c \\(1\\)), ta th\u1ea5y r\u1eb1ng \\(|d[i] - d[j]|\\) (v\u1edbi \\(i\\) v\u00e0 \\(j\\) l\u00e0 2 node b\u1ea5t k\u1ef3 trong h\u00e0ng \u0111\u1ee3i) kh\u00f4ng qu\u00e1 1. \u0110\u1eb7c bi\u1ec7t, ta bi\u1ebft r\u1eb1ng \\(d[v] \\le d[u] \\le d[v] + 1\\) v\u1edbi m\u1ecdi \\(u \\in Q\\). \u0110\u00f3 l\u00e0 b\u1edfi v\u00ec, ta ch\u1ec9 th\u00eam c\u00e1c node c\u00f3 kho\u1ea3ng c\u00e1ch b\u1eb1ng nhau ho\u1eb7c kho\u1ea3ng c\u00e1ch l\u1edbn h\u01a1n 1 so v\u1edbi node hi\u1ec7n t\u1ea1i v\u00e0o h\u00e0ng \u0111\u1ee3i trong m\u1ed7i l\u1ea7n l\u1eb7p. Gi\u1ea3 s\u1eed t\u1ed3n t\u1ea1i m\u1ed9t node \\(u\\) trong h\u00e0ng \u0111\u1ee3i v\u1edbi \\(d[u] - d[v] &gt; 1\\), th\u00ec \\(u\\) ph\u1ea3i \u0111\u01b0\u1ee3c th\u00eam v\u00e0o h\u00e0ng \u0111\u1ee3i th\u00f4ng qua m\u1ed9t node kh\u00e1c \\(t\\) v\u1edbi \\(d[t] \\ge d[u] - 1 &gt; d[v]\\). Tuy nhi\u00ean \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3, v\u00ec thu\u1eadt to\u00e1n Dijkstra l\u1eb7p qua c\u00e1c node theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n.</p> <p>\u0110i\u1ec1u n\u00e0y c\u00f3 ngh\u0129a l\u00e0, th\u1ee9 t\u1ef1 c\u1ee7a h\u00e0ng \u0111\u1ee3i s\u1ebd nh\u01b0 sau:</p> \\[Q = \\underbrace{v}_{d[v]}, \\dots, \\underbrace{u}_{d[v]}, \\underbrace{m}_{d[v]+1} \\dots \\underbrace{n}_{d[v]+1}\\] <p>C\u1ea5u tr\u00fac n\u00e0y \u0111\u01a1n gi\u1ea3n \u0111\u1ebfn m\u1ee9c ta kh\u00f4ng c\u1ea7n m\u1ed9t h\u00e0ng \u0111\u1ee3i \u01b0u ti\u00ean, t\u1ee9c l\u00e0 ta kh\u00f4ng c\u1ea7n m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n c\u00e2n b\u1eb1ng. Ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng m\u1ed9t h\u00e0ng \u0111\u1ee3i th\u00f4ng th\u01b0\u1eddng, v\u00e0 th\u00eam c\u00e1c node m\u1edbi v\u00e0o \u0111\u1ea7u h\u00e0ng \u0111\u1ee3i n\u1ebfu c\u1ea1nh t\u01b0\u01a1ng \u1ee9ng c\u00f3 tr\u1ecdng s\u1ed1 \\(0\\), t\u1ee9c l\u00e0 \\(d[u] = d[v]\\), ho\u1eb7c th\u00eam v\u00e0o cu\u1ed1i h\u00e0ng \u0111\u1ee3i n\u1ebfu c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 \\(1\\), t\u1ee9c l\u00e0 \\(d[u] = d[v] + 1\\). Nh\u01b0 v\u1eady, h\u00e0ng \u0111\u1ee3i s\u1ebd gi\u1eef nguy\u00ean th\u1ee9 t\u1ef1 s\u1eafp x\u1ebfp.</p> <pre><code>vector&lt;int&gt; d(n, INF);\nd[s] = 0;\ndeque&lt;int&gt; q;\nq.push_front(s);\nwhile (!q.empty()) {\n    int v = q.front();\n    q.pop_front();\n    for (auto edge : adj[v]) {\n        int u = edge.first;\n        int w = edge.second;\n        if (d[v] + w &lt; d[u]) {\n            d[u] = d[v] + w;\n            if (w == 1)\n                q.push_back(u);\n            else\n                q.push_front(u);\n        }\n    }\n}\n</code></pre>"},{"location":"cp-algorithms/graph/sssp/01-bfs/#thuat-toan-dial","title":"Thu\u1eadt to\u00e1n Dial","text":"<p>Ta c\u00f3 th\u1ec3 m\u1edf r\u1ed9ng thu\u1eadt to\u00e1n tr\u00ean n\u1ebfu ta cho ph\u00e9p tr\u1ecdng s\u1ed1 c\u1ee7a c\u00e1c c\u1ea1nh l\u1edbn h\u01a1n \\(1\\). N\u1ebfu m\u1ed7i c\u1ea1nh c\u00f3 tr\u1ecdng s\u1ed1 \\(\\le k\\), th\u00ec kho\u1ea3ng c\u00e1ch c\u1ee7a c\u00e1c node trong h\u00e0ng \u0111\u1ee3i s\u1ebd ch\u00eanh l\u1ec7ch t\u1ed1i \u0111a \\(k\\) so v\u1edbi kho\u1ea3ng c\u00e1ch c\u1ee7a node hi\u1ec7n t\u1ea1i \u0111\u1ebfn ngu\u1ed3n. V\u00ec v\u1eady, ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng \\(k + 1\\) h\u00e0ng \u0111\u1ee3i \u0111\u1ec3 l\u01b0u tr\u1eef c\u00e1c node trong h\u00e0ng \u0111\u1ee3i, v\u00e0 m\u1ed7i khi h\u00e0ng \u0111\u1ee3i c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t tr\u1edf th\u00e0nh r\u1ed7ng, ta d\u1ecbch chuy\u1ec3n c\u00e1c h\u00e0ng \u0111\u1ee3i \u0111\u1ec3 l\u1ea5y h\u00e0ng \u0111\u1ee3i c\u00f3 kho\u1ea3ng c\u00e1ch nh\u1ecf nh\u1ea5t ti\u1ebfp theo. Bi\u1ebfn th\u1ec3 m\u1edf r\u1ed9ng n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Thu\u1eadt to\u00e1n Dial.</p>"},{"location":"cp-algorithms/graph/sssp/01-bfs/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date Codeforces - Labyrinth Submission Code 16/10/2023 SPOJ - KATHTHI Unavailable public link Code 16/10/2023 TopCoder SRM 436 Round 1 - DoNotTurn Unavailable public link Code 17/10/2023 UVA 11573 - Ocean Currents Unavailable public link Code 16/10/2023 Codeforces - Olya and Energy Drinks Submission Code 17/10/2023 Codeforces - Three States Submission Code 18/10/2023 UVA 11574 - Colliding Traffic Unavailable public link Code 18/10/2023 Codeforces - Chamber of Secrets Submission Code 17/10/2023 Codeforces - Spiral Maximum Submission Code 17/10/2023 LeetCode 1368 - Minimum Cost to Make at Least One Valid Path in a Grid Unavailable public link Code 16/10/2023"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/","title":"Thu\u1eadt to\u00e1n Floyd t\u00ecm chu tr\u00ecnh trong Linked List","text":""},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#thuat-toan-floyd-tim-chu-trinh-trong-linked-list","title":"Thu\u1eadt to\u00e1n Floyd t\u00ecm chu tr\u00ecnh trong Linked List","text":""},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#nguon","title":"Ngu\u1ed3n","text":"<p> Floyd's Linked List Cycle Finding Algorithm</p>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#bai-toan","title":"B\u00e0i to\u00e1n","text":"<p>Cho m\u1ed9t linked list, v\u1edbi node \u0111\u1ea7u ti\u00ean c\u1ee7a linked list \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 <code>head</code>. v\u00e0 c\u00f3 th\u1ec3 c\u00f3 ho\u1eb7c kh\u00f4ng c\u00f3 chu tr\u00ecnh trong linked list n\u00e0y. V\u00ed d\u1ee5:</p> <p></p> <p>\u1ede \u0111\u00e2y b\u1ea1n c\u1ea7n t\u00ecm node C, node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh.</p>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#thuat-toan-e-xuat","title":"Thu\u1eadt to\u00e1n \u0111\u1ec1 xu\u1ea5t","text":"<p>Thu\u1eadt to\u00e1n sau \u0111\u00e2y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 Thu\u1eadt to\u00e1n t\u00ecm chu tr\u00ecnh Floyd - Floyd\u2019s Cycle Algorithm ho\u1eb7c Thu\u1eadt to\u00e1n r\u00f9a v\u00e0 th\u1ecf - Tortoise and Hare Algorithm. \u0110\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh, tr\u01b0\u1edbc ti\u00ean ta c\u1ea7n t\u00ecm xem c\u00f3 chu tr\u00ecnh hay kh\u00f4ng. Nh\u01b0 v\u1eady thu\u1eadt to\u00e1n s\u1ebd g\u1ed3m hai b\u01b0\u1edbc ch\u00ednh: Ki\u1ec3m tra xem c\u00f3 t\u1ed3n t\u1ea1i chu tr\u00ecnh hay kh\u00f4ng, v\u00e0 T\u00ecm node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh.</p>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#buoc-1-linked-list-co-chu-trinh-hay-khong","title":"B\u01b0\u1edbc 1: Linked List c\u00f3 chu tr\u00ecnh hay kh\u00f4ng?","text":"<ol> <li>Kh\u1edfi t\u1ea1o hai con tr\u1ecf <code>slow</code> v\u00e0 <code>fast</code>.</li> <li>Ban \u0111\u1ea7u c\u1ea3 hai con tr\u1ecf s\u1ebd tr\u1ecf v\u00e0o <code>head</code> c\u1ee7a linked list.</li> <li><code>slow</code> s\u1ebd di chuy\u1ec3n m\u1ed9t b\u01b0\u1edbc m\u1ed7i l\u1ea7n l\u1eb7p</li> <li><code>fast</code> s\u1ebd di chuy\u1ec3n hai b\u01b0\u1edbc m\u1ed7i l\u1ea7n l\u1eb7p, ngh\u0129a l\u00e0 t\u1ed1c \u0111\u1ed9 c\u1ee7a <code>fast</code> g\u1ea5p \u0111\u00f4i t\u1ed1c \u0111\u1ed9 c\u1ee7a <code>slow</code>.</li> <li>Ki\u1ec3m tra xem c\u00f3 th\u1eddi \u0111i\u1ec3m n\u00e0o ch\u00fang tr\u1ecf v\u00e0o c\u00f9ng m\u1ed9t node tr\u01b0\u1edbc khi m\u1ed9t trong hai con tr\u1ecf (ho\u1eb7c c\u1ea3 hai) tr\u1ecf v\u00e0o <code>NULL</code> hay kh\u00f4ng.</li> <li>N\u1ebfu ch\u00fang tr\u1ecf v\u00e0o c\u00f9ng m\u1ed9t node t\u1ea1i m\u1ed9t th\u1eddi \u0111i\u1ec3m n\u00e0o \u0111\u00f3, th\u00ec ta k\u1ebft lu\u1eadn r\u1eb1ng linked list c\u00f3 chu tr\u00ecnh.</li> <li>N\u1ebfu m\u1ed9t trong hai con tr\u1ecf tr\u1ecf v\u00e0o <code>NULL</code> th\u00ec ta k\u1ebft lu\u1eadn r\u1eb1ng linked list kh\u00f4ng c\u00f3 chu tr\u00ecnh.</li> </ol> <p>Gi\u1edd ta \u0111\u00e3 bi\u1ebft r\u1eb1ng chu tr\u00ecnh c\u00f3 t\u1ed3n t\u1ea1i trong linked list, b\u01b0\u1edbc ti\u1ebfp theo l\u00e0 t\u00ecm node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh, trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 node C.</p>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#buoc-2-tim-iem-bat-au-cua-chu-trinh","title":"B\u01b0\u1edbc 2: T\u00ecm \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh","text":"<ol> <li>\u0110\u01b0a <code>slow</code> v\u1ec1 l\u1ea1i <code>head</code> c\u1ee7a linked list.</li> <li>Di chuy\u1ec3n c\u1ea3 hai con tr\u1ecf <code>slow</code> v\u00e0 <code>fast</code> m\u1ed9t b\u01b0\u1edbc m\u1ed7i l\u1ea7n l\u1eb7p.</li> <li>Khi ch\u00fang tr\u1ecf v\u00e0o c\u00f9ng m\u1ed9t node, ta k\u1ebft lu\u1eadn r\u1eb1ng node \u0111\u00f3 l\u00e0 node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh.</li> </ol> <pre><code>// Ki\u1ec3m tra xem linked list c\u00f3 chu tr\u00ecnh hay kh\u00f4ng\npublic boolean hasCycle(ListNode head) {\n    ListNode slow = head;\n    ListNode fast = head;\n\n    while (slow !=null &amp;&amp; fast != null &amp;&amp; fast.next != null) {\n        slow = slow.next;\n        fast = fast.next.next;\n        if (slow == fast) {\n            return true;\n        }\n    }\n\n    return false;\n}\n</code></pre> <pre><code>// Gi\u1ea3 s\u1eed linked list c\u00f3 chu tr\u00ecnh, slow v\u00e0 fast \u0111ang tr\u1ecf v\u00e0o c\u00f9ng m\u1ed9t node\nslow = head;\nwhile (slow != fast) {\n    slow = slow.next;\n    fast = fast.next;\n}\n\nreturn slow; // Node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh\n</code></pre>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#chung-minh","title":"Ch\u1ee9ng minh","text":""},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#buoc-1-linked-list-co-chu-trinh-hay-khong_1","title":"B\u01b0\u1edbc 1: Linked List c\u00f3 chu tr\u00ecnh hay kh\u00f4ng?","text":"<p>V\u00ec <code>fast</code> di chuy\u1ec3n g\u1ea5p \u0111\u00f4i t\u1ed1c \u0111\u1ed9 c\u1ee7a <code>slow</code>, ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng t\u1ea1i b\u1ea5t c\u1ee9 th\u1eddi \u0111i\u1ec3m n\u00e0o, <code>fast</code> \u0111\u00e3 \u0111i \u0111\u01b0\u1ee3c h\u00e0nh tr\u00ecnh g\u1ea5p \u0111\u00f4i <code>slow</code>. Ta c\u0169ng c\u00f3 th\u1ec3 suy ra r\u1eb1ng kho\u1ea3ng c\u00e1ch c\u1ee7a hai node n\u00e0y s\u1ebd t\u1eb1ng \\(1\\) sau m\u1ed7i l\u1ea7n l\u1eb7p.</p> <pre><code>slow: 0 --&gt; 1 --&gt; 2 --&gt; 3 --&gt; 4 (qu\u00e3ng \u0111\u01b0\u1eddng)\nfast: 0 --&gt; 2 --&gt; 4 --&gt; 6 --&gt; 8 (qu\u00e3ng \u0111\u01b0\u1eddng)\ndiff: 0 --&gt; 1 --&gt; 2 --&gt; 3 --&gt; 4 (hi\u1ec7u qu\u00e3ng \u0111\u01b0\u1eddng)\n</code></pre> <p>G\u1ecdi \\(L\\) l\u00e0 \u0111\u1ed9 d\u00e0i (s\u1ed1 node) c\u1ee7a chu tr\u00ecnh, v\u00e0 \\(a\\) l\u00e0 s\u1ed1 b\u01b0\u1edbc c\u1ea7n \u0111\u1ec3 <code>slow</code> \u0111\u1ebfn node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh. T\u1ed3n t\u1ea1i s\u1ed1 nguy\u00ean d\u01b0\u01a1ng \\(k\\) (\\(k &gt; 0\\)) sao cho \\(k \\cdot L \\ge a\\). Khi <code>slow</code> \u0111i \u0111\u01b0\u1ee3c \\(k \\cdot L\\) b\u01b0\u1edbc, <code>fast</code> \u0111\u00e3 \u0111i \u0111\u01b0\u1ee3c \\(2 \\cdot k \\cdot L\\) b\u01b0\u1edbc, c\u1ea3 hai s\u1ebd \u0111\u1ec1u n\u1eb1m trong chu tr\u00ecnh. \u0110\u1ebfn \u0111\u00e2y, \"kho\u1ea3ng c\u00e1ch\" c\u1ee7a c\u1ea3 hai l\u00e0 \\(k \\cdot L\\). Ta c\u00f3 \u0111\u1ed9 d\u00e0i c\u1ee7a chu tr\u00ecnh l\u00e0 \\(L\\), ngh\u0129a l\u00e0 ch\u00fang s\u1ebd g\u1eb7p nhau t\u1ea1i c\u00f9ng m\u1ed9t node tr\u00ean chu tr\u00ecnh, d\u1eabn \u0111\u1ebfn vi\u1ec7c ch\u00fang tr\u00f9ng nhau.</p>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#buoc-2-tim-iem-bat-au-cua-chu-trinh_1","title":"B\u01b0\u1edbc 2: T\u00ecm \u0111i\u1ec3m b\u1eaft \u0111\u1ea7u c\u1ee7a chu tr\u00ecnh","text":"<p>C\u00f9ng t\u00ednh qu\u00e3ng \u0111\u01b0\u1eddng m\u00e0 c\u1ea3 hai con tr\u1ecf \u0111i qua cho \u0111\u1ebfn khi ch\u00fang g\u1eb7p nhau trong chu tr\u00ecnh.</p> <p></p> \\[slowDist = a + xL + b, x \\ge 0\\] \\[fastDist = a + yL + b, y \\ge 0\\] <p>Trong \u0111\u00f3,</p> <ul> <li>\\(slowDist\\) l\u00e0 qu\u00e3ng \u0111\u01b0\u1eddng c\u1ee7a <code>slow</code> \u0111i qua.</li> <li>\\(fastDist\\) l\u00e0 qu\u00e3ng \u0111\u01b0\u1eddng c\u1ee7a <code>fast</code> \u0111i qua.</li> <li>\\(a\\) l\u00e0 s\u1ed1 b\u01b0\u1edbc c\u1ea7n \u0111\u1ec3 c\u1ea3 hai con tr\u1ecf \u0111\u1ebfn node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh.</li> <li>\\(b\\) l\u00e0 kho\u1ea3ng c\u00e1ch gi\u1eefa C v\u00e0 G, ngh\u0129a l\u00e0 kho\u1ea3ng c\u00e1ch gi\u1eefa node \u0111\u1ea7u ti\u00ean c\u1ee7a chu tr\u00ecnh v\u00e0 node m\u00e0 <code>slow</code> v\u00e0 <code>fast</code> g\u1eb7p nhau, theo chi\u1ec1u t\u1eeb C \u0111\u1ebfn G.</li> <li>\\(x\\) l\u00e0 s\u1ed1 l\u1ea7n <code>slow</code> \u0111i m\u1ed9t v\u00f2ng chu tr\u00ecnh, b\u1eaft \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac \u1edf C.</li> <li>\\(y\\) l\u00e0 s\u1ed1 l\u1ea7n <code>fast</code> \u0111i m\u1ed9t v\u00f2ng chu tr\u00ecnh, b\u1eaft \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac \u1edf C.</li> </ul> \\[fastDist = 2 \\cdot (slowDist)\\] \\[a + yL + b = 2 \\cdot (a + xL + b)\\] <p>Gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh tr\u00ean ta \u0111\u01b0\u1ee3c:</p> \\[a = (y - 2x)L - b\\] <p>v\u1edbi \\(y - 2x\\) l\u00e0 m\u1ed9t s\u1ed1 nguy\u00ean.</p> <p>\u0110i\u1ec1u n\u00e0y ngh\u0129a l\u00e0 \\(a\\) b\u01b0\u1edbc s\u1ebd t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c \u0111i v\u00e0i v\u00f2ng chu tr\u00ecnh, v\u00e0 sau \u0111\u00f3 \u0111i l\u00f9i \\(b\\) b\u01b0\u1edbc. V\u00ec <code>fast</code> \u0111\u00e3 c\u00e1ch node \u0111\u1ea7u chu tr\u00ecnh \\(b\\) b\u01b0\u1edbc (theo chi\u1ec1u t\u1eeb \u0111\u1ea7u chu tr\u00ecnh \u0111i t\u1edbi), n\u1ebfu <code>fast</code> \u0111i th\u00eam \\(a\\) b\u01b0\u1edbc n\u1eefa th\u00ec n\u00f3 s\u1ebd d\u1eebng l\u1ea1i \u1edf node \u0111\u1ea7u chu tr\u00ecnh. V\u00e0 v\u00ec ta \u0111\u00e3 \u0111\u01b0a <code>slow</code> v\u1ec1 l\u1ea1i <code>head</code> c\u1ee7a linked list, n\u00ean n\u1ebfu <code>slow</code> \u0111i th\u00eam \\(a\\) b\u01b0\u1edbc n\u1eefa th\u00ec n\u00f3 s\u1ebd d\u1eebng l\u1ea1i \u1edf node \u0111\u1ea7u chu tr\u00ecnh. V\u00ec v\u1eady, n\u1ebfu c\u1ea3 hai \u0111i \\(a\\) b\u01b0\u1edbc th\u00ec ch\u00fang s\u1ebd g\u1eb7p nhau \u1edf node \u0111\u1ea7u chu tr\u00ecnh.</p>"},{"location":"cp-algorithms/misc/misc/tortoise-and-hare/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date LeetCode 141 - Linked List Cycle Unavailable public link Code 21/10/2023 LeetCode 142 - Linked List Cycle II Unavailable public link Code 21/10/2023 LeetCode 287 - Find the Duplicate Number Unavailable public link Code 21/10/2023"},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/","title":"Ph\u00e2n t\u00edch bi\u1ec3u th\u1ee9c","text":""},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#phan-tich-bieu-thuc","title":"Ph\u00e2n t\u00edch bi\u1ec3u th\u1ee9c","text":""},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#nguon","title":"Ngu\u1ed3n","text":"<p> Expression parsing</p>"},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#bai-toan","title":"B\u00e0i to\u00e1n","text":"<p>Cho m\u1ed9t x\u00e2u ch\u1ee9a m\u1ed9t bi\u1ec3u th\u1ee9c to\u00e1n h\u1ecdc, trong \u0111\u00f3 c\u00f3 ch\u1ee9a c\u00e1c s\u1ed1 v\u00e0 c\u00e1c to\u00e1n t\u1eed. T\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c \u0111\u00f3 trong \\(O(n)\\), v\u1edbi \\(n\\) l\u00e0 \u0111\u1ed9 d\u00e0i c\u1ee7a x\u00e2u.</p> <p>Thu\u1eadt to\u00e1n sau \u0111\u00e2y s\u1ebd chuy\u1ec3n bi\u1ec3u th\u1ee9c v\u1ec1 d\u1ea1ng \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 K\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan (Reverse Polish notation - RPN) v\u00e0 t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3.</p>"},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#ky-phap-nghich-ao-ba-lan","title":"K\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan","text":"<p>K\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan l\u00e0 m\u1ed9t d\u1ea1ng vi\u1ebft bi\u1ec3u th\u1ee9c to\u00e1n h\u1ecdc, trong \u0111\u00f3 c\u00e1c to\u00e1n t\u1eed \u0111\u01b0\u1ee3c \u0111\u1eb7t sau c\u00e1c to\u00e1n h\u1ea1ng c\u1ee7a n\u00f3. V\u00ed d\u1ee5 ta c\u00f3 bi\u1ec3u th\u1ee9c sau:</p> \\[a + b * c * d + (e - f) * (g * h + i)\\] <p>c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft d\u01b0\u1edbi d\u1ea1ng k\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan nh\u01b0 sau:</p> \\[a b c * d * + e f - g h * i + * +\\] <p>K\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi nh\u00e0 tri\u1ebft h\u1ecdc v\u00e0 chuy\u00ean gia khoa h\u1ecdc m\u00e1y t\u00ednh ng\u01b0\u1eddi \u00dac Charles Hamblin v\u00e0o gi\u1eefa nh\u1eefng n\u0103m 1950, d\u1ef1a tr\u00ean k\u00fd ph\u00e1p Ba Lan \u0111\u01b0\u1ee3c \u0111\u1ec1 xu\u1ea5t v\u00e0o n\u0103m 1920 b\u1edfi nh\u00e0 to\u00e1n h\u1ecdc ng\u01b0\u1eddi Ba Lan Jan \u0141ukasiewicz.</p> <p>L\u1ee3i th\u1ebf c\u1ee7a k\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan l\u00e0 n\u00f3 gi\u00fap c\u00e1c t\u00ednh c\u00e1c bi\u1ec3u th\u1ee9c to\u00e1n h\u1ecdc \u1edf d\u1ea1ng n\u00e0y d\u1ec5 d\u00e0ng h\u01a1n trong th\u1eddi gian tuy\u1ebfn t\u00ednh. Ban \u0111\u1ea7u ta d\u00f9ng m\u1ed9t stack r\u1ed7ng, sau \u0111\u00f3 duy\u1ec7t qua c\u00e1c to\u00e1n h\u1ea1ng v\u00e0 to\u00e1n t\u1eed c\u1ee7a bi\u1ec3u th\u1ee9c \u0111\u01b0\u1ee3c vi\u1ebft theo k\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan. N\u1ebfu g\u1eb7p m\u1ed9t to\u00e1n h\u1ea1ng, ta \u0111\u1ea9y n\u00f3 v\u00e0o stack. N\u1ebfu g\u1eb7p m\u1ed9t to\u00e1n t\u1eed, ta l\u1ea5y ra hai to\u00e1n h\u1ea1ng tr\u00ean c\u00f9ng c\u1ee7a stack, th\u1ef1c hi\u1ec7n ph\u00e9p t\u00ednh v\u00e0 \u0111\u1ea9y k\u1ebft qu\u1ea3 v\u00e0o stack. Sau khi duy\u1ec7t qua to\u00e0n b\u1ed9 bi\u1ec3u th\u1ee9c, s\u1ebd ch\u1ec9 c\u00f2n m\u1ed9t gi\u00e1 tr\u1ecb duy nh\u1ea5t tr\u00ean stack, \u0111\u00f3 ch\u00ednh l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c.</p> <p>R\u00f5 r\u00e0ng thu\u1eadt to\u00e1n n\u00e0y ch\u1ea1y trong \\(O(n)\\).</p>"},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#phan-tich-bieu-thuc-on-gian","title":"Ph\u00e2n t\u00edch bi\u1ec3u th\u1ee9c \u0111\u01a1n gi\u1ea3n","text":"<p>Tr\u01b0\u1edbc h\u1ebft ta s\u1ebd gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n \u0111\u01a1n gi\u1ea3n h\u01a1n, gi\u1ea3 s\u1eed t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed \u0111\u1ec1u l\u00e0 to\u00e1n t\u1eed hai ng\u00f4i (t\u1ee9c l\u00e0 ch\u00fang c\u00f3 hai to\u00e1n h\u1ea1ng), v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed \u0111\u1ec1u l\u00e0 to\u00e1n t\u1eed tr\u00e1i sang ph\u1ea3i (n\u1ebfu c\u00f3 hai to\u00e1n t\u1eed c\u00f3 c\u00f9ng \u0111\u1ed9 \u01b0u ti\u00ean, th\u00ec ch\u00fang \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n t\u1eeb tr\u00e1i sang ph\u1ea3i). D\u1ea5u ngo\u1eb7c c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng.</p> <p>Ta s\u1ebd thi\u1ebft l\u1eadp hai stack: m\u1ed9t stack \u0111\u1ec3 l\u01b0u c\u00e1c s\u1ed1, v\u00e0 m\u1ed9t stack \u0111\u1ec3 l\u01b0u c\u00e1c to\u00e1n t\u1eed v\u00e0 d\u1ea5u ngo\u1eb7c. Ban \u0111\u1ea7u c\u1ea3 hai stack \u0111\u1ec1u r\u1ed7ng. V\u1edbi stack th\u1ee9 hai, ta s\u1ebd duy tr\u00ec \u0111i\u1ec1u ki\u1ec7n r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp theo \u0111\u1ed9 \u01b0u ti\u00ean gi\u1ea3m d\u1ea7n. N\u1ebfu stack th\u1ee9 hai c\u00f3 ch\u1ee9a d\u1ea5u ngo\u1eb7c, th\u00ec m\u1ed7i kh\u1ed1i to\u00e1n t\u1eed (t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed9t c\u1eb7p d\u1ea5u ngo\u1eb7c) \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, v\u00e0 stack th\u1ee9 hai kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp.</p> <p>Ta s\u1ebd duy\u1ec7t qua c\u00e1c k\u00fd t\u1ef1 c\u1ee7a bi\u1ec3u th\u1ee9c t\u1eeb tr\u00e1i sang ph\u1ea3i. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t ch\u1eef s\u1ed1, ta \u0111\u01b0a gi\u00e1 tr\u1ecb c\u1ee7a n\u00f3 v\u00e0o stack th\u1ee9 nh\u1ea5t. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, ta \u0111\u01b0a n\u00f3 v\u00e0o stack th\u1ee9 hai. N\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng, ta th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack th\u1ee9 hai cho \u0111\u1ebfn khi g\u1eb7p d\u1ea5u ngo\u1eb7c m\u1edf. Cu\u1ed1i c\u00f9ng n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t to\u00e1n t\u1eed, ta th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack th\u1ee9 hai c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao h\u01a1n ho\u1eb7c b\u1eb1ng \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed hi\u1ec7n t\u1ea1i, v\u00e0 \u0111\u01b0a to\u00e1n t\u1eed m\u1edbi v\u00e0o stack th\u1ee9 hai.</p> <p>Sau khi duy\u1ec7t qua to\u00e0n b\u1ed9 bi\u1ec3u th\u1ee9c, m\u1ed9t s\u1ed1 to\u00e1n t\u1eed c\u00f3 th\u1ec3 v\u1eabn c\u00f2n trong stack th\u1ee9 hai, ta th\u1ef1c hi\u1ec7n ch\u00fang.</p> <p>Sau \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t cho b\u1ed1n to\u00e1n t\u1eed \\(+\\) \\(-\\) \\(*\\) \\(/\\):</p> <pre><code>// ki\u1ec3m tra xem k\u00fd t\u1ef1 c c\u00f3 ph\u1ea3i l\u00e0 k\u00fd t\u1ef1 ta kh\u00f4ng quan t\u00e2m hay kh\u00f4ng\nbool delim(char c) {\n    return c == ' ';\n}\n\n// ki\u1ec3m tra xem k\u00fd t\u1ef1 c c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t to\u00e1n t\u1eed hay kh\u00f4ng\nbool isOp(char c) {\n    return c == '+' || c == '-' || c == '*' || c == '/';\n}\n\n// x\u00e1c \u0111\u1ecbnh \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed, ph\u00e9p nh\u00e2n v\u00e0 chia c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao h\u01a1n\nint priority(char op) {\n    if (op == '+' || op == '-') {\n        return 1;\n    }\n    if (op == '*' || op == '/') {\n        return 2;\n    }\n    return -1;\n}\n\n// th\u1ef1c hi\u1ec7n ph\u00e9p t\u00ednh gi\u1eefa hai to\u00e1n h\u1ea1ng trong stack v\u1edbi to\u00e1n t\u1eed op\nvoid processOp(stack&lt;int&gt;&amp; st, char op) {\n    int r = st.top(); st.pop();\n    int l = st.top(); st.pop();\n    switch (op) {\n        case '+': st.push(l + r); break;\n        case '-': st.push(l - r); break;\n        case '*': st.push(l * r); break;\n        case '/': st.push(l / r); break;\n    }\n}\n\n// t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c s\nint evaluate(string&amp; s) {\n    // stack st l\u01b0u c\u00e1c s\u1ed1\n    stack&lt;int&gt; st;\n    // stack op l\u01b0u c\u00e1c to\u00e1n t\u1eed v\u00e0 d\u1ea5u ngo\u1eb7c\n    stack&lt;char&gt; op;\n    // duy\u1ec7t qua c\u00e1c k\u00fd t\u1ef1 c\u1ee7a bi\u1ec3u th\u1ee9c\n    for (int i = 0; i &lt; (int) s.size(); i++) {\n        if (delim(s[i])) {\n            // b\u1ecf qua c\u00e1c k\u00fd t\u1ef1 ta kh\u00f4ng quan t\u00e2m\n            continue;\n        }\n\n        if (s[i] == '(') {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, \u0111\u01b0a n\u00f3 v\u00e0o stack op\n            op.push('(');\n        } else if (s[i] == ')') {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng, th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack op cho \u0111\u1ebfn khi g\u1eb7p d\u1ea5u ngo\u1eb7c m\u1edf\n            while (op.top() != '(') {\n                processOp(st, op.top());\n                op.pop();\n            }\n            // b\u1ecf d\u1ea5u ngo\u1eb7c m\u1edf ra kh\u1ecfi stack op\n            op.pop();\n        } else if (isOp(s[i])) {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t to\u00e1n t\u1eed, th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack op \n            // c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao h\u01a1n ho\u1eb7c b\u1eb1ng \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed hi\u1ec7n t\u1ea1i, v\u00e0 \u0111\u01b0a to\u00e1n t\u1eed \n            // m\u1edbi v\u00e0o stack op\n            char curOp = s[i];\n            while (!op.empty() &amp;&amp; priority(op.top()) &gt;= priority(curOp)) {\n                processOp(st, op.top());\n                op.pop();\n            }\n            op.push(curOp);\n        } else {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t ch\u1eef s\u1ed1, l\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c ch\u1eef s\u1ed1 li\u00ean ti\u1ebfp nhau v\u00e0 \u0111\u01b0a v\u00e0o stack st \n            int number = 0;\n            while (i &lt; (int)s.size() &amp;&amp; isalnum(s[i])) {\n                number = number * 10 + s[i++] - '0';\n            }\n            --i;\n            st.push(number);\n        }\n    }\n\n    // sau khi duy\u1ec7t qua to\u00e0n b\u1ed9 bi\u1ec3u th\u1ee9c, m\u1ed9t s\u1ed1 to\u00e1n t\u1eed c\u00f3 th\u1ec3 v\u1eabn c\u00f2n trong stack op, ta th\u1ef1c hi\u1ec7n ch\u00fang\n    while (!op.empty()) {\n        processOp(st, op.top());\n        op.pop();\n    }\n    // stack st s\u1ebd ch\u1ec9 c\u00f2n m\u1ed9t gi\u00e1 tr\u1ecb duy nh\u1ea5t, \u0111\u00f3 ch\u00ednh l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c\n    return st.top();\n}\n</code></pre> <p>V\u1eady ta \u0111\u00e3 h\u1ecdc c\u00e1ch t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t bi\u1ec3u th\u1ee9c trong \\(O(n)\\), \u0111\u1ed3ng th\u1eddi ta c\u0169ng \u0111\u00e3 s\u1eed d\u1ee5ng k\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan. B\u1eb1ng c\u00e1ch thay \u0111\u1ed5i m\u1ed9t ch\u00fat c\u00e0i \u0111\u1eb7t tr\u00ean, ta c\u0169ng c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c bi\u1ec3u th\u1ee9c \u1edf d\u1ea1ng k\u00fd ph\u00e1p ngh\u1ecbch \u0111\u1ea3o Ba Lan.</p>"},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#toan-tu-on-nguyen","title":"To\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean","text":"<p>Gi\u1ea3 s\u1eed bi\u1ec3u th\u1ee9c c\u0169ng c\u00f3 th\u1ec3 ch\u1ee9a c\u00e1c to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean (to\u00e1n t\u1eed ch\u1ec9 c\u00f3 m\u1ed9t to\u00e1n h\u1ea1ng). V\u00ed d\u1ee5, \u0111\u01a1n gi\u1ea3n nh\u1ea5t l\u00e0 to\u00e1n t\u1eed \u00e2m v\u00e0 d\u01b0\u01a1ng.</p> <p>M\u1ed9t trong nh\u1eefng kh\u00e1c bi\u1ec7t trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y l\u00e0 ta c\u1ea7n x\u00e1c \u0111\u1ecbnh xem to\u00e1n t\u1eed hi\u1ec7n t\u1ea1i l\u00e0 to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean hay to\u00e1n t\u1eed hai ng\u00f4i.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng tr\u01b0\u1edbc m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean, lu\u00f4n c\u00f3 m\u1ed9t to\u00e1n t\u1eed kh\u00e1c ho\u1eb7c m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, ho\u1eb7c kh\u00f4ng c\u00f3 g\u00ec c\u1ea3 (n\u1ebfu n\u00f3 \u1edf \u0111\u1ea7u bi\u1ec3u th\u1ee9c). Ng\u01b0\u1ee3c l\u1ea1i, tr\u01b0\u1edbc m\u1ed9t to\u00e1n t\u1eed hai ng\u00f4i lu\u00f4n c\u00f3 m\u1ed9t to\u00e1n h\u1ea1ng (s\u1ed1) ho\u1eb7c m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng. Do \u0111\u00f3, ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng x\u00e1c \u0111\u1ecbnh xem to\u00e1n t\u1eed ti\u1ebfp theo c\u00f3 th\u1ec3 l\u00e0 to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean hay kh\u00f4ng.</p> <p>Ngo\u00e0i ra, ta c\u0169ng c\u1ea7n th\u1ef1c hi\u1ec7n c\u00e1c to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean v\u00e0 hai ng\u00f4i kh\u00e1c nhau. V\u00e0 ta c\u0169ng c\u1ea7n x\u00e1c \u0111\u1ecbnh \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean cao h\u01a1n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed hai ng\u00f4i.</p> <p>Th\u00eam n\u1eefa, c\u1ea7n l\u01b0u \u00fd r\u1eb1ng m\u1ed9t s\u1ed1 to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean (v\u00ed d\u1ee5 nh\u01b0 to\u00e1n t\u1eed \u00e2m v\u00e0 d\u01b0\u01a1ng) th\u1ef1c ch\u1ea5t l\u00e0 c\u00f3 t\u00ednh \u01b0u ti\u00ean ph\u1ea3i.</p>"},{"location":"cp-algorithms/string-processing/tasks/expression-parsing/#tinh-uu-tien-phai","title":"T\u00ednh \u01b0u ti\u00ean ph\u1ea3i","text":"<p>\u01afu ti\u00ean ph\u1ea3i c\u00f3 ngh\u0129a l\u00e0, b\u1ea5t c\u1ee9 khi n\u00e0o \u0111\u1ed9 \u01b0u ti\u00ean b\u1eb1ng nhau, c\u00e1c to\u00e1n t\u1eed ph\u1ea3i \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n t\u1eeb ph\u1ea3i sang tr\u00e1i.</p> <p>Nh\u01b0 \u0111\u00e3 n\u00f3i \u1edf tr\u00ean, c\u00e1c to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean th\u01b0\u1eddng c\u00f3 t\u00ednh \u01b0u ti\u00ean ph\u1ea3i. M\u1ed9t v\u00ed d\u1ee5 kh\u00e1c cho to\u00e1n t\u1eed \u01b0u ti\u00ean ph\u1ea3i l\u00e0 to\u00e1n t\u1eed m\u0169 (\\(a \\wedge b \\wedge c\\) th\u01b0\u1eddng \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 \\(a^{b^c}\\) ch\u1ee9 kh\u00f4ng ph\u1ea3i l\u00e0 \\((a^b)^c\\)).</p> <p>Ta c\u1ea7n l\u00e0m g\u00ec \u0111\u1ec3 x\u1eed l\u00fd tr\u01b0\u1eddng h\u1ee3p c\u00f3 to\u00e1n t\u1eed \u01b0u ti\u00ean ph\u1ea3i? C\u0169ng \u00edt th\u00f4i. Kh\u00e1c bi\u1ec7t duy nh\u1ea5t l\u00e0, n\u1ebfu \u0111\u1ed9 \u01b0u ti\u00ean b\u1eb1ng nhau, ta s\u1ebd ho\u00e3n vi\u1ec7c th\u1ef1c hi\u1ec7n to\u00e1n t\u1eed \u01b0u ti\u00ean ph\u1ea3i.</p> <p>D\u00f2ng duy nh\u1ea5t c\u1ea7n \u0111\u01b0\u1ee3c ch\u1ec9nh l\u00e0:</p> <pre><code>while (!op.empty() &amp;&amp; priority(op.top()) &gt;= priority(curOp))\n</code></pre> <p>thay b\u1eb1ng</p> <pre><code>while (!op.empty() &amp;&amp; (\n        (left_assoc(curOp) &amp;&amp; priority(op.top()) &gt;= priority(curOp)) ||\n        (!left_assoc(curOp) &amp;&amp; priority(op.top()) &gt; priority(curOp))\n    ))\n</code></pre> <p>v\u1edbi <code>left_assoc</code> l\u00e0 m\u1ed9t h\u00e0m x\u00e1c \u0111\u1ecbnh xem to\u00e1n t\u1eed c\u00f3 t\u00ednh \u01b0u ti\u00ean tr\u00e1i hay kh\u00f4ng.</p> <p>Sau \u0111\u00e2y l\u00e0 c\u00e0i \u0111\u1eb7t cho c\u00e1c to\u00e1n t\u1eed hai ng\u00f4i \\(+\\) \\(-\\) \\(*\\) \\(/\\) v\u00e0 c\u00e1c to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean \\(+\\) \\(-\\):</p> <pre><code>// ki\u1ec3m tra xem k\u00fd t\u1ef1 c c\u00f3 ph\u1ea3i l\u00e0 k\u00fd t\u1ef1 ta kh\u00f4ng quan t\u00e2m hay kh\u00f4ng\nbool delim(char c) {\n    return c == ' ';\n}\n\n// ki\u1ec3m tra xem k\u00fd t\u1ef1 c c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t to\u00e1n t\u1eed hai ng\u00f4i hay kh\u00f4ng\nbool isOp(char c) {\n    return c == '+' || c == '-' || c == '*' || c == '/';\n}\n\n// ki\u1ec3m tra xem k\u00fd t\u1ef1 c c\u00f3 ph\u1ea3i l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean hay kh\u00f4ng\nbool isUnary(char c) {\n    return c == '+' || c=='-';\n}\n\n// x\u00e1c \u0111\u1ecbnh \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed, ph\u00e9p nh\u00e2n v\u00e0 chia c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao h\u01a1n, nh\u01b0ng to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao nh\u1ea5t\nint priority(char op) {\n    if (op &lt; 0) // to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean\n        return 3;\n    if (op == '+' || op == '-')\n        return 1;\n    if (op == '*' || op == '/')\n        return 2;\n    return -1;\n}\n\nvoid processOp(stack&lt;int&gt;&amp; st, char op) {\n    if (op &lt; 0) {\n        int l = st.top(); st.pop();\n        switch (-op) {\n            case '+': st.push(l); break;\n            case '-': st.push(-l); break;\n        }\n    } else {\n        int r = st.top(); st.pop();\n        int l = st.top(); st.pop();\n        switch (op) {\n            case '+': st.push(l + r); break;\n            case '-': st.push(l - r); break;\n            case '*': st.push(l * r); break;\n            case '/': st.push(l / r); break;\n        }\n    }\n}\n\n// t\u00ednh gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c s\nint evaluate(string&amp; s) {\n    // stack st l\u01b0u c\u00e1c s\u1ed1\n    stack&lt;int&gt; st;\n    // stack op l\u01b0u c\u00e1c to\u00e1n t\u1eed v\u00e0 d\u1ea5u ngo\u1eb7c\n    stack&lt;char&gt; op;\n\n    // mayBeUnary x\u00e1c \u0111\u1ecbnh xem ti\u1ebfp theo c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean hay kh\u00f4ng\n    bool mayBeUnary = true;\n    // duy\u1ec7t qua c\u00e1c k\u00fd t\u1ef1 c\u1ee7a bi\u1ec3u th\u1ee9c\n    for (int i = 0; i &lt; (int) s.size(); i++) {\n        if (delim(s[i])) {\n            // b\u1ecf qua c\u00e1c k\u00fd t\u1ef1 ta kh\u00f4ng quan t\u00e2m\n            continue;\n        }\n\n        if (s[i] == '(') {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c m\u1edf, \u0111\u01b0a n\u00f3 v\u00e0o stack op\n            op.push('(');\n            // ti\u1ebfp theo c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean\n            mayBeUnary = true;\n        } else if (s[i] == ')') {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t d\u1ea5u ngo\u1eb7c \u0111\u00f3ng, th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack op cho \u0111\u1ebfn khi g\u1eb7p d\u1ea5u ngo\u1eb7c m\u1edf\n            while (op.top() != '(') {\n                processOp(st, op.top());\n                op.pop();\n            }\n            // b\u1ecf d\u1ea5u ngo\u1eb7c m\u1edf ra kh\u1ecfi stack op\n            op.pop();\n            // ti\u1ebfp theo kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean\n            mayBeUnary = false;\n        } else if (isOp(s[i])) {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t to\u00e1n t\u1eed\n            char curOp = s[i];\n            if (mayBeUnary &amp;&amp; isUnary(curOp)) {\n                // n\u1ebfu \u0111\u00e2y l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean, \u0111\u1ed5i d\u1ea5u c\u1ee7a n\u00f3 \u0111\u1ec3 ph\u00e2n bi\u1ec7t v\u1edbi to\u00e1n t\u1eed hai ng\u00f4i (+ v\u00e0 -)\n                curOp = -curOp;\n            }\n            while (!op.empty() &amp;&amp; (\n                    (curOp &gt;= 0 &amp;&amp; priority(op.top()) &gt;= priority(curOp)) ||\n                    (curOp &lt; 0 &amp;&amp; priority(op.top()) &gt; priority(curOp))\n                )) {\n                // n\u1ebfu to\u00e1n t\u1eed hai ng\u00f4i th\u00ec th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack op\n                // c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao h\u01a1n ho\u1eb7c b\u1eb1ng \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed hi\u1ec7n t\u1ea1i\n\n                // n\u1ebfu to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean th\u00ec th\u1ef1c hi\u1ec7n t\u1ea5t c\u1ea3 c\u00e1c to\u00e1n t\u1eed trong stack op\n                // c\u00f3 \u0111\u1ed9 \u01b0u ti\u00ean cao h\u01a1n \u0111\u1ed9 \u01b0u ti\u00ean c\u1ee7a to\u00e1n t\u1eed hi\u1ec7n t\u1ea1i\n                processOp(st, op.top());\n                op.pop();\n            }\n            // \u0111\u01b0a to\u00e1n t\u1eed m\u1edbi v\u00e0o stack op\n            op.push(curOp);\n            // ti\u1ebfp theo c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean\n            mayBeUnary = true;\n        } else {\n            // n\u1ebfu k\u00fd t\u1ef1 hi\u1ec7n t\u1ea1i l\u00e0 m\u1ed9t ch\u1eef s\u1ed1, l\u1ea5y t\u1ea5t c\u1ea3 c\u00e1c ch\u1eef s\u1ed1 li\u00ean ti\u1ebfp nhau v\u00e0 \u0111\u01b0a v\u00e0o stack st\n            int number = 0;\n            while (i &lt; (int)s.size() &amp;&amp; isalnum(s[i])) {\n                number = number * 10 + s[i++] - '0';\n            }\n            --i;\n            st.push(number);\n            // ti\u1ebfp theo kh\u00f4ng th\u1ec3 l\u00e0 m\u1ed9t to\u00e1n t\u1eed \u0111\u01a1n nguy\u00ean\n            mayBeUnary = false;\n        }\n    }\n\n    // sau khi duy\u1ec7t qua to\u00e0n b\u1ed9 bi\u1ec3u th\u1ee9c, m\u1ed9t s\u1ed1 to\u00e1n t\u1eed c\u00f3 th\u1ec3 v\u1eabn c\u00f2n trong stack op, ta th\u1ef1c hi\u1ec7n ch\u00fang\n    while (!op.empty()) {\n        processOp(st, op.top());\n        op.pop();\n    }\n\n    // stack st s\u1ebd ch\u1ec9 c\u00f2n m\u1ed9t gi\u00e1 tr\u1ecb duy nh\u1ea5t, \u0111\u00f3 ch\u00ednh l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c\n    return st.top();\n}\n</code></pre>"},{"location":"misc/algorithms/binary-search/","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n v\u00e0 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \"chia \u0111\u00f4i\" kh\u00e1c","text":""},{"location":"misc/algorithms/binary-search/#tim-kiem-nhi-phan-va-cac-phuong-phap-chia-oi-khac","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n v\u00e0 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \"chia \u0111\u00f4i\" kh\u00e1c","text":""},{"location":"misc/algorithms/binary-search/#nguon","title":"Ngu\u1ed3n","text":"<p>Binary search and other \"halving\" methods - nor's blog</p>"},{"location":"misc/algorithms/binary-search/#y-tuong-chinh-cua-tim-kiem-nhi-phan","title":"\u00dd t\u01b0\u1edfng ch\u00ednh c\u1ee7a t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n","text":"<p>\u00dd t\u01b0\u1edfng ch\u00ednh c\u1ee7a t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n l\u00e0 vi\u1ec7c gi\u1ea3m tuy\u1ebfn t\u00ednh kh\u00f4ng gian t\u00ecm ki\u1ebfm. Ta s\u1ebd \u0111i v\u00e0o chi ti\u1ebft sau \u0111\u00e2y.</p>"},{"location":"misc/algorithms/binary-search/#vi-du-nho-nho","title":"V\u00ed d\u1ee5 nho nh\u1ecf","text":"<p>H\u00e3y c\u00f9ng b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t v\u00ed d\u1ee5 \u0111\u01a1n gi\u1ea3n. Gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t m\u1ea3ng nh\u01b0 sau: \\([1, 7, 9, 12, 19]\\), v\u00e0 ta mu\u1ed1n xem th\u1eed s\u1ed1 \\(7\\) c\u00f3 trong m\u1ea3ng kh\u00f4ng (tr\u1ea3 v\u1ec1 ch\u1ec9 s\u1ed1 t\u00ednh t\u1eeb \\(0\\)). C\u00f3 m\u1ed9t s\u1ed1 c\u00e1ch \u0111\u1ec3 l\u00e0m, trong \u0111\u00f3 tr\u00e2u nh\u1ea5t l\u00e0 duy\u1ec7t qua t\u1eebng ph\u1ea7n t\u1eed, ki\u1ec3m tra xem c\u00f3 ph\u1ea7n t\u1eed n\u00e0o b\u1eb1ng \\(7\\) kh\u00f4ng. C\u00e1ch n\u00e0y t\u1ed1n 5 l\u1ea7n so s\u00e1nh.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng m\u1ea3ng \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp. V\u1eady n\u00ean n\u1ebfu ta ki\u1ec3m tra ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \\(p\\) n\u00e0o \u0111\u00f3 trong m\u1ea3ng, ta c\u00f3 3 kh\u1ea3 n\u0103ng sau:</p> <ul> <li>Ph\u1ea7n t\u1eed b\u1eb1ng \\(7\\): ta \u0111\u00e3 t\u00ecm th\u1ea5y k\u1ebft qu\u1ea3 v\u00e0 c\u00f3 th\u1ec3 d\u1eebng t\u00ecm ki\u1ebfm.</li> <li>Ph\u1ea7n t\u1eed nh\u1ecf h\u01a1n \\(7\\): do m\u1ea3ng \u0111\u00e3 \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp, t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed  \u1edf v\u1ecb tr\u00ed \\(&lt; p\\) \u0111\u1ec1u nh\u1ecf h\u01a1n \\(7\\), n\u00ean ta kh\u00f4ng c\u1ea7n ki\u1ec3m tra b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o \u1edf v\u1ecb tr\u00ed \\(\\leq p\\) n\u1eefa.</li> <li>Ph\u1ea7n t\u1eed l\u1edbn h\u01a1n \\(7\\): t\u01b0\u01a1ng t\u1ef1, ta kh\u00f4ng c\u1ea7n ki\u1ec3m tra b\u1ea5t k\u1ef3 ph\u1ea7n t\u1eed n\u00e0o \u1edf v\u1ecb tr\u00ed \\(\\geq p\\) n\u1eefa.</li> </ul> <p>V\u1eady ta c\u00f3 th\u1ec3 l\u00e0m nh\u01b0 sau: ban \u0111\u1ea7u kh\u00f4ng gian t\u00ecm ki\u1ebfm s\u1ebd l\u00e0 \u0111o\u1ea1n \\([0, 4]\\). Ta s\u1ebd x\u00e9t ph\u1ea7n t\u1eed n\u1eb1m gi\u1eefa c\u1ee7a kh\u00f4ng gian t\u00ecm ki\u1ebfm n\u00e0y. \u1ede \u0111\u00e2y ta s\u1ebd c\u00f3 2 tr\u01b0\u1eddng h\u1ee3p nh\u01b0 sau:</p> <ul> <li>Ta d\u1eebng t\u00ecm ki\u1ebfm n\u1ebfu ph\u1ea7n t\u1eed \u1edf v\u1ecb tr\u00ed \u0111\u00f3 b\u1eb1ng \\(7\\).</li> <li>Ta gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm \u0111i m\u1ed9t n\u1eeda sau m\u1ed7i l\u1ea7n ki\u1ec3m tra.</li> </ul> <p>V\u00ed d\u1ee5, x\u00e9t ph\u1ea7n t\u1eed gi\u1eefa c\u1ee7a kh\u00f4ng gian t\u00ecm ki\u1ebfm, n\u00f3 c\u00f3 gi\u00e1 tr\u1ecb l\u00e0 \\(9\\). V\u00ec \\(9 &gt; 7\\), ta s\u1ebd kh\u00f4ng c\u1ea7n x\u00e9t \u0111o\u1ea1n \\([2, 4]\\) n\u1eefa, v\u00e0 kh\u00f4ng gian t\u00ecm ki\u1ebfm m\u1edbi s\u1ebd l\u00e0 \\([0, 1]\\). C\u00f3 hai ph\u1ea7n t\u1eed gi\u1eefa trong kh\u00f4ng gian t\u00ecm ki\u1ebfm m\u1edbi n\u00e0y, ta s\u1ebd m\u1eb7c \u0111\u1ecbnh ch\u1ecdn ph\u1ea7n t\u1eed b\u00ean tr\u00e1i, s\u1ebd c\u00f3 gi\u00e1 tr\u1ecb l\u00e0 \\(1\\). V\u00ec \\(1 &lt; 7\\), ta s\u1ebd kh\u00f4ng c\u1ea7n x\u00e9t \u0111o\u1ea1n \\([0, 0]\\) n\u1eefa, v\u00e0 kh\u00f4ng gian t\u00ecm ki\u1ebfm m\u1edbi s\u1ebd l\u00e0 \\([1, 1]\\). B\u00e2y gi\u1edd ch\u1ec9 c\u00f2n m\u1ed9t ph\u1ea7n t\u1eed duy nh\u1ea5t trong kh\u00f4ng gian t\u00ecm ki\u1ebfm, ta ki\u1ec3m tra n\u00f3 v\u00e0 th\u1ea5y n\u00f3 b\u1eb1ng \\(7\\), n\u00ean ta c\u00f3 th\u1ec3 tr\u1ea3 v\u1ec1 ch\u1ec9 s\u1ed1 \\(1\\) c\u1ee7a n\u00f3.</p> <p>\u1ee6a n\u1ebfu ch\u1ed7 \u0111\u00f3 l\u00e0 s\u1ed1 \\(4\\) thay v\u00ec \\(7\\) th\u00ec sao? Ta s\u1ebd l\u00e0m t\u01b0\u01a1ng t\u1ef1, v\u00e0 cu\u1ed1i c\u00f9ng kh\u00f4ng gian t\u00ecm ki\u1ebfm s\u1ebd b\u1ecb thu h\u1eb9p l\u1ea1i th\u00e0nh m\u1ed9t \u0111o\u1ea1n r\u1ed7ng, v\u00e0 ta c\u00f3 th\u1ec3 tr\u1ea3 v\u1ec1 k\u1ebft qu\u1ea3 l\u00e0 kh\u00f4ng t\u00ecm th\u1ea5y. Ta s\u1ebd d\u00f9ng \u0111\u1ed9 d\u00e0i c\u1ee7a kh\u00f4ng gian t\u00ecm ki\u1ebfm l\u00e0m gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1 trong tr\u01b0\u1eddng h\u1ee3p kh\u00f4ng t\u00ecm th\u1ea5y (ta s\u1ebd gi\u1ea3i th\u00edch v\u1ee5 n\u00e0y sau).</p> <p>C\u00e0i \u0111\u1eb7t c\u1ee7a thu\u1eadt to\u00e1n th\u00ec s\u1ebd tr\u00f4ng nh\u01b0 sau:</p> <pre><code>int find_position(const vector&lt;int&gt;&amp; a, int x) {\n    int l = 0;\n    int r = (int)a.size() - 1;   // [l, r] l\u00e0 kh\u00f4ng gian t\u00ecm ki\u1ebfm\n    while (l &lt;= r) {             // khi kh\u00f4ng gian t\u00ecm ki\u1ebfm kh\u00f4ng r\u1ed7ng\n        int m = l + (r - l) / 2; // v\u1ecb tr\u00ed \"gi\u1eefa\" (middle) trong \u0111o\u1ea1n\n        if (a[m] == x) return m; // t\u00ecm ra r\u1ed3i\n        else if (a[m] &lt; x) {\n            l = m + 1;           // lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c ch\u1ec9 s\u1ed1 &lt;= m kh\u1ecfi kh\u00f4ng gian t\u00ecm ki\u1ebfm\n        } else {\n            r = m - 1;           // lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\u00e1c ch\u1ec9 s\u1ed1 &gt;= m kh\u1ecfi kh\u00f4ng gian t\u00ecm ki\u1ebfm\n        }\n    }\n    return n;                    // kh\u00f4ng t\u00ecm th\u1ea5y\n}\n</code></pre> <p>N\u00f3 c\u00f3 hi\u1ec7u qu\u1ea3 h\u01a1n t\u00ecm ki\u1ebfm tuy\u1ebfn t\u00ednh kh\u00f4ng? \u1ede m\u1ed7i b\u01b0\u1edbc, ta gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm \u0111i \u00edt nh\u1ea5t m\u1ed9t n\u1eeda, nh\u01b0 v\u1eady trong \\(1 + \\log_2 n\\) b\u01b0\u1edbc (\\(n\\) l\u00e0 k\u00edch th\u01b0\u1edbc m\u1ea3ng ban \u0111\u1ea7u) ta s\u1ebd thu h\u1eb9p kh\u00f4ng gian t\u00ecm ki\u1ebfm v\u1ec1 \u0111\u1ed9 d\u00e0i \\(&lt; 1\\), v\u00e0 v\u00ec k\u00edch th\u01b0\u1edbc l\u00e0 s\u1ed1 nguy\u00ean, n\u00f3 s\u1ebd tr\u1edf th\u00e0nh \\(0\\). Ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng bi\u1ebft l\u00fac n\u00e0o n\u00f3 d\u1eebng l\u1ea1i.</p>"},{"location":"misc/algorithms/binary-search/#tong-quat-hon-mot-ti","title":"T\u1ed5ng qu\u00e1t h\u01a1n m\u1ed9t t\u00ed","text":"<p>Ch\u1eafc ai c\u0169ng bi\u1ebft l\u00e0, t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n kh\u00f4ng ch\u1ec9 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng m\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n nh\u01b0 tr\u00ean trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u (v\u00e0 c\u1ea3 trong \u0111\u1eddi th\u1ef1c).</p> <p>Ta xem x\u00e9t k\u1ef9 h\u01a1n thu\u1eadt to\u00e1n \u1edf tr\u00ean nh\u00e1. Ta \u0111ang d\u00f9ng m\u1ed9t ki\u1ec3u th\u1ee9 t\u1ef1 g\u00ec \u0111\u00f3 (th\u1ee9 t\u1ef1 c\u00e1c s\u1ed1 nguy\u00ean nh\u01b0 trong v\u00ed d\u1ee5 tr\u00ean) \u0111\u1ec3 b\u1ecf \u0111i m\u1ed9t ph\u1ea7n l\u1edbn kh\u00f4ng gian t\u00ecm ki\u1ebfm (\u1edf \u0111\u00e2y l\u00e0 m\u1ed9t n\u1eeda kh\u00f4ng gian t\u00ecm ki\u1ebfm m\u1ed7i l\u1ea7n ki\u1ec3m tra).</p> <p>T\u1ed5ng qu\u00e1t h\u00f3a c\u00e1i n\u00e0y sao ta? Quan tr\u1ecdng h\u01a1n l\u00e0, \u0111\u1ec1 b\u00e0i ki\u1ec3u t\u1ed5ng qu\u00e1t s\u1ebd tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0o?</p> <p>\u0110\u1ea7u ti\u00ean, ta s\u1ebd ch\u1ec9nh b\u00e0i to\u00e1n ban \u0111\u1ea7u m\u1ed9t ch\u00fat \u0111\u1ec3 d\u1ec5 t\u1ed5ng qu\u00e1t h\u00f3a h\u01a1n. Thay v\u00ec t\u00ecm xem ph\u1ea7n t\u1eed n\u00e0o \u0111\u00f3 c\u00f3 t\u1ed3n t\u1ea1i trong m\u1ea3ng hay kh\u00f4ng, ta c\u00f3 th\u1ec3 t\u00ecm ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng m\u1ed9t gi\u00e1 tr\u1ecb cho tr\u01b0\u1edbc n\u00e0o \u0111\u00f3 (n\u1ebfu kh\u00f4ng c\u00f3 ph\u1ea7n t\u1eed nh\u01b0 v\u1eady th\u00ec tr\u1ea3 v\u1ec1 \u0111\u1ed9 d\u00e0i m\u1ea3ng).</p> <p>B\u00e0i n\u00e0y r\u00f5 r\u00e0ng t\u1ed5ng qu\u00e1t h\u01a1n b\u00e0i tr\u01b0\u1edbc. N\u1ebfu \u0111\u00e1p \u00e1n c\u1ee7a ta l\u00e0 \u1edf v\u1ecb tr\u00ed \\(i\\), ta c\u00f3 th\u1ec3 ki\u1ec3m tra xem n\u00f3 c\u00f3 \u0111\u00f9ng kh\u00f4ng b\u1eb1ng c\u00e1ch ki\u1ec3m tra \\(i &lt; n\\) v\u00e0 \\(a[i] = x\\) hay kh\u00f4ng. N\u1ebfu kh\u00f4ng th\u00ec ta kh\u00f4ng t\u00ecm th\u1ea5y ph\u1ea7n t\u1eed \\(x\\) trong m\u1ea3ng.</p> <p>Th\u1eed b\u1ecf ph\u1ea7n th\u1ee9 t\u1ef1 \u0111i nh\u00e9, xem ta c\u00f3 th\u1ec3 \u0111i \u0111\u01b0\u1ee3c bao xa.</p> <p>Ta s\u1ebd t\u01b0\u1edfng t\u01b0\u1ee3ng vi\u1ec7c t\u1ea1o ra m\u1ed9t m\u1ea3ng \\(b\\), v\u1edbi gi\u00e1 tr\u1ecb \\(b[i]\\) l\u00e0 <code>true</code> khi v\u00e0 ch\u1ec9 khi \\(a[i] &lt; x\\).</p> <p>\\(b\\) s\u1ebd tr\u00f4ng nh\u01b0 th\u1ebf n\u00e0o? M\u1ed9t s\u1ed1 (ho\u1eb7c kh\u00f4ng c\u00f3) c\u00e1c ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean s\u1ebd l\u00e0 <code>true</code>, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i s\u1ebd l\u00e0 <code>false</code>.</p> <p>Nh\u01b0 v\u1eady b\u00e0i to\u00e1n s\u1ebd c\u00f2n l\u1ea1i vi\u1ec7c t\u00ecm ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean m\u00e0 t\u1ea1i \u0111\u00f3 \\(b[i]\\) l\u00e0 <code>false</code> (ho\u1eb7c \\(n\\) n\u1ebfu kh\u00f4ng c\u00f3). Gi\u1edd ta c\u00f3 th\u1ec3 qu\u00ean \u0111i \\(a\\) v\u00e0 \\(x\\), ch\u1ec9 c\u1ea7n t\u1eadp trung v\u00e0o m\u1ea3ng \\(b\\) th\u00f4i.</p> <p>Ta th\u1ea5y r\u1eb1ng, v\u1edbi b\u1ea5t k\u1ef3 m\u1ea3ng \\(b\\) n\u00e0o, ta c\u0169ng c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c gi\u00e1 tr\u1ecb <code>false</code> \u0111\u1ea7u ti\u00ean v\u1edbi c\u00f9ng \u00fd t\u01b0\u1edfng gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm \u0111i m\u1ed9t n\u1eeda.</p> <p>X\u00e0i t\u00ed k\u00ed hi\u1ec7u nh\u00e1. G\u1ecdi \\([l_0, r_0]\\) l\u00e0 \u0111o\u1ea1n m\u00e0 ta c\u1ea7n t\u00ecm ki\u1ebfm (trong b\u00e0i to\u00e1n c\u1ee7a ta s\u1ebd l\u00e0 \\([0, n-1]\\)). \\(l\\), \\(r\\) s\u1ebd l\u00e0 c\u00e1c ch\u1ec9 s\u1ed1 ta duy tr\u00ec \u1edf m\u1ed7i b\u01b0\u1edbc m\u00e0 \u0111o\u1ea1n \\([l_0, l]\\) trong \\(b\\) s\u1ebd ch\u1ec9 bao g\u1ed3m c\u00e1c gi\u00e1 tr\u1ecb <code>true</code>, v\u00e0 \u0111o\u1ea1n \\([r, r_0]\\) trong \\(b\\) s\u1ebd ch\u1ec9 bao g\u1ed3m c\u00e1c gi\u00e1 tr\u1ecb <code>false</code>.</p> <p>Ban \u0111\u1ea7u ta kh\u00f4ng c\u00f3 th\u00f4ng tin g\u00ec v\u1ec1 c\u00e1c ph\u1ea7n t\u1eed trong m\u1ea3ng \\(b\\), n\u00ean c\u00e1c \u0111o\u1ea1n tr\u00ean c\u1ea7n ph\u1ea3i l\u00e0 c\u00e1c \u0111o\u1ea1n r\u1ed7ng. Ta s\u1ebd \u0111\u1eb7t \\(l = l_0 - 1\\) v\u00e0 \\(r = r_0 + 1\\) (\u0111o\u1ea1n \\([l_0, l]\\) v\u00e0 \\([r, r_0]\\) l\u00fac n\u00e0y \u0111\u1ec1u r\u1ed7ng). Ta s\u1ebd t\u0103ng \\(l\\) v\u00e0 gi\u1ea3m \\(r\\) sao cho hai \u0111o\u1ea1n n\u00e0y che ph\u1ee7 to\u00e0n b\u1ed9 kh\u00f4ng gian t\u00ecm ki\u1ebfm. V\u1eady cu\u1ed1i c\u00f9ng th\u00ec \\(l\\) s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 cu\u1ed1i c\u00f9ng m\u00e0 t\u1ea1i \u0111\u00f3 \\(b[l]\\) l\u00e0 <code>true</code>, v\u00e0 \\(r\\) s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean m\u00e0 t\u1ea1i \u0111\u00f3 \\(b[r]\\) l\u00e0 <code>false</code>, ta ch\u1ec9 c\u1ea7n tr\u1ea3 v\u1ec1 \\(r\\) l\u00e0 xong.</p> <p>Gi\u1ea3 s\u1eed t\u1ea1i m\u1ed9t b\u01b0\u1edbc n\u00e0o \u0111\u00f3, \\(r - l &gt; 1\\), ngh\u0129a l\u00e0 c\u00f3 \u00edt nh\u1ea5t m\u1ed9t ph\u1ea7n t\u1eed n\u1eb1m gi\u1eefa hai ch\u1ec9 s\u1ed1 n\u00e0y m\u00e0 ta ch\u01b0a \u0111\u1eb7t v\u00e0o m\u1ed9t trong hai \u0111o\u1ea1n. Ta s\u1ebd l\u1ea5y ph\u1ea7n t\u1eed gi\u1eefa c\u1ee7a \u0111o\u1ea1n \\((l, r)\\), l\u00e0 \\(m = \\lfloor (l+r) / 2 \\rfloor\\).</p> <ul> <li>N\u1ebfu \\(b[m]\\) l\u00e0 <code>true</code>, ta s\u1ebd bi\u1ebft r\u1eb1ng t\u1ea5t c\u1ea3 ph\u1ea7n t\u1eed n\u1eb1m b\u00ean tr\u00e1i \\(b[m]\\) c\u0169ng l\u00e0 <code>true</code>, n\u00ean ta c\u00f3 th\u1ec3 t\u0103ng \u0111o\u1ea1n \\([l_0, l]\\) l\u00ean th\u00e0nh \\([l_0, m]\\) (t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c \u0111\u1eb7t \\(l = m\\)).</li> <li>N\u1ebfu \\(b[m]\\) l\u00e0 <code>false</code>, ta s\u1ebd bi\u1ebft r\u1eb1ng t\u1ea5t c\u1ea3 ph\u1ea7n t\u1eed n\u1eb1m b\u00ean ph\u1ea3i \\(b[m]\\) c\u0169ng l\u00e0 <code>false</code>, n\u00ean ta c\u00f3 th\u1ec3 t\u0103ng \u0111o\u1ea1n \\([r, r_0]\\) l\u00ean th\u00e0nh \\([m, r_0]\\) (t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c \u0111\u1eb7t \\(r = m\\)).</li> </ul> <p>M\u1ed7i b\u01b0\u1edbc ta s\u1ebd gi\u1ea3m \u0111o\u1ea1n ch\u01b0a bi\u1ebft t\u1eeb \\(r - l - 1\\) xu\u1ed1ng \\(r - m - 1\\) ho\u1eb7c \\(m - l - 1\\), t\u1ee9c l\u00e0 gi\u1ea3m \u00edt nh\u1ea5t m\u1ed9t n\u1eeda. V\u1eady s\u1ed1 b\u01b0\u1edbc s\u1ebd l\u00e0 \\(\\log_2 (r_0 - l_0 + 1) + 1\\).</p> <p>C\u00e0i \u0111\u1eb7t th\u00ec s\u1ebd nh\u01b0 sau:</p> <pre><code>int find_first_false(const vector&lt;bool&gt;&amp; b) {\n    int l = -1;\n    int r = (int)b.size();\n    while (r - l &gt; 1) {\n        int m = l + (r - l) / 2;\n        if (b[m]) {\n            l = m;\n        } else {\n            r = m;\n        }\n    }\n    return r;\n}\n</code></pre> <p>Nh\u01b0ng ta \u0111\u00e3 n\u00f3i l\u00e0 kh\u00f4ng th\u1ef1c s\u1ef1 c\u1ea7n t\u1ea1o m\u1ea3ng \\(b\\) \u0111\u00fang kh\u00f4ng? V\u1eady d\u00f9ng n\u00f3 \u0111\u1ec3 gi\u1ea3i quy\u1ebft b\u00e0i to\u00e1n ban \u0111\u1ea7u nh\u01b0 th\u1ebf n\u00e0o?</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng \\(b[i]\\) ch\u1ec9 l\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a bi\u1ec3u th\u1ee9c \\(a[i] &lt; x\\), n\u00ean ta c\u00f3 th\u1ec3 t\u00ednh n\u1ebfu c\u1ea7n. Ta c\u00f3 th\u1ec3 thay \\(b[m]\\) b\u1eb1ng \\(a[m] &lt; x\\) trong c\u00e0i \u0111\u1eb7t tr\u00ean v\u00e0 m\u1ecdi th\u1ee9 s\u1ebd \u0111\u01b0\u1ee3c gi\u1ea3i quy\u1ebft.</p> <p>Kh\u00e1 ti\u1ec7n ph\u1ea3i kh\u00f4ng, gi\u1edd ta c\u00f3 th\u1ec3 t\u00f3m l\u1ea1i \u00fd m\u00e0 ta \u0111\u00e3 ph\u00e1t bi\u1ec3u \u1edf tr\u00ean:</p> <ul> <li>Thay v\u00ec d\u00f9ng th\u1ee9 t\u1ef1 \\(&lt;\\) v\u00e0 gi\u00e1 tr\u1ecb \\(x\\), ta t\u1ea1o ra m\u1ed9t m\u1ea3ng \\(b\\) theo m\u1ed9t d\u1ea1ng c\u1ee5 th\u1ec3 n\u00e0o \u0111\u00f3 (ti\u1ec1n t\u1ed1 c\u1ee7a m\u1ea3ng \\(b\\) l\u00e0 <code>true</code>, h\u1eadu t\u1ed1 l\u00e0 <code>false</code>), r\u1ed3i t\u00ecm ch\u1ec9 s\u1ed1 \u0111\u1ea7u ti\u00ean m\u00e0 t\u1ea1i \u0111\u00f3 \\(b[i]\\) l\u00e0 <code>false</code>.</li> </ul> <p>\u0110i\u1ec1u n\u00e0y d\u1eabn \u0111\u1ebfn b\u00e0i to\u00e1n t\u1ed5ng qu\u00e1t nh\u01b0 sau.</p>"},{"location":"misc/algorithms/binary-search/#bai-toan-tim-kiem-nhi-phan-tong-quat","title":"B\u00e0i to\u00e1n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n t\u1ed5ng qu\u00e1t","text":"<p>Ta c\u00f3:</p> <ul> <li>\\([l, r]\\): m\u1ed9t \u0111o\u1ea1n ch\u1ec9 s\u1ed1 (trong v\u00ed d\u1ee5 tr\u00ean l\u00e0 \\([0, n-1]\\)).</li> <li>\\(f\\): h\u00e0m \u00e1nh x\u1ea1 s\u1ed1 nguy\u00ean sang gi\u00e1 tr\u1ecb \u0111\u00fang sai, th\u1ecfa m\u00e3n t\u00ednh ch\u1ea5t sau: t\u1ed3n t\u1ea1i s\u00f4 \\(t\\) sao cho v\u1edbi m\u1ecdi \\(l \\leq x &lt; t\\), \\(f(x)\\) l\u00e0 <code>true</code>, v\u00e0 v\u1edbi m\u1ecdi \\(t \\leq i \\leq r\\), \\(f(i)\\) l\u00e0 <code>false</code>.</li> </ul> <p>N\u1ebfu c\u1eadn tr\u00ean c\u1ee7a th\u1eddi gian t\u00ednh \\(f\\) l\u00e0 \\(T(l,r)\\), ta c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c ch\u1ec9 s\u1ed1 \\(t\\) (ch\u1ec9 s\u1ed1 c\u1ee7a gi\u00e1 tr\u1ecb <code>false</code> \u0111\u1ea7u ti\u00ean) trong th\u1eddi gian \\(O(T(l,r) \\log_2 (r - l + 1)) + O(1)\\).</p> <p>H\u00e0m \\(f\\) nh\u01b0 v\u1eady g\u1ecdi l\u00e0 m\u1ed9t predicate (ti\u00ean \u0111\u1ec1). Trong v\u00ed d\u1ee5 ban \u0111\u1ea7u, \\(f\\) \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 predicate lu\u00f4n.</p> <p>C\u00e0i \u0111\u1eb7t n\u00f3 s\u1ebd nh\u01b0 sau (b\u1ecf qua tr\u00e0n s\u1ed1 nh\u00e9):</p> <pre><code>template &lt;class Integer, class F&gt;\nInteger find_first_false(Integer l, Integer r, F&amp;&amp; f) {\n    --l;\n    ++r;\n    while (r - l &gt; 1) {\n        Integer m = l + (r - l) / 2; // n\u00ean \u01b0u ti\u00ean d\u00f9ng std::midpoint trong C++20\n        if (f(m)) {\n            l = m;\n        } else {\n            r = m;\n        }\n    }\n    return r;\n}\n</code></pre> <p>\u0110\u1ec3 \u00fd r\u1eb1ng c\u00e0i \u0111\u1eb7t n\u00e0y c\u00f3 t\u00ednh ch\u1ea5t kh\u00e1 hay r\u1eb1ng \\(l\\) s\u1ebd l\u00e0 ch\u1ec9 s\u1ed1 cu\u1ed1i c\u00f9ng m\u00e0 t\u1ea1i \u0111\u00f3 \\(f(l)\\) l\u00e0 <code>true</code>, n\u00ean ta c\u00f3 th\u1ec3 t\u1ea1o m\u1ed9t h\u00e0m kh\u00e1c t\u01b0\u01a1ng t\u1ef1 \u0111\u1ec3 tr\u1ea3 v\u1ec1 \\(l\\) n\u1ebfu c\u1ea7n.</p> <p>\u0110\u1ec3 d\u00f9ng h\u00e0m n\u00e0y cho vi\u1ec7c c\u00e0i t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n, ta l\u00e0m nh\u01b0 sau:</p> <pre><code>int find_position(const vector&lt;int&gt;&amp; a, int x) {\n    auto f = [&amp;](int i) {\n        return a[i] &lt; x;\n    };\n    int n = (int)a.size();\n    int pos = find_first_false(0, n - 1, f);\n    if (pos == n || a[pos] != x) return n;\n    return pos;\n}\n</code></pre> <p>Ta c\u0169ng c\u00f3 m\u1ed9t k\u1ebft lu\u1eadn kh\u00e1 hay \u1edf \u0111\u00e2y: ta kh\u00f4ng th\u1ef1c s\u1ef1 c\u1ea7n \\(a\\) ph\u1ea3i \u0111\u01b0\u1ee3c s\u1eafp x\u1ebfp. Th\u1ee9 duy nh\u1ea5t ta c\u1ea7n l\u00e0 m\u1ecdi th\u1eed nh\u1ecf h\u01a1n \\(x\\) th\u00ec ph\u1ea3i n\u1eb1m \u1edf ti\u1ec1n t\u1ed1 m\u1ea3ng, v\u00e0 ph\u1ea7n c\u00f2n l\u1ea1i ph\u1ea3i n\u1eb1m \u1edf h\u1eadu t\u1ed1 m\u1ea3ng, v\u00e0 n\u1ebfu \\(x\\) n\u1eb1m trong m\u1ea3ng, ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a h\u1eadu t\u1ed1 \u0111\u00f3 ph\u1ea3i l\u00e0 \\(x\\). \u0110\u1ecbnh ngh\u0129a n\u00e0y c\u0169ng gi\u1ea3i quy\u1ebft \u0111\u01b0\u1ee3c tr\u01b0\u1eddng h\u1ee3p c\u00f3 nhi\u1ec1u ph\u1ea7n t\u1eed b\u1eb1ng \\(x\\) trong m\u1ea3ng. \u0110i\u1ec1u n\u00e0y s\u1ebd gi\u00fap ta gi\u1ea3i quy\u1ebft \u0111\u01b0\u1ee3c nhi\u1ec1u d\u1ea1ng b\u00e0i to\u00e1n h\u01a1n.</p> <p>B\u00e0i t\u1eadp: B\u1ea1n s\u1ebd l\u00e0m g\u00ec n\u1ebfu trong \\(b\\), m\u1ed9t s\u1ed1 ph\u1ea7n t\u1eed \u0111\u1ea7u l\u00e0 <code>false</code>, c\u00f2n l\u1ea1i l\u00e0 c\u00e1c ph\u1ea7n t\u1eed <code>true</code>?</p>"},{"location":"misc/algorithms/binary-search/#tim-kiem-nhi-phan-ap-an","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u00e1p \u00e1n","text":"<p>\u0110\u00f4i khi s\u1ebd d\u1ec5 d\u00e0ng h\u01a1n n\u1ebfu ta x\u1eed l\u00fd c\u1eadn tr\u00ean d\u01b0\u1edbi c\u1ee7a \u0111\u00e1p \u00e1n h\u01a1n l\u00e0 ch\u00ednh c\u00e1i \u0111\u00e1p \u00e1n \u0111\u00f3.</p> <p>T\u1ee9c l\u00e0, \u0111\u00f4i khi n\u00f3 s\u1ebd d\u1ec5 h\u01a1n n\u1ebfu ta c\u00f3 m\u1ed9t h\u00e0m \\(f\\) tr\u1ea3 v\u1ec1 <code>true</code> khi v\u00e0 ch\u1ec9 khi input \\(\\leq\\) \u0111\u00e1p \u00e1n c\u1ea7n t\u00ecm, b\u1eb1ng c\u00e1ch ch\u1ea1y m\u1ed9t thu\u1eadt to\u00e1n n\u00e0o \u0111\u00f3 tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb \u0111\u00fang sai b\u1eb1ng c\u00e1ch x\u00e9t m\u1ed9t s\u1ed1 t\u00ednh ch\u1ea5t c\u1ee7a b\u00e0i to\u00e1n v\u00e0 input.</p> <p>V\u00ed d\u1ee5, x\u00e9t b\u00e0i to\u00e1n sau.</p> <p>Ta s\u1ebd c\u00f3 m\u1ed9t b\u1ea3ng nh\u00e2n v\u1edbi k\u00edch th\u01b0\u1edbc \\(n \\times m\\), ta c\u1ea7n t\u00ecm s\u1ed1 nh\u1ecf th\u1ee9 \\(k\\) trong b\u1ea3ng n\u00e0y (v\u00ed d\u1ee5 n\u1ebfu s\u1eafp x\u1ebfp t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 trong b\u1ea3ng theo th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n, ta c\u1ea7n t\u00ecm s\u1ed1 \u1edf v\u1ecb tr\u00ed \\(k\\)).</p> <p>Kh\u00f4ng d\u1ec5 \u0111\u1ec3 t\u00ecm tr\u1ef1c ti\u1ebfp s\u1ed1 n\u00e0y. Nh\u01b0ng n\u1ebfu ta \"\u0111o\u00e1n\" \\(x\\), ta s\u1ebd xem th\u1eed n\u00f3 c\u00f3 g\u1ea7n v\u1edbi \u0111\u00e1p \u00e1n hay kh\u00f4ng:</p> <p>Ta s\u1ebd t\u00ecm s\u1ed1 s\u1ed1 nguy\u00ean nh\u1ecf h\u01a1n \\(x\\) tr\u00ean m\u1ed7i h\u00e0ng, r\u1ed3i c\u1ed9ng l\u1ea1i. Ta c\u00f3 th\u1ec3 d\u00f9ng ph\u00e9p chia \u0111\u01a1n gi\u1ea3n tr\u00ean t\u1eebng h\u00e0ng.</p> <p>N\u1ebfu t\u1ed5ng s\u1ed1 c\u00e1c s\u1ed1 nh\u1ecf h\u01a1n \\(x\\) nh\u1ecf h\u01a1n \\(k\\), ta s\u1ebd tr\u1ea3 v\u1ec1 <code>true</code>, ng\u01b0\u1ee3c l\u1ea1i tr\u1ea3 v\u1ec1 <code>false</code>. H\u00e0m predicate n\u00e0y hi\u1ec7u qu\u1ea3 v\u00ec s\u1ed1 c\u00e1c s\u1ed1 nh\u1ecf h\u01a1n \\(x\\) l\u00e0 h\u00e0m kh\u00f4ng gi\u1ea3m tr\u00ean \\(x\\) (ngh\u0129a l\u00e0, n\u1ebfu ta so s\u00e1nh $f(x) v\u00e0 \\(f(x+1)\\), v\u00e0 gi\u1ea3 s\u1eed \\(f(x)\\) tr\u1ea3 v\u1ec1 <code>false</code>, th\u00ec \\(f(x+1)\\) ch\u1eafc ch\u1eafn c\u0169ng tr\u1ea3 v\u1ec1 <code>false</code>). Nh\u01b0 v\u1eady gi\u00e1 tr\u1ecb cu\u1ed1i c\u00f9ng l\u00e0m cho h\u00e0m tr\u1ea3 v\u1ec1 <code>true</code> s\u1ebd l\u00e0 \u0111\u00e1p \u00e1n c\u1ea7n t\u00ecm.</p> <p>Ta d\u00f9ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u1ec3 t\u00ecm ra \u0111\u00e1p \u00e1n nh\u01b0 \u0111\u00e3 tr\u00ecnh b\u00e0y \u1edf tr\u00ean.</p>"},{"location":"misc/algorithms/binary-search/#hai-cach-pho-bien-khac-e-cai-at-tim-kiem-nhi-phan","title":"Hai c\u00e1ch ph\u1ed5 bi\u1ebfn kh\u00e1c \u0111\u1ec3 c\u00e0i \u0111\u1eb7t t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n","text":"<p>Ta s\u1ebd t\u00ecm hi\u1ec3u 2 c\u00e1ch kh\u00e1c m\u00e0 ng\u01b0\u1eddi ta th\u01b0\u1eddng d\u00f9ng \u0111\u1ec3 c\u00e0i \u0111\u1eb7t t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n v\u00e0 sao ch\u00fang l\u1ea1i d\u1ec5 hi\u1ec3u v\u1edbi h\u1ecd.</p> <p>Ta s\u1ebd g\u1ecdi c\u00e1ch m\u00e0 ta d\u00f9ng l\u00e0 c\u00e1ch \\((l, r)\\), v\u00ec n\u00f3 t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c duy tr\u00ec kh\u00f4ng gian t\u00ecm ki\u1ebfm l\u00e0 \u0111o\u1ea1n \\((l, r)\\) (kh\u00f4ng bao g\u1ed3m \\(l\\) v\u00e0 \\(r\\)).</p> <p>Ph\u1ea7n n\u00e0y s\u1ebd gi\u00fap ng\u01b0\u1eddi \u0111\u1ecdc hi\u1ec3u h\u01a1n c\u00e1ch c\u00e0i \u0111\u1eb7t t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n c\u1ee7a ng\u01b0\u1eddi kh\u00e1c v\u00e0 t\u00ecm ra c\u00e1ch c\u00e0i \u0111\u1eb7t ph\u00f9 h\u1ee3p v\u1edbi m\u00ecnh h\u01a1n. C\u00e1 nh\u00e2n t\u00f4i (ng\u01b0\u1eddi vi\u1ebft b\u00e0i) th\u00edch c\u00e1ch \u1edf tr\u00ean h\u01a1n, n\u00ean s\u1ebd gi\u1ea3i th\u00edch c\u00e1c c\u00e1ch sau d\u1ef1a tr\u00ean c\u00e1ch \u0111\u00f3, v\u1edbi m\u1ed9t s\u1ed1 l\u00fd do v\u00ec sao ng\u01b0\u1eddi ta th\u00edch c\u00e1c c\u00e1ch n\u00e0y.</p>"},{"location":"misc/algorithms/binary-search/#cach-l-r","title":"C\u00e1ch \\([l, r]\\)","text":"<p>Trong c\u00e1ch c\u00e0i \u0111\u1eb7t n\u00e0y, ta s\u1ebd duy tr\u00ec \\(l+1\\) v\u00e0 \\(r-1\\) thay v\u00ec \\(l\\) v\u00e0 \\(r\\). L\u00fd do l\u00e0 v\u00ec:</p> <p>\\([l, r]\\) t\u01b0\u01a1ng \u1ee9ng v\u1edbi kh\u00f4ng gian t\u00ecm ki\u1ebfm hi\u1ec7n t\u1ea1i. Ta s\u1ebd duy tr\u00ec th\u00eam m\u1ed9t gi\u00e1 tr\u1ecb \\(ans\\) n\u1eefa, n\u00f3 s\u1ebd ch\u1ee9a \u0111\u00e1p \u00e1n t\u1ed1t nh\u1ea5t hi\u1ec7n t\u1ea1i, ngh\u0129a l\u00e0 ch\u1ec9 s\u1ed1 <code>false</code> b\u00ean tr\u00e1i nh\u1ea5t hi\u1ec7n t\u1ea1i.</p> <p>\u0110o\u1ea1n n\u00e0y kh\u00f4ng r\u1ed7ng khi \\(r \\geq l\\). \u0110i\u1ec3m gi\u1eefa th\u00ec c\u0169ng y nh\u01b0 v\u1eady, \\(m = \\lfloor (l + r) / 2 \\rfloor\\). N\u1ebfu \\(f(m)\\) l\u00e0 <code>false</code>, \u0111\u00e1p \u00e1n t\u1ed1t nh\u1ea5t hi\u1ec7n t\u1ea1i s\u1ebd l\u00e0 \\(m\\), v\u00e0 ta s\u1ebd gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm xu\u1ed1ng th\u00e0nh \\([l, m-1]\\). Ng\u01b0\u1ee3c l\u1ea1i, ta s\u1ebd gi\u1ea3m kh\u00f4ng gian t\u00ecm ki\u1ebfm th\u00e0nh \\([m+1, r]\\) v\u00e0 kh\u00f4ng c\u1eadp nh\u1eadt \u0111\u00e1p \u00e1n.</p> <p>\u0110\u1ec3 \u00fd r\u1eb1ng ta s\u1ebd ph\u1ea3i duy tr\u00ec bi\u1ebfn \\(ans\\) v\u00e0 kh\u1edfi t\u1ea1o n\u00f3 m\u1ed9t c\u00e1ch h\u1ee3p l\u00fd, t\u00f9y v\u00e0o vi\u1ec7c ta mu\u1ed1n th\u1eb1ng <code>false</code> tr\u00e1i nh\u1ea5t (l\u00e0m nh\u01b0 tr\u00ean) hay th\u1eb1ng <code>true</code> ph\u1ea3i nh\u1ea5t (chuy\u1ec3n c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb sang khi \\(f(m)\\) l\u00e0 <code>true</code>), \u0111\u00f3 c\u0169ng l\u00e0 l\u00fd do m\u00e0 t\u00f4i kh\u00f4ng d\u00f9ng c\u00e1ch n\u00e0y l\u00e2u r\u1ed3i. Tuy nhi\u00ean, ng\u01b0\u1eddi ta c\u00f3 v\u1ebb th\u00edch c\u00e1c d\u00e3y \u0111\u00f3ng n\u00ean c\u00e1ch n\u00e0y c\u0169ng kh\u00e1 ph\u1ed5 bi\u1ebfn.</p> <p>M\u1ed9t bi\u1ebfn th\u1ec3 l\u00e0 khi ta c\u00f3 \\(l'\\) v\u00e0 \\(r'\\) gi\u1ed1ng v\u1edbi \\(l\\) v\u00e0 \\(r\\) trong c\u00e1ch \\((l, r)\\), v\u00e0 \\(l\\), \\(r\\) gi\u1ed1ng \\(l\\) v\u00e0 \\(r\\) trong c\u00e1ch n\u00e0y, khi \u0111\u00f3 \\(l' = l-1\\) v\u00e0 \\(ans = r' = r+1\\). N\u1ebfu mu\u1ed1n t\u00ecm th\u1eb1ng <code>true</code> ph\u1ea3i nh\u1ea5t, ta s\u1ebd c\u00f3 \\(r' = r+1\\) v\u00e0 \\(ans = l' = l-1\\).</p> <p>C\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>template &lt;class Integer, class F&gt;\nInteger find_first_false(Integer l, Integer r, F&amp;&amp; f) {\n    Integer ans = n;\n    while (l &lt;= r) {\n        Integer m = l + (r - l) / 2; // n\u00ean \u01b0u ti\u00ean d\u00f9ng std::midpoint trong C++20\n        if (f(m)) {\n            l = m + 1;\n        } else {\n            ans = m;\n            r = m - 1;\n        }\n    }\n    return ans;\n}\n</code></pre>"},{"location":"misc/algorithms/binary-search/#cach-l-r_1","title":"C\u00e1ch \\([l, r)\\)","text":"<p>Trong c\u00e1ch n\u00e0y, ta s\u1ebd duy tr\u00ec \\(l+1\\) v\u00e0 \\(r\\) thay v\u00ec \\(l\\) v\u00e0 \\(r\\). L\u00fd do l\u00e0 v\u00ec kh\u00f4ng gian t\u00ecm ki\u1ebfm l\u00fac n\u00e0y s\u1ebd l\u00e0 \\([l, r)\\), ngh\u0129a l\u00e0 bao g\u1ed3m \\(l\\) nh\u01b0ng kh\u00f4ng bao g\u1ed3m \\(r\\), nh\u1eefng ng\u01b0\u1eddi th\u00edch \u0111o\u1ea1n n\u1eeda m\u1edf s\u1ebd th\u00edch c\u00e1ch n\u00e0y. Khi kh\u00f4ng gian t\u00ecm ki\u1ebfm r\u1ed7ng, ta s\u1ebd c\u00f3 \u0111o\u1ea1n \\([ans, ans)\\) (n\u1ebfu mu\u1ed1n t\u00ecm th\u1eb1ng <code>false</code> tr\u00e1i nh\u1ea5t). C\u1ea5u tr\u00fac c\u1ee7a \u0111o\u1ea1n kh\u00f4ng khi n\u00e0o c\u0169ng \u1ee9ng v\u1edbi c\u00e1c c\u00e1ch kh\u00e1c, v\u00ec gi\u00e1 tr\u1ecb \\(m\\) s\u1ebd th\u01b0\u1eddng h\u01a1i kh\u00e1c m\u1ed9t ch\u00fat (th\u01b0\u1eddng s\u1ebd l\u00e0 \\(\\lfloor (l + r) / 2 \\rfloor\\) v\u1edbi \\([l, r)\\) l\u00e0 kh\u00f4ng gian t\u00ecm ki\u1ebfm hi\u1ec7n t\u1ea1i, v\u00e0 trong tr\u01b0\u1eddng h\u1ee3p c\u00f3 2 gi\u00e1 tr\u1ecb gi\u1eefa, ta s\u1ebd ch\u1ecdn gi\u00e1 tr\u1ecb b\u00ean ph\u1ea3i, kh\u00f4ng ph\u1ea3i b\u00ean tr\u00e1i).</p> <p>Ta c\u00f3 th\u1ec3 hi\u1ec3u nh\u01b0 sau: Gi\u1ea3 s\u1eed ta c\u00f3 \u0111o\u1ea1n \\([l, r)\\), v\u00e0 ta c\u1ea7n ch\u00e8n m\u1ed9t c\u00e1i <code>false</code> sau th\u1eb1ng <code>true</code> cu\u1ed1i c\u00f9ng tr\u00ean \u0111o\u1ea1n \u0111\u00f3. <code>false</code> n\u00e0y s\u1ebd n\u1eb1m \u1edf \u0111\u00e2u?</p> <p>M\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 ngh\u0129 l\u00e0: m\u1ecdi th\u1ee9 trong \u0111o\u1ea1n \\([l, ans)\\) l\u00e0 <code>true</code>, m\u1ecdi th\u1ee9 trong \u0111o\u1ea1n \\([ans, r)\\) l\u00e0 <code>false</code>. N\u00ean \\(ans\\) s\u1ebd l\u00e0 m\u1ed9t ki\u1ec3u v\u00e1ch ng\u0103n tr\u00ean m\u1ea3ng. Ta s\u1ebd xem c\u00e1ch gi\u1ea3i th\u00edch n\u00e0y \u1ee9ng d\u1ee5ng nh\u01b0 th\u1ebf n\u00e0o trong c\u00e0i \u0111\u1eb7t trong th\u01b0 vi\u1ec7n STL c\u1ee7a C++ sau nh\u00e9.</p> <p>V\u1edbi \u0111i\u1ec3m gi\u1eefa c\u1ee7a \u0111o\u1ea1n \\([l, r)\\), n\u1ebfu \\(f(m)\\) l\u00e0 <code>true</code>, ta s\u1ebd kh\u00f4ng bao gi\u1edf \u0111\u1eb7t <code>false</code> v\u00e0o b\u1ea5t k\u1ef3 v\u1ecb tr\u00ed n\u00e0o \\(\\leq m\\), n\u00ean \\(l\\) s\u1ebd th\u00e0nh \\(m+1\\). Ng\u01b0\u1ee3c l\u1ea1i, ta s\u1ebd ph\u1ea3i \u0111\u1eb7t n\u00f3 v\u00e0o v\u1ecb tr\u00ed \\(\\leq m\\), n\u00ean \\(r\\) s\u1ebd th\u00e0nh \\(m\\).</p> <pre><code>template &lt;class Integer, class F&gt;\nInteger find_first_false(Integer l, Integer r, F&amp;&amp; f) {\n    ++r;\n    while (l &lt; r) {\n        Integer m = l + (r - l) / 2; // n\u00ean \u01b0u ti\u00ean d\u00f9ng std::midpoint trong C++20\n        if (f(m)) {\n            l = m + 1;\n        } else {\n            r = m;\n        }\n    }\n    return r;\n}\n</code></pre>"},{"location":"misc/algorithms/binary-search/#binary-lifting-cho-tim-kiem-nhi-phan","title":"Binary lifting cho t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n","text":"<p>Ta s\u1ebd \u0111i l\u01b0\u1edbt qua ph\u1ea7n n\u00e0y th\u00f4i, v\u00ec ta s\u1ebd ch\u1ec9 xem x\u00e9t t\u1ed5ng quan c\u1ee7a h\u00e0m thay v\u00ec gi\u1ea3i th\u00edch chi ti\u1ebft.</p> <p>X\u00e9t c\u00e0i \u0111\u1eb7t sau:</p> <pre><code>template &lt;class Integer, class F&gt;\nInteger find_first_false(Integer l, Integer r, F&amp;&amp; f) {\n    if (l &gt; r) return r + 1;\n    ++r;\n    Integer w = Integer(1) &lt;&lt; __lg(r - l);\n    --l;\n    if (f(l + w)) l = r - w;\n    for (w &gt;&gt;= 1; w &gt;= Integer(1); w &gt;&gt;= 1)\n        if (f(l + w)) l += w;\n    return l + 1;\n}\n</code></pre> <p>\u1ede \u0111\u00e2y ta c\u1ea7n \u0111\u1ea3m b\u1ea3o r\u1eb1ng \u0111\u1ed9 d\u00e0i c\u00e1c \u0111o\u1ea1n l\u00e0 l\u0169y th\u1eeba c\u1ee7a \\(2\\). L\u00fd do v\u00ec sao th\u00ec ta s\u1ebd gi\u1ea3i th\u00edch trong ph\u1ea7n t\u1ed1i \u01b0u t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n sau.</p> <p>Sau khi ch\u1eafc r\u1eb1ng \u0111\u1ed9 d\u00e0i \u0111o\u1ea1n l\u00e0 l\u0169y th\u1eeba c\u1ee7a \\(2\\), ta ch\u1ec9 c\u1ea7n t\u1ea1o bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n c\u1ee7a \\(ans - 1 - l\\), v\u1edbi \\(ans\\) l\u00e0 gi\u00e1 tr\u1ecb tr\u1ea3 v\u1ec1. Ta c\u00f3 th\u1ec3 \u0111i t\u1eeb bit l\u1edbn nh\u1ea5t \u0111\u1ebfn bit nh\u1ecf nh\u1ea5t, v\u00e0 tham lam \u1edf \u0111\u00e2y v\u1edbi l\u00fd do l\u00e0 bi\u1ec3u di\u1ec5n nh\u1ecb ph\u00e2n l\u00e0 duy nh\u1ea5t; v\u00e0 d\u1ea7n d\u1ea7n th\u00eam c\u00e1c l\u0169y th\u1eeba c\u1ee7a \\(2\\) v\u00e0o khi h\u00e0m \\(f\\) v\u1eabn c\u00f2n tr\u1ea3 v\u1ec1 <code>true</code>.</p>"},{"location":"misc/algorithms/binary-search/#tim-kiem-nhi-phan-theo-ngon-ngu-lap-trinh","title":"T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n theo ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh","text":"<p>C\u00e1c ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh ph\u1ed5 bi\u1ebfn trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u \u0111\u1ec1u c\u00f3 c\u00e1c h\u00e0m th\u01b0 vi\u1ec7n \u0111\u1ec3 h\u1ed7 tr\u1ee3 b\u1ea1n t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</p>"},{"location":"misc/algorithms/binary-search/#c","title":"C++","text":"<ul> <li><code>binary_search</code>: H\u00e0m n\u00e0y tr\u1ea3 v\u1ec1 m\u1ed9t gi\u00e1 tr\u1ecb \u0111\u00fang sai, cho bi\u1ebft ph\u1ea7n t\u1eed c\u00f3 t\u1ed3n t\u1ea1i gi\u1eefa 2 iterator hay kh\u00f4ng (v\u1edbi m\u1ed9t h\u00e0m so s\u00e1nh t\u00f9y ch\u1ecdn).</li> <li><code>lower_bound</code>, <code>upper_bound</code>: N\u1ebfu \u0111o\u1ea1n c\u00f3 ph\u1ea7n t\u1eed \\(x\\) c\u1ea7n t\u00ecm \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a b\u1edfi c\u1eb7p iterator \\([it_l, it_r)\\) n\u1eb1m trong \u0111o\u1ea1n ban \u0111\u1ea7u \\([\\text{input_it}_l, \\text{input_it}_r)\\), th\u00ec <code>lower_bound</code> v\u00e0 <code>upper_bound</code> l\u1ea7n l\u01b0\u1ee3t tr\u1ea3 v\u1ec1  \\(it_l\\) v\u00e0 \\(it_r\\). N\u00f3i c\u00e1ch kh\u00e1c, <code>lower_bound(it1, it2, x, comp)</code> tr\u1ea3 v\u1ec1 iterator \u0111\u1ebfn ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean c\u1ee7a \u0111o\u1ea1n iterator \\([it1, it2)\\), \u0111o\u1ea1n n\u00e0y \\(\\geq x\\) theo h\u00e0m so s\u00e1nh <code>comp</code> (t\u00f9y ch\u1ecdn v\u00e0 m\u1eb7c \u0111\u1ecbnh l\u00e0 th\u1ee9 t\u1ef1 t\u0103ng d\u1ea7n), v\u00e0 <code>upper_bound</code> l\u00e0m y v\u1eady v\u1edbi ph\u1ea7n t\u1eed \\(&gt; x\\).</li> <li><code>equal_range</code>: Tr\u1ea3 v\u1ec1 c\u1ea3 <code>lower_bound</code> v\u00e0 <code>upper_bound</code> trong m\u1ed9t l\u1ea7n g\u1ecdi h\u00e0m.</li> <li><code>partition_point</code>: Gi\u1ed1ng y nh\u01b0 h\u00e0m t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n theo c\u00e1ch \\([l, r)\\) \u0111\u00e3 tr\u00ecnh b\u00e0y \u1edf tr\u00ean. Trong C++20, v\u1edbi <code>ranges::views::iota</code>, ta c\u00f3 th\u1ec3 d\u00f9ng n\u00f3 \u0111\u1ec3 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u00e1p \u00e1n.</li> </ul>"},{"location":"misc/algorithms/binary-search/#python","title":"Python","text":"<ul> <li>Module <code>bisect</code> c\u00f3 c\u00e1c h\u00e0m nh\u01b0 <code>bisect</code>, <code>bisect_left</code>, <code>bisect_right</code> c\u00f3 ch\u1ee9c n\u0103ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 <code>lower_bound</code> v\u00e0 <code>upper_bound</code>.</li> </ul>"},{"location":"misc/algorithms/binary-search/#java","title":"Java","text":"<ul> <li><code>Collections.binarySearch</code> v\u00e0 <code>Arrays.binarySearch</code> c\u00f3 ch\u1ee9c n\u0103ng t\u01b0\u01a1ng t\u1ef1 vi\u1ec7c t\u00ecm ki\u1ebfm m\u1ed9t ph\u1ea7n t\u1eed hay ch\u1ec9 s\u1ed1 (kh\u00f4ng nh\u1ea5t thi\u1ebft l\u00e0 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\u00ean hay cu\u1ed1i c\u00f9ng) v\u1edbi t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</li> </ul>"},{"location":"misc/algorithms/binary-search/#toi-uu-tim-kiem-nhi-phan","title":"T\u1ed1i \u01b0u t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n","text":"<p>Trong c\u00e0i \u0111\u1eb7t ban \u0111\u1ea7u, ta tr\u1ea3 v\u1ec1 ngay khi ta t\u00ecm th\u1ea5y ph\u1ea7n t\u1eed c\u1ea7n t\u00ecm. \u0110\u00f4i khi, s\u1ebd nhanh h\u01a1n khi ta d\u1eebng t\u00ecm ki\u1ebfm s\u1edbm, v\u00e0 trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p nh\u01b0 v\u1eady, n\u00f3 l\u00e0 t\u1ed1i \u01b0u theo constant factor.</p> <p>Binary lifting \u1edf tr\u00ean c\u0169ng l\u00e0 m\u1ed9t c\u00e1ch t\u1ed1i \u01b0u theo constant factor tr\u00ean m\u1ed9t s\u1ed1 ki\u1ebfn tr\u00fac n\u1ebfu \u0111\u01b0\u1ee3c tri\u1ec3n khai th\u1ee7 c\u00f4ng (kh\u1ea3 thi do t\u00ednh ch\u1ea5t \u0111\u01a1n gi\u1ea3n c\u1ee7a s\u1ed1 t\u0103ng v\u00e0 kh\u1ea3 n\u0103ng hardcoding c\u00e1c h\u1eb1ng s\u1ed1), theo cu\u1ed1n Programming Pearls c\u1ee7a John Bentley. \u0110\u00e2y l\u00e0 m\u1ed9t c\u1ea3i ti\u1ebfn trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p, khi c\u00e1c v\u1ecb tr\u00ed t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u00edt v\u00e0 l\u1eb7p l\u1ea1i trong c\u00e1c \u1ee9ng d\u1ee5ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n li\u00ean ti\u1ebfp, d\u1eabn \u0111\u1ebfn vi\u1ec7c s\u1eed d\u1ee5ng cache t\u1ed1t h\u01a1n. M\u1ed9t v\u00ed d\u1ee5 v\u1ec1 vi\u1ec7c th\u1ef1c hi\u1ec7n t\u1ed1i \u01b0u h\u00f3a \u0111\u1ebfn m\u1ee9c t\u1ed1i \u0111a l\u00e0 vi\u1ec7c tri\u1ec3n khai nhi\u1ec1u h\u00e0m (m\u1ed7i h\u00e0m c\u00f3 l\u0169y th\u1eeba c\u1ee7a \\(2\\) kh\u00e1c nhau), l\u01b0u c\u00e1c con tr\u1ecf h\u00e0m trong m\u1ed9t m\u1ea3ng v\u00e0 d\u00f9ng c\u00e1c l\u1ec7nh nh\u1ea3y (v\u00ed d\u1ee5, b\u1eb1ng c\u00e1ch t\u00ednh l\u0169y th\u1eeba \\(2\\) khi c\u1ea7n) \u0111\u1ec3 \u0111\u1ebfn \u0111\u00fang h\u00e0m khi ch\u1ea1y, gi\u00fap t\u0103ng t\u1ed1c tr\u00ean m\u1ed9t s\u1ed1 ki\u1ebfn tr\u00fac nh\u1ea5t \u0111\u1ecbnh.</p> <p>V\u00ed d\u1ee5, v\u1edbi m\u1ed9t s\u1ed1 lo\u1ea1i truy v\u1ea5n nh\u1ea5t \u0111\u1ecbnh (\\(l\\) ho\u1eb7c \\(r\\) \u00edt nhi\u1ec1u gi\u1ed1ng nhau), t\u1ed1c \u0111\u1ed9 t\u0103ng \u0111\u00e1ng k\u1ec3. Tuy nhi\u00ean, \u0111\u1ed1i v\u1edbi c\u00e1c lo\u1ea1i truy v\u1ea5n kh\u00e1c, phi\u00ean b\u1ea3n \u0111\u01a1n gi\u1ea3n h\u01a1n l\u1ea1i hi\u1ec7u qu\u1ea3 h\u01a1n. \u0110\u1ec3 th\u1ec3 hi\u1ec7n m\u1ee9c \u0111\u1ed9 t\u0103ng t\u1ed1c b\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c cho m\u1ed9t s\u1ed1 lo\u1ea1i truy v\u1ea5n nh\u1ea5t \u0111\u1ecbnh, t\u00f4i \u0111\u00e3 th\u1ef1c hi\u1ec7n m\u1ed9t s\u1ed1 benchmark tr\u00ean c\u00e1c truy v\u1ea5n m\u00e0 gi\u1edbi h\u1ea1n b\u00ean tr\u00e1i lu\u00f4n gi\u1ed1ng nhau. V\u1edbi code benchmark b\u00ean d\u01b0\u1edbi, k\u1ebft qu\u1ea3 nh\u01b0 sau:</p> Code benchmark <pre><code>#pragma GCC optimize(\"O3,unroll-loops\")\n#pragma GCC target(\"avx2,bmi,bmi2,popcnt,lzcnt\")\n#include \"bits/stdc++.h\"\n\nusing ll = int64_t;\nusing ld = long double;\n\nusing namespace std;\n\ntemplate &lt;typename C = std::chrono::steady_clock,\n        typename T1 = std::chrono::nanoseconds,\n        typename T2 = std::chrono::milliseconds&gt;\nstruct Stopwatch {\n    std::string name;\n    std::chrono::time_point&lt;C&gt; last_played;\n    T1 elapsed_time;\n    bool running;\n    Stopwatch(const std::string&amp; s) : name(s), running(true) { reset(); }\n    Stopwatch() : Stopwatch(\"Time\") {}\n    void reset() {\n        last_played = C::now();\n        elapsed_time = T1::zero();\n    }\n    void pause() {\n        if (!running) return;\n        running = false;\n        elapsed_time += std::chrono::duration_cast&lt;T1&gt;(C::now() - last_played);\n    }\n    void play() {\n        if (running) return;\n        running = true;\n        last_played = C::now();\n    }\n    int_fast64_t elapsed() const {\n        return std::chrono::duration_cast&lt;T2&gt;(\n                elapsed_time + (running ? std::chrono::duration_cast&lt;T1&gt;(\n                                                C::now() - last_played)\n                                        : T1::zero()))\n            .count();\n    }\n    void print() const { std::cerr &lt;&lt; name &lt;&lt; \": \" &lt;&lt; elapsed() &lt;&lt; \" ms\\n\"; }\n    ~Stopwatch() { print(); }\n};\nstruct Random : std::mt19937 {\n    using std::mt19937::mt19937;\n    using std::mt19937::operator();\n    static int64_t gen_seed() {\n        return 42;\n        // return std::chrono::steady_clock::now().time_since_epoch().count();\n    }\n    Random() : std::mt19937(gen_seed()) {}\n    template &lt;class Int&gt;\n    auto operator()(Int a, Int b)\n        -&gt; std::enable_if_t&lt;std::is_integral_v&lt;Int&gt;, Int&gt; {\n        return std::uniform_int_distribution&lt;Int&gt;(a, b)(*this);\n    }\n    template &lt;class Int&gt;\n    auto operator()(Int a) -&gt; std::enable_if_t&lt;std::is_integral_v&lt;Int&gt;, Int&gt; {\n        return std::uniform_int_distribution&lt;Int&gt;(0, a - 1)(*this);\n    }\n    template &lt;class Real&gt;\n    auto operator()(Real a, Real b)\n        -&gt; std::enable_if_t&lt;std::is_floating_point_v&lt;Real&gt;, Real&gt; {\n        return std::uniform_real_distribution&lt;Real&gt;(a, b)(*this);\n    }\n};\n\ntemplate &lt;class Integer, class F&gt;\nInteger find_first_false(Integer l, Integer r, F&amp;&amp; f) {\n    --l, ++r;\n    while (r - l &gt; 1) {\n        auto mid = l + (r - l) / 2;\n        if (f(mid))\n            l = mid;\n        else\n            r = mid;\n    }\n    return r;\n}\n\ntemplate &lt;class Integer, class F&gt;\nInteger lifting_find_first_false(Integer l, Integer r, F&amp;&amp; f) {\n    if (l &gt; r) return r + 1;\n    ++r;\n    Integer w = Integer(1) &lt;&lt; __lg(r - l);\n    --l;\n    if (f(l + w)) l = r - w;\n    for (w &gt;&gt;= 1; w &gt;= Integer(1); w &gt;&gt;= 1)\n        if (f(l + w)) l += w;\n    return l + 1;\n}\n\ntemplate &lt;class Integer, class F&gt;\nInteger unrolled_find_first_false(Integer l, Integer r,\n                                F&amp;&amp; f) requires(sizeof(Integer) == 4) {\n    if (l &gt; r) return r + 1;\n    ++r;\n    int p = __lg(r - l);\n    Integer w = Integer(1) &lt;&lt; p;\n    --l;\n    if (f(l + w)) l = r - w;\n    switch (p) {\n        case 31:\n            if (f(l + (1 &lt;&lt; 30))) l += 1 &lt;&lt; 30;\n        case 30:\n            if (f(l + (1 &lt;&lt; 29))) l += 1 &lt;&lt; 29;\n        case 29:\n            if (f(l + (1 &lt;&lt; 28))) l += 1 &lt;&lt; 28;\n        case 28:\n            if (f(l + (1 &lt;&lt; 27))) l += 1 &lt;&lt; 27;\n        case 27:\n            if (f(l + (1 &lt;&lt; 26))) l += 1 &lt;&lt; 26;\n        case 26:\n            if (f(l + (1 &lt;&lt; 25))) l += 1 &lt;&lt; 25;\n        case 25:\n            if (f(l + (1 &lt;&lt; 24))) l += 1 &lt;&lt; 24;\n        case 24:\n            if (f(l + (1 &lt;&lt; 23))) l += 1 &lt;&lt; 23;\n        case 23:\n            if (f(l + (1 &lt;&lt; 22))) l += 1 &lt;&lt; 22;\n        case 22:\n            if (f(l + (1 &lt;&lt; 21))) l += 1 &lt;&lt; 21;\n        case 21:\n            if (f(l + (1 &lt;&lt; 20))) l += 1 &lt;&lt; 20;\n        case 20:\n            if (f(l + (1 &lt;&lt; 19))) l += 1 &lt;&lt; 19;\n        case 19:\n            if (f(l + (1 &lt;&lt; 18))) l += 1 &lt;&lt; 18;\n        case 18:\n            if (f(l + (1 &lt;&lt; 17))) l += 1 &lt;&lt; 17;\n        case 17:\n            if (f(l + (1 &lt;&lt; 16))) l += 1 &lt;&lt; 16;\n        case 16:\n            if (f(l + (1 &lt;&lt; 15))) l += 1 &lt;&lt; 15;\n        case 15:\n            if (f(l + (1 &lt;&lt; 14))) l += 1 &lt;&lt; 14;\n        case 14:\n            if (f(l + (1 &lt;&lt; 13))) l += 1 &lt;&lt; 13;\n        case 13:\n            if (f(l + (1 &lt;&lt; 12))) l += 1 &lt;&lt; 12;\n        case 12:\n            if (f(l + (1 &lt;&lt; 11))) l += 1 &lt;&lt; 11;\n        case 11:\n            if (f(l + (1 &lt;&lt; 10))) l += 1 &lt;&lt; 10;\n        case 10:\n            if (f(l + (1 &lt;&lt; 9))) l += 1 &lt;&lt; 9;\n        case 9:\n            if (f(l + (1 &lt;&lt; 8))) l += 1 &lt;&lt; 8;\n        case 8:\n            if (f(l + (1 &lt;&lt; 7))) l += 1 &lt;&lt; 7;\n        case 7:\n            if (f(l + (1 &lt;&lt; 6))) l += 1 &lt;&lt; 6;\n        case 6:\n            if (f(l + (1 &lt;&lt; 5))) l += 1 &lt;&lt; 5;\n        case 5:\n            if (f(l + (1 &lt;&lt; 4))) l += 1 &lt;&lt; 4;\n        case 4:\n            if (f(l + (1 &lt;&lt; 3))) l += 1 &lt;&lt; 3;\n        case 3:\n            if (f(l + (1 &lt;&lt; 2))) l += 1 &lt;&lt; 2;\n        case 2:\n            if (f(l + (1 &lt;&lt; 1))) l += 1 &lt;&lt; 1;\n        case 1:\n            if (f(l + (1 &lt;&lt; 0))) l += 1 &lt;&lt; 0;\n        default:\n            break;\n    }\n    return l + 1;\n}\n\nvoid test2() {\n    Random rng;\n    int n = 4e6;\n    vector&lt;int&gt; a(n);\n    generate(begin(a), end(a), [&amp;] { return rng(1, 2 * n); });\n    sort(begin(a), end(a));\n    ll ans = 0;\n    Stopwatch timer;\n    for (int i = 0; i &lt; n; ++i) {\n        int q = rng(1, 2 * n);\n        int d = rng(n);\n        ans ^= find_first_false(0, d, [&amp;](int i) { return a[i] &lt; q; });\n    }\n    cout &lt;&lt; \"-----------------------------\\n\";\n    cout &lt;&lt; \"Simple binary search\\n\";\n    cout &lt;&lt; ans &lt;&lt; '\\n';\n}\n\nvoid test3() {\n    Random rng;\n    int n = 4e6;\n    vector&lt;int&gt; a(n);\n    generate(begin(a), end(a), [&amp;] { return rng(1, 2 * n); });\n    sort(begin(a), end(a));\n    ll ans = 0;\n    Stopwatch timer;\n    for (int i = 0; i &lt; n; ++i) {\n        int q = rng(1, 2 * n);\n        int d = rng(n);\n        ans ^= lifting_find_first_false(0, d, [&amp;](int i) { return a[i] &lt; q; });\n    }\n    cout &lt;&lt; \"-----------------------------\\n\";\n    cout &lt;&lt; \"Binary lifting\\n\";\n    cout &lt;&lt; ans &lt;&lt; '\\n';\n}\n\nvoid test4() {\n    Random rng;\n    int n = 4e6;\n    vector&lt;int&gt; a(n);\n    generate(begin(a), end(a), [&amp;] { return rng(1, 2 * n); });\n    sort(begin(a), end(a));\n    ll ans = 0;\n    Stopwatch timer;\n    for (int i = 0; i &lt; n; ++i) {\n        int q = rng(1, 2 * n);\n        int d = rng(n);\n        ans ^= unrolled_find_first_false(0, d, [&amp;](int i) { return a[i] &lt; q; });\n    }\n    cout &lt;&lt; \"-----------------------------\\n\";\n    cout &lt;&lt; \"Binary lifting with unrolling\\n\";\n    cout &lt;&lt; ans &lt;&lt; '\\n';\n}\n\nint main() {\n    int _tests = 1;\n    // cin &gt;&gt; _tests;\n    for (int _test = 1; _test &lt;= _tests; ++_test) {\n        // cout &lt;&lt; \"Case #\" &lt;&lt; _test &lt;&lt; \": \";\n        test2();\n        test3();\n        test4();\n        cout &lt;&lt; \"-----------------------------\\n\";\n    }\n}\n</code></pre> <p>K\u1ebft qu\u1ea3:</p> <pre><code>-----------------------------\nSimple binary search\n744175\nTime: 2184 ms\n-----------------------------\nBinary lifting\n744175\nTime: 1504 ms\n-----------------------------\nBinary lifting with unrolling\n744175\nTime: 1407 ms\n-----------------------------\n</code></pre> <p>https://algorithmica.org/en/eytzinger gi\u1ea3i th\u00edch m\u1ed9t c\u00e1ch kh\u00e1 hay v\u1ec1 vi\u1ec7c khai th\u00e1c cache v\u00e0 t\u0103ng t\u1ed1c t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p nh\u1ea5t \u0111\u1ecbnh v\u1edbi m\u1ed9t h\u1ec7 s\u1ed1 kh\u00e1 \u1ea5n t\u01b0\u1ee3ng.</p> <p>https://codeforces.com/blog/entry/76182 gi\u1ea3i th\u00edch m\u1ed9t bi\u1ebfn th\u1ec3 c\u1ee7a t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n chia \u0111o\u1ea1n kh\u00f4ng \u0111\u1ec1u, \u0111i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn s\u1ef1 thay \u0111\u1ed5i v\u1ec1 m\u1eb7t \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u00ednh to\u00e1n.</p>"},{"location":"misc/algorithms/binary-search/#tai-lieu-tham-khao","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o","text":"<p>B\u1ea1n c\u00f3 th\u1ec3 tham kh\u1ea3o c\u00e1c t\u00e0i li\u1ec7u sau \u0111\u1ec3 luy\u1ec7n t\u1eadp v\u00e0 hi\u1ec3u th\u00eam v\u1ec1 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</p> <p>Codeforce EDU tutorial (v\u00e0 c\u00e1c b\u00e0i t\u1eadp) v\u1ec1 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n.</p> <p>M\u1ed9t video kh\u00e1 hay gi\u1ea3i th\u00edch t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n trong post n\u00e0y: https://codeforces.com/blog/entry/67509.</p> <p>M\u1ed9t b\u1ea3n m\u1edf r\u1ed9ng c\u1ee7a t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n g\u1ecdi l\u00e0 t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n song song (parallel binary search), b\u00e0i https://codeforces.com/blog/entry/89694 c\u00f3 m\u1ed9t video kh\u00e1 hay v\u1ec1 n\u00f3.</p> <p>Binary lifting l\u00e0 m\u1ed9t kh\u00e1i ni\u1ec7m chung chung. H\u01b0\u1edbng d\u1eabn binary lifting tr\u00ean c\u00e2y Fenwick c\u00f3 th\u1ec3 tham kh\u1ea3o \u1edf \u0111\u00e2y https://codeforces.com/blog/entry/61364. Binary lifting tr\u00ean c\u00e2y c\u00f3 th\u1ec3 tham kh\u1ea3o \u1edf \u0111\u00e2y https://usaco.guide/plat/binary-jump?lang=cpp.</p> <p>T\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n tr\u00ean segment tree c\u0169ng l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt hay, c\u00e0i \u0111\u1eb7t v\u00e0 gi\u1ea3i th\u00edch cho recursive segment tree c\u00f3 th\u1ec3 tham kh\u1ea3o \u1edf \u0111\u00e2y https://codeforces.com/blog/entry/83883. V\u1edbi iterative segment tree, b\u1ea1n c\u00f3 th\u1ec3 tham kh\u1ea3o c\u00e0i \u0111\u1eb7t \u1edf \u0111\u00e2y https://github.com/atcoder/ac-library/blob/master/atcoder/lazysegtree.hpp. \u00dd t\u01b0\u1edfng c\u1ee7a n\u00f3 nh\u01b0 sau:</p> \u00dd t\u01b0\u1edfng <p>\u0110\u1ec3 \u00fd r\u1eb1ng node con c\u1ee7a node <code>x</code> l\u00e0 c\u00e1c node <code>(x &lt;&lt; 1)</code> v\u00e0 <code>(x &lt;&lt; 1) | 1</code>. Ta l\u00e0m nh\u01b0 sau: l\u1ea5y node t\u1ed5 ti\u00ean c\u1ee7a <code>r</code> th\u1ecfa <code>predicate(node) = true</code> (kh\u00f4ng nh\u1ea5t thi\u1ebft l\u00e0 t\u1ed5 ti\u00ean, ch\u1ec9 c\u1ea7n l\u00e0 m\u1ed9t node th\u1ecfa m\u00e3n t\u00ednh ch\u1ea5t sau: n\u1ebfu \u0111\u00e1p \u00e1n l\u00e0 <code>l</code>, node ta c\u1ea7n s\u1ebd l\u00e0 node con b\u00ean tr\u00e1i c\u1ee7a t\u1ed5 ti\u00ean chung c\u1ee7a c\u00e1c node l\u00e1 t\u01b0\u01a1ng \u1ee9ng v\u1edbi <code>l</code> v\u00e0 <code>r</code>). Khi c\u00f3 \u0111\u01b0\u1ee3c v\u1ecb tr\u00ed \u0111\u00f3 r\u1ed3i, ta s\u1ebd \u0111i xu\u1ed1ng theo segment tree, v\u00ec ta bi\u1ebft \u0111\u01b0\u1ee3c \u0111\u00e1p \u00e1n s\u1ebd n\u1eb1m \u1edf c\u00e2y con n\u00e0o (ta s\u1ebd b\u1ecf qua \u0111\u01b0\u1ee3c \u0111i\u1ec1u ki\u1ec7n <code>l &lt; r</code>).</p> <pre><code>// For implementing this for a lazy segtree, ensure that you have pushed the updates accumulated at ancestors appropriately before accessing the value at a node\ntemplate &lt;class F&gt; int min_left(int r, F f) const {\n    assert(0 &lt;= r &amp;&amp; r &lt;= _n); // precondition check\n    assert(f(e())); // f should evaluate true on the empty range\n    if (r == 0) return 0; // has to be empty\n    r += size; // get the leaf\n    S sm = e(); // accumulator variable\n    do {\n        r--;\n        while (r &gt; 1 &amp;&amp; (r % 2)) r &gt;&gt;= 1; // get the highest ancestor of this node which shares the right boundary with this node\n        if (!f(op(d[r], sm))) { // if the range (left(ancestor), right(query)) doesn't work, we have found a node which contains the leaf corresponding to the answer in the subtree\n            while (r &lt; size) {\n                r = (2 * r + 1); // go to the right child\n                if (f(op(d[r], sm))) { // if right child works, go to the left, else remain there\n                    sm = op(d[r], sm);\n                    r--;\n                }\n            }\n            return r + 1 - size;\n        }\n        sm = op(d[r], sm); // otherwise just update the accumulator and go to the node left of the highest ancestor we found earlier\n    } while ((r &amp; -r) != r);\n    return 0;\n}\n</code></pre> <p>Gi\u1ea3i th\u00edch cho <code>max_right</code> c\u0169ng t\u01b0\u01a1ng t\u1ef1.</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/","title":"C\u00e1c k\u00fd hi\u1ec7u ti\u1ec7m c\u1eadn","text":""},{"location":"misc/complexity-analysis/asymptotic-notations/#cac-ky-hieu-tiem-can","title":"C\u00e1c k\u00fd hi\u1ec7u ti\u1ec7m c\u1eadn","text":""},{"location":"misc/complexity-analysis/asymptotic-notations/#nguon","title":"Ngu\u1ed3n","text":"<p> What are Asymptotic Notations in Complexity Analysis of Algorithms - GeeksForGeeks</p> <p>H\u00ecnh v\u1ebd tham kh\u1ea3o t\u1eeb Asymptotic Analysis: Big-O Notation and More - Programiz</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>C\u00e1c k\u00ed hi\u1ec7u ti\u1ec7m c\u1eadn \u0111\u00f3ng vai tr\u00f2 r\u1ea5t quan tr\u1ecdng trong ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p thu\u1eadt to\u00e1n. Ph\u00e2n t\u00edch ti\u1ec7m c\u1eadn gi\u00fap \u0111o \u0111\u1ea1c \u0111\u1ed9 hi\u1ec7u qu\u1ea3 c\u1ee7a c\u00e1c thu\u1eadt to\u00e1n m\u00e0 kh\u00f4ng ph\u1ee5 thu\u1ed9c v\u00e0o c\u00e1c h\u1eb1ng s\u1ed1 (h\u1eb1ng s\u1ed1 tu\u1ef3 v\u00e0o lo\u1ea1i m\u00e1y t\u00ednh) v\u00e0 kh\u00f4ng y\u00eau c\u1ea7u ph\u1ea3i c\u00e0i \u0111\u1eb7t thu\u1eadt to\u00e1n v\u00e0 th\u1eddi gian bi\u00ean d\u1ecbch. C\u00e1c k\u00ed hi\u1ec7u ti\u1ec7m c\u1eadn l\u00e0 nh\u1eefng c\u00f4ng c\u1ee5 to\u00e1n h\u1ecdc \u0111\u1ec3 bi\u1ec3u th\u1ecb \u0111\u1ed9 ph\u1ee9c t\u1ea1p v\u1ec1 m\u1eb7t th\u1eddi gian c\u1ee7a thu\u1eadt to\u00e1n cho vi\u1ec7c ph\u00e2n t\u00edch ti\u1ec7m c\u1eadn. </p> <p>C\u00f3 3 lo\u1ea1i k\u00fd hi\u1ec7u ti\u1ec7m c\u1eadn ch\u00ednh:</p> <ul> <li>K\u00ed hi\u1ec7u Big-O (k\u00ed hi\u1ec7u \\(O\\))</li> <li>K\u00ed hi\u1ec7u Omega (k\u00ed hi\u1ec7u \\(\\Omega\\))</li> <li>K\u00ed hi\u1ec7u Theta (k\u00ed hi\u1ec7u \\(\\Theta\\))</li> </ul>"},{"location":"misc/complexity-analysis/asymptotic-notations/#ki-hieu-theta-ki-hieu-theta","title":"K\u00ed hi\u1ec7u Theta (k\u00ed hi\u1ec7u \\(\\Theta\\))","text":"<p>K\u00ed hi\u1ec7u Theta bao h\u00e0m c\u1eadn tr\u00ean v\u00e0 c\u1eadn d\u01b0\u1edbi c\u1ee7a h\u00e0m. V\u00ec n\u00f3 \u0111\u1ea1i di\u1ec7n cho 2 c\u1eadn c\u1ee7a th\u1eddi gian ch\u1ea1y, n\u00f3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p thu\u1eadt to\u00e1n trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p th\u00f4ng th\u01b0\u1eddng (kh\u00f4ng ph\u1ea3i x\u1ea5u nh\u1ea5t c\u0169ng kh\u00f4ng ph\u1ea3i t\u1ed1t nh\u1ea5t).</p> <p>G\u1ecdi \\(g\\) v\u00e0 \\(f\\) l\u00e0 c\u00e1c h\u00e0m \u00e1nh x\u1ea1 t\u1eeb t\u1eadp s\u1ed1 t\u1ef1 nhi\u00ean \u0111\u1ebfn ch\u00ednh n\u00f3. H\u00e0m \\(f\\) \u0111\u01b0\u1ee3c coi l\u00e0 \\(\\Theta(g)\\), khi t\u1ed3n t\u1ea1i h\u1eb1ng s\u1ed1 \\(c_1, c_2 &gt; 0\\) v\u00e0 m\u1ed9t s\u1ed1 t\u1ef1 nhi\u00ean \\(n_0\\) sao cho \\(c_1 * g(n) \\leq f(n) \\leq c_2 * g(n)\\) v\u1edbi m\u1ecdi \\(n \\geq n_0\\).</p> <p></p> <p>Bi\u1ec3u di\u1ec5n to\u00e1n h\u1ecdc c\u1ee7a k\u00ed hi\u1ec7u Theta:</p> \\[\\Theta(g(n)) = \\{ f(n): \\text{t\u1ed3n t\u1ea1i c\u00e1c h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng }c_1\\text{, }c_2\\text{ v\u00e0 }n_0\\text{ sao cho }0 \\leq c_1 * g(n) \\leq f(n) \\leq c_2 * g(n)\\text{ v\u1edbi m\u1ecdi }n \\geq n_0 \\}\\] <p>L\u01b0u \u00fd: \\(\\Theta(g)\\) l\u00e0 m\u1ed9t t\u1eadp</p> <p>Bi\u1ec3u th\u1ee9c \u1edf tr\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u00f4 t\u1ea3 l\u00e0: n\u1ebfu \\(f(n)\\) l\u00e0 \\(\\Theta\\) c\u1ee7a \\(g(n)\\), gi\u00e1 tr\u1ecb \\(f(n)\\) s\u1ebd lu\u00f4n n\u1eb1m gi\u1eefa \\(c_1 * g(n)\\) v\u00e0 \\(c_2 * g(n)\\) v\u1edbi m\u1ecdi gi\u00e1 tr\u1ecb l\u1edbn c\u1ee7a \\(n\\) (\\(n \\geq n_0\\)). \u0110\u1ecbnh ngh\u0129a c\u1ee7a \\(\\Theta\\) c\u0169ng y\u00eau c\u1ea7u r\u1eb1ng \\(f(n)\\) ph\u1ea3i kh\u00f4ng \u00e2m v\u1edbi m\u1ecdi gi\u00e1 tr\u1ecb \\(n &gt; n_0\\).</p> <p>M\u1ed9t c\u00e1ch \u0111\u01a1n gi\u1ea3n \u0111\u1ec3 l\u1ea5y \u0111\u01b0\u1ee3c \\(\\Theta\\) c\u1ee7a m\u1ed9t bi\u1ec3u th\u1ee9c l\u00e0 b\u1ecf qua nh\u1eefng to\u00e1n h\u1ea1ng y\u1ebfu h\u01a1n v\u00e0 c\u00e1c h\u1eb1ng s\u1ed1. V\u00ed d\u1ee5, x\u00e9t bi\u1ec3u th\u1ee9c \\(3n^3 + 6n^2 + 6000 = \\Theta(n^3)\\), vi\u1ec7c b\u1ecf \u0111i c\u00e1c to\u00e1n h\u1ea1ng y\u1ebfu h\u01a1n \u0111\u01b0\u1ee3c ch\u1ea5p nh\u1eadn v\u00ec s\u1ebd lu\u00f4n t\u1ed3n t\u1ea1i \\(n\\) m\u00e0 c\u00e1c gi\u00e1 tr\u1ecb sau n\u00f3 l\u00e0m cho \\(\\Theta(n^3)\\) lu\u00f4n c\u00f3 gi\u00e1 tr\u1ecb l\u1edbn h\u01a1n \\(\\Theta(n^2)\\) m\u00e0 kh\u00f4ng li\u00ean quan g\u00ec \u0111\u1ebfn c\u00e1c h\u1eb1ng s\u1ed1 trong bi\u1ec3u th\u1ee9c. V\u1edbi m\u1ed9t h\u00e0m \\(g(n)\\) cho tr\u01b0\u1edbc, ta bi\u1ec3u th\u1ecb \\(\\Theta(g(n))\\) nh\u01b0 sau:</p> <p>V\u00ed d\u1ee5:</p> <ul> <li>T\u1eadp \\(\\{ 100\\text{, }\\log(2000)\\text{, }10^4 \\}\\) n\u1eb1m trong \\(\\Theta(1)\\)</li> <li>T\u1eadp \\(\\{ \\frac{n}{4}\\text{, }2n + 3\\text{, }\\frac{n}{100} + \\log(n) \\}\\) n\u1eb1m trong \\(\\Theta(n)\\)</li> <li>T\u1eadp \\(\\{ n^2 + n\\text{, }2n^2\\text{, }n^2 + \\log(n) \\}\\) n\u1eb1m trong \\(\\Theta(n^2)\\)</li> </ul> <p>L\u01b0u \u00fd: \\(\\Theta\\) th\u1ec3 hi\u1ec7n ch\u00ednh x\u00e1c c\u00e1c c\u1eadn.</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/#ki-hieu-big-o-ki-hieu-o","title":"K\u00ed hi\u1ec7u Big-O (k\u00ed hi\u1ec7u \\(O\\))","text":"<p>K\u00ed hi\u1ec7u Big-O \u0111\u1ea1i di\u1ec7n cho c\u1eadn tr\u00ean c\u1ee7a th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n. V\u00ec v\u1eady, n\u00f3 cho bi\u1ebft \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t c\u1ee7a m\u1ed9t thu\u1eadt to\u00e1n.</p> <p>N\u1ebfu \\(f(n)\\) m\u00f4 t\u1ea3 th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n, \\(f(n)\\) l\u00e0 \\(O(g(n))\\) n\u1ebfu t\u1ed3n t\u1ea1i m\u1ed9t h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng \\(C\\) v\u00e0 \\(n_0\\) m\u00e0 \\(0 \\leq f(n) \\leq C * g(n)\\) v\u1edbi m\u1ecdi \\(n \\geq n_0\\).</p> <p></p> <p>Bi\u1ec3u di\u1ec5n to\u00e1n h\u1ecdc c\u1ee7a k\u00ed hi\u1ec7u Big-O:</p> \\[O(g(n)) = \\{ f(n): \\text{t\u1ed3n t\u1ea1i c\u00e1c h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng }c\\text{ v\u00e0 }n_0\\text{ sao cho }0 \\leq f(n) \\leq c * g(n)\\text{ v\u1edbi m\u1ecdi }n \\geq n_0 \\}\\] <p>V\u00ed d\u1ee5, x\u00e9t thu\u1eadt to\u00e1n Insertion Sort. N\u00f3 t\u1ed1n th\u1eddi gian tuy\u1ebfn t\u00ednh trong tr\u01b0\u1eddng h\u1ee3p t\u1ed1t nh\u1ea5t nh\u01b0ng t\u1ed1n th\u1eddi gian b\u1eadc hai cho tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t. Ta c\u00f3 th\u1ec3 n\u00f3i r\u1eb1ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a Insertion Sort l\u00e0 \\(O(n^2)\\).</p> <p>L\u01b0u \u00fd: \\(O(n^2)\\) c\u0169ng bao g\u1ed3m th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>N\u1ebfu ta d\u00f9ng k\u00ed hi\u1ec7u \\(\\Theta\\) \u0111\u1ec3 bi\u1ec3u di\u1ec5n \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a Insertion Sort, ta ph\u1ea3i d\u00f9ng 2 m\u1ec7nh \u0111\u1ec1 cho c\u00e1c tr\u01b0\u1eddng h\u1ee3p t\u1ed1t v\u00e0 x\u1ea5u nh\u1ea5t:</p> <ul> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t c\u1ee7a Insertion Sort l\u00e0 \\(\\Theta(n^2)\\)</li> <li>\u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian cho tr\u01b0\u1eddng h\u1ee3p t\u1ed1t nh\u1ea5t c\u1ee7a Insertion Sort l\u00e0 \\(\\Theta(n)\\)</li> </ul> <p>K\u00ed hi\u1ec7u Big-O ph\u00e1t huy t\u00e1c d\u1ee5ng khi ta ch\u1ec9 c\u00f3 c\u1eadn tr\u00ean c\u1ee7a \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n. \u0110a ph\u1ea7n ta c\u00f3 th\u1ec3 t\u00ecm ra \u0111\u01b0\u1ee3c c\u1eadn tr\u00ean n\u00e0y ch\u1ec9 b\u1eb1ng c\u00e1ch nh\u00ecn v\u00e0o thu\u1eadt to\u00e1n.</p> <p>V\u00ed d\u1ee5:</p> <ul> <li>T\u1eadp \\(\\{ 100\\text{, }\\log(2000)\\text{, }10^4 \\}\\) n\u1eb1m trong \\(O(1)\\)</li> <li>\\(\\cup\\) T\u1eadp \\(\\{ \\frac{n}{4}\\text{, }2n + 3\\text{, }\\frac{n}{100} + \\log(n) \\}\\) n\u1eb1m trong \\(O(n)\\)</li> <li>\\(\\cup\\) T\u1eadp \\(\\{ n^2 + n\\text{, }2n^2\\text{, }n^2 + \\log(n) \\}\\) n\u1eb1m trong \\(O(n^2)\\)</li> </ul> <p>L\u01b0u \u00fd: \u1ede \u0111\u00e2y \\(\\cup\\) l\u00e0 k\u00ed hi\u1ec7u h\u1ee3p, ta c\u00f3 th\u1ec3 vi\u1ebft th\u1ebf n\u00e0y v\u00ec Big-O th\u1ec3 hi\u1ec7n c\u1eadn ch\u00ednh x\u00e1c ho\u1eb7c c\u1eadn tr\u00ean.</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/#ki-hieu-omega-ki-hieu-omega","title":"K\u00ed hi\u1ec7u Omega (k\u00ed hi\u1ec7u \\(\\Omega\\))","text":"<p>K\u00ed hi\u1ec7u Omega \u0111\u1ea1i di\u1ec7n cho c\u1eadn d\u01b0\u1edbi c\u1ee7a th\u1eddi gian ch\u1ea1y c\u1ee7a thu\u1eadt to\u00e1n. V\u00ec v\u1eady, n\u00f3 cho bi\u1ebft \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a tr\u01b0\u1eddng h\u1ee3p t\u1ed1t nh\u1ea5t c\u1ee7a m\u1ed9t thu\u1eadt to\u00e1n.</p> <p>G\u1ecdi \\(g\\) v\u00e0 \\(f\\) l\u00e0 c\u00e1c h\u00e0m \u00e1nh x\u1ea1 t\u1eeb t\u1eadp s\u1ed1 t\u1ef1 nhi\u00ean \u0111\u1ebfn ch\u00ednh n\u00f3. H\u00e0m \\(f\\) \u0111\u01b0\u1ee3c coi l\u00e0 \\(\\Omega(g)\\), khi t\u1ed3n t\u1ea1i h\u1eb1ng s\u1ed1 \\(c &gt; 0\\) v\u00e0 m\u1ed9t s\u1ed1 t\u1ef1 nhi\u00ean \\(n_0\\) sao cho \\(c * g(n) \\leq f(n)\\) v\u1edbi m\u1ecdi \\(n \\geq n_0\\).</p> <p></p> <p>Bi\u1ec3u di\u1ec5n to\u00e1n h\u1ecdc c\u1ee7a k\u00ed hi\u1ec7u Omega:</p> \\[\\Omega(g(n)) = \\{ f(n): \\text{t\u1ed3n t\u1ea1i c\u00e1c h\u1eb1ng s\u1ed1 d\u01b0\u01a1ng }c\\text{ v\u00e0 }n_0\\text{ sao cho }0 \\leq c * g(n) \\leq f(n) \\text{ v\u1edbi m\u1ecdi }n \\geq n_0 \\}\\] <p>X\u00e9t l\u1ea1i v\u00ed d\u1ee5 Insertion Sort \u1edf tr\u00ean. \u0110\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a Insertion Sort c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft l\u00e0 \\(\\Omega(n)\\), nh\u01b0ng \u0111\u00e2y kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t th\u00f4ng tin qu\u00e1 h\u1eefu \u00edch, v\u00ec nh\u00ecn chung ch\u00fang ta hay quan t\u00e2m \u0111\u1ebfn tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t ho\u1eb7c th\u1ec9nh tho\u1ea3ng l\u00e0 tr\u01b0\u1eddng h\u1ee3p trung b\u00ecnh.</p> <p>V\u00ed d\u1ee5:</p> <ul> <li>T\u1eadp \\(\\{ n^2 + n\\text{, }2n^2\\text{, }n^2 + \\log(n) \\}\\) n\u1eb1m trong \\(\\Omega(n^2)\\)</li> <li>\\(\\cup\\) T\u1eadp \\(\\{ \\frac{n}{4}\\text{, }2n + 3\\text{, }\\frac{n}{100} + \\log(n) \\}\\) n\u1eb1m trong \\(\\Omega(n)\\)</li> <li>\\(\\cup\\) T\u1eadp \\(\\{ 100\\text{, }\\log(2000)\\text{, }10^4 \\}\\) n\u1eb1m trong \\(\\Omega(1)\\)</li> </ul> <p>L\u01b0u \u00fd: \u1ede \u0111\u00e2y \\(\\cup\\) l\u00e0 k\u00ed hi\u1ec7u h\u1ee3p, ta c\u00f3 th\u1ec3 vi\u1ebft th\u1ebf n\u00e0y v\u00ec Big-O th\u1ec3 hi\u1ec7n c\u1eadn ch\u00ednh x\u00e1c ho\u1eb7c c\u1eadn d\u01b0\u1edbi.</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/#tinh-chat-cua-cac-ki-hieu-tiem-can","title":"T\u00ednh ch\u1ea5t c\u1ee7a c\u00e1c k\u00ed hi\u1ec7u ti\u1ec7m c\u1eadn","text":""},{"location":"misc/complexity-analysis/asymptotic-notations/#tinh-chat-chung","title":"T\u00ednh ch\u1ea5t chung","text":"<p>N\u1ebfu \\(f(n)\\) l\u00e0 \\(O(g(n))\\) th\u00ec \\(a * f(n)\\) c\u0169ng l\u00e0 \\(O(g(n))\\), v\u1edbi \\(a\\) l\u00e0 h\u1eb1ng s\u1ed1.</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;f(n) = 2n^2 + 5\\text{ l\u00e0 }O(n^2) \\\\ &amp;\\text{th\u00ec , }7 * f(n) = 7 * (2n^2 + 5) = 14n^2 + 35\\text{ c\u0169ng l\u00e0 }O(n^2)\\\\ \\end{align}\\] <p>T\u01b0\u01a1ng t\u1ef1, t\u00ednh ch\u1ea5t n\u00e0y c\u0169ng tho\u1ea3 v\u1edbi \\(\\Theta\\) v\u00e0 \\(\\Omega\\).</p> <p>Ta c\u00f3 th\u1ec3 n\u00f3i l\u00e0:</p> <ul> <li>N\u1ebfu \\(f(n)\\) l\u00e0 \\(\\Theta(g(n))\\) th\u00ec \\(a * f(n)\\) c\u0169ng l\u00e0 \\(\\Theta(g(n))\\), v\u1edbi \\(a\\) l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1.</li> <li>N\u1ebfu \\(f(n)\\) l\u00e0 \\(\\Omega(g(n))\\) th\u00ec \\(a * f(n)\\) c\u0169ng l\u00e0 \\(\\Omega(g(n))\\), v\u1edbi \\(a\\) l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1.</li> </ul>"},{"location":"misc/complexity-analysis/asymptotic-notations/#tinh-chat-bac-cau","title":"T\u00ednh ch\u1ea5t b\u1eafc c\u1ea7u","text":"<p>N\u1ebfu \\(f(n)\\) l\u00e0 \\(O(g(n))\\) v\u00e0 \\(g(n)\\) l\u00e0 \\(O(h(n))\\) th\u00ec \\(f(n) = O(h(n))\\).</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;\\text{N\u1ebfu }f(n) = n\\text{, }g(n) = n^2\\text{ v\u00e0 }h(n) = n^3 \\\\ &amp;n\\text{ l\u00e0 }O(n^2)\\text{ v\u00e0 }n^2\\text{ l\u00e0 }O(n^3)\\text{ th\u00ec }n\\text{ l\u00e0 }O(n^3)\\\\ \\end{align}\\] <p>T\u01b0\u01a1ng t\u1ef1, t\u00ednh ch\u1ea5t n\u00e0y c\u0169ng tho\u1ea3 v\u1edbi \\(\\Theta\\) v\u00e0 \\(\\Omega\\).</p> <p>Ta c\u00f3 th\u1ec3 n\u00f3i l\u00e0:</p> <ul> <li>N\u1ebfu \\(f(n)\\) l\u00e0 \\(\\Theta(g(n))\\) v\u00e0 \\(g(n)\\) l\u00e0 \\(\\Theta(h(n))\\) th\u00ec \\(f(n) = \\Theta(h(n))\\).</li> <li>N\u1ebfu \\(f(n)\\) l\u00e0 \\(\\Omega(g(n))\\) v\u00e0 \\(g(n)\\) l\u00e0 \\(\\Omega(h(n))\\) th\u00ec \\(f(n) = \\Omega(h(n))\\).</li> </ul>"},{"location":"misc/complexity-analysis/asymptotic-notations/#tinh-chat-anh-xa","title":"T\u00ednh ch\u1ea5t \u00e1nh x\u1ea1","text":"<p>T\u00ednh \u00e1nh x\u1ea1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c suy ra t\u1eeb t\u00ednh ch\u1ea5t b\u1eafc c\u1ea7u.</p> <p>N\u1ebfu \\(f(n)\\) \u0111\u01b0\u1ee3c cho th\u00ec \\(f(n)\\) l\u00e0 \\(O(f(n))\\), v\u00ec gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t c\u1ee7a \\(f(n)\\) l\u00e0 ch\u00ednh \\(f(n)\\).</p> <p>V\u1eady n\u00ean \\(x = f(n)\\) v\u00e0 \\(y = O(f(n))\\) lu\u00f4n g\u1eafn v\u1edbi nhau trong quan h\u1ec7 \u00e1nh x\u1ea1.</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;f(n) = n^2\\text{ t\u1ee9c l\u00e0 }O(n^2)\\text{ hay l\u00e0 }O(f(n)) \\\\ \\end{align}\\] <p>T\u01b0\u01a1ng t\u1ef1, t\u00ednh ch\u1ea5t n\u00e0y c\u0169ng tho\u1ea3 v\u1edbi \\(\\Theta\\) v\u00e0 \\(\\Omega\\).</p> <p>Ta c\u00f3 th\u1ec3 n\u00f3i l\u00e0:</p> <ul> <li>N\u1ebfu \\(f(n)\\) \u0111\u01b0\u1ee3c cho th\u00ec \\(f(n)\\) l\u00e0 \\(\\Theta(f(n))\\).</li> <li>N\u1ebfu \\(f(n)\\) \u0111\u01b0\u1ee3c cho th\u00ec \\(f(n)\\) l\u00e0 \\(\\Omega(f(n))\\).</li> </ul>"},{"location":"misc/complexity-analysis/asymptotic-notations/#tinh-chat-oi-xung","title":"T\u00ednh ch\u1ea5t \u0111\u1ed1i x\u1ee9ng","text":"<p>N\u1ebfu \\(f(n)\\) l\u00e0 \\(\\Theta(g(n))\\) th\u00ec \\(g(n)\\) l\u00e0 \\(\\Theta(f(n))\\).</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;\\text{N\u1ebfu }f(n) = n\\text{, }g(n) = n^2 \\\\ &amp;\\text{th\u00ec }f(n)\\text{ l\u00e0 }\\Theta(n^2)\\text{ v\u00e0 }g(n)\\text{ l\u00e0 }\\Theta(n^2)\\\\ \\end{align}\\] <p>T\u00ednh ch\u1ea5t n\u00e0y ch\u1ec9 tho\u1ea3 v\u1edbi \\(\\Theta\\).</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/#tinh-chat-chuyen-oi-oi-xung","title":"T\u00ednh ch\u1ea5t chuy\u1ec3n \u0111\u1ed5i \u0111\u1ed1i x\u1ee9ng","text":"<p>N\u1ebfu \\(f(n)\\) l\u00e0 \\(O(g(n))\\) th\u00ec \\(g(n)\\) l\u00e0 \\(\\Omega(f(n))\\).</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;\\text{N\u1ebfu }f(n) = n\\text{, }g(n) = n^2 \\\\ &amp;\\text{th\u00ec }n\\text{ l\u00e0 }O(n^2)\\text{ v\u00e0 }n^2\\text{ l\u00e0 }\\Omega(n)\\\\ \\end{align}\\] <p>T\u00ednh ch\u1ea5t n\u00e0y ch\u1ec9 tho\u1ea3 v\u1edbi \\(O\\) v\u00e0 \\(\\Omega\\).</p>"},{"location":"misc/complexity-analysis/asymptotic-notations/#cac-tinh-chat-khac","title":"C\u00e1c t\u00ednh ch\u1ea5t kh\u00e1c","text":"<ol> <li>N\u1ebfu \\(f(n) = O(g(n))\\) v\u00e0 \\(f(n) = \\Omega(g(n))\\) th\u00ec \\(f(n) = \\Theta(g(n))\\)</li> <li> <p>N\u1ebfu \\(f(n) = O(g(n))\\) v\u00e0 \\(d(n) = O(e(n))\\) th\u00ec \\(f(n) + d(n) = O(max(g(n),e(n)))\\)</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;f(n) = n\\text{ t\u1ee9c l\u00e0 }O(n)\\\\ &amp;d(n) = n^2\\text{ t\u1ee9c l\u00e0 }O(n^2)\\\\ &amp;\\text{th\u00ec }f(n) + d(n) = n + n^2\\text{ t\u1ee9c l\u00e0 }O(n^2)\\\\ \\end{align}\\] </li> <li> <p>N\u1ebfu \\(f(n) = O(g(n))\\) v\u00e0 \\(d(n) = O(e(n))\\) th\u00ec \\(f(n) * d(n) = O(g(n) * e(n))\\)</p> <p>V\u00ed d\u1ee5:</p> \\[\\begin{align} &amp;f(n) = n\\text{ t\u1ee9c l\u00e0 }O(n)\\\\ &amp;d(n) = n^2\\text{ t\u1ee9c l\u00e0 }O(n^2)\\\\ &amp;\\text{th\u00ec }f(n) * d(n) = n * n^2 = n^3\\text{ t\u1ee9c l\u00e0 }O(n^3)\\\\ \\end{align}\\] <p>L\u01b0u \u00fd: n\u1ebfu \\(f(n) = O(g(n))\\) th\u00ec \\(g(n) = \\Omega(f(n))\\)</p> </li> </ol> <p>Ngo\u00e0i ra c\u00f2n 2 lo\u1ea1i k\u00ed hi\u1ec7u n\u1eefa l\u00e0 O nh\u1ecf (little O) v\u00e0 Omega nh\u1ecf (little Omega). Little O cung c\u1ea5p cho ch\u00fang ta m\u1ed9t c\u1eadn tr\u00ean ch\u1eb7t ch\u1ebd h\u01a1n (\u0111i\u1ec1u ki\u1ec7n b\u1eb1ng \u0111\u01b0\u1ee3c b\u1ecf kh\u1ecfi Big O) v\u00e0 Little Omega cung c\u1ea5p cho ch\u00fang ta m\u1ed9t c\u1eadn d\u01b0\u1edbi ch\u1eb7t ch\u1ebd h\u01a1n (\u0111i\u1ec1u ki\u1ec7n b\u1eb1ng \u0111\u01b0\u1ee3c b\u1ecf kh\u1ecfi Big Omega).</p>"},{"location":"misc/complexity-analysis/potential-method/","title":"Ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng","text":""},{"location":"misc/complexity-analysis/potential-method/#phuong-phap-tiem-nang","title":"Ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng","text":""},{"location":"misc/complexity-analysis/potential-method/#nguon","title":"Ngu\u1ed3n","text":"<p> Potential method - Wikipedia</p>"},{"location":"misc/complexity-analysis/potential-method/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>Trong l\u00fd thuy\u1ebft t\u00ednh to\u00e1n \u0111\u1ed9 ph\u1ee9c t\u1ea1p, Ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng l\u00e0 m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p d\u00f9ng \u0111\u1ec3 ph\u00e2n t\u00edch \u0111\u1ed9 ph\u1ee9c t\u1ea1p ph\u00e2n b\u1ed5 (Amortized complexity) v\u1ec1 m\u1eb7t th\u1eddi gian v\u00e0 b\u1ed9 nh\u1edb c\u1ee7a m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u. N\u00f3 c\u0169ng l\u00e0 m\u1ed9t th\u01b0\u1edbc \u0111o hi\u1ec7u su\u1ea5t th\u00f4ng qua m\u1ed9t chu\u1ed7i c\u00e1c thao t\u00e1c \u0111\u1ec3 lo\u1ea1i b\u1ecf chi ph\u00ed c\u1ee7a c\u00e1c thao t\u00e1c kh\u00f4ng th\u01b0\u1eddng xuy\u00ean nh\u01b0ng t\u1ed1n k\u00e9m.</p>"},{"location":"misc/complexity-analysis/potential-method/#inh-nghia-thoi-gian-phan-bo-amortized-time","title":"\u0110\u1ecbnh ngh\u0129a Th\u1eddi gian ph\u00e2n b\u1ed5 (Amortized time)","text":"<p>Trong ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng, m\u1ed9t h\u00e0m \\(\\Phi\\) \u0111\u01b0\u1ee3c ch\u1ecdn \u0111\u1ec3 \u00e1nh x\u1ea1 c\u00e1c tr\u1ea1ng th\u00e1i c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u v\u1edbi c\u00e1c s\u1ed1 kh\u00f4ng \u00e2m. N\u1ebfu \\(S\\) l\u00e0 m\u1ed9t tr\u1ea1ng th\u00e1i c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, \\(\\Phi(S)\\) t\u01b0\u1ee3ng tr\u01b0ng cho l\u01b0\u1ee3ng c\u00f4ng vi\u1ec7c \u0111\u01b0\u1ee3c gi\u1eef (hay \"\u0111\u01b0\u1ee3c tr\u1ea3 ti\u1ec1n\") trong ph\u00e2n t\u00edch ph\u00e2n b\u1ed5 nh\u01b0ng ch\u01b0a \u0111\u01b0\u1ee3c th\u1ef1c thi. V\u00ec v\u1eady, \\(\\Phi(S)\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 vi\u1ec7c t\u00ednh ph\u1ea7n n\u0103ng l\u01b0\u1ee3ng ti\u1ec1m n\u0103ng l\u01b0u trong tr\u1ea1ng th\u00e1i \u0111\u00f3. Gi\u00e1 tr\u1ecb ti\u1ec1m n\u0103ng tr\u01b0\u1edbc khi kh\u1edfi t\u1ea1o c\u1ea5u tr\u00fac d\u1eef li\u1ec7u l\u00e0 \\(0\\). Ngo\u00e0i ra, \\(\\Phi(S)\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c hi\u1ec3u l\u00e0 l\u01b0\u1ee3ng h\u1ed7n lo\u1ea1n trong tr\u1ea1ng th\u00e1i \\(S\\) ho\u1eb7c l\u00e0 kho\u1ea3ng c\u00e1ch c\u1ee7a tr\u1ea1ng th\u00e1i hi\u1ec7n t\u1ea1i \u0111\u1ebfn tr\u1ea1ng th\u00e1i l\u00fd t\u01b0\u1edfng.</p> <p>G\u1ecdi \\(o\\) l\u00e0 b\u1ea5t c\u1ee9 thao t\u00e1c \u0111\u01a1n l\u1ebb n\u00e0o trong m\u1ed9t d\u00e3y c\u00e1c thao t\u00e1c tr\u00ean m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0o \u0111\u00f3, v\u1edbi \\(S_{tr\u01b0\u1edbc}\\) l\u00e0 tr\u1ea1ng th\u00e1i c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u tr\u01b0\u1edbc thao t\u00e1c \\(o\\) n\u00e0y v\u00e0 \\(S_{sau}\\) l\u00e0 tr\u1ea1ng th\u00e1i sau khi thao t\u00e1c \\(o\\) k\u1ebft th\u00fac. M\u1ed9t khi \\(\\Phi\\) \u0111\u01b0\u1ee3c ch\u1ecdn, th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a thao t\u00e1c \\(o\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0:</p> \\[T_{\\text{ph\u00e2n b\u1ed5} }(o) = T_{th\u1ef1c}(o) + C \\times (\\Phi(S_{tr\u01b0\u1edbc}) - \\Phi(S_{sau}))\\] <p>Trong \u0111\u00f3 \\(C\\) l\u00e0 h\u1eb1ng s\u1ed1 t\u1ec9 l\u1ec7 kh\u00f4ng \u00e2m (t\u00ednh theo \u0111\u01a1n v\u1ecb th\u1eddi gian) ph\u1ea3i c\u1ed1 \u0111\u1ecbnh trong su\u1ed1t qu\u00e1 tr\u00ecnh ph\u00e2n t\u00edch. Ngh\u0129a l\u00e0, th\u1eddi gian ph\u00e2n b\u1ed5 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 th\u1eddi gian th\u1ef1c ti\u00eau t\u1ed1n b\u1edfi thao t\u00e1c c\u1ed9ng v\u1edbi \\(C\\) l\u1ea7n ch\u00eanh l\u1ec7ch ti\u1ec1m n\u0103ng t\u1ea1o ra b\u1edfi thao t\u00e1c \u0111\u00f3.</p> <p>Khi nghi\u00ean c\u1ee9u \u0111\u1ed9 ph\u1ee9c t\u1ea1p t\u00ednh to\u00e1n ti\u1ec7m c\u1eadn b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng k\u00fd hi\u1ec7u big O, c\u00e1c y\u1ebfu t\u1ed1 h\u1eb1ng s\u1ed1 kh\u00f4ng li\u00ean quan v\u00e0 do \u0111\u00f3 h\u1eb1ng s\u1ed1 \\(C\\) th\u01b0\u1eddng b\u1ecb b\u1ecf qua.</p>"},{"location":"misc/complexity-analysis/potential-method/#quan-he-giua-thoi-gian-phan-bo-va-thoi-gian-thuc","title":"Quan h\u1ec7 gi\u1eefa th\u1eddi gian ph\u00e2n b\u1ed5 v\u00e0 th\u1eddi gian th\u1ef1c","text":"<p>M\u1eb7c d\u00f9 c\u00f3 v\u1ebb h\u01a1i tr\u1eebu t\u01b0\u1ee3ng, t\u1ed5ng th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a m\u1ed9t chu\u1ed7i thao t\u00e1c cung c\u1ea5p cho ch\u00fang ta m\u1ed9t c\u1eadn tr\u00ean t\u1ed1t so v\u1edbi th\u1eddi gian th\u1ef1c tr\u00ean c\u00f9ng m\u1ed9t nh\u00f3m thao t\u00e1c \u0111\u00f3.</p> <p>V\u1edbi m\u1ecdi chu\u1ed7i thao t\u00e1c \\(O = o_1, o_2, ..., o_n\\), ta \u0111\u1ecbnh ngh\u0129a:</p> <ul> <li>T\u1ed5ng th\u1eddi gian ph\u00e2n b\u1ed5: \\(T_{\\text{ph\u00e2n b\u1ed5} }(O) = \\sum_{i=1}^{n} T_{\\text{ph\u00e2n b\u1ed5} }(o_i)\\)</li> <li>T\u1ed5ng th\u1eddi gian th\u1ef1c: \\(T_{th\u1ef1c}(O) = \\sum_{i=1}^{n} T_{th\u1ef1c}(o_i)\\)</li> </ul> <p>N\u00ean:</p> \\[T_{\\text{ph\u00e2n b\u1ed5} }(O) = \\sum_{i=1}^{n} (T_{th\u1ef1c}(o_i) + C \\times (\\Phi(S_i) - \\Phi(S_{i-1}))) = T_{th\u1ef1c}(O) + C \\times (\\Phi(S_n) - \\Phi(S_0))\\] <p>Trong \u0111\u00f3 d\u00e3y c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a h\u00e0m Ti\u1ec1m n\u0103ng t\u1ea1o ra m\u1ed9t chu\u1ed7i l\u1ed3ng nhau, trong \u0111\u00f3 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 h\u1ea1ng kh\u00f4ng ph\u1ea3i \u0111\u1ea7u ti\u00ean v\u00e0 cu\u1ed1i c\u00f9ng hu\u1ef7 nhau theo c\u1eb7p. Chuy\u1ec3n v\u1ebf ta c\u00f3:</p> \\[T_{th\u1ef1c}(O) = T_{\\text{ph\u00e2n b\u1ed5} }(O) - C \\times (\\Phi(S_n) - \\Phi(S_0))\\] <p>Do \\(\\Phi(S_0) = 0\\) v\u00e0 \\(\\Phi(S_n) \\geq 0\\), \\(T_{th\u1ef1c}(O) \\leq T_{\\text{ph\u00e2n b\u1ed5} }(O)\\), n\u00ean th\u1eddi gian ph\u00e2n b\u1ed5 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 t\u00ednh c\u1eadn tr\u00ean c\u1ee7a th\u1eddi gian th\u1ef1c tr\u00ean m\u1ed9t d\u00e3y c\u00e1c thao t\u00e1c, ngay c\u1ea3 khi th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a m\u1ed9t thao t\u00e1c n\u00e0o \u0111\u00f3 c\u00f3 bi\u00ean \u0111\u1ed9 l\u1edbn so v\u1edbi th\u1eddi gian th\u1ef1c.</p>"},{"location":"misc/complexity-analysis/potential-method/#phan-tich-phan-bo-trong-truong-hop-xau-nhat","title":"Ph\u00e2n t\u00edch Ph\u00e2n b\u1ed5 trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t","text":"<p>Th\u00f4ng th\u01b0\u1eddng, ph\u00e2n t\u00edch ph\u00e2n b\u1ed5 \u0111\u01b0\u1ee3c d\u00f9ng k\u1ebft h\u1ee3p v\u1edbi tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t c\u1ee7a \u0111\u1ea7u v\u00e0o. V\u1edbi tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t n\u00e0y, n\u1ebfu \\(X\\) l\u00e0 lo\u1ea1i thao t\u00e1c \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\u1ea5u tr\u00fac d\u1eef li\u1ec7u, v\u00e0 s\u1ed1 nguy\u00ean \\(n\\) l\u00e0 k\u00edch th\u01b0\u1edbc c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c cho (v\u00ed d\u1ee5 nh\u01b0 n\u00f3 ch\u1ee9a bao nhi\u00eau bi\u1ebfn ch\u1eb3ng h\u1ea1n), th\u00ec th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a c\u00e1c thao t\u00e1c lo\u1ea1i \\(X\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0 th\u1eddi gian ph\u00e2n b\u1ed5 l\u1edbn nh\u1ea5t trong t\u1ea5t c\u1ea3 c\u00e1c d\u00e3y thao t\u00e1c c\u00f3 th\u1ec3 c\u00f3 tr\u00ean c\u1ea5u tr\u00fac d\u1eef li\u1ec7u k\u00edch th\u01b0\u1edbc \\(n\\), ch\u1ec9 t\u00ednh c\u00e1c thao t\u00e1c \\(o_i\\) lo\u1ea1i \\(X\\) trong nh\u00f3m.</p> <p>V\u1edbi \u0111\u1ecbnh ngh\u0129a n\u00e0y, th\u1eddi gian \u0111\u1ec3 th\u1ef1c hi\u1ec7n d\u00e3y thao t\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u01b0\u1edbc l\u01b0\u1ee3ng b\u1eb1ng c\u00e1ch nh\u00e2n th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a m\u1ed7i lo\u1ea1i thao t\u00e1c trong d\u00e3y v\u1edbi s\u1ed1 thao t\u00e1c c\u1ee7a lo\u1ea1i thao t\u00e1c \u0111\u00f3.</p>"},{"location":"misc/complexity-analysis/potential-method/#cac-vi-du","title":"C\u00e1c v\u00ed d\u1ee5","text":""},{"location":"misc/complexity-analysis/potential-method/#mang-ong","title":"M\u1ea3ng \u0111\u1ed9ng","text":"<p>M\u1ea3ng \u0111\u1ed9ng l\u00e0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u d\u00f9ng \u0111\u1ec3 duy tr\u00ec m\u1ed9t d\u00e3y c\u00e1c ph\u1ea7n t\u1eed, cho ph\u00e9p truy c\u1eadp nh\u1edd v\u00e0o v\u1ecb tr\u00ed trong m\u1ea3ng v\u00e0 kh\u1ea3 n\u0103ng t\u0103ng gi\u1edbi h\u1ea1n m\u1ea3ng l\u00ean 1. Trong Java n\u00f3 l\u00e0 ArrayList c\u00f2n trong Python n\u00f3 l\u00e0 list.</p> <p>M\u1ea3ng \u0111\u1ed9ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i nh\u01b0 m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u g\u1ed3m m\u1ed9t m\u1ea3ng \\(A\\) c\u00e1c ph\u1ea7n t\u1eed, c\u00f3 \u0111\u1ed9 d\u00e0i \\(N\\) n\u00e0o \u0111\u00f3, v\u1edbi m\u1ed9t s\u1ed1 \\(n \\leq N\\) l\u00e0 c\u00e1c v\u1ecb tr\u00ed trong m\u1ea3ng ch\u00fang ta \u0111\u00e3 d\u00f9ng. V\u1edbi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u nh\u01b0 th\u1ebf n\u00e0y, vi\u1ec7c truy c\u1eadp v\u00e0o m\u1ea3ng \u0111\u1ed9ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i b\u1eb1ng c\u00e1ch truy c\u1eadp v\u00e0o c\u00f9ng \u00f4 nh\u1edb trong m\u1ea3ng \\(A\\) \u0111\u00f3, v\u00e0 khi \\(n &lt; N\\), thao t\u00e1c t\u0103ng size c\u1ee7a m\u1ea3ng \u0111\u1ed9ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u00e0i b\u1eb1ng c\u00e1ch t\u0103ng n l\u00ean. Tuy nhi\u00ean, khi \\(n=N\\), ta c\u1ea7n resize l\u1ea1i \\(A\\), m\u1ed9t c\u00e1ch ph\u1ed5 bi\u1ebfn l\u00e0 t\u0103ng g\u1ea5p \u0111\u00f4i size c\u1ee7a n\u00f3, thay \\(A\\) b\u1eb1ng m\u1ed9t m\u1ea3ng c\u00f3 \u0111\u1ed9 d\u00e0i \\(2n\\).</p> <p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n t\u00edch nh\u1edd h\u00e0m Ti\u1ec1m n\u0103ng sau:</p> \\[\\Phi = 2n - N\\] <p>V\u00ec vi\u1ec7c resize n\u00e0y l\u00e0m cho \\(A\\) lu\u00f4n c\u00f3 s\u1ed1 ph\u1ea7n t\u1eed l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng n\u1eeda k\u00edch th\u01b0\u1edbc, n\u00ean h\u00e0m ti\u1ec1m n\u0103ng lu\u00f4n kh\u00f4ng \u00e2m.</p> <p>Thao t\u00e1c t\u0103ng k\u00edch th\u01b0\u1edbc m\u1ea3ng kh\u00f4ng ph\u1ea3i l\u00fac n\u00e0o c\u0169ng d\u1eabn \u0111\u1ebfn vi\u1ec7c resize, \\(\\Phi\\) t\u0103ng l\u00ean 2, m\u1ed9t h\u1eb1ng s\u1ed1. V\u00ec v\u1eady, th\u1eddi gian th\u1ef1c c\u1ee7a thao t\u00e1c v\u00e0 th\u1eddi gian t\u0103ng l\u00ean ti\u1ec1m n\u0103ng k\u1ebft h\u1ee3p l\u1ea1i \u0111\u1ec3 t\u1ea1o ra th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a thao t\u00e1c lo\u1ea1i n\u00e0y.</p> <p>Tuy nhi\u00ean, n\u1ebfu vi\u1ec7c t\u0103ng k\u00edch th\u01b0\u1edbc d\u1eabn \u0111\u1ebfn resize m\u1ea3ng, \\(\\Phi\\) gi\u1ea3m v\u1ec1 \\(0\\) sau khi resize. T\u1ea1o m\u1ea3ng m\u1edbi \\(A\\) v\u00e0 sao ch\u00e9p t\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u0169 c\u1ee7a v\u00e0o m\u1ea3ng m\u1edbi n\u00e0y t\u00f4n \\(O(n)\\) th\u1eddi gian th\u1ef1c, nh\u01b0ng (v\u1edbi h\u1eb1ng s\u1ed1 t\u1ec9 l\u1ec7 \\(C\\) t\u1ed1t) c\u00e1i n\u00e0y b\u1ecb ti\u00eau hu\u1ef7 b\u1edbi vi\u1ec7c gi\u1ea3m h\u00e0m ti\u1ec1m n\u0103ng, tr\u1ea3 v\u1ec1 m\u1ed9t t\u1ed5ng th\u1eddi gian ph\u00e2n b\u1ed5 l\u00e0 h\u1eb1ng s\u1ed1 cho thao t\u00e1c n\u00e0y.</p> <p>Nh\u1eefng thao t\u00e1c kh\u00e1c c\u1ee7a c\u1ea5u tr\u00fac d\u1eef li\u1ec7u (\u0111\u1ecdc ghi m\u1ea3ng m\u00e0 kh\u00f4ng thay \u0111\u1ed5i k\u00edch th\u01b0\u1edbc) kh\u00f4ng t\u1ea1o ra thay \u0111\u1ed5i cho h\u00e0m ti\u1ec1m n\u0103ng v\u00e0 c\u00f3 c\u00f9ng th\u1eddi gian ph\u00e2n b\u1ed5 h\u1eb1ng s\u1ed1 nh\u01b0 th\u1eddi gian th\u1ef1c.</p> <p>V\u00ec v\u1eady, v\u1edbi vi\u1ec7c resize nh\u01b0 th\u1ebf n\u00e0y c\u1ed9ng v\u1edbi h\u00e0m ti\u1ec1m n\u0103ng, ph\u01b0\u01a1ng ph\u00e1p ti\u1ec1m n\u0103ng cho th\u1ea5y r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c tr\u00ean m\u1ea3ng \u0111\u1ed9ng t\u1ed1n th\u1eddi gian ph\u00e2n b\u1ed5 h\u1eb1ng s\u1ed1. K\u1ebft h\u1ee3p \u0111i\u1ec1u n\u00e0y v\u1edbi b\u1ea5t \u0111\u1eb3ng th\u1ee9c gi\u1eefa th\u1eddi gian ph\u00e2n b\u1ed5 v\u00e0 th\u1eddi gian th\u1ef1c tr\u00ean d\u00e3y c\u00e1c thao t\u00e1c, \u0111i\u1ec1u n\u00e0y cho th\u1ea5y r\u1eb1ng b\u1ea5t k\u1ef3 d\u00e3y \\(n\\) thao t\u00e1c tr\u00ean m\u1ea3ng \u0111\u1ed9ng t\u1ed1n \\(O(n)\\) th\u1eddi gian th\u1ef1c trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t, d\u00f9 cho m\u1ed9t s\u1ed1 thao t\u00e1c \u0111\u01a1n l\u1ebb c\u00f3 th\u1ec3 ti\u00eau t\u1ed1n h\u01a1n th\u1eddi gian tuy\u1ebfn t\u00ednh.</p> <p>Khi m\u1ea3ng \u0111\u1ed9ng ch\u1ee9a c\u00e1c thao t\u00e1c gi\u1ea3m k\u00edch th\u01b0\u1edbc m\u1ea3ng c\u0169ng nh\u01b0 t\u0103ng k\u00edch th\u01b0\u1edbc, h\u00e0m ti\u1ec1m n\u0103ng c\u0169ng ph\u1ea3i \u0111\u01b0\u1ee3c thay \u0111\u1ed5i \u0111\u1ec3 tr\u00e1nh vi\u1ec7c h\u00e0m b\u1ecb \u00e2m. M\u1ed9t c\u00e1ch \u0111\u1ec3 l\u00e0m \u0111\u00f3 l\u00e0 th\u00eam tr\u1ecb tuy\u1ec7t \u0111\u1ed1i v\u00e0o h\u00e0m ti\u1ec1m n\u0103ng \u1edf tr\u00ean.</p>"},{"location":"misc/complexity-analysis/potential-method/#multi-pop-stack","title":"Multi-Pop Stack","text":"<p>Cho m\u1ed9t stack h\u1ed7 tr\u1ee3 c\u00e1c thao t\u00e1c sau:</p> <ul> <li>\\(Init\\): t\u1ea1o m\u1ed9t stack r\u1ed7ng.</li> <li>\\(Push\\): th\u00eam m\u1ed9t ph\u1ea7n t\u1eed l\u00ean \u0111\u1ec9nh stack, t\u0103ng size c\u1ee7a n\u00f3 l\u00ean 1.</li> <li>\\(Pop(k)\\): xo\u00e1 \\(k\\) ph\u1ea7n t\u1eed t\u1eeb \u0111\u1ec9nh stack, trong \u0111\u00f3 \\(k\\) kh\u00f4ng l\u1edbn h\u01a1n s\u1ed1 ph\u1ea7n t\u1eed hi\u1ec7n th\u1eddi c\u1ee7a stack.</li> </ul> <p>\\(Pop(k)\\) t\u1ed1n \\(O(k)\\) th\u1eddi gian, nh\u01b0ng ta c\u00f3 th\u1ec3 ch\u1ee9ng minh \u0111\u01b0\u1ee3c t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c t\u1ed1n \\(O(1)\\) th\u1eddi gian ph\u00e2n b\u1ed5.</p> <p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n t\u00edch nh\u1edd h\u00e0m Ti\u1ec1m n\u0103ng sau:</p> \\[\\Phi = \\text{s\u1ed1 ph\u1ea7n t\u1eed trong stack}\\] <p>R\u00f5 r\u00e0ng s\u1ed1 ph\u1ea7n t\u1eed th\u00ec lu\u00f4n kh\u00f4ng \u00e2m.</p> <p>M\u1ed9t thao t\u00e1c \\(Push\\) t\u1ed1n \\(O(1)\\) v\u00e0 t\u0103ng \\(\\Phi\\) l\u00ean \\(1\\), n\u00ean th\u1eddi gian ph\u00e2n b\u1ed5 l\u00e0 h\u1eb1ng s\u1ed1.</p> <p>M\u1ed9t thao t\u00e1c \\(Pop\\) t\u1ed1n \\(O(k)\\) v\u00e0 gi\u1ea3m \\(\\Phi\\) \u0111i \\(k\\), n\u00ean th\u1eddi gian ph\u00e2n b\u1ed5 c\u0169ng l\u00e0 h\u1eb1ng s\u1ed1.</p> <p>\u0110i\u1ec1u n\u00e0y ch\u1ee9ng t\u1ecf b\u1ea5t k\u00ec chu\u1ed7i \\(m\\) thao t\u00e1c n\u00e0o c\u0169ng t\u1ed5n \\(O(m)\\) th\u1eddi gian trong tr\u01b0\u1eddng h\u1ee3p x\u1ea5u nh\u1ea5t.</p>"},{"location":"misc/complexity-analysis/potential-method/#bo-em-nhi-phan","title":"B\u1ed9 \u0111\u1ebfm nh\u1ecb ph\u00e2n","text":"<p>X\u00e9t m\u1ed9t b\u1ed9 \u0111\u1ebfm d\u00f9ng s\u1ed1 nh\u1ecb ph\u00e2n v\u1edbi c\u00e1c thao t\u00e1c nh\u01b0 sau:</p> <ul> <li>\\(Init\\): t\u1ea1o b\u1ed9 \u0111\u1ebfm v\u1edbi gi\u00e1 tr\u1ecb l\u00e0 \\(0\\).</li> <li>\\(Inc\\): th\u00eam \\(1\\) v\u00e0o gi\u00e1 tr\u1ecb c\u1ee7a b\u1ed9 \u0111\u1ebfm.</li> <li>\\(Read\\): tr\u1ea3 v\u1ec1 gi\u00e1 tr\u1ecb hi\u1ec7n th\u1eddi c\u1ee7a b\u1ed9 \u0111\u1ebfm.</li> </ul> <p>Trong v\u00ed d\u1ee5 n\u00e0y ta coi vi\u1ec7c t\u0103ng gi\u00e1 tr\u1ecb t\u1ed1n 1 \u0111\u01a1n v\u1ecb th\u1eddi gian cho m\u1ed7i thao t\u00e1c bit. Ta mu\u1ed1n ch\u1ee9ng minh l\u00e0 thao t\u00e1c \\(Inc\\) t\u1ed1n \\(O(1)\\) th\u1eddi gian ph\u00e2n b\u1ed5.</p> <p>C\u1ea5u tr\u00fac d\u1eef li\u1ec7u n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c ph\u00e2n t\u00edch nh\u1edd h\u00e0m Ti\u1ec1m n\u0103ng sau:</p> \\[\\Phi = \\text{s\u1ed1 bit 1 c\u1ee7a gi\u00e1 tr\u1ecb b\u1ed9 \u0111\u1ebfm} = \\text{kho\u1ea3ng-c\u00e1ch-hamming}(\\text{b\u1ed9 \u0111\u1ebfm})\\] <p>R\u00f5 r\u00e0ng s\u1ed1 ph\u1ea7n t\u1eed th\u00ec lu\u00f4n kh\u00f4ng \u00e2m.</p> <p>M\u1ed9t thao t\u00e1c \\(Inc\\) \u0111\u1ea3o bit \u0111\u1ea7u ti\u00ean (bit b\u00ean ph\u1ea3i ngo\u00e0i c\u00f9ng). Sau \u0111\u00f3, n\u1ebfu bit \u0111\u1ea7u ti\u00ean b\u1ecb \u0111\u1ea3o t\u1eeb \\(1\\) v\u1ec1 \\(0\\), bit ti\u1ebfp theo c\u0169ng ph\u1ea3i b\u1ecb \u0111\u1ea3o. Vi\u1ec7c n\u00e0y ti\u1ebfp t\u1ee5c \u0111\u1ebfn khi m\u1ed9t bit \u0111\u01b0\u1ee3c \u0111\u1ea3o t\u1eeb \\(0\\) sang \\(1\\). \u0110\u1ebfn \u0111\u00e2y th\u00ec n\u00f3 d\u1eebng \u0111\u1ea3o. N\u1ebfu gi\u00e1 tr\u1ecb ban \u0111\u1ea7u c\u00f3 \\(k\\) bit \\(1\\) th\u00ec ta \u0111\u1ea3o t\u1ed5ng c\u1ed9ng \\(k+1\\) bit, v\u1edbi th\u1eddi gian th\u1ef1c l\u00e0 \\(k+1\\), tr\u1eeb \u0111i ph\u1ea7n Ti\u1ec1m n\u0103ng l\u00e0 \\(k-1\\) (tr\u01b0\u1edbc thao t\u00e1c ta c\u00f3 \\(k\\) bit \\(1\\), sau thao t\u00e1c ta c\u00f3 \\(1\\) bit \\(1\\), n\u00ean \\(\\Phi(S_{tr\u01b0\u1edbc}) - \\Phi(S_{sau}) = k - 1\\)), th\u00ec th\u1eddi gian ph\u00e2n b\u1ed5 l\u00e0 \\(2\\). V\u1eady th\u1eddi gian th\u1ef1c \u0111\u1ec3 ch\u1ea1y \\(m\\) thao t\u00e1c l\u00e0 \\(O(m)\\).</p>"},{"location":"misc/complexity-analysis/potential-method/#ung-dung","title":"\u1ee8ng d\u1ee5ng","text":"<p>H\u00e0m Ti\u1ec1m n\u0103ng th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed dung \u0111\u1ec3 ph\u00e2n t\u00edch Fibonacci Heap, m\u1ed9t lo\u1ea1i h\u00e0ng ch\u1edd \u01b0u ti\u00ean (priority queue) cho ph\u00e9p xo\u00e1 ph\u1ea7n t\u1eed v\u1edbi th\u1eddi gian ph\u00e2n b\u1ed5 l\u00e0 \\(log\\), v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c thao t\u00e1c kh\u00e1c v\u1edbi th\u1eddi gian ph\u00e2n b\u1ed5 l\u00e0 h\u1eb1ng s\u1ed1. N\u00f3 c\u0169ng \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 ph\u00e2n t\u00edch Splay Tree, m\u1ed9t lo\u1ea1i c\u00e2y nh\u1ecb ph\u00e2n t\u00ecm ki\u1ebfm t\u1ef1 bi\u1ebfn \u0111\u1ed5i v\u1edbi th\u1eddi gian ph\u00e2n b\u1ed5 c\u1ee7a m\u1ed7i thao t\u00e1c l\u00e0 \\(log\\).</p>"},{"location":"misc/data-structures/splay-tree/","title":"Splay Tree: M\u1ed9t m\u00ecnh anh ch\u1ea5p h\u1ebft","text":""},{"location":"misc/data-structures/splay-tree/#splay-tree-mot-minh-anh-chap-het","title":"Splay Tree: M\u1ed9t m\u00ecnh anh ch\u1ea5p h\u1ebft","text":""},{"location":"misc/data-structures/splay-tree/#nguon","title":"Ngu\u1ed3n","text":"<p>Splay Tree: One Tree to Rule Them All - zhtluo.com</p>"},{"location":"misc/data-structures/splay-tree/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>B\u1ea1n c\u00f3 s\u1ee3 c\u00e1c b\u00e0i d\u00f9ng Fenwick Tree, RMQ, Segment Tree trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u kh\u00f4ng?</p> <p>B\u1ea1n c\u00f3 s\u1ee3 c\u00e0i \u0111\u1eb7t c\u00e1c b\u00e0i t\u00ecm gi\u00e1 tr\u1ecb nh\u1ecf nh\u1ea5t, l\u1edbn nh\u1ea5t hay t\u1ed5ng \u0111o\u1ea1n, m\u00e0 trong \u0111\u00f3 y\u00eau c\u1ea7u c\u1eadp nh\u1eadt gi\u00e1 tr\u1ecb kh\u00f4ng?</p> <p>Kh\u00f4ng c\u1ea7n ph\u1ea3i s\u1ee3 n\u1eefa. Trong b\u00e0i n\u00e0y t\u00f4i s\u1ebd gi\u1edbi thi\u1ec7u cho c\u00e1c b\u1ea1n m\u1ed9t c\u1ea5u tr\u00fac d\u1eef li\u1ec7u (CTDL) c\u00f3 th\u1ec3 gi\u1ea3i \u0111\u01b0\u1ee3c c\u00e1c d\u1ea1ng b\u00e0i n\u00e0y - Splay Tree. M\u1ed9t m\u00ecnh anh ch\u1ea5p h\u1ebfttttttttttt!</p> <p>L\u01b0u \u00fd: M\u1ed9t nh\u01b0\u1ee3c \u0111i\u1ec3m c\u1ee7a Splay Tree l\u00e0 vi\u1ec7c n\u00f3 c\u00f3 h\u1eb1ng s\u1ed1 trong \u0111\u1ed9 ph\u1ee9c t\u1ea1p l\u1edbn m\u1eb7c d\u00f9 n\u00f3 \u0111\u01b0\u1ee3c kh\u1ea5u hao v\u1ec1 \\(O(\\log n)\\). D\u00f9ng CTDL n\u00e0y tr\u00ean c\u00e1c b\u00e0i c\u00f3 limit nh\u1ecf s\u1ebd c\u00f3 nguy c\u01a1 TLE r\u1ea5t l\u1edbn (b\u1ea1n ho\u00e0n to\u00e0n c\u00f3 th\u1ec3 d\u00f9ng c\u00e1c CTDL \u00edt t\u1ed1n k\u00e9m h\u01a1n n\u1ebfu \u0111\u00f3 l\u00e0 v\u1ea5n \u0111\u1ec1).</p> <p>L\u01b0u \u00fd t\u1eeb farmerboy: M\u00ecnh \u0111\u00e3 c\u1ed1 g\u1eafng c\u00e0i \u0111\u1eb7t l\u1ea1i c\u00e1c code trong b\u00e0i g\u1ed1c theo m\u1ed9t c\u00e1ch d\u1ec5 hi\u1ec3u h\u01a1n v\u1edbi ph\u1ea7n comment b\u1eb1ng ti\u1ebfng Vi\u1ec7t.</p>"},{"location":"misc/data-structures/splay-tree/#tao-cay-tu-mang","title":"T\u1ea1o c\u00e2y t\u1eeb m\u1ea3ng","text":"<p>C\u00e1ch d\u1ec5 nh\u1ea5t \u0111\u1ec3 l\u01b0u tr\u1eef m\u1ed9t d\u00e3y d\u1eef li\u1ec7u: \\((1, 2, 4, 5, 6)\\) l\u00e0 cho ch\u00fang v\u00e0o m\u1ed9t c\u00e1i m\u1ea3ng. M\u1ea3ng r\u1ea5t \u0111\u01a1n gi\u1ea3n v\u00e0 l\u00e0 m\u1ed9t CTDL t\u1ed1t \u0111\u1ec3 t\u00ecm c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a m\u1ea3ng trong th\u1eddi gian \\(O(1)\\) t\u1eeb v\u1ecb tr\u00ed c\u1ee7a ch\u00fang.</p> <p>Tuy nhi\u00ean, v\u1ea5n \u0111\u1ec1 x\u1ea3y ra khi ta mu\u1ed1n ch\u00e8n th\u00eam v\u00e0o d\u00e3y n\u00e0y. V\u00ed d\u1ee5 ch\u00e8n \\(3\\) v\u00e0o gi\u1eefa \\(2\\) v\u00e0 \\(4\\). Kh\u00f4ng c\u00f3 c\u00e1ch n\u00e0o t\u1ed1t \u0111\u1ec3 th\u1ef1c hi\u1ec7n \u0111i\u1ec1u n\u00e0y ngo\u00e0i vi\u1ec7c di chuy\u1ec3n c\u00e1c ph\u1ea7n t\u1eed sau \\(3\\) (t\u1ee9c l\u00e0 \\(4\\), \\(5\\), \\(6\\)). Ta s\u1ebd t\u1ed1n \\(O(n)\\) th\u1eddi gian cho \\(n\\) ph\u1ea7n t\u1eed.</p> <p>Ch\u1eafc h\u1eb3n c\u00e1c b\u1ea1n \u0111\u00e3 bi\u1ebft r\u1eb1ng danh s\u00e1ch li\u00ean k\u1ebft (DSLK) c\u00f3 th\u1ec3 \u0111\u1ea3o l\u1ea1i \u0111\u01b0\u1ee3c: n\u00f3 c\u00f3 th\u1ec3 th\u00eam ph\u1ea7n t\u1eed trong \\(O(1)\\) nh\u01b0ng l\u1ea5y ph\u1ea7n t\u1eed ra th\u00ec l\u1ea1i t\u1ed1n \\(O(n)\\). C\u0169ng v\u1eabn kh\u00f4ng \u1ed5n, c\u00f2n c\u00e2y nh\u1ecb ph\u00e2n th\u00ec sao nh\u1ec9?</p> <p>\u0110\u1ea7u ti\u00ean, ta c\u1ea7n ph\u1ea3i thi\u1ebft l\u1eadp m\u1ed1i t\u01b0\u01a1ng quan gi\u1eefa 1 c\u00e1i c\u00e2y nh\u1ecb ph\u00e2n v\u00e0 1 d\u00e3y. Ta th\u1eed c\u00e1ch d\u1ec5 tr\u01b0\u1edbc: gi\u1ea3 s\u1eed t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed n\u1eb1m \u1edf c\u00e2y con tr\u00e1i th\u00ec n\u1eb1m tr\u01b0\u1edbc ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i trong d\u00e3y, v\u00e0 t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed n\u1eb1m \u1edf c\u00e2y con ph\u1ea3i th\u00ec n\u1eb1m b\u00ean ph\u1ea3i ph\u1ea7n t\u1eed hi\u1ec7n t\u1ea1i trong d\u00e3y. \u0110\u1ec3 \u00fd l\u00e0 \u0111\u1ecbnh ngh\u0129a n\u00e0y t\u1ea1o ra m\u1ed9t d\u00e3y duy nh\u1ea5t t\u1eeb 1 c\u00e2y nh\u1ecb ph\u00e2n (th\u1ee9 t\u1ef1 in-order, n\u1ebfu b\u1ea1n \u0111\u00e3 bi\u1ebft). V\u00ed d\u1ee5 d\u00e3y \u1edf tr\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u1ea1o t\u1eeb c\u00e2y nh\u1ecb ph\u00e2n nh\u01b0 sau:</p> <p></p> <p>\u0110\u1ebfn \u0111\u00e2y vi\u1ec7c c\u00e0i \u0111\u1eb7t \u0111\u1ec3 t\u00ecm ph\u1ea7n t\u1eed th\u1ee9 \\(i\\) v\u00e0 th\u00eam ph\u1ea7n t\u1eed v\u00e0o CTDL r\u1ea5t d\u1ec5 d\u00e0ng.</p> <pre><code>struct Node {\n    // node cha\n    Node *parent;\n    // c\u00e1c node con\n    Node *children[2];\n    // s\u1ed1 node trong c\u00e2y v\u00e0 value c\u1ee7a node\n    int size, value;\n    Node(int value) {\n        this-&gt;value = value;\n    }\n\n    // t\u00ednh l\u1ea1i s\u1ed1 node tr\u00ean c\u00e2y\n    void update() {\n        size = 1;\n        for (int i = 0; i &lt; 2; i++) {\n            if (children[i]) {\n                size += children[i]-&gt;size;\n            }\n        }\n    }\n};\n\nNode *root;\n\n// - h\u00e0m walk n\u00e0y d\u00f9ng \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh ta c\u1ea7n \u0111i xu\u1ed1ng d\u01b0\u1edbi \n// node con theo h\u01b0\u1edbng n\u00e0o v\u00e0 update pos\n// - dir: h\u01b0\u1edbng. 0 - tr\u00e1i, 1 - ph\u1ea3i\n// - pos: ta c\u1ea7n t\u00ecm node th\u1ee9 \"pos\" c\u1ee7a c\u00e2y g\u1ed1c \"node\"\n// (node th\u1ee9 0 l\u00e0 node \u0111\u1ea7u ti\u00ean)\n// - tr\u1ea3 v\u1ec1 s\u1ed1 node tr\u00ean c\u00e2y con tr\u00e1i c\u1ee7a c\u00e2y g\u1ed1c \"node\"\nint walk(Node *node, int &amp;dir, int &amp;pos) {\n    int leftSize = node-&gt;children[0] ? node-&gt;children[0]-&gt;size : 0;\n    // c\u00e1c v\u1ecb tr\u00ed t\u1eeb 0 \u0111\u1ebfn leftSize s\u1ebd n\u1eb1m b\u00ean tr\u00e1i\n    // c\u00f2n l\u1ea1i ch\u1eafc ch\u1eafn n\u1eb1m b\u00ean ph\u1ea3i\n    dir = (leftSize &lt; pos);\n    if (dir) {\n        // n\u1ebfu n\u1eb1m b\u00ean ph\u1ea3i ta c\u1eadp nh\u1eadt l\u1ea1i pos ngay l\u1eadp t\u1ee9c\n        pos -= leftSize + 1;\n    }\n    return leftSize;\n}\n\n// t\u00ecm node th\u1ee9 \"pos\" tr\u00ean c\u00e2y g\u1ed1c \"root\"\n// (node th\u1ee9 0 l\u00e0 node \u0111\u1ea7u ti\u00ean)\nNode* find(int pos) {\n    Node *cur = root;\n    int dir;\n    // n\u1ebfu dir == 1, ta c\u1ea7n \u0111i qua ph\u1ea3i\n    // ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu pos &lt; leftSize th\u00ec ta n\u00ean sang tr\u00e1i\n    // ng\u01b0\u1ee3c l\u1ea1i, pos == leftSize, ch\u00ednh node cur l\u00e0 node c\u1ea7n t\u00ecm\n    while (pos &lt; walk(cur, dir, pos) || dir) {\n        cur = cur-&gt;children[dir];\n    }\n    return cur;\n}\n\n// ch\u00e8n node v\u00e0o v\u1ecb tr\u00ed th\u1ee9 \"pos\" tr\u00ean c\u00e2y g\u1ed1c \"root\"\n// (node th\u1ee9 0 l\u00e0 node \u0111\u1ea7u ti\u00ean)\nvoid insert(Node *node, int pos) {\n    Node *cur = root;\n    int dir;\n    while (1) {\n        // ta t\u00ecm h\u01b0\u1edbng tr\u01b0\u1edbc b\u1eb1ng h\u00e0m walk \u0111\u1ec3 c\u1eadp nh\u1eadt dir v\u00e0 pos\n        // sau \u0111\u00f3 \u0111i xu\u1ed1ng n\u1ebfu v\u1eabn \u0111i \u0111\u01b0\u1ee3c\n        walk(cur, dir, pos);\n        if (!cur-&gt;children[dir]) {\n            break;\n        }\n        cur = cur-&gt;children[dir];\n    }\n\n    // th\u00eam node\n    cur-&gt;children[dir] = node;\n    node-&gt;parent = cur;\n\n    // c\u1eadp nh\u1eadt size\n    while (node) {\n        node-&gt;update();\n        node = node-&gt;parent;\n    }\n}\n</code></pre> <p>Gi\u1edd ch\u00fang ta x\u00e9t \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thu\u1eadt to\u00e1n n\u00e0y. Ta c\u00f3 th\u1ec3 suy lu\u1eadn ra \u0111\u01b0\u1ee3c \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a b\u1ea5t k\u1ef3 thao t\u00e1c n\u00e0o \u1edf tr\u00ean l\u00e0 chi\u1ec1u cao c\u00e2y \\(O(h)\\), v\u00e0 m\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n c\u00f3 th\u1ec3 l\u01b0u \\(n\\) ph\u1ea7n t\u1eed v\u1edbi chi\u1ec1u cao t\u1ed1i thi\u1ec3u l\u00e0 \\(\\text{log n}\\). V\u00ec v\u1eady ta c\u00f3 th\u1ec3 l\u00e0m cho \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a thao t\u00e1c T\u00ecm v\u00e0 Ch\u00e8n th\u00e0nh \\(O(\\log n)\\).</p> <p>Tuy nhi\u00ean, d\u00f9ng m\u1ed9t c\u00e2y \u0111\u01a1n gi\u1ea3n nh\u01b0 tr\u00ean \u0111\u1ec3 gi\u1ea3i l\u00e0 \u0111i\u1ec1u kh\u00f4ng d\u1ec5 d\u00e0ng. M\u1ed9t c\u00e2y nh\u1ecb ph\u00e2n c\u00f3 th\u1ec3 tr\u1edf th\u00e0nh m\u1ed9t \"c\u00e2y g\u1eady\" n\u1ebfu ta kh\u00f4ng \u0111\u1ec3 \u00fd. X\u00e9t c\u00e2y nh\u01b0 sau, c\u00e2y n\u00e0y c\u0169ng c\u00f3 th\u1ec3 bi\u1ec3u th\u1ecb d\u00e3y ban \u0111\u1ea7u:</p> <p></p> <p>C\u00e2y g\u1eady n\u00e0y c\u00f3 chi\u1ec1u cao \\(n\\), l\u00e0m cho gi\u1ea3 thi\u1ebft v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a ch\u00fang ta kh\u00f4ng th\u00e0nh hi\u1ec7n th\u1ef1c. V\u00ec v\u1eady, ta c\u1ea7n m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3 \u0111\u1ec3 duy tr\u00ec chi\u1ec1u cao c\u00e2y l\u00e0 \\(O(\\log n)\\) \u0111\u1ec3 gi\u1eef \u0111\u1ed9 ph\u1ee9c t\u1ea1p nh\u01b0 l\u00fd thuy\u1ebft. Vi\u1ec7c n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e2n b\u1eb1ng c\u00e2y, v\u00e0 c\u00f3 nhi\u1ec1u c\u00e1ch \u0111\u1ec3 l\u00e0m nh\u01b0 AVL, Red-Black Tree, Scapegoat Tree... Tuy nhi\u00ean, ch\u00fang ta s\u1ebd t\u00ecm hi\u1ec3u m\u1ed9t lo\u1ea1i c\u00e2y c\u00f3 th\u1ec3 kh\u00f4ng ch\u1ec9 t\u1ef1 c\u00e2n b\u1eb1ng, m\u00e0 c\u00f2n duy tr\u00ec \u0111\u01b0\u1ee3c c\u00e1c th\u00f4ng tin b\u1ed5 tr\u1ee3 \u0111\u1ec3 gi\u00fap ta t\u00ecm \u0111\u01b0\u1ee3c nh\u1eefng th\u00f4ng tin kh\u00f3 ch\u1ecbu nh\u01b0 t\u1ed5ng \u0111o\u1ea1n - Splay Tree!</p>"},{"location":"misc/data-structures/splay-tree/#can-bang-cay","title":"C\u00e2n b\u1eb1ng c\u00e2y","text":""},{"location":"misc/data-structures/splay-tree/#xoay","title":"Xoay","text":"<p>\u0110\u1ec3 c\u00e2n b\u1eb1ng c\u00e2y nh\u1ecb ph\u00e2n, ta c\u1ea7n m\u1ed9t thao t\u00e1c n\u00e0o \u0111\u00f3. M\u1ed9t thao t\u00e1c ph\u1ed5 bi\u1ebfn l\u00e0 ph\u00e9p xoay c\u00e2y</p> <p></p> <p>Node \\(n\\) v\u00e0 \\(p\\) l\u00e0 2 node m\u00e0 ta c\u1ea7n ch\u00fa \u00fd, v\u00e0 \\(A\\), \\(B\\), \\(C\\) l\u00e0 3 c\u00e2y con c\u1ee7a c\u00e1c node n\u00e0y. \u0110\u1ec3 \u00fd r\u1eb1ng 2 c\u00e2y b\u00ean tr\u00e1i v\u00e0 b\u00ean ph\u1ea3i trong h\u00ecnh c\u00f3 th\u1ee9 t\u1ef1 in-order l\u00e0 \\((A,n,B,p,C)\\), nh\u01b0ng ch\u00fang c\u00f3 chi\u1ec1u cao h\u01a1i kh\u00e1c nhau m\u1ed9t ch\u00fat. C\u0169ng c\u1ea7n \u0111\u1ec3 \u00fd r\u1eb1ng ta c\u00f3 th\u1ec3 thay \u0111\u1ed5i g\u1ed1c c\u1ee7a c\u00e2y th\u00e0nh node \\(n\\) qua m\u1ed9t ph\u00e9p xoay (l\u00e0 xoay \\(n\\) l\u00ean tr\u00ean)</p> <p>Ph\u00e9p xoay \u0111\u01b0\u1ee3c c\u00e0i \u0111\u1eb7t nh\u01b0 sau:</p> <pre><code>// Xoay node l\u00ean, \u1edf \u0111\u00e2y node t\u01b0\u1ee3ng tr\u01b0ng cho n trong h\u00ecnh, parentNode l\u00e0 p trong h\u00ecnh\nvoid rotate(Node *node) {\n    // t\u1eeb parent node \u0111i xu\u1ed1ng th\u00ec \u0111i h\u01b0\u1edbng n\u00e0o m\u1edbi \u0111\u1ebfn node\n    int dirOfNode = (node-&gt;parent-&gt;children[1] == node);\n    Node *parentNode = node-&gt;parent;\n\n    // ta c\u1ea7n ph\u1ea3i chuy\u1ec3n node B trong h\u00ecnh sau khi xoay, B ch\u00ednh l\u00e0 movingChildOfNode \u1edf \u0111\u00e2y\n    Node *movingChildOfNode = node-&gt;children[dirOfNode ^ 1];\n\n    if (parentNode-&gt;parent) {\n        // update parent c\u1ee7a parentNode \u0111\u1ec3 nh\u1eadn node l\u00e0m con m\u1edbi\n        parentNode-&gt;parent-&gt;children[parentNode-&gt;parent-&gt;children[1] == parentNode] = node;\n    }\n\n    // update cha v\u00e0 con c\u1ee7a node\n    node-&gt;parent = parentNode-&gt;parent;\n    node-&gt;children[dirOfNode ^ 1] = parentNode;\n\n    // update cha v\u00e0 con c\u1ee7a parentNode, l\u01b0u \u00fd di chuy\u1ec3n lu\u00f4n node B\n    parentNode-&gt;parent = node;\n    parentNode-&gt;children[dirOfNode] = movingChildOfNode;\n\n    if (movingChildOfNode) {\n        // update cha c\u1ee7a node B\n        movingChildOfNode-&gt;parent = parentNode;\n    }\n\n    // cu\u1ed1i c\u00f9ng update size c\u1ee7a parentNode v\u00e0 node sau khi xoay\n    parentNode-&gt;update();\n    node-&gt;update();\n}\n</code></pre> <p>\u00dd t\u01b0\u1edfng c\u01a1 b\u1ea3n c\u1ee7a Splay r\u1ea5t \u0111\u01a1n gi\u1ea3n: nh\u1eefng tr\u01b0\u1eddng h\u1ee3p x\u1ea5u tr\u00ean c\u00e2y nh\u1ecb ph\u00e2n x\u1ea3y ra khi ta \u0111\u1ebfn m\u1ed9t node r\u1ea5t s\u00e2u trong c\u00e2y (v\u00ed d\u1ee5 c\u00e2y r\u1ea5t cao ch\u1eb3ng h\u1ea1n). V\u00ec v\u1eady, \u0111\u1ec3 gi\u1ea3m chi ph\u00ed \u0111\u1ebfn \u0111\u01b0\u1ee3c node n\u00e0y trong t\u01b0\u01a1ng lai, ta ph\u1ea3i xoay n\u00f3 l\u00ean. Th\u1ef1c t\u1ebf th\u00ec, m\u1ed7i l\u1ea7n ta \u0111\u1ebfn node \u0111\u00f3, ta l\u1ea1i xoay n\u00f3 l\u00ean g\u1ed1c!</p> <p>Tuy nhi\u00ean, c\u00e1ch n\u00e0y kh\u00f4ng th\u1ef1c s\u1ef1 hi\u1ec7u qu\u1ea3. Xoay node d\u01b0\u1edbi c\u00f9ng tr\u00ean m\u1ed9t \"c\u00e2y g\u1eady\" l\u1ea1i t\u1ea1o ra m\u1ed9t c\u00e2y d\u1ea1ng \"g\u1eady\" kh\u00e1c, kh\u00f4ng l\u00e0m gi\u1ea3m \u0111\u1ed9 ph\u1ee9c t\u1ea1p \u0111i \u0111\u01b0\u1ee3c:</p> <p></p> <p>V\u00ec v\u1eady, ta c\u1ea7n t\u00ecm c\u00e1ch \u0111\u1ec3 xoay m\u1ed9t node l\u00ean g\u1ed1c. H\u00e3y xem thao t\u00e1c Splay nh\u00e9!</p>"},{"location":"misc/data-structures/splay-tree/#thao-tac-splay","title":"Thao t\u00e1c Splay","text":"<p>Trong thao t\u00e1c splay, ta th\u01b0\u1eddng xoay node \\(n\\) l\u00ean 2 l\u1ea7n li\u00ean ti\u1ebfp \u0111\u1ec3 gi\u1ea3m \u0111\u1ed9 cao c\u1ee7a node \u0111\u00f3 \u0111i 2 (c\u00e1ch n\u00e0y g\u1ecdi l\u00e0 Zig-Zag) (\u0111\u1ed9 cao c\u1ee7a node g\u1ed1c l\u00e0 th\u1ea5p nh\u1ea5t):</p> <p></p> <p>Tuy nhi\u00ean, n\u1ebfu node \\(n\\) v\u00e0 cha \\(m\\) c\u1ee7a n\u00f3 n\u1eb1m c\u00f9ng ph\u00eda (ngh\u0129a l\u00e0 c\u1ea3 2 \u0111\u1ec1u l\u00e0 node con tr\u00e1i ho\u1eb7c \u0111\u1ec1u l\u00e0 node con ph\u1ea3i), thay v\u00ec xoay n l\u00ean 2 l\u1ea7n, ta xoay \\(m\\) l\u00ean 1 l\u1ea7n, r\u1ed3i xoay \\(n\\) l\u00ean m\u1ed9t l\u1ea7n n\u1eefa th\u00ec c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3m \u0111\u1ed9 cao c\u1ee7a node \u0111\u00f3 \u0111i 2, nh\u01b0 sau (c\u00e1ch n\u00e0y g\u1ecdi l\u00e0 Zig-Zig, v\u00ec 2 l\u1ea7n xoay \u0111\u1ec1u theo c\u00f9ng m\u1ed9t h\u01b0\u1edbng):</p> <p></p> <p>L\u01b0u \u00fd: Trong tr\u01b0\u1eddng h\u1ee3p cha c\u1ee7a \\(n\\) l\u00e0 node g\u1ed1c, ch\u1ec9 c\u1ea7n xoay \\(n\\) l\u00ean g\u1ed1c m\u1ed9t l\u1ea7n l\u00e0 \u0111\u1ee7 (c\u00e1ch n\u00e0y g\u1ecdi l\u00e0 Zig).</p> <p>Ta kh\u00f4ng th\u1ec3 th\u1ea5y ngay r\u1eb1ng v\u00ec sao n\u00f3 ho\u1ea1t \u0111\u1ed9ng: c\u00e2y b\u00ean d\u01b0\u1edbi gi\u1ed1ng \"c\u00e2y g\u1eady\" tr\u01b0\u1edbc v\u00e0 sau thao t\u00e1c. Nh\u01b0ng n\u1ebfu l\u00e0m theo v\u00ed d\u1ee5 tr\u01b0\u1edbc, n\u00f3 tr\u1edf n\u00ean r\u00f5 r\u00e0ng h\u01a1n. \u1ede h\u00ecnh d\u01b0\u1edbi, ta \u00e1p d\u1ee5ng Zig-Zag, sau \u0111\u00f3 d\u00f9ng Zig-Zig l\u00e0 s\u1ebd ra \u0111\u01b0\u1ee3c c\u00e2y sau c\u00f9ng.</p> <p></p> <p>Zig-Zig b\u1eb1ng m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3 c\u00f3 th\u1ec3 l\u00e0m c\u00e2y c\u00f3 chi\u1ec1u cao th\u1ea5p h\u01a1n sau m\u1ed9t thao t\u00e1c splay v\u1ec1 g\u1ed1c. \u0110\u1ec3 bi\u1ebft t\u1ea1i sao n\u00f3 ho\u1ea1t \u0111\u1ed9ng, ta c\u1ea7n d\u00f9ng m\u1ed9t ch\u00fat to\u00e1n \u1edf \u0111\u00e2y.</p>"},{"location":"misc/data-structures/splay-tree/#o-phuc-tap","title":"\u0110\u1ed9 ph\u1ee9c t\u1ea1p","text":"<p>L\u01b0u \u00fd: B\u1ea1n c\u00f3 th\u1ec3 b\u1ecf qua ph\u1ea7n n\u00e0y n\u1ebfu b\u1ea1n kh\u00f4ng quan t\u00e2m Splay ho\u1ea1t \u0111\u1ed9ng nh\u01b0 th\u1ebf n\u00e0o.</p>"},{"location":"misc/data-structures/splay-tree/#phuong-phap-tiem-nang-the-potential-method","title":"Ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng (The Potential Method)","text":"<p>X\u00e9t m\u1ed9t dynamic rotating tree \\(T\\) tr\u00ean m\u1ed9t d\u00e3y c\u00e1c thao t\u00e1c t\u00ecm v\u00e0 splay-to-top \\(Q\\).</p> <p>\u0110\u1ea7u ti\u00ean, ta th\u1ea5y r\u1eb1ng vi\u1ec7c t\u00ecm m\u1ed9t node c\u00f3 c\u00f9ng \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian v\u1edbi vi\u1ec7c splay m\u1ed9t node l\u00ean root, b\u1edfi v\u00ec ch\u00fang \u0111\u1ec1u truy c\u1eadp v\u00e0o \u0111\u01b0\u1eddng \u0111i t\u1eeb node l\u00ean root v\u00e0 ch\u1ea5m h\u1ebft. Ta s\u1ebd ch\u1ec9 n\u00f3i v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p c\u1ee7a vi\u1ec7c splay m\u1ed9t node l\u00ean root theo ph\u00e2n t\u00edch sau \u0111\u00e2y.</p> <p>M\u1ed9t gi\u1ea3i ph\u00e1p ph\u1ed5 bi\u1ebfn l\u00e0 Ph\u01b0\u01a1ng ph\u00e1p Ti\u1ec1m n\u0103ng (b\u1ea1n n\u00ean \u0111\u1ecdc b\u00e0i vi\u1ebft trong link \u0111\u1ec3 hi\u1ec3u h\u01a1n), ti\u1ebfng Anh g\u1ecdi l\u00e0 the Potential Method. \u1ede \u0111\u00e2y v\u00ed d\u1ee5 ta c\u00f3 m\u1ed9t c\u1ee5c pin, ta s\u1ebd th\u1ef1c hi\u1ec7n \u0111\u01b0\u1ee3c c\u00e1c h\u00e0nh \u0111\u1ed9ng nh\u01b0 sau:</p> <ul> <li>Ta c\u00f3 th\u1ec3 s\u1ea1c pin b\u1ea5t k\u00ec l\u00fac n\u00e0o v\u1edbi \\(k\\) thao t\u00e1c. H\u00e0nh \u0111\u1ed9ng n\u00e0y t\u1ed1n \\(k\\) th\u1eddi gian.</li> <li>Ta c\u00f3 th\u1ec3 d\u00f9ng pin cho \\(k\\) thao t\u00e1c. H\u00e0nh \u0111\u1ed9ng n\u00e0y ti\u1ebft ki\u1ec7m \\(k\\) th\u1eddi gian.</li> </ul> <p>Sau khi th\u1ef1c thi c\u00e1c h\u00e0nh \u0111\u1ed9ng, t\u1ed5ng th\u1eddi gian th\u1ef1c thi s\u1ebd l\u00e0:</p> \\[\\text{s\u1ed1 thao t\u00e1c ta \u0111\u00e3 d\u00f9ng + ch\u00eanh l\u1ec7ch pin tr\u01b0\u1edbc v\u00e0 sau khi th\u1ef1c thi c\u00e1c h\u00e0nh \u0111\u1ed9ng}\\] <p>Th\u00f4ng th\u01b0\u1eddng ta mu\u1ed1n c\u1ee5c pin s\u1ebd \u1ee9ng v\u1edbi c\u1ea5u tr\u00fac d\u1eef li\u1ec7u ta \u0111ang s\u1eed d\u1ee5ng. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y ta \u0111\u1ecbnh ngh\u0129a c\u1ee5c pin \\(\\Phi\\) c\u1ee7a c\u00e2y \\(T\\) l\u00e0:</p> \\[\\begin{align} k&amp;=\\text{s\u1ed1 thao t\u00e1c c\u1ea7n \u0111\u1ec3 th\u1ef1c hi\u1ec7n m\u1ed9t thao t\u00e1c Splay}\\\\ \\text{size}(n)&amp;=\\text{s\u1ed1 node tr\u00ean c\u00e2y con c\u00f3 g\u1ed1c l\u00e0 }n\\\\ \\text{rank}(n)&amp;=\\log_2\\text{size}(n)\\\\ \\Phi&amp;=k\\sum_{n\\in T}\\text{rank}(n) \\end{align}\\] <p>\u0110\u1ec3 \u00fd r\u1eb1ng \\(rank(n) \\leq \\log |T|\\), n\u00ean \\(0 \\leq \\Phi \\leq k|T|log|T|\\), ngh\u0129a l\u00e0 ta gi\u1edbi h\u1ea1n \u0111\u01b0\u1ee3c th\u1eddi l\u01b0\u1ee3ng pin ch\u00eanh l\u1ec7ch tr\u01b0\u1edbc v\u00e0 sau khi th\u1ef1c thi c\u00e1c h\u00e0nh \u0111\u1ed9ng \\(\\Delta\\Phi\\) th\u00e0nh \\(O(|T|log|T|)\\). Gi\u1edd ta c\u1ea7n ch\u1eafc ch\u1eafn r\u1eb1ng m\u1ed7i thao t\u00e1c t\u1ed1n \\(O(log|T|)\\) th\u1eddi gian, v\u00e0 ta s\u1ebd c\u00f3 \u0111\u1ed9 ph\u1ee9c t\u1ea1p cu\u1ed1i c\u00f9ng l\u00e0 \\(O((|Q|+|T|)log|T|)\\)</p>"},{"location":"misc/data-structures/splay-tree/#gioi-han-thao-tac","title":"Gi\u1edbi h\u1ea1n thao t\u00e1c","text":"<p>X\u00e9t m\u1ed9t thao t\u00e1c Zig-Zag:</p> <p></p> \\[\\begin{align} \\text{TIME}(\\text{Zig-Zag})&amp;=k+k(\\text{rank}'(n)+\\text{rank}'(m)+\\text{rank}'(l)-\\text{rank}(n)-\\text{rank}(m)-\\text{rank}(l))\\\\ &amp;=k(1+\\text{rank}'(n)+\\text{rank}'(m)+\\text{rank}'(l)-\\text{rank}(n)-\\text{rank}(m)-\\text{rank}(l)) \\end{align}\\] <p>V\u00ec \\(\\text{rank}(l)=\\text{rank}'(n)\\) (c\u1ea3 2 \u0111\u1ec1u l\u00e0 c\u00e2y con),</p> \\[\\begin{align} \\text{TIME}(\\text{Zig-Zag})&amp;=k(1+\\text{rank}'(m)+\\text{rank}'(l)-\\text{rank}(n)-\\text{rank}(m))\\\\ &amp;&lt; k(1+\\text{rank}'(m)+\\text{rank}'(l)-2\\text{rank}(n))\\\\ \\end{align}\\] <p>V\u00ec</p> \\[\\begin{align} 1+\\text{rank}'(m)+\\text{rank}'(l)&amp;=\\log 2+\\log \\text{size}'(m)+\\log \\text{size}'(l)\\\\ &amp;=\\log 2\\text{size}'(m)\\text{size}'(l)\\\\ &amp;&lt;\\log (\\text{size}'(m)+\\text{size}'(l))^2\\\\ &amp;&lt;\\log \\text{size}'^2(n)\\\\ &amp;=\\log \\text{size}'(n)+\\log \\text{size}'(n)=2\\text{rank}'(n)\\text{,}\\\\ \\end{align}\\] <p>Ta ch\u1ee9ng minh \u0111\u01b0\u1ee3c</p> \\[\\text{TIME}(\\text{Zig-Zag})&lt;k(2\\text{rank}'(n)-2\\text{rank}(n))=2k(\\text{rank}'(n)-\\text{rank}(n))\\text{.}\\] <p>T\u01b0\u01a1ng t\u1ef1 v\u1edbi thao t\u00e1c Zig-Zig:</p> <p></p> \\[\\begin{align} \\text{TIME}(\\text{Zig-Zig})&amp;=k+k(\\text{rank}'(n)+\\text{rank}'(m)+\\text{rank}'(l)-\\text{rank}(n)-\\text{rank}(m)-\\text{rank}(l))\\\\ &amp;=k(1+\\text{rank}'(n)+\\text{rank}'(m)+\\text{rank}'(l)-\\text{rank}(n)-\\text{rank}(m)-\\text{rank}(l))\\\\ &amp;=k(1+\\text{rank}'(m)+\\text{rank}'(l)-\\text{rank}(n)-\\text{rank}(m))\\\\ &amp;&lt; k(1+\\text{rank}'(m)+\\text{rank}'(l)-2\\text{rank}(n))\\\\ &amp;=k(\\log 2\\text{size}'(m)\\text{size}'(l)-2\\text{rank}(n))\\text{.} \\end{align}\\] <p>Gi\u1edd ta d\u00f9ng t\u00ednh ch\u1ea5t c\u1ee7a thao t\u00e1c Zig-Zig, l\u00e0:</p> \\[\\text{size}(n)+\\text{size}'(l)+1=(\\text{size}(A)+\\text{size}(B)+1)+(\\text{size}(C)+\\text{size}(D)+1)+1=\\text{size}'(n)\\text{.}\\] <p>V\u00ec v\u1eady,</p> \\[\\begin{align} \\text{TIME}(\\text{Zig-Zig})&amp;&lt;k(\\log 2\\text{size}'(m)\\text{size}'(l)-2\\text{rank}(n))\\\\ &amp;=k(\\log 2\\text{size}'(m)(\\text{size}'(n)-\\text{size}(n)-1)-2\\text{rank}(n))\\\\ &amp;&lt;k(\\log 2\\text{size}'(n)(\\text{size}'(n)-\\text{size}(n))-2\\text{rank}(n))\\\\ &amp;=k(\\log 2\\text{size}'(n)(\\text{size}'(n)-\\text{size}(n))+\\text{rank}(n)-3\\text{rank}(n))\\\\ &amp;=k(\\log 2\\text{size}'(n)(\\text{size}'(n)-\\text{size}(n))+\\log\\text{size}(n)-3\\text{rank}(n))\\\\ &amp;=k(\\log 2\\text{size}'(n)\\text{size}(n)(\\text{size}'(n)-\\text{size}(n))-3\\text{rank}(n))\\text{.} \\end{align}\\] <p>V\u00ec</p> \\[\\text{size}(n)(\\text{size}'(n)-\\text{size}(n)) &lt; \\frac{1}{4}\\text{size}'^2(n) &lt; \\frac{1}{2}\\text{size}'^2(n)\\text{,}\\] \\[\\begin{align} \\text{TIME}(\\text{Zig-Zig})&amp;&lt;k(\\log 2\\text{size}'(n)\\text{size}(n)(\\text{size}'(n)-\\text{size}(n))-3\\text{rank}(n))\\\\ &amp;&lt;k(\\log \\text{size}'^3(n)-3\\text{rank}(n))=3k(\\text{rank}'(n)-\\text{rank}(n))\\text{.} \\end{align}\\] <p>Ta k\u1ebft lu\u1eadn r\u1eb1ng</p> \\[\\text{TIME}(\\text{Zig-Zag}),\\text{TIME}(\\text{Zig-Zig})&lt;3k(\\text{rank}'(n)-\\text{rank}(n))\\text{.}\\] <p>V\u00ec vi\u1ec7c splay-to-root l\u00e0 m\u1ed9t chu\u1ed7i c\u00e1c thao t\u00e1c Zig-Zag v\u00e0 Zig-Zig b\u1eaft \u0111\u1ea7u v\u1edbi node c\u00f3 rank l\u00e0 \\(rank(n)\\) v\u00e0 k\u1ebft th\u00fac \u1edf node c\u00f3 rank l\u00e0 \\(rank(root) = log|T|\\),</p> \\[\\begin{align} \\text{TIME}(\\text{Splay-to-root})=3k(\\text{rank}(\\text{root})-\\text{rank}(n))=O(\\log |T|)\\text{.} \\end{align}\\] <p>Cu\u1ed1i c\u00f9ng ta gi\u1edbi h\u1ea1n \u0111\u01b0\u1ee3c thao t\u00e1c splay-to-root v\u1ec1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p \\(O(log|T|)\\) th\u1eddi gian.</p>"},{"location":"misc/data-structures/splay-tree/#cai-at","title":"C\u00e0i \u0111\u1eb7t","text":"<p>Ta c\u00e0i \u0111\u1eb7t Splay nh\u01b0 sau:</p> <pre><code>// Splay node n \u0111\u1ebfn khi n\u00f3 l\u00e0 con c\u1ee7a desiredParent (ho\u1eb7c \u0111\u1ebfn root n\u1ebfu desiredParent null)\nvoid splay(Node *node, Node *desiredParent = NULL) {\n    while (node-&gt;parent != desiredParent) {\n        // l\u1ea5y node m (cha) v\u00e0 l (cha c\u1ee7a m) nh\u01b0 trong c\u00e1c h\u00ecnh v\u1ebd\n        Node *parent = node-&gt;parent, *parentOfParent = parent-&gt;parent;\n\n        if (parentOfParent == desiredParent) {\n            // n\u1ebfu l l\u00e0 desiredParent th\u00ec ta ch\u1ec9 c\u1ea7n xoay m\u1ed9t l\u1ea7n - Zig\n            rotate(node);\n        } else if ((parentOfParent-&gt;children[0] == parent) == (parent-&gt;children[0] == node)) {\n            // n\u1ebfu n v\u00e0 m c\u00f9ng h\u01b0\u1edbng (c\u00f9ng l\u00e0 node con tr\u00e1i ho\u1eb7c c\u00f9ng l\u00e0 node con ph\u1ea3i) - Zig-Zig\n            rotate(parent);\n            rotate(node);\n        } else {\n            // tr\u01b0\u1eddng h\u1ee3p c\u00f2n l\u1ea1i - Zig-Zag\n            rotate(node);\n            rotate(node);\n        }\n    }\n\n    // n\u1ebfu desiredParent null th\u00ec update root\n    if (!desiredParent) {\n        root = node;\n    }\n}\n</code></pre>"},{"location":"misc/data-structures/splay-tree/#cac-thao-tac-tren-splay-tree","title":"C\u00e1c thao t\u00e1c tr\u00ean Splay Tree","text":"<p>\u0110\u1ec3 t\u1ed5ng h\u1ee3p l\u1ea1i nh\u1eefng g\u00ec \u0111\u00e3 h\u1ecdc, ch\u00fang ta \u0111\u00e3 c\u00e0i Splay Tree gi\u00fap</p> <ul> <li>T\u00ecm m\u1ed9t ph\u1ea7n t\u1eed t\u1ea1i m\u1ed9t v\u1ecb tr\u00ed x\u00e1c \u0111\u1ecbnh;</li> <li>Ch\u00e8n m\u1ed9t ph\u1ea7n t\u1eed v\u00e0o m\u1ed9t v\u1ecb tr\u00ed x\u00e1c \u0111\u1ecbnh</li> </ul> <p>trong th\u1eddi gian ph\u00e2n b\u1ed5 \\(O(\\log n)\\). \u0110\u00f3 l\u00e0 \u0111i\u1ec1u r\u1ea5t t\u1ed1t v\u00ec \\(O(\\log n)\\) r\u1ea5t nh\u1ecf. Ta s\u1ebd xem x\u00e9t m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 v\u00e0 t\u00f4i s\u1ebd tr\u00ecnh b\u00e0y m\u1ed9t v\u00ed d\u1ee5 c\u1ee5 th\u1ec3 v\u1edbi m\u00e3 ngu\u1ed3n.</p>"},{"location":"misc/data-structures/splay-tree/#tong-oan","title":"T\u1ed5ng \u0111o\u1ea1n","text":"<p>Truy v\u1ea5n th\u00f4ng d\u1ee5ng nh\u1ea5t tr\u00ean d\u00e3y \\((x_1,x_2,\\ldots,x_n)\\) l\u00e0 t\u00ecm t\u1ed5ng \u0111o\u1ea1n \\(\\sum_{i=l}^{r}x_i\\).</p> <p>B\u1ea1n c\u00f3 th\u1ec3 r\u1ea5t ng\u1ea1c nhi\u00ean khi ta \u0111\u00e3 c\u00f3 c\u00e1ch c\u00e0i \u0111\u1eb7t (ki\u1ec3u th\u1ebf) c\u00e1i n\u00e0y trong nh\u1eefng code tr\u01b0\u1edbc r\u1ed3i. Nh\u1edb l\u1ea1i l\u00e0 ch\u00fang ta \u0111\u00e3 duy tr\u00ec k\u00edch th\u01b0\u1edbc m\u1ed7i c\u00e2y con v\u1edbi <code>node.size</code> v\u00e0 <code>node.update()</code>. V\u00ec v\u1eady n\u00ean ta c\u00f3 th\u1ec3 duy tr\u00ec t\u1ed5ng \u0111o\u1ea1n theo c\u00e1ch y nh\u01b0 v\u1eady. V\u1ea5n \u0111\u1ec1 b\u00e2y gi\u1edd l\u00e0 t\u00ecm c\u00e2y con \u1ee9ng v\u1edbi \u0111o\u1ea1n \\([x_l,x_r]\\).</p> <p>C\u00e1ch gi\u1ea3i kh\u00e1 l\u00e0 \u0111\u01a1n gi\u1ea3n: ta c\u00f3 th\u1ec3 splay node \\(x_{r+1}\\) v\u1ec1 root, v\u00e0 node \\(x_{l-1}\\) v\u1ec1 l\u00e0m con c\u1ee7a node \\(x_{r+1}\\). Th\u00ec c\u00e2y con \u1ee9ng v\u1edbi \\([x_l,x_r]\\) s\u1ebd xu\u1ea5t hi\u1ec7n:</p> <p></p> <p>L\u01b0u \u00fd: Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y ta gi\u1ea3 s\u1eed \\(x_{l-1}\\) v\u00e0 \\(x_{r+1}\\) \u0111\u1ec1u c\u00f3 t\u1ed3n t\u1ea1i. Trong th\u1ef1c t\u1ebf, ta c\u00f3 th\u1ec3 th\u00eam node \u0111\u1ea7u v\u00e0 node \u0111u\u00f4i gi\u1ea3 \u0111\u1ec3 \u0111i\u1ec1u ki\u1ec7n tr\u00ean lu\u00f4n tho\u1ea3 m\u00e3n.</p>"},{"location":"misc/data-structures/splay-tree/#xoa-oan","title":"Xo\u00e1 \u0111o\u1ea1n","text":"<p>Xo\u00e1 tr\u00ean Splay Tree r\u1ea5t d\u1ec5 d\u00e0ng. V\u00ed d\u1ee5 ta mu\u1ed1n xo\u00e1 m\u1ed9t \u0111o\u1ea1n \\([x_l, x_r]\\), ta ch\u1ec9 c\u1ea7n t\u00ecm c\u00e2y con t\u01b0\u01a1ng \u1ee9ng v\u1edbi \u0111o\u1ea1n \u0111\u00f3, r\u1ed3i xo\u00e1 n\u00f3 ra kh\u1ecfi c\u00e2y.</p>"},{"location":"misc/data-structures/splay-tree/#gan-tat-ca-cac-phan-tu-cua-oan-bang-mot-so-nao-o","title":"G\u00e1n t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a \u0111o\u1ea1n b\u1eb1ng m\u1ed9t s\u1ed1 n\u00e0o \u0111\u00f3","text":"<p>Th\u00f4ng th\u01b0\u1eddng ta mu\u1ed1n ch\u1ec9nh s\u1eeda \u0111o\u1ea1n \\([x_l,x_r]\\) theo m\u1ed9t c\u00e1ch n\u00e0o \u0111\u00f3: th\u00eam gi\u00e1 tr\u1ecb, g\u00e1n gi\u00e1 tr\u1ecb b\u1eb1ng m\u1ed9t s\u1ed1 n\u00e0o \u0111\u00f3, ... Ta s\u1ebd xem x\u00e9t m\u1ed9t v\u00ed d\u1ee5 m\u00e0 ta c\u1ea7n g\u00e1n t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed trong \u0111o\u1ea1n \\([x_l,x_r]\\) b\u1eb1ng m\u1ed9t s\u1ed1 \\(v\\) n\u00e0o \u0111\u00f3.</p> <p>Ta s\u1ebd duy tr\u00ec m\u1ed9t lazy label tr\u00ean m\u1ed7i node. M\u1ed9t lazy label c\u00f3 th\u1ec3 l\u00e0 null ho\u1eb7c gi\u00e1 tr\u1ecb n\u00e0o \u0111\u00f3. N\u1ebfu label \\(c\\) kh\u00f4ng ph\u1ea3i null, ta coi c\u00e2y con c\u1ee7a node t\u01b0\u01a1ng \u1ee9ng nh\u01b0 th\u1ec3 m\u1ecdi node tr\u00ean c\u00e2y con \u0111\u00f3 \u0111\u1ec1u c\u00f3 gi\u00e1 tr\u1ecb l\u00e0 \\(c\\). V\u00ec v\u1eady, \u0111\u1ec3 \u00e1p d\u1ee5ng thao t\u00e1c n\u00e0y, ta ch\u1ec9 c\u1ea7n t\u00ecm c\u00e2y con \\([x_l,x_r]\\) v\u00e0 g\u00e1n cho g\u1ed1c c\u1ee7a c\u00e2y con n\u00e0y v\u00e0 label c\u1ee7a n\u00f3 l\u00e0 \\(c\\).</p> <p>R\u00f5 r\u00e0ng l\u00e0 khi ta th\u1ef1c s\u1ef1 d\u00f9ng m\u1ed9t node, ta c\u1ea7n ch\u1eafc ch\u1eafn r\u1eb1ng t\u1ed5 ti\u00ean c\u1ee7a n\u00f3 kh\u00f4ng c\u00f3 lazy label n\u00e0o, v\u00ec c\u00e1c label n\u00e0y c\u00f3 th\u1ec3 can thi\u1ec7p v\u00e0o gi\u00e1 tr\u1ecb c\u1ee7a node hi\u1ec7n t\u1ea1i. Th\u1eadt may l\u00e0 ta c\u00f3 th\u1ec3 d\u00f9ng <code>push_down</code> \u0111\u1ec3 xo\u00e1 label v\u1edbi m\u1ecdi node t\u1ed5 ti\u00ean, b\u1eaft \u0111\u1ea7u t\u1eeb node g\u1ed1c:</p> <ol> <li>\u00c1p d\u1ee5ng thao t\u00e1c g\u00e1n ph\u1ea7n t\u1eed tr\u00ean 2 con c\u1ee7a node:<ol> <li>G\u00e1n gi\u00e1 tr\u1ecb c\u1ee7a 2 con c\u1ee7a node th\u00e0nh \\(c\\).</li> <li>G\u00e1n label c\u1ee7a 2 con c\u1ee7a node th\u00e0nh \\(c\\).</li> </ol> </li> <li>G\u00e1n label c\u1ee7a node th\u00e0nh null.</li> </ol> <p>Ta c\u00f3 th\u1ec3 vi\u1ebft l\u1ea1i h\u00e0m <code>walk</code> \u0111\u1ec3 n\u00f3 c\u00f3 th\u1ec3 <code>push_down</code> li\u00ean t\u1ee5c:</p> <pre><code>// - h\u00e0m walk n\u00e0y d\u00f9ng \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh ta c\u1ea7n \u0111i xu\u1ed1ng d\u01b0\u1edbi \n// node con theo h\u01b0\u1edbng n\u00e0o v\u00e0 update pos\n// - dir: h\u01b0\u1edbng. 0 - tr\u00e1i, 1 - ph\u1ea3i\n// - pos: ta c\u1ea7n t\u00ecm node th\u1ee9 \"pos\" c\u1ee7a c\u00e2y g\u1ed1c \"node\"\n// (node th\u1ee9 0 l\u00e0 node \u0111\u1ea7u ti\u00ean)\n// - tr\u1ea3 v\u1ec1 s\u1ed1 node tr\u00ean c\u00e2y con tr\u00e1i c\u1ee7a c\u00e2y g\u1ed1c \"node\"\nint walk(Node *node, int &amp;dir, int &amp;pos) {\n    node-&gt;push_down();\n    int leftSize = node-&gt;children[0] ? node-&gt;children[0]-&gt;size : 0;\n    // c\u00e1c v\u1ecb tr\u00ed t\u1eeb 0 \u0111\u1ebfn leftSize s\u1ebd n\u1eb1m b\u00ean tr\u00e1i\n    // c\u00f2n l\u1ea1i ch\u1eafc ch\u1eafn n\u1eb1m b\u00ean ph\u1ea3i\n    dir = (leftSize &lt; pos);\n    if (dir) {\n        // n\u1ebfu n\u1eb1m b\u00ean ph\u1ea3i ta c\u1eadp nh\u1eadt l\u1ea1i pos ngay l\u1eadp t\u1ee9c\n        pos -= leftSize + 1;\n    }\n    return leftSize;\n}\n\n// t\u00ecm node th\u1ee9 \"pos\" tr\u00ean c\u00e2y g\u1ed1c \"root\"\n// (node th\u1ee9 0 l\u00e0 node \u0111\u1ea7u ti\u00ean)\n// n\u1ebfu sp true th\u00ec ta splay\nNode* find(int pos, int sp = true) {\n    Node *cur = root;\n    int dir;\n    // th\u00eam node \u0111\u1ea7u gi\u1ea3 v\u00e0o c\u00e2y\n    pos++;\n    // n\u1ebfu dir == 1, ta c\u1ea7n \u0111i qua ph\u1ea3i\n    // ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu pos &lt; leftSize th\u00ec ta n\u00ean sang tr\u00e1i\n    // ng\u01b0\u1ee3c l\u1ea1i, pos == leftSize, ch\u00ednh node cur l\u00e0 node c\u1ea7n t\u00ecm\n    while (pos &lt; walk(cur, dir, pos) || dir) {\n        cur = cur-&gt;children[dir];\n    }\n    if (sp) splay(cur);\n    return cur;\n}\n</code></pre>"},{"location":"misc/data-structures/splay-tree/#ao-oan","title":"\u0110\u1ea3o \u0111o\u1ea1n","text":"<p>Cu\u1ed1i c\u00f9ng ta x\u00e9t m\u1ed9t v\u00ed d\u1ee5: \u0111\u1ea3o \u0111o\u1ea1n \\([x_l,x_r]\\) trong d\u00e3y th\u00e0nh \\((x_r, x_{r-1}, \\ldots, x_l)\\).</p> <p>Ta c\u00e0i thao t\u00e1c n\u00e0y theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 nh\u01b0 tr\u00ean: Duy tr\u00ec m\u1ed9t label \u0111\u1ec3 coi c\u00e2y c\u00f3 b\u1ecb \u0111\u1ea3o hay kh\u00f4ng. Sau \u0111\u00f3, khi <code>push_down</code>:</p> <ol> <li>N\u1ebfu label \u0111\u01b0\u1ee3c set th\u00ec ta \u00e1p d\u1ee5ng thao t\u00e1c \u0111\u1ea3o tr\u00ean 2 con c\u1ee7a node:<ol> <li>\u0110\u1ea3o con tr\u00e1i c\u1ee7a 2 node con.</li> <li>\u0110\u1ea3o con ph\u1ea3i c\u1ee7a 2 node con.</li> <li>Set label c\u1ee7a 2 node con c\u1ee7a node hi\u1ec7n t\u1ea1i \u0111\u1ec3 \u0111\u1ea3o label c\u1ee7a ch\u00fang.</li> </ol> </li> <li>Set label c\u1ee7a node th\u00e0nh null.</li> </ol>"},{"location":"misc/data-structures/splay-tree/#vi-du","title":"V\u00ed d\u1ee5","text":"<p>Ta s\u1ebd xem v\u00ed d\u1ee5 gi\u1ea3i b\u00e0i POJ 3580</p> <p>\u1ede \u0111\u00e2y m\u00ecnh \u0111\u00e3 th\u00eam c\u00e1c comment b\u1eb1ng ti\u1ebfng Vi\u1ec7t \u0111\u1ec3 c\u00e1c b\u1ea1n ti\u1ec7n theo d\u00f5i.</p> <pre><code>// L\u01b0\u1ee3c b\u1ecf c\u00e1c \u0111o\u1ea1n define v\u00e0 constant\n\n// Splay Tree Node\nstruct Node {\n    // \u0111\u1ecbnh ngh\u0129a parent node and 2 node con c\u1ee7a n\u00f3\n    Node* parent, *children[2];\n    // k\u00edch th\u01b0\u1edbc subtree v\u1edbi g\u1ed1c l\u00e0 node hi\u1ec7n t\u1ea1i\n    int size;\n    // gi\u00e1 tr\u1ecb node, min c\u1ee7a subtree v\u00e0 label c\u1ee7a ph\u00e9p c\u1ed9ng lazy\n    ll val, Min, labelAdd;\n    // label c\u1ee7a ph\u00e9p \u0111\u1ea3o lazy\n    int labelReverse;\n\n    // h\u00e0m kh\u1edfi t\u1ea1o\n    Node(int val) {\n        parent = children[0] = children[1] = NULL;\n        size = 1;\n        this-&gt;val = val;\n        Min = labelAdd = labelReverse = 0;\n    }\n\n    // th\u00eam v v\u00e0o c\u1ea3 subtree\n    void add(ll v) {\n        // th\u00eam v gi\u00e1 tr\u1ecb node, min v\u00e0 labelAdd\n        val += v;\n        Min += v;\n        labelAdd += v;\n    }\n\n    // \u00e1p c\u00e1c label v\u00e0o v\u00e0 \u0111\u1ea9y ch\u00fang xu\u1ed1ng c\u00e1c node con\n    void pushDown() {\n        if (labelReverse) {\n            FOR(i,0,1) {\n                if (children[i]) {\n                    children[i]-&gt;reverse();\n                }\n            }\n            labelReverse = 0;\n        }\n\n        if (labelAdd) {\n            FOR(i,0,1) {\n                if (children[i]) {\n                    children[i]-&gt;add(labelAdd);\n                }\n            }\n            labelAdd = 0;\n        }\n    }\n\n    // update k\u00edch th\u01b0\u1edbc subtree v\u00e0 min c\u1ee7a subtree\n    void update() {\n        size = 1;\n        Min = val;\n        FOR(i,0,1) {\n            if (children[i]) {\n                size += children[i]-&gt;size;\n                ckmin(Min, children[i]-&gt;Min);\n            }\n        }\n    }\n\n    // \u0111\u1ea3o c\u1ea3 subtree, \u0111\u1ea7u ti\u00ean c\u1ea7n \u0111\u1ea3o 2 con c\u1ee7a node tr\u01b0\u1edbc\n    void reverse() {\n        swap(children[0], children[1]);\n        labelReverse ^= 1;\n    }\n};\n\nstruct SplayTree {\n    Node *root;\n\n    // t\u1ea1o splay tree v\u1edbi 2 node \u0111\u1ea7u cu\u1ed1i gi\u1ea3\n    SplayTree() {\n        root = new Node(-1);\n        root-&gt;children[1] = new Node(-1);\n        root-&gt;size = 2;\n        root-&gt;children[1]-&gt;parent = root;\n    }\n\n    // v\u00ec c\u00f3 2 node gi\u1ea3 n\u00ean size tr\u1ea3 v\u1ec1 \u00edt h\u01a1n 2 so v\u1edbi size th\u1ef1c\n    int size() { \n        return root-&gt;size - 2;\n    }\n\n    // h\u00e0m rotate node\n    void rotate(Node *node) {\n        int dirOfNode = (node-&gt;parent-&gt;children[1] == node);\n        Node *parentNode = node-&gt;parent;\n\n        Node *movingChildOfNode = node-&gt;children[dirOfNode ^ 1];\n\n        if (parentNode-&gt;parent) {\n            parentNode-&gt;parent-&gt;children[parentNode-&gt;parent-&gt;children[1] == parentNode] = node;\n        }\n\n        node-&gt;parent = parentNode-&gt;parent;\n        node-&gt;children[dirOfNode ^ 1] = parentNode;\n\n        parentNode-&gt;parent = node;\n        parentNode-&gt;children[dirOfNode] = movingChildOfNode;\n\n        if (movingChildOfNode) {\n            movingChildOfNode-&gt;parent = parentNode;\n        }\n\n        parentNode-&gt;update();\n        node-&gt;update();\n    }\n\n    // splay node \u0111\u1ec3 n\u00f3 n\u1eb1m ngay d\u01b0\u1edbi desiredParent ho\u1eb7c n\u1eb1m \u1edf root n\u1ebfu desiredParent null\n    void splay(Node *node, Node *desiredParent = NULL) {\n        while (node-&gt;parent != desiredParent) {\n            Node *parent = node-&gt;parent, *parentOfParent = parent-&gt;parent;\n            if (parentOfParent == desiredParent) {\n                rotate(node);\n            } else if ((parentOfParent-&gt;children[0] == parent) == (parent-&gt;children[0] == node)) {\n                rotate(parent);\n                rotate(node);\n            } else {\n                rotate(node);\n                rotate(node);\n            }\n        }\n        if (!desiredParent) {\n            root = node;\n        }\n    }\n\n    // h\u00e0m walk n\u00e0y d\u00f9ng \u0111\u1ec3 x\u00e1c \u0111\u1ecbnh ta c\u1ea7n \u0111i xu\u1ed1ng d\u01b0\u1edbi node con theo h\u01b0\u1edbng n\u00e0o v\u00e0 update pos\n    int walk(Node *node, int &amp;dir, int &amp;pos) {\n        node-&gt;pushDown();\n        int leftSize = node-&gt;children[0] ? node-&gt;children[0]-&gt;size : 0;\n        dir = (leftSize &lt; pos);\n        if (dir) {\n            pos -= leftSize + 1;\n        }\n        return leftSize;\n    }\n\n    // th\u00eam node v\u00e0o v\u1ecb tr\u00ed pos\n    void insert(Node *node, int pos) {\n        Node *cur = root;\n        int dir;\n        // ta c\u00f3 node \u0111\u1ea7u gi\u1ea3 v\u00e0 pos b\u1eaft \u0111\u1ea7u t\u1eeb 0, n\u00ean ta t\u0103ng pos\n        pos++;\n        while (1) {\n            walk(cur, dir, pos);\n            if (!cur-&gt;children[dir]) {\n                break;\n            }\n            cur = cur-&gt;children[dir];\n        }\n\n        cur-&gt;children[dir] = node;\n        node-&gt;parent = cur;\n        // th\u00eam v\u00e0o r\u1ed3i th\u00ec ta splay n\u00f3 l\u00ean root\n        splay(node);\n    }\n\n    // T\u00ecm node \u1edf v\u1ecb tr\u00ed pos, n\u1ebfu sp th\u00ec ta splay n\u00f3.\n    Node* find(int pos, int sp = true) {\n        Node *cur = root;\n        int dir;\n        // ta c\u00f3 node \u0111\u1ea7u gi\u1ea3 v\u00e0 pos b\u1eaft \u0111\u1ea7u t\u1eeb 0, n\u00ean ta t\u0103ng pos\n        pos++;\n        while (pos &lt; walk(cur, dir, pos) || dir) {\n            cur = cur-&gt;children[dir];\n        }\n        if (sp) splay(cur);\n        return cur;\n    }\n\n    // T\u00ecm \u0111o\u1ea1n [posL, posR)\n    // splay node posR l\u00ean g\u1ed1c, sau \u0111\u00f3 splay posL-1 l\u00ean \u1edf ngay d\u01b0\u1edbi posR, sau \u0111\u00f3 \u0111o\u1ea1n [posL, posR-1] s\u1ebd thu\u1ed9c quy\u1ec1n qu\u1ea3n l\u00fd c\u1ee7a node con b\u00ean ph\u1ea3i node posL-1\n    Node *findRange(int posL, int posR) {\n        Node *r = find(posR), *l = find(posL - 1, false);\n        splay(l, r);\n        if (l-&gt;children[1]) l-&gt;children[1]-&gt;pushDown();\n        return l-&gt;children[1];\n    }\n\n    // xo\u00e1 \u0111o\u1ea1n [posL, posR)\n    // t\u00ecm \u0111o\u1ea1n r\u1ed3i ng\u1eaft n\u00f3 ra kh\u1ecfi c\u00e2y\n    Node* eraseRange(int posL, int posR) {\n        Node *range = findRange(posL, posR);\n        range-&gt;parent-&gt;children[1] = NULL;\n        range-&gt;parent-&gt;update();\n        range-&gt;parent-&gt;parent-&gt;update();\n        range-&gt;parent = NULL;\n        return range;\n    }\n\n    // in c\u00e2y g\u1ed1c cur theo in-order\n    void print(Node *cur, string pref) {\n        if (cur == NULL) return;\n        // nh\u1edb push down khi \u0111i xu\u1ed1ng t\u1eebng node\n        cur-&gt;pushDown();\n        print(cur-&gt;children[1], pref + \"  \");\n        cout &lt;&lt; pref &lt;&lt; cur-&gt;val &lt;&lt; \"\\n\";\n        print(cur-&gt;children[0], pref + \"  \");\n    }\n\n    // in c\u1ea3 c\u00e2y theo th\u1ee9 t\u1ef1 in-order\n    // c\u00e2y trong output s\u1ebd gi\u1ed1ng c\u00e2y th\u1ef1c n\u1ebfu b\u1ea1n xoay n\u00f3 90 \u0111\u1ed9 theo chi\u1ec1u kim \u0111\u1ed3ng h\u1ed3\n    void printTree() {\n        print(root, \"\");\n        cout &lt;&lt; \"\\n\";\n    }\n};\n\nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(nullptr);\n    int n, m;\n    cin &gt;&gt; n;\n    SplayTree t;\n    while (n--) {\n        ll x;\n        cin &gt;&gt; x;\n        t.insert(new Node(x), t.size());\n    }\n\n    cin &gt;&gt; m;\n    while (m--) {\n        string s;\n        int x, y, k;\n        cin &gt;&gt; s;\n        if (s == \"ADD\") {\n            cin &gt;&gt; x &gt;&gt; y &gt;&gt; k;\n            // t\u00ecm \u0111o\u1ea1n v\u00e0 th\u00eam k v\u00e0o\n            t.findRange(x-1, y)-&gt;add(k);\n        } else if (s == \"REVERSE\") {\n            cin &gt;&gt; x &gt;&gt; y;\n            // t\u00ecm \u0111o\u1ea1n v\u00e0 \u0111\u1ea3o n\u00f3\n            t.findRange(x-1, y)-&gt;reverse();\n        } else if (s == \"REVOLVE\") {\n            cin &gt;&gt; x &gt;&gt; y &gt;&gt; k;\n            // xem ta c\u1ea7n \u0111\u1ea9y bao nhi\u00eau, r\u1ed3i l\u1ea5y \u0111o\u1ea1n sau insert v\u00e0o ph\u00eda tr\u01b0\u1edbc\n            k %= (y - x + 1);\n            if (k) {\n                Node *right = t.eraseRange(y-k, y);\n                t.insert(right, x-1);\n            }\n        } else if (s == \"INSERT\") {\n            cin &gt;&gt; x &gt;&gt; k;\n            // th\u00eam node k v\u00e0o v\u1ecb tr\u00ed x\n            t.insert(new Node(k), x);\n        } else if (s == \"DELETE\") {\n            cin &gt;&gt; x;\n            // xo\u00e1 node \u1edf v\u1ecb tr\u00ed x\n            t.eraseRange(x-1, x);\n        } else {\n            cin &gt;&gt; x &gt;&gt; y;\n            // l\u1ea5y min c\u1ee7a \u0111o\u1ea1n\n            cout &lt;&lt; t.findRange(x-1, y)-&gt;Min &lt;&lt; \"\\n\";\n        }\n    }\n    return 0;\n}\n</code></pre>"},{"location":"misc/data-structures/splay-tree/#luyen-tap","title":"Luy\u1ec7n t\u1eadp","text":"Problem Status Submission Code Date POJ 3580 Unavailable public link Code 11/11/2022 HDU 3487 Unavailable public link Code 11/11/2022 SPOJ ADALIST Unavailable public link Code 11/11/2022"},{"location":"misc/experience/being-better/","title":"L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 gi\u1ecfi h\u01a1n trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u?","text":""},{"location":"misc/experience/being-better/#lam-the-nao-e-gioi-hon-trong-lap-trinh-thi-au","title":"L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 gi\u1ecfi h\u01a1n trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u?","text":""},{"location":"misc/experience/being-better/#nguon","title":"Ngu\u1ed3n","text":"<p>How to get better? - lukipuki.github.io</p>"},{"location":"misc/experience/being-better/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>Tr\u01b0\u1edbc ti\u00ean m\u00ecnh mu\u1ed1n tr\u00ecnh b\u00e0y r\u1eb1ng m\u00ecnh kh\u00f4ng xem b\u1ea3n th\u00e2n l\u00e0 m\u1ed9t ng\u01b0\u1eddi th\u00e0nh c\u00f4ng trong c\u1ed9ng \u0111\u1ed3ng L\u1eadp tr\u00ecnh thi \u0111\u1ea5u (Competitive Programming - CP) c\u0169ng nh\u01b0 kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ng\u01b0\u1eddi c\u00f3 kh\u1ea3 n\u0103ng chi\u1ebfn thu\u1eadt t\u1ed1t. B\u00e0i vi\u1ebft n\u00e0y l\u00e0 m\u1ed9t b\u00e0i m\u00ecnh d\u1ecbch t\u1eeb m\u1ed9t b\u00e0i vi\u1ebft trong blog c\u1ee7a m\u1ed9t cao th\u1ee7 trong c\u1ed9ng \u0111\u1ed3ng. \u0110\u00e2y l\u00e0 m\u1ed9t b\u00e0i kh\u00e1 hay v\u00e0 m\u00ecnh ngh\u0129 s\u1ebd c\u00f3 \u00edch cho c\u00e1c \u0111\u1ed9i thi.</p> <p>S\u01a1 l\u01b0\u1ee3c v\u1ec1 t\u00e1c gi\u1ea3: Luk\u00e1\u0161 Pol\u00e1\u010dek - hi\u1ec7n \u0111ang l\u00e0 nghi\u00ean c\u1ee9u sinh t\u1ea1i KTH Royal Institute of Technology, Th\u1ee5y \u0110i\u1ec3n (profile n\u00e0y l\u00e0 n\u0103m 2016). Anh \u1ea5y t\u1eebng \u0111\u1ea1t huy ch\u01b0\u01a1ng \u0111\u1ed3ng t\u1ea1i ACM ICPC 2010 v\u00e0 t\u1eebng c\u00f3 rating cao nh\u1ea5t l\u00e0 2676 tr\u00ean TopCoder.</p> <p>S\u01a1 l\u01b0\u1ee3c v\u1ec1 k\u00ec thi: ACM-ICPC (gi\u1edd r\u00fat g\u1ecdn th\u00e0nh ICPC) l\u00e0 k\u00ec thi l\u1eadp tr\u00ecnh thi \u0111\u1ea5u l\u1edbn v\u00e0 uy t\u00edn nh\u1ea5t th\u1ebf gi\u1edbi. K\u00ec thi k\u00e9o d\u00e0i 5 gi\u1edd \u0111\u1ed3ng h\u1ed3, m\u1ed7i \u0111\u1ed9i 3 ng\u01b0\u1eddi s\u1ebd ph\u1ea3i suy ngh\u0129 v\u00e0 gi\u1ea3i quy\u1ebft 10-12 b\u00e0i to\u00e1n b\u1eb1ng m\u00e1y t\u00ednh.</p> <p>Sau \u0111\u00e2y l\u00e0 n\u1ed9i dung b\u00e0i d\u1ecbch c\u1ee7a m\u00ecnh. Ng\u00f4i th\u1ee9 nh\u1ea5t trong b\u00e0i l\u00e0 ch\u1ec9 t\u00e1c gi\u1ea3, kh\u00f4ng ph\u1ea3i ch\u1ec9 m\u00ecnh.</p>"},{"location":"misc/experience/being-better/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>Khi \u0111i nh\u00e0 s\u00e1ch, b\u1ea1n th\u01b0\u1eddng g\u1eb7p nh\u1eefng t\u1ef1a s\u00e1ch nh\u01b0 \"D\u1ea1y Java trong 7 ng\u00e0y\". Trong nh\u1eefng cu\u1ed1n s\u00e1ch nh\u01b0 v\u1eady, t\u00e1c gi\u1ea3 mu\u1ed1n thuy\u1ebft ph\u1ee5c b\u1ea1n r\u1eb1ng l\u1eadp tr\u00ecnh d\u1ec5 v\u00e3i trong khi th\u1ef1c ra n\u00f3 kh\u00f4ng nh\u01b0 v\u1eady. Peter Novig \u0111\u00e3 vi\u1ebft m\u1ed9t b\u00e0i lu\u1eadn r\u1ea5t hay v\u1ec1 ch\u1ee7 \u0111\u1ec1 n\u00e0y l\u00e0 Teach Yourself Programming in Ten Years (T\u1ef1 h\u1ecdc l\u1eadp tr\u00ecnh trong 10 n\u0103m) m\u00e0 m\u00ecnh \u0111\u00e1nh gi\u00e1 r\u1ea5t cao. Ngo\u00e0i ra c\u00f3 m\u1ed9t bi\u1ebfm h\u1ecda vui v\u1ec1 ch\u1ee7 \u0111\u1ec1 n\u00e0y c\u1ee7a Abstruce Goose. M\u00ecnh \u0111\u1ed3ng \u00fd v\u1edbi Peter r\u1eb1ng c\u1ea7n nhi\u1ec1u th\u1eddi gian v\u00e0 n\u1ed7 l\u1ef1c \u0111\u1ec3 h\u1ecdc l\u1eadp tr\u00ecnh. Tuy nhi\u00ean b\u1ea1n v\u1eabn n\u00ean luy\u1ec7n t\u1eadp m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 nh\u1ea5t c\u00f3 th\u1ec3.</p> <p>C\u00f3 r\u1ea5t \u00edt th\u00f4ng tin c\u00f3 s\u1eb5n v\u1ec1 vi\u1ec7c luy\u1ec7n t\u1eadp cho c\u00e1c cu\u1ed9c thi l\u1eadp tr\u00ecnh, n\u00ean m\u00ecnh quy\u1ebft \u0111\u1ecbnh t\u1ea1o ra m\u1ed9t ch\u01b0\u01a1ng tr\u00ecnh luy\u1ec7n t\u1eadp (training program), c\u00f3 l\u1ebd \u0111\u01b0\u1ee3c l\u1ea7n \u0111\u1ea7u \u0111\u01b0\u1ee3c vi\u1ebft ra. N\u00f3 d\u1ef1a tr\u00ean kinh nghi\u1ec7m l\u1eadp tr\u00ecnh thi \u0111\u1ea5u c\u1ee7a b\u1ea3n th\u00e2n m\u00ecnh. N\u1ebfu c\u00f3 b\u00ecnh lu\u1eadn g\u00ec xin h\u00e3y \u0111\u1ec3 l\u1ea1i \u1edf d\u01b0\u1edbi.</p>"},{"location":"misc/experience/being-better/#chuong-trinh-luyen-tap","title":"Ch\u01b0\u01a1ng tr\u00ecnh luy\u1ec7n t\u1eadp","text":""},{"location":"misc/experience/being-better/#triet-ly-ao-tao","title":"Tri\u1ebft l\u00fd \u0111\u00e0o t\u1ea1o","text":"<p>Tr\u01b0\u1edbc n\u0103m 16 tu\u1ed5i, m\u00ecnh tham gia thi Orienteering (\u0111i t\u1eeb \u0111i\u1ec3m A \u0111\u1ebfn \u0111i\u1ec3m B trong r\u1eebng, d\u00f9ng b\u1ea3n \u0111\u1ed3 v\u00e0 la b\u00e0n). M\u00ecnh luy\u1ec7n t\u1eadp r\u1ea5t nhi\u1ec1u, ch\u1ea1y 1700 km m\u1ed7i n\u0103m tr\u00ean n\u00fai. Sau \u0111\u00f3 m\u00ecnh g\u1eb7p m\u1ed9t s\u1ed1 v\u1ea5n \u0111\u1ec1 s\u1ee9c kh\u1ecfe v\u00e0 ngh\u1ec9 thi \u0111\u1ea5u. M\u00ecnh c\u00f3 nhi\u1ec1u th\u1eddi gian r\u1ea3nh n\u00ean \u0111\u00e3 luy\u1ec7n t\u1eadp cho c\u00e1c cu\u1ed9c thi to\u00e1n v\u00e0 tin h\u1ecdc. M\u00ecnh d\u00f9ng m\u1ed9t s\u1ed1 ph\u01b0\u01a1ng ph\u00e1p luy\u1ec7n t\u1eadp trong th\u1ec3 thao \u0111\u1ec3 \u00e1p d\u1ee5ng cho vi\u1ec7c luy\u1ec7n t\u1eadp c\u1ee7a m\u00ecnh.</p> <p>M\u00ecnh ngh\u0129 th\u1ec3 thao v\u00e0 l\u1eadp tr\u00ecnh thi \u0111\u1ea5u c\u00f3 nhi\u1ec1u \u0111i\u1ec3m chung. T\u01b0\u01a1ng t\u1ef1 nh\u01b0 th\u1ec3 thao, b\u1ea1n s\u1ebd kh\u00f4ng c\u1ea3i thi\u1ec7n nhi\u1ec1u n\u1ebfu ch\u1ec9 luy\u1ec7n 1 ki\u1ec3u. Luy\u1ec7n t\u1eadp ph\u1ea3i \u0111a d\u1ea1ng v\u00e0 c\u1ea7n t\u1eadp trung v\u00e0o nh\u1eefng \u0111i\u1ec3m y\u1ebfu c\u1ee7a b\u1ea1n.</p> <p>L\u1ea5y v\u00ed d\u1ee5 nh\u01b0 trong b\u00f3ng \u0111\u00e1, gi\u1ea3 s\u1eed b\u1ea1n l\u00e0 m\u1ed9t ti\u1ec1n \u0111\u1ea1o. B\u1ea1n r\u1ea5t gi\u1ecfi ghi b\u00e0n nh\u01b0ng y\u1ebfu trong vi\u1ec7c s\u00fat penalty. B\u1ea1n c\u00f3 th\u1ec3 luy\u1ec7n t\u1eadp nh\u01b0 tr\u01b0\u1edbc \u0111\u00e2y v\u00e0 \u0111\u00e1 2-3 qu\u1ea3 pen m\u1ed9t tu\u1ea7n khi c\u00f3 c\u01a1 h\u1ed9i trong m\u1ed9t tr\u1eadn \u0111\u1ea5u t\u1eadp ho\u1eb7c trong m\u1ed9t tr\u1eadn ch\u00ednh th\u1ee9c. Nh\u01b0ng kh\u00f4ng ph\u1ea3i s\u1ebd t\u1ed1t h\u01a1n n\u1ebfu b\u1ea1n \u1edf l\u1ea1i t\u1eadp \u0111\u00e1 pen th\u00eam 15 ph\u00fat m\u1ed7i bu\u1ed5i n\u1eefa sao?</p> <p>L\u1eadp tr\u00ecnh thi \u0111\u1ea5u c\u0169ng y v\u1eady th\u00f4i. N\u1ebfu b\u1ea1n hi\u1ebfm khi gi\u1ea3i b\u00e0i t\u1eadp h\u00ecnh h\u1ecdc trong m\u1ed9t contest, v\u00e0 b\u1ea1n luy\u1ec7n tr\u00ean TopCoder nhi\u1ec1u, b\u1ea1n s\u1ebd kh\u00f4ng thu \u0111\u01b0\u1ee3c g\u00ec c\u1ea3, v\u00ec TopCoder c\u0169ng hi\u1ebfm b\u00e0i h\u00ecnh y nh\u01b0 v\u1eady. B\u1ea1n c\u1ea7n t\u00ecm c\u00e1ch kh\u00e1c \u0111\u1ec3 luy\u1ec7n.</p> <p>Luy\u1ec7n t\u1eadp c\u1ea7n \u0111a d\u1ea1ng. M\u00ecnh \u0111\u1ec3 \u00fd r\u1eb1ng nhi\u1ec1u tr\u01b0\u1eddng \u0111\u1ea1i h\u1ecdc ch\u1ec9 luy\u1ec7n theo \u0111\u1ed9i cho ACM-ICPC. T\u1ea1i KTH (tr\u01b0\u1eddng c\u1ee7a t\u00e1c gi\u1ea3), b\u1ecdn m\u00ecnh luy\u1ec7n c\u00e1 nh\u00e2n v\u00e0o m\u00f9a xu\u00e2n v\u00e0 team v\u00e0o m\u00f9a thu. M\u00ecnh ngh\u0129 c\u1ea3 2 ki\u1ec3u luy\u1ec7n n\u00e0y \u0111\u1ec1u quan tr\u1ecdng. V\u00ed d\u1ee5, b\u1ea1n c\u00f3 th\u1ec3 kh\u00f4ng bao gi\u1edd gi\u1ea3i m\u1ed9t b\u00e0i Quy ho\u1ea1ch \u0111\u1ed9ng (Dynamic Programming - DP) trong su\u1ed1t qu\u00e1 tr\u00ecnh train team, v\u00ec \u0111\u1ed3ng \u0111\u1ed9i lu\u00f4n gi\u1ea3i \u0111\u01b0\u1ee3c ki\u1ec3u b\u00e0i \u0111\u00f3 tr\u01b0\u1edbc khi b\u1ea1n c\u00f3 c\u01a1 h\u1ed9i \u0111\u1ecdc xem \u0111\u1ec1 b\u00e0i vi\u1ebft g\u00ec. Khi train c\u00e1 nh\u00e2n, b\u1ea1n s\u1ebd b\u1ecb bu\u1ed9c ph\u1ea3i gi\u1ea3i nh\u1eefng b\u00e0i \u0111\u00f3, v\u00e0 c\u00f3 th\u1ec3 h\u1ecdc \u0111\u01b0\u1ee3c nhi\u1ec1u th\u1ee9 h\u01a1n.</p> <p>Ch\u01b0\u01a1ng tr\u00ecnh luy\u1ec7n t\u1eadp c\u1ee7a b\u1ecdn m\u00ecnh g\u1ed3m 7 m\u1ea3ng. Ch\u01b0\u01a1ng tr\u00ecnh luy\u1ec7n t\u1eadp trong th\u1ec3 thao th\u01b0\u1eddng y\u00eau c\u1ea7u b\u1ea1n n\u00ean l\u00e0m th\u1ee9 n\u00e0y 2 l\u1ea7n m\u1ed7i tu\u1ea7n trong v\u00f2ng 1 ti\u1ebfng, l\u00e0m th\u1ee9 kh\u00e1c 1 l\u1ea7n 1 tu\u1ea7n trong 30 ph\u00fat, ho\u1eb7c th\u1ee9 g\u00ec \u0111\u00f3 \u0111\u1ea1i lo\u1ea1i th\u1ebf. Kh\u00f3 m\u00e0 l\u00e0m y v\u1eady trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u, v\u00ec m\u1ed7i ng\u01b0\u1eddi c\u00f3 m\u1ed9t xu\u1ea5t ph\u00e1t \u0111i\u1ec3m kh\u00e1c nhau, th\u1eadm ch\u00ed r\u1ea5t kh\u00e1c nhau. Thay v\u00e0o \u0111\u00f3, b\u1ea1n n\u00ean t\u1ef1 \u0111\u00e1nh gi\u00e1 b\u1ea3n th\u00e2n, x\u00e1c \u0111\u1ecbnh \u0111i\u1ec3m m\u1ea1nh, y\u1ebfu v\u00e0 ch\u1ecdn ph\u01b0\u01a1ng ph\u00e1p cho ri\u00eang m\u00ecnh. B\u1ea1n c\u00f3 th\u1ec3 nh\u1edd m\u1ed9t ng\u01b0\u1eddi kinh nghi\u1ec7m h\u01a1n ho\u1eb7c hu\u1ea5n luy\u1ec7n vi\u00ean \u0111\u1ed9i b\u1ea1n gi\u00fap b\u1ea1n t\u00ecm ra c\u00e1ch luy\u1ec7n hi\u1ec7u qu\u1ea3 nh\u1ea5t.</p> <p>N\u00ean ho\u00e0n th\u00e0nh c\u1ea3 7 m\u1ea3ng, nh\u01b0ng th\u1eddi gian c\u1ea7n cho m\u1ed7i m\u1ea3ng th\u00ec kh\u00e1c nhau \u0111\u1ed1i v\u1edbi m\u1ed7i b\u1ea1n.</p>"},{"location":"misc/experience/being-better/#hoc-thuat-toan-va-cau-truc-du-lieu","title":"H\u1ecdc thu\u1eadt to\u00e1n v\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u","text":"<p>Khi c\u1ed1 g\u1eafng \u0111\u1ec3 gi\u1ecfi h\u01a1n trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u, \u0111\u1ea7u ti\u00ean m\u1ecdi ng\u01b0\u1eddi h\u1ecdc thu\u1eadt to\u00e1n v\u00e0 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u. Trong c\u1ea3 7 m\u1ea3ng, m\u1ea3ng n\u00e0y \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n m\u1ea1nh nh\u1ea5t. C\u00f3 h\u00e0ng t\u00e1 s\u00e1ch, h\u01b0\u1edbng d\u1eabn v\u00e0 kh\u00f3a h\u1ecdc gi\u00fap b\u1ea1n n\u00e2ng cao m\u1ea3ng n\u00e0y.</p> <p>M\u00ecnh gi\u1edbi thi\u1ec7u c\u00e1c b\u1ea1n cu\u1ed1n Introduction to Algorithms c\u1ee7a Cormen, Leiserson, Rivest v\u00e0 Stein. Ngo\u00e0i ra c\u00f2n c\u00f3 nh\u1eefng tutorial t\u1ed1t tr\u00ean TopCoder. V\u1edbi c\u00e1c kh\u00f3a h\u1ecdc thu\u1eadt to\u00e1n, b\u1ea1n n\u00ean t\u00ecm trong tr\u01b0\u1eddng c\u1ee7a ch\u00ednh m\u00ecnh ho\u1eb7c t\u00ecm tr\u00ean m\u1ea1ng xem c\u00f3 kh\u00f3a online n\u00e0o kh\u00f4ng. N\u1ebfu b\u1ea1n \u1edf KTH (tr\u01b0\u1eddng c\u1ee7a t\u00e1c gi\u1ea3), \u0111\u0103ng k\u00fd kh\u00f3a Algoritmer, datastrukturer och komplexitet v\u00e0 Probleml\u00f6sning och programmering under press c\u00e0ng s\u1edbm c\u00e0ng t\u1ed1t trong n\u0103m 1 v\u00e0 n\u0103m 2. T\u1eeb 2013, kh\u00f3a th\u1ee9 2 \u1edf tr\u00ean \u0111\u01b0\u1ee3c d\u1ea1y b\u1edfi Peter Austrin (red coder tr\u00ean TopCoder) v\u00e0 m\u1ed9t s\u1ed1 b\u1ea1n thi l\u1eadp tr\u00ecnh thi \u0111\u1ea5u c\u1ee7a KTH th\u01b0\u1eddng tham gia tr\u1ee3 gi\u1ea3ng.</p> <p>Tuy nhi\u00ean, \u0111\u00e2y ch\u1ec9 l\u00e0 ph\u1ea7n nh\u1ecf c\u1ee7a vi\u1ec7c tr\u1edf th\u00e0nh l\u1eadp tr\u00ecnh vi\u00ean gi\u1ecfi v\u00e0 n\u00f3 h\u01a1i b\u1ecb \u0111\u00e1nh gi\u00e1 cao qu\u00e1 m\u1ee9c. B\u1ea1n ho\u00e0n to\u00e0n c\u00f3 th\u1ec3 ti\u1ebfn xa m\u00e0 kh\u00f4ng ph\u1ea3i bi\u1ebft qu\u00e1 nhi\u1ec1u thu\u1eadt to\u00e1n v\u00e0 c\u00e1c m\u1ea3ng kh\u00e1c c\u1ee7a ch\u01b0\u01a1ng tr\u00ecnh luy\u1ec7n t\u1eadp c\u00f3 th\u1ec3 gi\u00fap b\u1ea1n nhi\u1ec1u h\u01a1n.</p> <p>\u0110\u1ec3 m\u00ecnh gi\u1ea3i th\u00edch t\u1ea1i sao b\u1ea1n kh\u00f4ng n\u00ean h\u1ecdc qu\u00e1 nhi\u1ec1u b\u1eb1ng ph\u00e9p lo\u1ea1i suy nha. Gi\u1ea3 s\u1eed b\u1ea1n quy\u1ebft \u0111\u1ecbnh \u0111i xe \u0111\u1ea1p leo n\u00fai m\u00e0 ch\u01b0a bao gi\u1edd \u0111\u1ea1p xe tr\u01b0\u1edbc \u0111\u00f3. B\u1ea1n l\u00ean m\u1ea1ng, coi clip tr\u00ean YouTube v\u00e0 mua m\u1ed9t quy\u1ec3n s\u00e1ch d\u00e0y 150 trang v\u1ec1 xe \u0111\u1ea1p leo n\u00fai. Sau 2 th\u00e1ng c\u00e0y cu\u1ed1c, b\u1ea1n quy\u1ebft \u0111\u1ecbnh th\u1eed \u0111i xem sao. B\u1ea1n c\u1ed1 g\u1eafng nh\u1edb m\u1ecdi th\u1ee9 b\u1ea1n \u0111\u1ecdc, xem v\u00e0 th\u1ef1c s\u1ef1 n\u00f3 qu\u00e1 nhi\u1ec1u, \u00e1p \u0111\u1ea3o t\u00e2m tr\u00ed b\u1ea1n. B\u1ea1n b\u1eaft \u0111\u1ea7u n\u00f3ng gi\u1eadn v\u1edbi b\u1ea3n th\u00e2n, v\u00ec b\u1ea1n ng\u00e3 nhi\u1ec1u qu\u00e1 trong khi b\u1ea1n h\u1ecdc nhi\u1ec1u ch\u1ea3 k\u00e9m. B\u1ea1n b\u1ecf \u0111\u1ea1p xe lu\u00f4n.</p> <p>Nghe bu\u1ed3n c\u01b0\u1eddi kh\u00f4ng? Gi\u1edd thay \"\u0111\u1ea1p xe\" b\u1eb1ng \"l\u1eadp tr\u00ecnh\" \u0111i. T\u1ea5t nhi\u00ean 2 th\u1ee9 \u0111\u00f3 kh\u00f4ng ph\u1ea3i l\u00e0 1, nh\u01b0ng vi\u1ec7c nh\u1ed3i nh\u00e9t t\u1ea5t c\u1ea3 ki\u1ebfn th\u1ee9c c\u00f3 s\u1eb5n th\u01b0\u1eddng g\u00e2y h\u1ea1i h\u01a1n l\u00e0 c\u00f3 l\u1ee3i cho b\u1ea1n. Thay v\u00e0o \u0111\u00f3, b\u1ea1n n\u00ean b\u1eaft \u0111\u1ea7u gi\u1ea3i b\u00e0i v\u00e0 h\u1ecdc thu\u1eadt to\u00e1n song song v\u1edbi nhau. B\u1ea1n s\u1ebd th\u1ea5y khi n\u00e0o v\u00e0 l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 thu\u1eadt to\u00e1n \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\u00e1c b\u00e0i to\u00e1n. Con ng\u01b0\u1eddi h\u1ecdc b\u1eb1ng c\u00e1ch th\u1ef1c h\u00e0nh v\u00e0 b\u1ea1n c\u1ea7n ph\u1ea3i t\u1ea1o  ra sai l\u1ea7m \u0111\u1ec3 h\u1ecdc t\u1ed1t h\u01a1n. N\u1ebfu kh\u00f4ng th\u1ea5t b\u1ea1i, b\u1ea1n s\u1ebd kh\u00f4ng h\u1ecdc \u0111\u01b0\u1ee3c g\u00ec. B\u1ea1n c\u00f3 th\u1ec3 \u0111\u1ecdc v\u1ec1 th\u1ea5t b\u1ea1i \u1edf ph\u1ea7n d\u01b0\u1edbi.</p> <p>Nh\u1eefng lu\u1eadn \u0111i\u1ec3m n\u00e0y \u0111\u01b0\u1ee3c ch\u1ee9ng minh b\u1eb1ng nghi\u00ean c\u1ee9u r\u1ed3i. H\u00f3a ra s\u1ebd t\u1ed1t h\u01a1n n\u1ebfu b\u1ea1n t\u1ef1 gi\u1ea3i b\u00e0i tr\u01b0\u1edbc khi \u0111\u1ecdc h\u01b0\u1edbng d\u1eabn. V\u00ed d\u1ee5, trong l\u1edbp h\u1ecdc thu\u1eadt to\u00e1n, b\u1ea1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c y\u00eau c\u1ea7u \u0111\u1ec3 vi\u1ebft thu\u1eadt t\u00ecm \u0111\u01b0\u1eddng \u0111i ng\u1eafn nh\u1ea5t trong \u0111\u1ed3 th\u1ecb kh\u00f4ng tr\u1ecdng s\u1ed1 m\u00e0 kh\u00f4ng c\u00f3 th\u00f4ng tin g\u00ec v\u1ec1 c\u1ea5u tr\u00fac d\u1eef li\u1ec7u v\u00e0 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian. B\u1ea1n s\u1ebd c\u00f3 th\u1ec3 m\u00f2 ra \u0111\u01b0\u1ee3c g\u00ec \u0111\u00f3 gi\u1ed1ng BFS (Breadth First Search - t\u00ecm ki\u1ebfm theo chi\u1ec1u r\u1ed9ng) nh\u01b0ng v\u00ec b\u1ea1n ch\u01b0a bao gi\u1edd nghe \u0111\u1ebfn Queue (h\u00e0ng \u0111\u1ee3i) hay \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian, thu\u1eadt c\u1ee7a b\u1ea1n s\u1ebd ch\u1eadm h\u01a1n m\u1ed9t t\u00ed. Trong ti\u1ebft ti\u1ebfp theo gi\u00e1o vi\u00ean s\u1ebd tr\u00ecnh b\u00e0y solution li\u00ean quan \u0111\u1ebfn h\u00e0ng \u0111\u1ee3i v\u00e0 s\u1ebd n\u00f3i cho b\u1ea1n bi\u1ebft l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 \u0111\u00e1nh gi\u00e1 \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a code. Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y hi\u1ec7u qu\u1ea3 h\u01a1n vi\u1ec7c tr\u00ecnh b\u00e0y thu\u1eadt tr\u01b0\u1edbc r\u1ed3i gi\u1ea3i b\u00e0i sau.</p>"},{"location":"misc/experience/being-better/#cai-thien-kha-nang-giai-quyet-van-e","title":"C\u1ea3i thi\u1ec7n kh\u1ea3 n\u0103ng gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1","text":"<p>\u0110\u00e2y l\u00e0 m\u1ea3ng kh\u00f3 nh\u1ea5t trong ch\u01b0\u01a1ng tr\u00ecnh luy\u1ec7n t\u1eadp. M\u1ee5c ti\u00eau t\u1ed1i th\u01b0\u1ee3ng l\u00e0 t\u0103ng c\u01b0\u1eddng s\u1ef1 th\u00f4ng minh. B\u1ea1n c\u00f3 th\u1ec3 \u0111\u00e3 nghe n\u00f3i r\u1eb1ng tr\u00ed th\u00f4ng minh l\u00e0 th\u1ee9 \u0111\u01b0\u1ee3c k\u1ebf th\u1eeba v\u00e0 kh\u00f4ng th\u1ec3 thay \u0111\u1ed5i \u0111\u01b0\u1ee3c, nh\u01b0ng th\u1eadt ra b\u1ea1n c\u00f3 th\u1ec3 t\u0103ng nh\u1eb9 n\u00f3 (ho\u1eb7c gi\u1ea3m nh\u1eb9 b\u1eb1ng s\u1ef1 l\u01b0\u1eddi nh\u00e1c). \u0110\u00e1ng ti\u1ebfc l\u00e0 kh\u00f4ng c\u00f3 nhi\u1ec1u th\u00f4ng tin v\u1ec1 ch\u1ee7 \u0111\u1ec1 n\u00e0y.</p> <p>Khi b\u1ea1n nh\u00ecn v\u00e0o b\u1ea3ng rating c\u1ee7a m\u00ecnh tr\u00ean TopCoder, b\u1ea1n c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng trong c\u1ea3 2 n\u0103m 2006 v\u00e0 2007, rating c\u1ee7a m\u00ecnh t\u0103ng nh\u01b0ng t\u0103ng nhi\u1ec1u h\u01a1n trong n\u0103m 2007. Ph\u1ea7n l\u1edbn n\u0103m 2006 rating m\u00ecnh l\u00e0 1900 - 2100 trong khi 2007 m\u00ecnh t\u0103ng l\u00ean 2300. N\u1eeda \u0111\u1ea7u 2006, sau khi kh\u00f4ng t\u0103ng \u0111\u01b0\u1ee3c rating, m\u00ecnh ngh\u0129 m\u00ecnh \u0111\u00e3 \u0111\u1ea1t \u0111\u1ec9nh v\u00e0 m\u00ecnh s\u1ebd k\u1eb9t \u1edf kho\u1ea3ng 2000 - 2100 m\u00e3i m\u00e3i.</p> <p>C\u00f3 th\u1ec3 b\u1ea1n ngh\u0129 r\u1eb1ng m\u00ecnh luy\u1ec7n nhi\u1ec1u h\u01a1n trong n\u0103m 2007, nh\u01b0ng kh\u00f4ng ph\u1ea3i. N\u0103m 2007 m\u00ecnh l\u00e0m 2 ng\u00e0y 1 tu\u1ea7n cho 1 c\u00f4ng ty, ph\u1ea3i vi\u1ebft lu\u1eadn \u00e1n t\u1ed1t nghi\u1ec7p, d\u1ea1y v\u00e0 gi\u00fap \u0111\u1ed9i Olympic Slovakia, ch\u01a1i frisbee kh\u00f4ng chuy\u00ean v\u00e0 tr\u1edf n\u00ean n\u0103ng \u0111\u1ed9ng h\u01a1n trong x\u00e3 h\u1ed9i. M\u00ecnh c\u00f3 \u00edt th\u1eddi gian luy\u1ec7n t\u1eadp l\u1eadp tr\u00ecnh.</p> <p>Thay v\u00ec t\u0103ng s\u1ed1 l\u01b0\u1ee3ng, m\u00ecnh t\u0103ng ch\u1ea5t l\u01b0\u1ee3ng luy\u1ec7n t\u1eadp. M\u00ecnh b\u1eaft \u0111\u1ea7u l\u00e0m c\u00e1c b\u00e0i kh\u00f3 h\u01a1n. Khi gi\u1ea3i nhi\u1ec1u b\u00e0i d\u1ec5, b\u1ea1n h\u1ecdc c\u00e1ch \u0111\u00e1nh m\u00e1y nhanh h\u01a1n v\u00e0 kh\u00f4ng m\u1eafc sai l\u1ea7m, nh\u01b0ng kh\u00f4ng th\u00e1ch th\u1ee9c b\u1ea3n th\u00e2n nhi\u1ec1u. M\u1eb7c kh\u00e1c, b\u1ea1n kh\u00f4ng n\u00ean th\u1eed th\u00e1ch b\u1ea3n th\u00e2n qu\u00e1 nhi\u1ec1u, v\u00ec khi \u0111\u00f3 b\u1ea1n s\u1ebd tuy\u1ec7t v\u1ecdng n\u1ebfu b\u00e0i qu\u00e1 kh\u00f3. T\u00e2m l\u00fd h\u1ecdc g\u1ecdi hi\u1ec7n t\u01b0\u1ee3ng n\u00e0y l\u00e0 Zone of proximal development.</p> <p>M\u00ecnh th\u00edch gi\u1ea3i b\u00e0i theo h\u01b0\u1edbng \"\u1ea9n d\u1ee5 n\u1ed9i th\u1ea5t\" (furniture metaphor). T\u01b0\u1edfng t\u01b0\u1ee3ng b\u1ea1n c\u00f3 1 c\u00e1i nh\u00e0 v\u00e0 b\u1ea1n mua 1 c\u00e1i b\u00e0n to \u0111\u1ec3 mang l\u00ean t\u1ea7ng 2. N\u1ebfu c\u1eeda v\u00e0 c\u1ea7u thang qu\u00e1 nh\u1ecf, b\u1ea1n ph\u1ea3i th\u00e1o c\u00e1i b\u00e0n ho\u1eb7c c\u1eaft n\u00f3 ra. Sau khi mang c\u00e1c m\u1ea3nh nh\u1ecf l\u00ean t\u1ea7ng 2, b\u1ea1n gh\u00e9p ch\u00fang l\u1ea1i nh\u01b0ng m\u1ea5t nhi\u1ec1u th\u1eddi gian. Kh\u00f4ng ph\u1ea3i s\u1ebd t\u1ed1t h\u01a1n n\u1ebfu c\u00f3 c\u1eeda to v\u00e0 c\u1ea7u thang r\u1ed9ng sao?</p> <p>Khi gi\u1ea3i 1 b\u00e0i t\u1eadp, b\u1ea1n c\u1ed1 g\u1eafng cho b\u00e0i to\u00e1n v\u00e0o n\u00e3o b\u1ed9 m\u00ecnh theo c\u00e1ch t\u01b0\u01a1ng t\u1ef1 c\u00e1i b\u00e0n trong nh\u00e0. N\u1ebfu b\u00e0i to\u00e1n qu\u00e1 ph\u1ee9c t\u1ea1p, b\u1ea1n ph\u1ea3i c\u1eaft nh\u1ecf ch\u00fang ra, gi\u1ea3i quy\u1ebft h\u1ebft c\u00e1c b\u00e0i to\u00e1n nh\u1ecf, gh\u00e9p l\u1ea1i th\u00e0nh b\u00e0i to\u00e1n l\u1edbn. Khi b\u1ea1n th\u00f4ng minh h\u01a1n, n\u00e3o b\u1ea1n \"to l\u00ean\", th\u00ec khi \u0111\u00f3 b\u1ea1n c\u00f3 th\u1ec3 cho c\u00e1c b\u00e0i to\u00e1n kh\u00f3 h\u01a1n v\u00e0o m\u00e0 kh\u00f4ng c\u1ea7n c\u1eaft nh\u1ecf n\u1eefa.</p> <p>C\u00e2u h\u1ecfi c\u00f2n l\u1ea1i l\u00e0 l\u00e0m sao t\u00ecm \u0111\u01b0\u1ee3c b\u00e0i t\u1eadp n\u1eb1m ngo\u00e0i v\u00f9ng an to\u00e0n m\u00e0 kh\u00f4ng qu\u00e1 kh\u00f3. B\u1ea1n c\u00f3 th\u1ec3 t\u00ecm c\u00e1ch kh\u00e1c nh\u01b0ng \u0111\u00e2y l\u00e0 c\u00e1ch m\u00ecnh l\u00e0m. M\u00ecnh th\u00edch SPOJ v\u00ec c\u00f3 nhi\u1ec1u b\u00e0i hay. V\u1edbi m\u1ed7i b\u00e0i b\u1ea1n c\u00f3 th\u1ec3 xem s\u1ed1 ng\u01b0\u1eddi l\u00e0m \u0111\u01b0\u1ee3c. L\u00fac \u0111\u1ea7u, m\u00ecnh coi b\u00e0i c\u00f3 150 - 200 ng\u01b0\u1eddi gi\u1ea3i v\u00e0 l\u00e0m trong v\u00e0i th\u00e1ng. Khi m\u00ecnh th\u1ea5y n\u00f3 d\u1ec5 v\u00e3i r\u1ed3i, m\u00ecnh l\u00e0m c\u00e1c b\u00e0i 100 - 150 v\u00e0 c\u1ee9 nh\u01b0 th\u1ebf. B\u1ea1n c\u00f3 th\u1ec3 l\u00e0m t\u01b0\u01a1ng t\u1ef1 tr\u00ean TopCoder. B\u1eaft \u0111\u1ea7u v\u1edbi Div 2 Easy v\u00e0 \u0111\u1ebfn Div 1. Khi c\u00f3 v\u1ea5n \u0111\u1ec1 khi gi\u1ea3i b\u00e0i, h\u1ecfi ai \u0111\u00f3 kinh nghi\u1ec7m h\u01a1n, hu\u1ea5n luy\u1ec7n vi\u00ean ho\u1eb7c tr\u00ean di\u1ec5n \u0111\u00e0n. C\u00f3 nhi\u1ec1u c\u1ed9ng \u0111\u1ed3ng online, n\u01a1i c\u00f3 nhi\u1ec1u b\u1ea1n s\u1eb5n l\u00f2ng gi\u00fap b\u1ea1n.</p>"},{"location":"misc/experience/being-better/#cai-thien-ki-nang-lap-trinh","title":"C\u1ea3i thi\u1ec7n k\u0129 n\u0103ng l\u1eadp tr\u00ecnh","text":"<p>Sau khi t\u00ecm ra \u0111\u01b0\u1ee3c solution, b\u1ea1n ph\u1ea3i code n\u00f3. Trong \u0111i\u1ec1u ki\u1ec7n l\u00fd t\u01b0\u1edfng, b\u1ea1n vi\u1ebft code ho\u00e0n h\u1ea3o m\u00e0 kh\u00f4ng c\u1ea7n debug. B\u1ea1n c\u00f3 th\u1ec3 ngh\u0129 r\u1eb1ng \u0111i\u1ec1u n\u00e0y l\u00e0 kh\u00f4ng th\u1ec3 nh\u01b0ng n\u1ebfu b\u1ea1n xem c\u00e1c cao th\u1ee7 tr\u00ean TopCoder, \u0111\u00e2y ch\u00ednh l\u00e0 th\u1ee9 m\u00e0 h\u1ecd l\u00e0m. Sau khi ra solution, h\u1ecd code th\u01b0\u1eddng tr\u00fang lu\u00f4n trong ph\u00e1t \u0111\u1ea7u ti\u00ean. T\u1ea5t nhi\u00ean, vi\u1ec7c n\u00e0y kh\u00f4ng d\u1ec5 v\u00e0 ph\u1ea3i m\u1ea5t nhi\u1ec1u th\u1eddi gian.</p> <p>T\u01b0\u01a1ng t\u1ef1 nh\u01b0 m\u1ea3ng \"C\u1ea3i thi\u1ec7n kh\u1ea3 n\u0103ng gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1\", b\u1ea1n c\u1ea3i thi\u1ec7n kh\u1ea3 n\u0103ng l\u1eadp tr\u00ecnh v\u1edbi c\u00e1c b\u00e0i n\u1eb1m trong v\u00f9ng \"ra solution\" an to\u00e0n nh\u01b0ng n\u1eb1m ngo\u00e0i v\u00f9ng \"code\" an to\u00e0n. \u0110\u00e2y l\u00e0 c\u00e1c b\u00e0i b\u1ea1n ngh\u0129 ra solution nhanh nh\u01b0ng code ch\u00fang t\u1ed1n nhi\u1ec1u th\u1eddi gian v\u00e0 l\u00e0m b\u1ea1n sai nhi\u1ec1u khi submit.</p> <p>Khi b\u1eaft \u0111\u1ea7u luy\u1ec7n t\u1eadp, m\u00ecnh gi\u1ea3i r\u1ea5t nhi\u1ec1u b\u00e0i d\u1ec5. C\u00f3 tu\u1ea7n m\u00ecnh to\u00e0n l\u00e0m Div 2 Easy tr\u00ean TopCoder. T\u1ea5t nhi\u00ean, b\u1ea1n s\u1ebd tr\u1edf n\u00ean ph\u00e1t ch\u00e1n nh\u01b0ng cu\u1ed1i c\u00f9ng b\u00e0i c\u1ee7a b\u1ea1n \u0111\u00fang trong l\u1ea7n submit \u0111\u1ea7u ti\u00ean. Sau \u0111\u00f3 l\u00ean Div 2 Medium v\u00e0 c\u1ee9 nh\u01b0 th\u1ebf.</p>"},{"location":"misc/experience/being-better/#code-va-debug-tren-giay","title":"Code v\u00e0 Debug tr\u00ean gi\u1ea5y","text":"<p>B\u00e2y gi\u1edd kh\u00f4ng nhi\u1ec1u b\u1ea1n code tr\u00ean gi\u1ea5y, nh\u01b0ng \u0111\u00f3 c\u0169ng l\u00e0 c\u00e1ch luy\u1ec7n t\u1eadp hay. B\u1ea1n ph\u1ea3i ngh\u0129 nhi\u1ec1u h\u01a1n tr\u01b0\u1edbc khi b\u1eaft \u0111\u1ea7u code v\u00ec hi\u1ec3n nhi\u00ean l\u00e0 kh\u00f3 m\u00e0 s\u1eeda code tr\u00ean gi\u1ea5y \u0111\u01b0\u1ee3c. Khi code tr\u00ean m\u00e1y, b\u1ea1n th\u01b0\u1eddng code ngay, k\u1ec3 c\u1ea3 tr\u01b0\u1edbc khi ch\u1eafc r\u1eb1ng solution c\u1ee7a m\u00ecnh \u0111\u00fang. B\u1ea1n s\u1ebd ngh\u0129 r\u1eb1ng b\u1ea1n c\u00f3 th\u1ec3 s\u1eeda code nhanh tr\u00ean m\u00e1y khi c\u00f3 bug. Tuy nhi\u00ean, nhi\u1ec1u l\u00fac nh\u1eefng bug \u0111\u00f3 n\u1eb7ng \u0111\u1ebfn m\u1ee9c b\u1ea1n c\u1ea7n code l\u1ea1i m\u1ecdi th\u1ee9. Code tr\u00ean gi\u1ea5y gi\u00fap b\u1ea1n tr\u00e1nh nh\u1eefng th\u1ee9 \u0111\u00f3, v\u00ec n\u00f3 bu\u1ed9c b\u1ea1n ph\u1ea3i ngh\u0129 t\u1ea5t c\u1ea3 c\u00e1c tr\u01b0\u1eddng h\u1ee3p. Ngo\u1ea3i ra, m\u1ee5c ti\u00eau c\u1ee7a ch\u00fang ta l\u00e0 h\u1ecdc code \u0111\u00fang trong l\u1ea7n \u0111\u1ea7u ti\u00ean m\u00e0 kh\u00f4ng ph\u1ea3i s\u1eeda nhi\u1ec1u, c\u00e1ch n\u00e0y r\u1ea5t ho\u00e0n h\u1ea3o \u0111\u1ec3 \u0111\u1ea1t \u0111\u1ebfn m\u1ee5c ti\u00eau \u0111\u00f3.</p> <p>\u0110\u00e2y c\u0169ng l\u00e0 m\u1ed9t k\u0129 n\u0103ng h\u1eefu \u00edch trong ACM-ICPC, v\u00ec b\u1ea1n ch\u1ec9 c\u00f3 1 m\u00e1y t\u00ednh v\u00e0 b\u1ea1n n\u00ean code tr\u00ean gi\u1ea5y c\u00e0ng s\u1edbm c\u00e0ng t\u1ed1t khi c\u00f3 solution, \u0111\u1ebfn khi b\u1ea1n d\u00f9ng m\u00e1y th\u00ec b\u1ea1n kh\u00f4ng ph\u00ed th\u1eddi gian ngh\u0129 nh\u1eefng th\u1ee9 kh\u00e1c n\u1eefa.</p> <p>\u00c0 m\u00e0 c\u0169ng c\u1ea7n debug tr\u00ean gi\u1ea5y n\u1eefa. In m\u1ed9t s\u1ed1 output c\u1ea7n thi\u1ebft khi ch\u1ea1y ch\u01b0\u01a1ng tr\u00ecnh, in code ra v\u00e0 \u0111\u1ecdc khi b\u1ea1n ng\u1ed3i tr\u00ean xe bus ho\u1eb7c t\u00e0u. Debug tr\u00ean m\u00e1y t\u1ed1n nhi\u1ec1u th\u1eddi gian v\u00e0 trong nhi\u1ec1u tr\u01b0\u1eddng h\u1ee3p debug tr\u00ean gi\u1ea5y nhanh h\u01a1n.</p>"},{"location":"misc/experience/being-better/#thi-au","title":"Thi \u0111\u1ea5u","text":"<p>B\u1ea1n n\u00ean thi \u0111\u1ea5u c\u00e0ng nhi\u1ec1u c\u00e0ng t\u1ed1t v\u00ec m\u1ee5c ti\u00eau c\u1ee7a b\u1ea1n l\u00e0 th\u00e0nh c\u00f4ng trong c\u00e1c cu\u1ed9c thi. Khi gi\u1ea3i b\u00e0i \u1edf nh\u00e0, b\u1ea1n kh\u00f4ng c\u0103ng th\u1eb3ng v\u00e0 b\u1ea1n c\u00f3 nhi\u1ec1u th\u1eddi gian. Trong k\u00ec thi, th\u1eddi gian l\u00e0 \u00e1p l\u1ef1c, n\u00f3 c\u00f3 th\u1ec3 l\u00e0m gi\u1ea3m kh\u1ea3 n\u0103ng gi\u1ea3i b\u00e0i c\u1ee7a b\u1ea1n. Trong \u0111i\u1ec1u ki\u1ec7n l\u00fd t\u01b0\u1edfng, b\u1ea1n s\u1ebd thi \u0111\u1ea5u t\u1ed1t trong \u00e1p l\u1ef1c h\u01a1n l\u00e0 kh\u00f4ng c\u00f3 \u00e1p l\u1ef1c n\u00e0o.</p> <p>B\u1eb1ng vi\u1ec7c luy\u1ec7n t\u1eadp, b\u1ea1n h\u1ecdc \u0111\u01b0\u1ee3c c\u00e1ch x\u1eed l\u00fd c\u0103ng th\u1eb3ng v\u00e0 b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 h\u1ecdc nh\u1eefng chi\u1ebfn thu\u1eadt c\u01a1 b\u1ea3n. V\u00ed d\u1ee5, 1 gi\u1edd tr\u01b0\u1edbc khi h\u1ebft k\u00ec thi 5 ti\u1ebfng, s\u1ebd r\u1ea5t t\u1ec7 n\u1ebfu l\u00e0m b\u00e0i m\u1edbi khi b\u1ea1n c\u00f3 3 b\u00e0i ch\u01b0a l\u00e0m xong v\u1edbi nhi\u1ec1u submission sai.</p>"},{"location":"misc/experience/being-better/#cai-thien-chat-luong-code","title":"C\u1ea3i thi\u1ec7n ch\u1ea5t l\u01b0\u1ee3ng code","text":"<p>Sau khi submit v\u00e0 accepted, quay l\u1ea1i \u0111\u1ecdc v\u00e0 s\u1eeda code cho \u0111\u1eb9p h\u01a1n v\u00e0 ng\u1eafn h\u01a1n. \u0110\u1ecdc code c\u1ee7a ng\u01b0\u1eddi kh\u00e1c v\u00e0 s\u1eeda l\u1ea1i. Th\u01b0\u1eddng cao th\u1ee7 nh\u01b0 Petr hay tourist c\u00f3 nh\u1eefng code c\u1ef1c \u0111\u1eb9p v\u00e0 ch\u00fang c\u00f3 th\u1ec3 gi\u00fap b\u1ea1n trong t\u01b0\u01a1ng lai.</p> <p>B\u1ea1n c\u0169ng c\u00f3 th\u1ec3 s\u1eeda code cho n\u00f3 ch\u1ea1y nhanh h\u01a1n sau khi accepted. \u0110i\u1ec1u n\u00e0y c\u00f3 th\u1ec3 l\u00e0m code d\u00e0i h\u01a1n v\u00e0 kh\u00f3 hi\u1ec3u h\u01a1n. C\u00e1c trang nh\u01b0 SPOJ c\u00f3 ranking c\u1ee7a nh\u01b0ng code nhanh nh\u1ea5t, h\u00e3y c\u1ed1 g\u1eafng l\u00e0m code c\u1ee7a b\u1ea1n v\u01b0\u01a1n cao nh\u1ea5t c\u00f3 th\u1ec3. B\u1ea1n s\u1ebd h\u1ecdc \u0111\u01b0\u1ee3c nhi\u1ec1u th\u1ee9 v\u1ec1 t\u1ed1c \u0111\u1ed9 c\u1ee7a c\u00e1c c\u00e2u l\u1ec7nh trong ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh b\u1ea1n \u0111ang d\u00f9ng.</p>"},{"location":"misc/experience/being-better/#cham-soc-ban-than","title":"Ch\u0103m s\u00f3c b\u1ea3n th\u00e2n","text":"<p>C\u00e1i n\u00e0y nghe c\u00f3 v\u1ebb l\u1ea1, nh\u01b0ng m\u00ecnh ngh\u0129 th\u1ec3 d\u1ee5c v\u00e0 m\u1ed9t ch\u1ebf \u0111\u1ed9 \u0103n kh\u1ecfe m\u1ea1nh s\u1ebd r\u1ea5t quan tr\u1ecdng cho l\u1eadp tr\u00ecnh vi\u00ean. N\u00e3o l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a c\u01a1 th\u1ec3 v\u00e0 ch\u00fang ta c\u00f3 th\u1ec3 xem ph\u1ea7n c\u00f2n l\u1ea1i nh\u01b0 l\u00e0 tr\u1ee3 l\u00fd c\u1ee7a n\u00e3o b\u1ed9. N\u1ebfu b\u1ea1n kh\u00f4ng ch\u0103m s\u00f3c \u0111\u00e1m tr\u1ee3 l\u00fd n\u00e0y cho t\u1ed1t, n\u00f3 c\u00f3 th\u1ec3 \u1ea3nh h\u01b0\u1edfng x\u1ea5u \u0111\u1ebfn n\u00e3o b\u1ea1n.</p>"},{"location":"misc/experience/being-better/#ong-luc","title":"\u0110\u1ed9ng l\u1ef1c","text":"<p>C\u00e1c k\u00ec thi gi\u00fap t\u0103ng kh\u1ea3 n\u0103ng l\u1eadp tr\u00ecnh c\u1ee7a b\u1ea1n. Nhi\u1ec1u ng\u01b0\u1eddi cho r\u1eb1ng c\u00e1c b\u00e0i t\u1eadp l\u1eadp tr\u00ecnh thi \u0111\u1ea5u kh\u00f4ng gi\u1ed1ng c\u00e1c v\u1ea5n \u0111\u1ec1 trong th\u1ebf gi\u1edbi th\u1ef1c l\u1eafm v\u00e0 \u0111i\u1ec1u n\u00e0y \u0111\u00fang trong nhi\u1ec1u tr\u01b0\u1eddng h\u1ee3p. Khi \u0111i l\u00e0m, c\u00e1c v\u1ea5n \u0111\u1ec1 mang t\u00ednh thu\u1eadt to\u00e1n ch\u1ec9 chi\u1ebfm 5 - 10% c\u00f4ng vi\u1ec7c n\u1ebfu b\u1ea1n may m\u1eafn th\u00f4i. C\u00e1c b\u00e0i to\u00e1n khi \u0111i l\u00e0m kh\u00f4ng \u0111\u01b0\u1ee3c n\u00eau ra r\u00f5 r\u00e0ng, l\u1ea5y \u0111\u01b0\u1ee3c input t\u1ed1t r\u1ea5t kh\u00f3 v\u00e0 nhi\u1ec1u solution qu\u00e1 ph\u1ee9c t\u1ea1p ho\u1eb7c qu\u00e1 ch\u1eadm khi ch\u1ea1y.</p> <p>Tuy nhi\u00ean, v\u1eabn t\u1ed1t khi b\u1ea1n luy\u1ec7n m\u00f4n n\u00e0y. Trong tr\u01b0\u1eddng m\u1ecdi ng\u01b0\u1eddi \u0111\u1ec1u h\u1ecdc to\u00e1n, \u0111\u1ecdc v\u00e0 vi\u1ebft nh\u01b0ng \u00edt ng\u01b0\u1eddi l\u00e0m nh\u00e0 to\u00e1n h\u1ecdc, nh\u00e0 v\u0103n ho\u1eb7c reader (n\u1ebfu c\u00f3 c\u00e1i ngh\u1ec1 \u0111\u00f3). Ch\u00fang ta c\u1ea7n nh\u1eefng k\u0129 n\u0103ng n\u00e0y trong cu\u1ed9c s\u1ed1ng h\u00e0ng ng\u00e0y. Ngay c\u1ea3 khi b\u1ea1n kh\u00f4ng nghi\u00ean c\u1ee9u to\u00e1n, n\u00f3 gi\u00fap b\u1ea1n suy ngh\u0129 m\u1ed9t c\u00e1ch logic. C\u00f3 th\u1ec3 b\u1ea1n kh\u00f4ng vi\u1ebft nhi\u1ec1u, nh\u01b0ng vi\u1ebft gi\u00fap b\u1ea1n luy\u1ec7n n\u00e3o \u0111\u1ec3 h\u00ecnh th\u00e0nh suy ngh\u0129 theo m\u1ed9t h\u01b0\u1edbng d\u1ec5 hi\u1ec3u.</p> <p>T\u1ea5t nhi\u00ean, c\u00f3 nhi\u1ec1u k\u0129 n\u0103ng c\u1ea7n \u0111\u1ec3 th\u00e0nh 1 l\u1eadp tr\u00ecnh vi\u00ean gi\u1ecfi. B\u1ea1n n\u00ean h\u1ecdc c\u00e1ch l\u00e0m vi\u1ec7c nh\u00f3m, c\u00e1ch d\u00f9ng git, v\u00e2n v\u00e2n... Nh\u01b0ng trong l\u1eadp tr\u00ecnh thi \u0111\u1ea5u, n\u00f3 d\u1ea1y b\u1ea1n c\u00e1ch chia nh\u1ecf b\u00e0i to\u00e1n l\u1edbn th\u00e0nh c\u00e1c b\u00e0i to\u00e1n con, gi\u1ea3i ch\u00fang r\u1ed3i gh\u00e9p l\u1ea1i. \u00cdt bug xu\u1ea5t hi\u1ec7n h\u01a1n v\u00e0 b\u1ea1n s\u1ebd quan t\u00e2m nhi\u1ec1u h\u01a1n \u0111\u1ebfn \u0111\u1ed9 ph\u1ee9c t\u1ea1p th\u1eddi gian c\u1ee7a code.</p> <p>Nh\u01b0 b\u1ea1n th\u1ea5y \u0111\u1ea5y, c\u00f3 nhi\u1ec1u l\u1ee3i \u00edch c\u1ee7a l\u1eadp tr\u00ecnh thi \u0111\u1ea5u. Tuy nhi\u00ean, m\u00ecnh thi v\u00ec m\u00ecnh th\u1ea5y vui. Ph\u1ea7n luy\u1ec7n t\u1eadp c\u0169ng hay ph\u1ebft, nh\u01b0ng c\u00e1i n\u00e0y th\u01b0\u1eddng kh\u00f4ng \u00e9p b\u1ea1n c\u00e0y ng\u00e0y \u0111\u00eam \u0111\u01b0\u1ee3c n\u1ebfu b\u1ea1n kh\u00f4ng th\u1ea5y th\u00edch.</p> <p>Th\u1eadt v\u1eady, n\u1ebfu kh\u00f4ng th\u1ea5y vui, b\u1ea1n n\u00ean ngh\u1ec9 \u0111i v\u00e0 l\u00e0m g\u00ec \u0111\u00f3 kh\u00e1c. M\u00ecnh t\u1eebng g\u1eb7p nhi\u1ec1u b\u1ea1n r\u1ea5t kh\u1ee7ng, nh\u01b0ng h\u1ecd c\u00f3 v\u1ebb kh\u00f4ng th\u00edch m\u00f3n n\u00e0y l\u1eafm. N\u1ebfu b\u1ea1n th\u00edch c\u00e1c d\u1ef1 \u00e1n m\u00e3 ngu\u1ed3n m\u1edf ho\u1eb7c nghi\u00ean c\u1ee9u khoa h\u1ecdc, c\u1ee9 l\u00e0m \u0111i, kh\u00f4ng sao \u0111\u00e2u.</p> <p>Tuy nhi\u00ean, n\u1ebfu b\u1ea1n ph\u00e2n v\u00e2n gi\u1eefa thi \u0111\u1ea5u v\u00e0 ch\u01a1i game, l\u01b0\u1edbt Reddit ho\u1eb7c Facebook, b\u1ea1n n\u00ean ngh\u0129 c\u00e1ch t\u1ea1o \u0111\u1ed9ng l\u1ef1c cho m\u00ecnh nhi\u1ec1u h\u01a1n. Th\u1eed tr\u00f2 n\u00e0y xem: ngh\u0129 v\u1ec1 b\u1ea3n th\u00e2n 10 n\u0103m n\u1eefa. B\u1ea1n c\u00f3 ngh\u0129 r\u1eb1ng ng\u01b0\u1eddi \u0111\u00f3 s\u1ebd n\u00f3i v\u1edbi b\u1ea1n r\u1eb1ng \"Minh \u01b0\u1edbc m\u00ecnh ch\u01a1i game nhi\u1ec1u h\u01a1n, l\u01b0\u1edbt Reddit v\u00e0 Facebook nhi\u1ec1u h\u01a1n v\u00e0 luy\u1ec7n code \u00edt h\u01a1n khi c\u00f2n l\u00e0 sinh vi\u00ean\" kh\u00f4ng? M\u00ecnh kh\u00f4ng c\u1ea5m c\u00e1c b\u1ea1n l\u00e0m nh\u1eefng vi\u1ec7c \u0111\u00f3, v\u00ed d\u1ee5 Reddit r\u1ea5t c\u00f3 \u00edch khi t\u00ecm t\u00e0i li\u1ec7u vi\u1ebft b\u00e0i blog n\u00e0y. C\u1ee9 l\u00e0m, nh\u01b0ng v\u1eeba ph\u1ea3i th\u00f4i.</p>"},{"location":"misc/experience/being-better/#that-bai","title":"Th\u1ea5t b\u1ea1i","text":"<p>Th\u1ea5t b\u1ea1i l\u00e0 t\u1ed1t, n\u00f3 cho th\u1ea5y b\u1ea1n \u0111ang sai c\u00e1i g\u00ec. Ngo\u00e0i ra, n\u00e3o b\u1ea1n l\u00e0m vi\u1ec7c theo ki\u1ec3u b\u1ea1n h\u1ecdc t\u1ed1t nh\u1ea5t t\u1eeb nh\u1eefng sai l\u1ea7m c\u1ee7a b\u1ea3n th\u00e2n. \u0110\u00e2y l\u00e0 m\u1ed9t tr\u00edch d\u1eabn hay trong b\u00e0i Why Floundering Is Good:</p> <p>Tr\u00edch d\u1eabn</p> <p>H\u00e3y g\u1ecdi n\u00f3 l\u00e0 ngh\u1ecbch l\u00fd h\u1ecdc t\u1eadp: khi b\u1ea1n h\u1ecdc, b\u1ea1n c\u00e0ng loay hoay, th\u1eadm ch\u00ed th\u1ea5t b\u1ea1i nhi\u1ec1u, b\u1ea1n c\u00e0ng nh\u1edb l\u00e2u h\u01a1n v\u00e0 \u1ee9ng d\u1ee5ng nh\u1eefng th\u1ee9 b\u1ea1n h\u1ecdc t\u1ed1t h\u01a1n sau n\u00e0y.</p> <p>Th\u1ea5t b\u1ea1i r\u1ea5t quan tr\u1ecdng trong qu\u00e1 tr\u00ecnh h\u1ecdc, b\u1ea1n c\u1ea7n bi\u1ebft c\u00e1ch \u0111\u01b0\u01a1ng \u0111\u1ea7u v\u1edbi n\u00f3. \u0110\u00f3 \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 self-compassion (t\u1ef1 v\u1ecb tha) trong ti\u1ebfng Anh. \u0110\u00e2y l\u00e0 c\u00e1c tr\u00edch d\u1eabn v\u1ec1 self-compassion trong To Succeed, Forget Self-Esteem.</p> <p>Tr\u00edch d\u1eabn</p> <p>Self-compassion l\u00e0 vi\u1ec7c s\u1eb5n s\u00e0ng nh\u00ecn v\u00e0o sai l\u1ea7m v\u00e0 thi\u1ebfu s\u00f3t c\u1ee7a b\u1ea3n th\u00e2n v\u1edbi l\u00f2ng t\u1ed1t v\u00e0 s\u1ef1 hi\u1ec3u bi\u1ebft, \u0111\u00f3 l\u00e0 vi\u1ec7c ch\u1ea5p nh\u1eadn th\u1ef1c t\u1ebf r\u1eb1ng b\u1ea1n th\u1ef1c s\u1ef1 l\u00e0 con ng\u01b0\u1eddi. Khi b\u1ea1n self-compassionate khi g\u1eb7p kh\u00f3 kh\u0103n, b\u1ea1n kh\u00f4ng \u0111\u00e1nh gi\u00e1 b\u1ea3n th\u00e2n kh\u1eafc nghi\u1ec7t qu\u00e1, c\u0169ng kh\u00f4ng c\u1ea3m th\u1ea5y c\u1ea7n t\u1eadp trung v\u00e0o t\u1ea5t c\u1ea3 nh\u1eefng g\u00ec t\u1ed1t nh\u1ea5t c\u1ee7a m\u00ecnh \u0111\u1ec3 b\u1ea3o v\u1ec7 b\u1ea3n ng\u00e3. (Self-compassion is a willingness to look at your own mistakes and shortcomings with kindness and understanding \u2014 it\u2019s embracing the fact that to err is indeed human. When you are self-compassionate in the face of difficulty, you neither judge yourself harshly, nor feel the need to defensively focus on all your awesome qualities to protect your ego.)</p> <p>Tr\u00edch d\u1eabn</p> <p>\u0110\u00e2y l\u00e0 th\u1ef1c t\u1ebf kh\u00f4ng tr\u00e1nh kh\u1ecfi: B\u1ea1n s\u1ebd ho\u1ea3ng lo\u1ea1n. T\u1ea5t c\u1ea3 m\u1ecdi ng\u01b0\u1eddi, k\u1ec3 c\u1ea3 nh\u1eefng ng\u01b0\u1eddi th\u00e0nh c\u00f4ng nh\u1ea5t, t\u1ea1o ra c\u1ea3 \u0111\u1ed1ng sai l\u1ea7m. Ch\u00eca kh\u00f3a s\u1ef1 th\u00e0nh c\u00f4ng, nh\u01b0 m\u1ecdi ng\u01b0\u1eddi \u0111\u1ec1u bi\u1ebft, l\u00e0 r\u00fat kinh nghi\u1ec7m v\u00e0 ti\u1ebfn l\u00ean. Nh\u01b0ng kh\u00f4ng ph\u1ea3i ai c\u0169ng bi\u1ebft ph\u1ea3i l\u00e0m nh\u01b0 th\u1ebf n\u00e0o. Self-compassion l\u00e0 th\u1ee9 b\u1ea1n c\u1ea7n. Cho n\u00ean, h\u00e3y cho b\u1ea3n th\u00e2n ngh\u1ec9 ng\u01a1i \u0111i. (Here\u2019s an unavoidable truth: You are going to screw up. Everyone \u2014 including very successful people \u2014 makes boatloads of mistakes. The key to success is, as everyone knows, to learn from those mistakes and keep moving forward. But not everyone knows how. Self-compassion is the how you\u2019ve been looking for. So please, give yourself a break.)</p> <p>C\u00e1c b\u1ea1n n\u00ean \u0111\u1ecdc c\u1ea3 b\u00e0i vi\u1ebft \u0111\u00f3 th\u00ec s\u1ebd t\u1ed1t h\u01a1n.</p>"},{"location":"misc/experience/icpc-strategy/","title":"Chi\u1ebfn thu\u1eadt khi thi ICPC","text":""},{"location":"misc/experience/icpc-strategy/#chien-thuat-khi-thi-icpc","title":"Chi\u1ebfn thu\u1eadt khi thi ICPC","text":""},{"location":"misc/experience/icpc-strategy/#nguon","title":"Ngu\u1ed3n","text":"<p>Team strategy - lukipuki.github.io</p>"},{"location":"misc/experience/icpc-strategy/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>Tr\u01b0\u1edbc ti\u00ean m\u00ecnh mu\u1ed1n tr\u00ecnh b\u00e0y r\u1eb1ng m\u00ecnh kh\u00f4ng xem b\u1ea3n th\u00e2n l\u00e0 m\u1ed9t ng\u01b0\u1eddi th\u00e0nh c\u00f4ng trong c\u1ed9ng \u0111\u1ed3ng L\u1eadp tr\u00ecnh thi \u0111\u1ea5u (Competitive Programming - CP) c\u0169ng nh\u01b0 kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ng\u01b0\u1eddi c\u00f3 kh\u1ea3 n\u0103ng chi\u1ebfn thu\u1eadt t\u1ed1t. B\u00e0i vi\u1ebft n\u00e0y l\u00e0 m\u1ed9t b\u00e0i m\u00ecnh d\u1ecbch t\u1eeb m\u1ed9t b\u00e0i vi\u1ebft trong blog c\u1ee7a m\u1ed9t cao th\u1ee7 trong c\u1ed9ng \u0111\u1ed3ng. \u0110\u00e2y l\u00e0 m\u1ed9t b\u00e0i kh\u00e1 hay v\u00e0 m\u00ecnh ngh\u0129 s\u1ebd c\u00f3 \u00edch cho c\u00e1c \u0111\u1ed9i thi.</p> <p>S\u01a1 l\u01b0\u1ee3c v\u1ec1 t\u00e1c gi\u1ea3: Luk\u00e1\u0161 Pol\u00e1\u010dek - hi\u1ec7n \u0111ang l\u00e0 nghi\u00ean c\u1ee9u sinh t\u1ea1i KTH Royal Institute of Technology, Th\u1ee5y \u0110i\u1ec3n (profile n\u00e0y l\u00e0 n\u0103m 2016). Anh \u1ea5y t\u1eebng \u0111\u1ea1t huy ch\u01b0\u01a1ng \u0111\u1ed3ng t\u1ea1i ACM ICPC 2010 v\u00e0 t\u1eebng c\u00f3 rating cao nh\u1ea5t l\u00e0 2676 tr\u00ean TopCoder.</p> <p>S\u01a1 l\u01b0\u1ee3c v\u1ec1 k\u00ec thi: ACM-ICPC (gi\u1edd r\u00fat g\u1ecdn th\u00e0nh ICPC) l\u00e0 k\u00ec thi l\u1eadp tr\u00ecnh thi \u0111\u1ea5u l\u1edbn v\u00e0 uy t\u00edn nh\u1ea5t th\u1ebf gi\u1edbi. K\u00ec thi k\u00e9o d\u00e0i 5 gi\u1edd \u0111\u1ed3ng h\u1ed3, m\u1ed7i \u0111\u1ed9i 3 ng\u01b0\u1eddi s\u1ebd ph\u1ea3i suy ngh\u0129 v\u00e0 gi\u1ea3i quy\u1ebft 10-12 b\u00e0i to\u00e1n b\u1eb1ng m\u00e1y t\u00ednh.</p> <p>Sau \u0111\u00e2y l\u00e0 n\u1ed9i dung b\u00e0i d\u1ecbch c\u1ee7a m\u00ecnh. Ng\u00f4i th\u1ee9 nh\u1ea5t trong b\u00e0i l\u00e0 ch\u1ec9 t\u00e1c gi\u1ea3, kh\u00f4ng ph\u1ea3i ch\u1ec9 m\u00ecnh.</p>"},{"location":"misc/experience/icpc-strategy/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>B\u00e0i vi\u1ebft n\u00e0y n\u00f3i v\u1ec1 chi\u1ebfn thu\u1eadt khi thi ICPC, n\u01a1i m\u00e0 b\u1ea1n s\u1ebd c\u00f9ng 2 \u0111\u1ed3ng \u0111\u1ed9i kh\u00e1c thi \u0111\u1ea5u trong v\u00f2ng 5 gi\u1edd \u0111\u1ed3ng h\u1ed3. C\u00f3 nhi\u1ec1u k\u00ec thi kh\u00e1c nhau v\u1edbi nh\u1eefng lu\u1eadt l\u1ec7 kh\u00e1c nhau nh\u01b0ng \u1edf \u0111\u00e2y ta s\u1ebd ch\u1ec9 t\u1eadp trung v\u00e0o ICPC.</p> <p>C\u00f3 3 y\u1ebfu t\u1ed1 quan tr\u1ecdng m\u00e0 b\u1ea1n c\u1ea7n l\u01b0u \u00fd trong su\u1ed1t k\u00ec thi:</p> <ul> <li>\u0110\u00e2y l\u00e0 k\u00ec thi \u0111\u1ed3ng \u0111\u1ed9i v\u00e0 m\u1ed7i team c\u00f3 3 ng\u01b0\u1eddi.</li> <li>Th\u1eddi gian s\u1eed d\u1ee5ng m\u00e1y t\u00ednh (computer time) r\u1ea5t l\u00e0 qu\u00fd gi\u00e1 (5 ti\u1ebfng d\u00f9ng m\u00e1y, nh\u01b0ng c\u00f3 15 ti\u1ebfng suy ngh\u0129 chia ra cho m\u1ed7i ng\u01b0\u1eddi). </li> <li>Giai \u0111o\u1ea1n \u0111\u1ea7u l\u00e0 giai \u0111o\u1ea1n quan tr\u1ecdng nh\u1ea5t c\u1ee7a k\u00ec thi.</li> </ul>"},{"location":"misc/experience/icpc-strategy/#chien-thuat-chung","title":"Chi\u1ebfn thu\u1eadt chung","text":"<p>V\u1edbi 3 y\u1ebfu t\u1ed1 tr\u00ean, b\u1ea1n c\u00f3 th\u1ec3 tri\u1ec3n khai \u0111\u01b0\u1ee3c m\u1ed9t chi\u1ebfn thu\u1eadt ngon l\u00e0nh. Trong giai \u0111o\u1ea1n \u0111\u1ea7u k\u00ec thi, ng\u01b0\u1eddi code nhanh nh\u1ea5t \u0111\u1ed9i vi\u1ebft code template v\u00e0 c\u00f3 th\u1ec3 th\u00eam 1 script \u0111\u1ec3 bi\u00ean d\u1ecbch. V\u1edbi c\u00e1ch t\u00ednh \u0111i\u1ec3m c\u1ee7a ICPC, gi\u1ea3i b\u00e0i d\u1ec5 tr\u01b0\u1edbc l\u00e0 t\u1ed1i \u01b0u nh\u1ea5t, v\u00ec v\u1eady, 2 ng\u01b0\u1eddi c\u00f2n l\u1ea1i c\u00f3 th\u1ec3 \u0111\u1ecdc s\u01a1 qua c\u1ea3 t\u1ea5t c\u1ea3 c\u00e1c b\u00e0i thi \u0111\u1ec3 t\u00ecm b\u00e0i d\u1ec5 (1 ng\u01b0\u1eddi \u0111\u1ecdc t\u1eeb b\u00e0i A xu\u1ed1ng, m\u1ed9t ng\u01b0\u1eddi \u0111\u1ecdc t\u1eeb b\u00e0i J l\u00ean, v\u00ed d\u1ee5 th\u1ebf). Khi x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c b\u00e0i d\u1ec5 r\u1ed3i (gi\u1ea3i \u0111\u01b0\u1ee3c trong kho\u1ea3ng 10-15 ph\u00fat ch\u1eb3ng h\u1ea1n), \u0111\u01b0a b\u00e0i \u0111\u00f3 v\u00e0 m\u00f4 t\u1ea3 nhanh b\u00e0i \u0111\u00f3 cho ng\u01b0\u1eddi code nhanh nh\u1ea5t \u0111\u1ed9i.</p> <p>Hai ng\u01b0\u1eddi c\u00f2n l\u1ea1i ti\u1ebfp t\u1ee5c \u0111\u1ecdc l\u01b0\u1edbt qua \u0111\u1ec1 thi. N\u1ebfu c\u00f3 b\u00e0i d\u1ec5 h\u01a1n b\u00e0i tr\u01b0\u1edbc \u0111\u00f3 (gi\u1ea3i \u0111\u01b0\u1ee3c trong 5 ph\u00fat), th\u00ec \u01b0u ti\u00ean b\u00e0i d\u1ec5 h\u01a1n. Sau khi \u0111\u1ecdc xong to\u00e0n b\u1ed9 \u0111\u1ec1 thi, 2 ng\u01b0\u1eddi kh\u00f4ng code trong \u0111\u1ed9i n\u00ean trao \u0111\u1ed5i v\u1ec1 c\u00e1c b\u00e0i h\u1ecd \u0111\u00e3 \u0111\u1ecdc.</p> <p>Th\u1ee9 kh\u00f4ng n\u00ean x\u1ea3y ra trong giai \u0111o\u1ea1n \u0111\u1ea7u: Sau khi \u0111\u1ecdc b\u00e0i \u0111\u1ea7u ti\u00ean, m\u00ecnh th\u1ea5y m\u00ecnh gi\u1ea3i \u0111\u01b0\u1ee3c. M\u00ecnh kh\u00f4ng \u0111\u1ecdc c\u00e1c b\u00e0i kh\u00e1c v\u00e0 c\u1ed1 g\u1eafng gi\u1ea3i b\u00e0i \u0111\u1ea7u trong 2 ti\u1ebfng m\u00e0 kh\u00f4ng xong, trong khi \u0111\u1ec1 c\u00f3 2 b\u00e0i d\u1ec5 h\u01a1n m\u00e0 m\u00ecnh kh\u00f4ng \u0111\u1ecdc. \u0110\u00f3 l\u00e0 m\u1ed9t trong c\u00e1c l\u00fd do m\u00e0 vi\u1ec7c \u0111\u1ecdc h\u1ebft \u0111\u1ec1 v\u00e0 trao \u0111\u1ed5i v\u1edbi nhau trong giai \u0111o\u1ea1n \u0111\u1ea7u l\u00e0 c\u1ef1c k\u1ef3 quan trong.</p> <p>Team ti\u1ebfp t\u1ee5c gi\u1ea3i c\u00e1c b\u00e0i. N\u1ebfu c\u00f3 ng\u01b0\u1eddi bi\u1ebft c\u00e1ch gi\u1ea3i 1 b\u00e0i n\u00e0o \u0111\u00f3 v\u00e0 kh\u00f4ng ai d\u00f9ng m\u00e1y t\u00ednh, ng\u01b0\u1eddi \u0111\u00f3 n\u00ean l\u00e0m b\u00e0i \u0111\u00f3 lu\u00f4n. Ng\u01b0\u1ee3c l\u1ea1i, n\u1ebfu c\u00f3 ng\u01b0\u1eddi \u0111ang code, ch\u1ecbu kh\u00f3 chu\u1ea9n b\u1ecb solution v\u00e0 code s\u01a1 b\u1ed9 tr\u00ean gi\u1ea5y.</p> <p>Chi\u1ebfn thu\u1eadt t\u1ed1t c\u1ea7n ph\u1ea3i \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng d\u1ef1a theo k\u0129 n\u0103ng c\u1ee7a t\u1eebng b\u1ea1n trong \u0111\u1ed9i. V\u00ed d\u1ee5, m\u1ed9t ng\u01b0\u1eddi gi\u1ecfi ngh\u0129 thu\u1eadt nh\u01b0ng code kh\u00f4ng t\u1ed1t th\u00ec n\u00ean l\u00e0m vi\u1ec7c ch\u1ee7 y\u1ebfu tr\u00ean gi\u1ea5y, sau \u0111\u00f3 gi\u1ea3i th\u00edch solution c\u1ee7a m\u00ecnh cho ng\u01b0\u1eddi kh\u00e1c \u0111\u1ec3 h\u1ecd code. Team n\u00ean train th\u01b0\u1eddng xuy\u00ean \u0111\u1ec3 t\u00ecm hi\u1ec3u \u0111i\u1ec3m m\u1ea1nh, y\u1ebfu c\u1ee7a nhau v\u00e0 sau \u0111\u00f3 d\u00f9ng nh\u1eefng \u0111i\u1ec3m \u0111\u00f3 \u0111\u1ec3 x\u00e2y d\u1ef1ng chi\u1ebfn thu\u1eadt t\u1ed1t nh\u1ea5t cho \u0111\u1ed9i. Ngay c\u1ea3 vi\u1ec7c thi\u1ebfu 1 b\u1ea1n th\u00ec 2 ng\u01b0\u1eddi c\u00f2n l\u1ea1i c\u0169ng train \u0111\u01b0\u1ee3c. Ngo\u00e0i ra, n\u00ean nh\u1edd hu\u1ea5n luy\u1ec7n vi\u00ean c\u1ee7a b\u1ea1n theo d\u00f5i ti\u1ebfn \u0111\u1ed9 train c\u1ee7a \u0111\u1ed9i \u0111\u1ec3 \u0111\u01b0a ra nh\u1eefng l\u1eddi khuy\u00ean ph\u00f9 h\u1ee3p.</p>"},{"location":"misc/experience/icpc-strategy/#nhung-meo-khac","title":"Nh\u1eefng m\u1eb9o kh\u00e1c","text":"<p>Gi\u1edd b\u1ea1n \u0111\u00e3 th\u1ea5m nhu\u1ea7n chi\u1ebfn thu\u1eadt chung, \u0111\u1ebfn nh\u1eefng m\u1eb9o kh\u00e1c th\u00f4i.</p> <ul> <li>N\u1ebfu kh\u00f4ng ch\u1eafc v\u1ec1 solution c\u1ee7a m\u00ecnh, h\u00e3y trao \u0111\u1ed5i v\u1edbi \u0111\u1ed3ng \u0111\u1ed9i. N\u1ebfu kh\u00f4ng c\u00f3 h\u01b0\u1edbng \u0111i, gi\u1ea3i th\u00edch v\u1ea5n \u0111\u1ec1 v\u1edbi \u0111\u1ed3ng \u0111\u1ed9i.</li> <li>N\u1ebfu c\u00f3 th\u1eddi gian, vi\u1ebft code ra gi\u1ea5y tr\u01b0\u1edbc khi code tr\u00ean m\u00e1y \u0111\u1ec3 ti\u1ebft ki\u1ec7m th\u1eddi gian d\u00f9ng m\u00e1y. Kh\u00f4ng c\u1ea7n code qu\u00e1 chi ti\u1ebft, n\u00ean t\u1eadp trung v\u00e0o c\u00e1c ph\u1ea7n quan trong nh\u1ea5t c\u1ee7a code th\u00f4i.</li> <li>Kh\u00f4ng n\u00ean debug tr\u00ean m\u00e1y. In code ra v\u1edbi m\u1ed9t s\u1ed1 debugging output v\u00e0 debug tr\u00ean gi\u1ea5y.</li> <li>N\u1ebfu kh\u00f4ng t\u00ecm ra \u0111\u01b0\u1ee3c h\u01b0\u1edbng l\u00e0m, n\u00ean \u0111i d\u1ea1o ho\u1eb7c \u0111i v\u1ec7 sinh. \u0110\u00f4i khi \u00fd t\u01b0\u1edfng l\u1ea1i \u0111\u1ebfn khi b\u1ea1n gi\u1ea3i quy\u1ebft \u0111\u01b0\u1ee3c n\u1ed7i bu\u1ed3n.</li> <li>N\u1ebfu c\u1ee9 b\u1ecb Wrong Answer, \u0111\u1ec3 b\u00e0i \u0111\u00f3 \u0111\u1ea5y v\u00e0 gi\u1ea3i b\u00e0i kh\u00e1c. C\u00f3 th\u1ec3 sau \u0111\u00f3 b\u1ea1n s\u1ebd t\u00ecm \u0111\u01b0\u1ee3c c\u00e1ch gi\u1ea3i b\u00e0i c\u0169. \u0110\u1eebng ng\u1ea1i code l\u1ea1i to\u00e0n b\u1ed9, th\u01b0\u1eddng ch\u1ec9 m\u1ea5t t\u1ea7m 15 ph\u00fat \u0111\u1ec3 code l\u1ea1i h\u1ebft c\u1ea3 b\u00e0i n\u1ebfu nh\u01b0 b\u1ea1n hi\u1ec3u c\u00e1ch gi\u1ea3i b\u00e0i \u0111\u00f3.</li> <li>N\u1ebfu sinh \u0111\u01b0\u1ee3c test to, ho\u1eb7c test nh\u1ecf m\u00e0 b\u1ea1n bi\u1ebft ch\u00ednh x\u00e1c \u0111\u00e1p \u00e1n th\u00ec n\u00ean l\u00e0m, c\u1ea9n th\u1eadn m\u1ed9t ch\u00fat c\u00f2n h\u01a1n l\u00e0 m\u1ea5t 20 ph\u00fat penalty.</li> <li>L\u00e0m xong b\u00e0i n\u00e0o th\u00ec v\u1ee9t h\u1ebft c\u00e1c gi\u1ea5y t\u1edd li\u00ean quan \u0111\u1ebfn b\u00e0i \u0111\u00f3 \u0111i. B\u1ea1n s\u1ebd kh\u00f4ng b\u1ecb m\u1ea5t c\u00f4ng t\u00ecm th\u1ee9 m\u00ecnh mu\u1ed1n trong m\u1ed9t \u0111\u1ed1ng b\u00f9i nh\u00f9i gi\u1ea5y t\u1edd tr\u00ean b\u00e0n, ti\u1ebft ki\u1ec7m th\u1eddi gian s\u1ebd t\u1ed1t h\u01a1n.</li> <li>Th\u01b0\u1eddng xuy\u00ean xem scoreboard. N\u1ebfu c\u00f3 b\u00e0i nhi\u1ec1u \u0111\u1ed9i l\u00e0m \u0111\u01b0\u1ee3c th\u00ec n\u00f3 h\u1eb3n l\u00e0 b\u00e0i d\u1ec5.</li> <li>Vi\u1ebft ra th\u00f4ng tin c\u00e1c submission c\u1ee7a \u0111\u1ed9i tr\u00ean gi\u1ea5y, vi\u1ebft th\u00eam ra xem ai l\u00e0m b\u00e0i g\u00ec.</li> <li>Th\u01b0\u1eddng xuy\u00ean y\u00eau c\u1ea7u in code, in m\u1ed7i khi submit b\u00e0i (\u1edf \u0111\u00e2y m\u00ecnh c\u0169ng kh\u00f4ng hi\u1ec3u \u00fd l\u00e0 in code ra hay l\u00e0 in th\u00f4ng tin bi\u1ebfn ra m\u00e0n h\u00ecnh console \u0111\u1ec3 ti\u1ec7n theo d\u00f5i).</li> <li>\u0110\u1eebng qu\u00ean chi\u1ebfn thu\u1eadt l\u00fac g\u1ea7n h\u1ebft th\u1eddi gian. Khi g\u1ea7n h\u1ebft gi\u1edd, kh\u00f4ng n\u00ean m\u1ed7i ng\u01b0\u1eddi l\u00e0m m\u1ed9t b\u00e0i m\u00e0 n\u00ean t\u1eadp trung 3 ng\u01b0\u1eddi l\u00e0m 1 b\u00e0i th\u00f4i. \u0110\u1ea3m b\u1ea3o ai c\u0169ng \u0111ang l\u00e0m g\u00ec \u0111\u00f3 h\u1eefu \u00edch (v\u00ed d\u1ee5 1 ng\u01b0\u1eddi ki\u1ec3m tra code c\u00f9ng v\u1edbi ng\u01b0\u1eddi code, 1 ng\u01b0\u1eddi ngh\u0129 test hi\u1ec3m). M\u00ecnh bi\u1ebft vi\u1ec7c n\u00e0y r\u1ea5t kh\u00f3 l\u00e0m v\u00e0 kh\u00f4ng ph\u1ea3i ai c\u0169ng \u0111\u1ee7 d\u0169ng c\u1ea3m \u0111\u1ec3 b\u1ecf qua nh\u1eefng b\u00e0i c\u00f2n l\u1ea1i m\u00e0 m\u00ecnh bi\u1ebft l\u00e0m nh\u01b0ng c\u00f3 kh\u1ea3 n\u0103ng b\u1ea1n s\u1ebd t\u1ea1ch c\u1ea3 3 b\u00e0i, ho\u1eb7c b\u1ea1n c\u00f3 th\u1ec3 ch\u1ecdn l\u00e0m 1 b\u00e0i ch\u1eafc k\u00e8o, t\u00f9y b\u1ea1n th\u00f4i.</li> <li>Trong v\u00e0i tr\u01b0\u1eddng h\u1ee3p b\u1ea1n n\u00ean cho 1 ng\u01b0\u1eddi th\u1eed gi\u1ea3i 1 b\u00e0i kh\u00f3 trong 2-3 ti\u1ebfng tr\u01b0\u1edbc khi h\u1ebft gi\u1edd \u0111\u1ec3 tr\u00e1nh tr\u01b0\u1eddng h\u1ee3p sau. Gi\u1ea3 s\u1eed m\u1ecdi th\u1ee9 \u0111ang \u0111i \u0111\u00fang h\u01b0\u1edbng v\u00e0 b\u1ea1n d\u00f9ng m\u00e1y t\u00ednh, gi\u1ea3i b\u00e0i th\u1ee9 8 c\u1ee7a \u0111\u1ed9i sau 4 ti\u1ebfng. C\u00f3 2 b\u00e0i kh\u00f3 nh\u01b0ng b\u1ea1n c\u1ea7n 1 gi\u1edd ngh\u0129 v\u00e0 45 ph\u00fat code. 3 ng\u01b0\u1eddi c\u00e1c b\u1ea1n c\u00f3 3 gi\u1edd suy ngh\u0129 trong 1 ti\u1ebfng th\u1eddi gian th\u1ef1c, r\u00f5 r\u00e0ng nhi\u1ec1u h\u01a1n 1 gi\u1edd 45 ph\u00fat, nh\u01b0ng 1 ti\u1ebfng suy ngh\u0129 kh\u00f4ng th\u1ec3 chia ra cho 3 ng\u01b0\u1eddi \u0111\u01b0\u1ee3c, v\u00e0 b\u1ea1n ph\u1ea3i ch\u1edd solution c\u1ee7a 1 b\u1ea1n kh\u00e1c tr\u01b0\u1edbc khi code.</li> <li>Ch\u1ec9 submit b\u1eeba khi b\u1ea1n th\u1ea5y gi\u1ea3i \u0111\u01b0\u1ee3c 1 b\u00e0i quan tr\u1ecdng h\u01a1n penalty v\u00e0 b\u1ea1n th\u1ea5y code c\u1ee7a b\u1ea1n c\u00f3 kh\u1ea3 n\u0103ng Accepted. Th\u01b0\u1eddng b\u1ea1n s\u1ebd submit b\u1eeba trong v\u00f2ng 30 ph\u00fat cu\u1ed1i. C\u01a1 m\u00e0 n\u1ebfu \u0111\u1ed9i b\u1ea1n c\u00f3 penalty kh\u00f4ng t\u1ed1t ngay t\u1eeb \u0111\u1ea7u r\u1ed3i (sai r\u1ea5t nhi\u1ec1u trong giai \u0111o\u1ea1n \u0111\u1ea7u) th\u00ec penalty kh\u00f4ng qu\u00e1 quan tr\u1ecdng n\u1eefa, c\u1ee9 submit th\u00f4i (th\u1eddi gian submit b\u1eeba s\u1ebd \u0111\u01b0\u1ee3c t\u0103ng l\u00ean, 1-2 ti\u1ebfng ch\u1eb3ng h\u1ea1n). </li> <li>Thi 5 ti\u1ebfng, nh\u01b0ng train 5 ti\u1ebfng th\u00ec h\u1ebft c\u1ea3 ng\u00e0y c\u1ee7a b\u1ea1n r\u1ed3i. B\u1ea1n c\u00f3 th\u1ec3 train 3.5 \u0111\u1ebfn 4 ti\u1ebfng th\u00f4i, v\u00e0 hi\u1ec7u qu\u1ea3 th\u00ec nh\u01b0 nhau. Ngay c\u1ea3 v\u1eadn \u0111\u1ed9ng vi\u00ean marathon c\u0169ng ch\u1ec9 ch\u1ea1y 30 km m\u1ed7i ng\u00e0y trong khi cu\u1ed9c \u0111ua th\u1eadt d\u00e0i 42 km.</li> </ul>"},{"location":"misc/probability/expected-value/","title":"Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng","text":""},{"location":"misc/probability/expected-value/#gia-tri-ky-vong","title":"Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng","text":""},{"location":"misc/probability/expected-value/#nguon","title":"Ngu\u1ed3n","text":"<p> Expected Value - Brilliant</p>"},{"location":"misc/probability/expected-value/#mo-au","title":"M\u1edf \u0111\u1ea7u","text":"<p>Trong l\u00fd thuy\u1ebft x\u00e1c su\u1ea5t, m\u1ed9t gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng l\u00e0 gi\u00e1 tr\u1ecb trung b\u00ecnh l\u00fd thuy\u1ebft c\u1ee7a m\u1ed9t ph\u00e9p th\u1eed s\u1ed1 h\u1ecdc qua nhi\u1ec1u l\u1ea7n l\u1eb7p l\u1ea1i ph\u00e9p th\u1eed. Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng l\u00e0 th\u01b0\u1edbc \u0111o xu h\u01b0\u1edbng trung t\u00e2m; m\u1ed9t gi\u00e1 tr\u1ecb m\u00e0 k\u1ebft qu\u1ea3 s\u1ebd c\u00f3 t\u00ednh h\u01b0\u1edbng v\u00e0o \u0111\u00f3. Khi ph\u00e2n ph\u1ed1i x\u00e1c su\u1ea5t l\u00e0 chu\u1ea9n t\u1eafc, nhi\u1ec1u k\u1ebft qu\u1ea3 s\u1ebd g\u1ea7n v\u1edbi gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng.</p> <p>B\u1ea5t k\u1ef3 bi\u1ebfn ng\u1eabu nhi\u00ean nh\u1ea5t \u0111\u1ecbnh n\u00e0o c\u0169ng ch\u1ee9a v\u00f4 s\u1ed1 th\u00f4ng tin. N\u00f3 c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u (ho\u1eb7c v\u00f4 s\u1ed1) k\u1ebft qu\u1ea3 c\u00f3 th\u1ec3 x\u1ea3y ra v\u00e0 m\u1ed7i k\u1ebft qu\u1ea3 c\u00f3 th\u1ec3 c\u00f3 kh\u1ea3 n\u0103ng x\u1ea3y ra kh\u00e1c nhau. Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng l\u00e0 m\u1ed9t c\u00e1ch \u0111\u1ec3 t\u00f3m t\u1eaft t\u1ea5t c\u1ea3 th\u00f4ng tin n\u00e0y trong m\u1ed9t gi\u00e1 tr\u1ecb s\u1ed1 duy nh\u1ea5t.</p>"},{"location":"misc/probability/expected-value/#inh-nghia","title":"\u0110\u1ecbnh ngh\u0129a","text":"<p>N\u1ebfu kh\u00f4ng gian m\u1eabu c\u1ee7a m\u1ed9t ph\u00e9p th\u1eed x\u00e1c su\u1ea5t ch\u1ec9 ch\u1ee9a c\u00e1c k\u1ebft qu\u1ea3 s\u1ed1 h\u1ecdc, th\u00ec bi\u1ebfn ng\u1eabu nhi\u00ean l\u00e0 bi\u1ebfn \u0111\u1ea1i di\u1ec7n cho c\u00e1c k\u1ebft qu\u1ea3 n\u00e0y. V\u00ed d\u1ee5, k\u1ebft qu\u1ea3 c\u1ee7a vi\u1ec7c tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u (ngh\u0129a l\u00e0 x\u00e1c su\u1ea5t tung ra m\u1ed7i m\u1eb7t l\u00e0 nh\u01b0 nhau) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean nh\u1eadn t\u1eebng gi\u00e1 tr\u1ecb t\u1eeb 1 \u0111\u1ebfn 6 v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{6}\\). \u0110\u00e2y l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c.</p> <p>\u0110\u1ed1i v\u1edbi m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c, gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch nh\u00e2n t\u1eebng k\u1ebft qu\u1ea3 s\u1ed1 v\u1edbi x\u00e1c su\u1ea5t c\u1ee7a k\u1ebft qu\u1ea3 \u0111\u00f3, sau \u0111\u00f3 t\u00ednh t\u1ed5ng c\u00e1c t\u00edch \u0111\u00f3 l\u1ea1i v\u1edbi nhau. Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed9t con x\u00fac x\u1eafc s\u00e1u m\u1eb7t \u0111\u1ec1u \u0111\u01b0\u1ee3c t\u00ednh nh\u01b0 sau:</p> \\[\\frac{1}{6} \\cdot 1 + \\frac{1}{6} \\cdot 2 + \\frac{1}{6} \\cdot 3 + \\frac{1}{6} \\cdot 4 + \\frac{1}{6} \\cdot 5 + \\frac{1}{6} \\cdot 6 = 3.5\\] <p>\u0110\u1ecbnh ngh\u0129a</p> <p>G\u1ecdi \\(X\\) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c. Th\u00ec gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\), k\u00fd hi\u1ec7u l\u00e0 $E[X] hay \\(\\mu\\), l\u00e0:</p> \\[E[X] = \\mu = \\sum_{x} xP(X=x)\\] <p>V\u00ed d\u1ee5</p> <p>M\u1ed9t b\u1ed9 b\u00e0i ch\u1ee9a m\u1ed9t l\u00e1 b\u00e0i c\u00f3 s\u1ed1 \\(1\\), hai l\u00e1 b\u00e0i c\u00f3 s\u1ed1 \\(2\\), ba l\u00e1 b\u00e0i c\u00f3 s\u1ed1 \\(3\\), v\u00e0 b\u1ed1n l\u00e1 b\u00e0i c\u00f3 s\u1ed1 \\(4\\). N\u1ebfu b\u1ed9 b\u00e0i \u0111\u01b0\u1ee3c x\u00e1o l\u00ean v\u00e0 ta l\u1ea5y m\u1ed9t l\u00e1 ra, k\u1ef3 v\u1ecdng gi\u00e1 tr\u1ecb c\u1ee7a l\u00e1 \u0111\u00f3 l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u1ea1i di\u1ec7n cho gi\u00e1 tr\u1ecb c\u1ee7a l\u00e1 b\u00e0i \u0111\u01b0\u1ee3c l\u1ea5y. Ta c\u00f3</p> \\[\\begin{align} P(X = 1) &amp;= \\frac{1}{10}\\\\ P(X = 2) &amp;= \\frac{2}{10}\\\\ P(X = 3) &amp;= \\frac{3}{10}\\\\ P(X = 4) &amp;= \\frac{4}{10}\\\\ \\Rightarrow E[X] &amp;= (1 \\times \\frac{1}{10}) + (2 \\times \\frac{2}{10}) + (3 \\times \\frac{3}{10}) + (4 \\times \\frac{4}{10})\\\\ &amp;= 3 \\end{align}\\] <p>V\u1eady k\u1ef3 v\u1ecdng gi\u00e1 tr\u1ecb l\u00e1 b\u00e0i l\u00e0 \\(3\\).</p> <p>T\u1eeb g\u00f3c \u0111\u1ed9 l\u00fd thuy\u1ebft \u0111o l\u01b0\u1eddng, g\u1ecdi \\((\\Omega, \\mathcal{F}, P)\\) l\u00e0 kh\u00f4ng gian \u0111o l\u01b0\u1eddng. \u0110\u1ec3 t\u00ednh k\u1ef3 v\u1ecdng ho\u1eb7c t\u00edch ph\u00e2n c\u1ee7a c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean n\u00f3i chung, ta ph\u1ea3i ti\u1ebfn h\u00e0nh theo c\u00e1ch sau (l\u01b0u \u00fd, \u0111\u1ec3 bi\u1ebft \u0111\u1ecbnh ngh\u0129a \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1, vui l\u00f2ng truy c\u1eadp Ti\u00ean \u0111\u1ec1 X\u00e1c su\u1ea5t):</p> <p>\u0110\u1ea7u ti\u00ean, k\u1ef3 v\u1ecdng, \\(\\mathbb{E}\\{X\\}\\) c\u1ee7a c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>M\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean, \\(X\\) \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \u0111\u01a1n gi\u1ea3n, n\u1ebfu n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft th\u00e0nh \\(X = \\sum_{i=1}^{n} a_i 1_{A_i}\\). Trong ddos \\(A_i\\) t\u1ea1o th\u00e0nh m\u1ed9t ph\u00e2n v\u00f9ng c\u1ee7a \\(\\Omega\\), ngh\u0129a l\u00e0, \\(\\bigcup_{i=1}^{n} A_i = \\Omega\\) v\u00e0 \\(A_i \\cap A_j = \\emptyset\\) (\\(\\forall i \\ne j\\)), v\u1edbi m\u1ed7i \\(a_i = A_i\\).</p> <p>Gi\u1edd ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n:</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>\\(\\mathbb{E}\\{X\\} = \\sum_{i=1}^{n} a_i \\mathbb{P}(A_i)\\), trong \u0111\u00f3 \\mathbb{P}(A_i) l\u00e0 x\u00e1c su\u1ea5t \u0111o l\u01b0\u1eddng v\u00e0 m\u1ed7i \\(A_i \\in \\mathcal{F}\\), \\(\\mathcal{F}\\) l\u00e0 m\u1ed9t \\(\\sigma\\)-\u0111\u1ea1i s\u1ed1 c\u1ee7a c\u00e1c t\u1eadp con trong \\(\\Omega\\). \\(\\mathbb{E}\\{X\\}\\) t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi vi\u1ec7c vi\u1ebft \\(\\mathbb{E}\\{X\\} = \\int X(\\omega) \\mathbb{P}(d\\omega)\\) hay \\(\\int X d \\mathbb{P}\\)</p> <p>V\u00ec s\u1ef1 ph\u00e2n v\u00f9ng \\(\\Omega\\) c\u00f3 nhi\u1ec1u c\u00e1ch bi\u1ec3u di\u1ec5n, ta ph\u1ea3i cho th\u1ea5y r\u1eb1ng, d\u00f9 d\u00f9ng c\u00e1ch bi\u1ec3n di\u1ec5n n\u00e0o, ta c\u0169ng ph\u1ea3i suy ra \u0111\u01b0\u1ee3c m\u1ed9t kh\u00e1i ni\u1ec7m k\u1ef3 v\u1ecdng \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 r\u00e0ng.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>\u0110\u1ecbnh ngh\u0129a c\u1ee7a \\(\\mathbb{E}\\{X\\}\\) cho c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 r\u00e0ng.</p> <p>Ch\u1ee9ng minh</p> <p>G\u1ecdi \\(X = \\sum_{i=1}^{n} a_i 1_{A_i}\\) v\u00e0 \\(Y = \\sum_{j=1}^{m} b_j 1_{B_j}\\) l\u00e0 hai bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n sao cho \\(\\bigcup_{i=1}^{n} A_i = \\Omega = \\bigcup_{j=1}^{m} B_j\\) v\u1edbi \\(A_i \\cap A_l = \\emptyset\\) (\\(\\forall i \\ne l\\)) vaf \\(B_j \\cap B_k = \\emptyset\\) (\\(\\forall j \\ne k\\)).</p> <p>L\u01b0u \u00fd r\u1eb1ng ta c\u00f3 th\u1ec3 vi\u1ebft m\u1ed7i \\(A_i = A_i \\cap \\Omega = A_i \\cap (\\bigcup_{j=1}^{m} B_j)\\) v\u00e0 m\u1ed7i \\(B_j = B_j \\cap \\Omega = B_j \\cap (\\bigcup_{i=1}^{n} A_i)\\). V\u00ec v\u1eady ta c\u00f3 th\u1ec3 vi\u1ebft l\u1ea1i \\(X\\) th\u00e0nh \\(X = \\sum_{i=1}^{n} a_i 1_{A_i} = \\sum_{i=1}^{n} a_i 1_{A_i \\cap (\\bigcup_{j=1}^{m} B_j)}\\).</p> <p>V\u00ec t\u1ea5t c\u1ea3 c\u00e1c \\(A_i\\) v\u00e0 \\(B_j\\) kh\u00f4ng giao nhau, n\u00ean m\u1ed7i \\(A_i \\cap B_j\\) t\u1ea1o ra m\u1ed9t t\u1eadp r\u1eddi r\u1ea1c c\u1ee7a \\(\\Omega\\), do v\u1eady, \\(X = \\sum_{i=1}^{n} a_i 1_{A_i \\cap (\\bigcup_{j=1}^{m} B_j)} = \\sum_{i=1}^{n} \\sum_{j=1}^{m} a_i 1_{A_i \\cap B_j}\\). Ta l\u00e0m t\u01b0\u01a1ng t\u1ef1 v\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n \\(Y\\) th\u00ec ta c\u00f3 \\(Y = \\sum_{j=1}^{m} \\sum_{i=1}^{n} b_j 1_{A_i \\cap B_j}\\).</p> <p>V\u00ec v\u1eady, ta cho \\(a_i = b_j\\) tr\u00ean m\u1ecdi \\(A_i \\cap B_j \\ne \\emptyset\\) th\u00ec ta th\u1ea5y r\u1eb1ng \\(X = \\sum_{i=1}^{n} \\sum_{j=1}^{m} a_i 1_{A_i \\cap B_j} = \\sum_{j=1}^{m} \\sum_{i=1}^{n} b_j 1_{A_i \\cap B_j} = Y\\).</p> <p>Gi\u1edd l\u1ea5y k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\) v\u00e0 \\(Y\\), ta c\u00f3 \\(\\mathbb{E}\\{X\\} = \\sum_{i=1}^{n} \\sum_{j=1}^{m} a_i \\mathbb{P}(A_i \\cap B_j) = \\sum_{j=1}^{m} \\sum_{i=1}^{n} b_j \\mathbb{P}(A_i \\cap B_j) = \\mathbb{E}\\{Y\\}\\) n\u00ean \u0111\u1ecbnh ngh\u0129a k\u1ef3 v\u1ecdng c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n \u0111\u01b0\u1ee3c x\u00e1c \u0111\u1ecbnh r\u00f5 r\u00e0ng.</p>"},{"location":"misc/probability/expected-value/#tinh-chat","title":"T\u00ednh ch\u1ea5t","text":"<p>\u0110\u1ecbnh l\u00fd</p> <p>V\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) v\u00e0 b\u1ea5t k\u1ef3 h\u1eb1ng s\u1ed1 \\(c\\) n\u00e0o,</p> \\[E[X + c] = E[X] + c\\] <p>Ch\u1ee9ng minh</p> <p>Ta c\u00f3</p> \\[\\begin{align} E[X + c] &amp;= \\sum_{x} (x + c) P(X+c = x+c)\\\\ &amp;= \\sum_{x} xP(X = x) + \\sum_{x} cP(X = x) \\\\ &amp;= E[X] + c \\sum_{x} P(X = x)\\\\ &amp;= E[X] + c \\cdot 1\\\\ &amp;= E[X] + c\\\\ \\end{align}\\] <p>\u0110\u1ecbnh l\u00fd</p> <p>V\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) v\u00e0 b\u1ea5t k\u1ef3 h\u1eb1ng s\u1ed1 \\(c\\) n\u00e0o,</p> \\[E[cX] = c \\cdot E[X]\\] <p>Ch\u1ee9ng minh</p> <p>Theo \u0111\u1ecbnh ngh\u0129a k\u1ef3 v\u1ecdng,</p> \\[\\begin{align} E[cX] &amp;= \\sum_{x} cx \\cdot P(cX = cx)\\\\ &amp;= c \\sum_{x} x \\cdot P(X = x)\\\\ &amp;= c \\cdot E[X]\\\\ \\end{align}\\] <p>\u0110\u1ecbnh l\u00fd \u0111\u1ea7u ti\u00ean cho ta th\u1ea5y d\u1ecbch duy\u1ec3n t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn theo m\u1ed9t h\u1eb1ng s\u1ed1 c\u0169ng d\u1ecbch chuy\u1ec3n k\u1ef3 v\u1ecdng theo h\u1eb1ng s\u1ed1 \u0111\u00f3. \u0110i\u1ec1u n\u00e0y r\u1ea5t h\u1ee3p l\u00fd v\u00ec n\u1ebfu t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn \u0111\u01b0\u1ee3c d\u1ecbch chuy\u1ec3n theo m\u1ed9t h\u1eb1ng s\u1ed1, gi\u00e1 tr\u1ecb trung b\u00ecnh c\u0169ng \u0111\u01b0\u1ee3c d\u1ecbch chuy\u1ec3n theo h\u1eb1ng s\u1ed1 \u0111\u00f3. \u0110\u1ecbnh l\u00fd th\u1ee9 hai cho ta bi\u1ebft r\u1eb1ng nh\u00e2n c\u00e1c gi\u00e1 tr\u1ecb c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean theo m\u1ed9t h\u1eb1ng s\u1ed1 \\(c\\) c\u0169ng b\u1ed9i ho\u00e1 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng l\u00ean \\(c\\) l\u1ea7n.</p> <p>V\u00ed d\u1ee5</p> <p>M\u1ed9t x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u c\u00f3 c\u00e1c m\u1eb7t ghi c\u00e1c s\u1ed1 t\u1eeb 5 \u0111\u1ebfn 10. K\u1ef3 v\u1ecdng s\u1ed1 tung ra \u0111\u01b0\u1ee3c l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Tr\u01b0\u1edbc \u0111\u00f3 ta bi\u1ebft r\u1eb1ng k\u1ef3 v\u1ecdng khi tung m\u1ed9t x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u l\u00e0 \\(E[X] = 3.5\\). B\u00e0i n\u00e0y h\u1ecfi l\u00e0m sao t\u00ednh \\(E[X + 4]\\).</p> <p>V\u1eady k\u1ef3 v\u1ecdng s\u1ed1 tr\u00ean x\u00fac x\u1eafc l\u00e0 \\(3.5 \\times 4 = 7.5\\).</p> <p>V\u00ed d\u1ee5</p> <p>M\u1ed9t x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u c\u00f3 c\u00e1c m\u1eb7t ghi b\u1ed9i c\u1ee7a 6 s\u1ed1 d\u01b0\u01a1ng \u0111\u1ea7u ti\u00ean v\u1edbi 5. K\u1ef3 v\u1ecdng s\u1ed1 tung ra \u0111\u01b0\u1ee3c l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Tr\u01b0\u1edbc \u0111\u00f3 ta bi\u1ebft r\u1eb1ng k\u1ef3 v\u1ecdng khi tung m\u1ed9t x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u l\u00e0 \\(E[X] = 3.5\\). B\u00e0i n\u00e0y h\u1ecfi l\u00e0m sao t\u00ednh \\(E[5X]\\).</p> <p>V\u1eady k\u1ef3 v\u1ecdng s\u1ed1 tr\u00ean x\u00fac x\u1eafc l\u00e0 \\(3.5 \\times 5 = 17.5\\).</p> <p>Gi\u1edd ta s\u1ebd xem l\u00e0m sao \u0111\u1ec3 t\u00ednh gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean.</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>G\u1ecdi \\(X\\) v\u00e0 \\(Y\\) l\u00e0 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean, th\u00ec</p> \\[E[X+Y] = E[X] + E[Y]\\] <p>V\u00ed d\u1ee5</p> <p>Hai con x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u \u0111\u01b0\u1ee3c tung. K\u1ef3 v\u1ecdng t\u1ed5ng c\u00e1c s\u1ed1 l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Tr\u01b0\u1edbc \u0111\u00f3 ta bi\u1ebft r\u1eb1ng k\u1ef3 v\u1ecdng khi tung m\u1ed9t x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u l\u00e0 \\(E[X] = 3.5\\). B\u00e0i n\u00e0y h\u1ecfi l\u00e0m sao t\u00ednh \\(E[X+X]\\).</p> <p>V\u1eady k\u1ef3 v\u1ecdng t\u1ed5ng c\u00e1c s\u1ed1 l\u00e0 \\(3.5 + 3.5 = 7\\).</p>"},{"location":"misc/probability/expected-value/#ky-vong-tuyen-tinh","title":"K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh","text":"<p>C\u00e1c \u0111\u1ecbnh l\u00fd \u1edf tr\u00ean c\u00f3 th\u1ec3 k\u1ebft h\u1ee3p th\u00e0nh:</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>V\u1edbi b\u1ea5t k\u1ef3 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \\(X_1, X_2, \\ldots, X_k\\) v\u00e0 c\u00e1c h\u1eb1ng s\u1ed1 \\(c_1, c_2, \\ldots, c_k\\) ta c\u00f3</p> \\[E\\left[ \\sum_{i=1}^{k} c_i X_i \\right] = \\sum_{i=1}^{k} c_i E[X_i]\\] <p>N\u00f3 c\u00f2n \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn v\u1edbi c\u00e1i t\u00ean K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, v\u00e0 \u0111\u00fang ngay c\u1ea3 khi c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \\(X_i\\) kh\u00f4ng \u0111\u1ed9c l\u1eadp.</p> <p>V\u00ed d\u1ee5</p> <p>M\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u \u0111\u01b0\u1ee3c tung cho \u0111\u1ebfn khi ra ba s\u1ed1 6 li\u00ean ti\u1ebfp. K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_n\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 l\u1ea7n tung c\u1ea7n \u0111\u1ec3 c\u00f3 \\(n\\) s\u1ed1 6 li\u00ean ti\u1ebfp.</p> <p>\u0110\u1ec3 c\u00f3 \\(n\\) s\u1ed1 6 li\u00ean ti\u1ebfp th\u00ec ta ph\u1ea3i c\u00f3 \\(n-1\\) s\u1ed1 6 li\u00ean ti\u1ebfp. Sau \u0111\u00f3, s\u1ed1 6 th\u1ee9 \\(n\\) s\u1ebd xu\u1ea5t hi\u1ec7n trong l\u1ea7n tung ti\u1ebfp theo v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{6}\\), ho\u1eb7c qu\u00e1 tr\u00ecnh s\u1ebd quay l\u1ea1i t\u1eeb \u0111\u1ea7u v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{5}{6}\\):</p> \\[E[X_n] = E \\left[\\frac{1}{6} (X_{n-1} + 1)  + \\frac{5}{6} (X_{n-1} + 1 + X_n) \\right] = E \\left[X_{n-1} + 1 + \\frac{5}{6} X_n \\right]\\] <p>Theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh,</p> \\[E[X_n] = E[X_{n-1}] + 1 + \\frac{5}{6} E[X_n]\\] <p>Gi\u1ea3i \\(E[X_n]\\) ta c\u00f3</p> \\[E[X_n] = 6E[X_{n-1}] + 6\\] <p>C\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \\(E[X_1] = 6\\), n\u00ean \\(E[X_2] = 6 \\times 6 + 6 = 42\\), v\u00e0 \\(E[X_3] = 6 \\times 42 + 6 = 258\\).</p> <p>K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra 3 s\u1ed1 6 l\u00e0 \\(258\\).</p> <p>V\u00ed d\u1ee5</p> <p>M\u1ed9t \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng \u0111\u01b0\u1ee3c tung cho \u0111\u1ebfn khi c\u00f3 5 m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp. K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_n\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 l\u1ea7n tung c\u1ea7n \u0111\u1ec3 c\u00f3 \\(n\\) s\u1ed1 m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp.</p> <p>\u0110\u1ec3 c\u00f3 \\(n\\) m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp th\u00ec ta ph\u1ea3i c\u00f3 \\(n-1\\) m\u1eb7t ng\u1eeda li\u00ean ti\u1ebfp. Sau \u0111\u00f3, m\u1eb7t ng\u1eeda th\u1ee9 \\(n\\) s\u1ebd xu\u1ea5t hi\u1ec7n trong l\u1ea7n tung ti\u1ebfp theo v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{2}\\), ho\u1eb7c qu\u00e1 tr\u00ecnh s\u1ebd quay l\u1ea1i t\u1eeb \u0111\u1ea7u v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{2}\\) c\u00f2n l\u1ea1i:</p> \\[E[X_n] = E \\left[\\frac{1}{2} (X_{n-1} + 1) + \\frac{1}{2} (X_{n-1} + 1 + X_n) \\right] = E \\left[X_{n-1} + 1 + \\frac{1}{2} X_n \\right]\\] <p>Theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh,</p> \\[E[X_n] = E[X_{n-1}] + 1 + \\frac{1}{2} E[X_n]\\] <p>Gi\u1ea3i \\(E[X_n]\\) ta c\u00f3</p> \\[E[X_n] = 2E[X_{n-1}] + 2\\] <p>C\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng \\(E[X_1] = 2\\). Theo c\u00f4ng th\u1ee9c tr\u00ean ta s\u1ebd t\u00ednh \u0111\u01b0\u1ee3c \\(E[X_5] = 62\\)</p> <p>K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra 5 m\u1eb7t ng\u1eeda l\u00e0 \\(62\\).</p>"},{"location":"misc/probability/expected-value/#bien-ngau-nhien-lien-tuc","title":"Bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c","text":"<p>C\u00f3 hai lo\u1ea1i bi\u1ebfn ng\u1eabu nhi\u00ean, \u0111\u00f3 l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c v\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c. X\u00fac x\u1eafc \u1edf v\u00ed d\u1ee5 tr\u00ean l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c v\u00ec bi\u1ebfn n\u00e0y c\u00f3 th\u1ec3 nh\u1eadn m\u1ed9t s\u1ed1 h\u1eefu h\u1ea1n c\u00e1c gi\u00e1 tr\u1ecb r\u1eddi r\u1ea1c. Ch\u1ecdn m\u1ed9t s\u1ed1 th\u1ef1c ng\u1eabu nhi\u00ean t\u1eeb kho\u1ea3ng \\([0, 1]\\) l\u00e0 m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c.</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>Cho m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c \\(X\\) v\u00e0 m\u1ed9t h\u00e0m m\u1eadt \u0111\u1ed9 x\u00e1c su\u1ea5t \\(f(x)\\), gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a l\u00e0</p> \\[E[X] = \\int_{x} xf(x)dx\\] <p>V\u00ed d\u1ee5</p> <p>Cho h\u00e0m m\u1eadt \u0111\u1ed9 x\u00e1c su\u1ea5t \\(f(x) = 3x^2\\) \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a tr\u00ean \u0111o\u1ea1n \\([0, 1]\\), \\(E[X]\\) b\u1eb1ng bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Theo \u0111\u1ecbnh ngh\u0129a \u1edf tr\u00ean,</p> \\[\\begin{align} E[X] &amp;= \\int_{0}^{1} 3x^3 dx\\\\ &amp;= \\left. \\frac{3}{4} x^4 \\right\\rvert_0^1 \\\\ &amp;= \\frac{3}{4}\\\\ \\end{align}\\] <p>V\u00ed d\u1ee5</p> \\[f(x) = \\frac{\\pi}{14400} x \\sin \\left( \\frac{\\pi}{120} x \\right) , 0 &lt; x &lt; 120\\] <p>M\u1ed9t chuy\u00ean gia t\u00ednh to\u00e1n b\u1ea3o hi\u1ec3m nh\u00e2n th\u1ecd \u01b0\u1edbc t\u00ednh x\u00e1c su\u1ea5t c\u1ee7a \\(X\\) (tu\u1ed5i th\u1ecd c\u1ee7a m\u1ed9t ng\u01b0\u1eddi) v\u1edbi h\u00e0m m\u1eadt \u0111\u1ed9 x\u00e1c su\u1ea5t nh\u01b0 m\u00f4 t\u1ea3 \u1edf tr\u00ean</p> <p>Theo model n\u00e0y, \\(\\lfloor E[X] \\rfloor\\) l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Theo \u0111\u1ecbnh ngh\u0129a \u1edf tr\u00ean,</p> \\[E[X] = \\int_{0}^{120} xf(x) dx = \\int_{0}^{120}  \\frac{\\pi}{14400} x^2 \\sin \\left( \\frac{\\pi}{120} x \\right) dx\\] <p>D\u00f9ng t\u00edch ph\u00e2n t\u1eebng ph\u1ea7n ta c\u00f3</p> \\[E[X] = \\left. - \\frac{1}{120} x^2 \\cos\\left( \\frac{\\pi}{120} x \\right) + \\frac{2}{\\pi} x \\sin \\left( \\frac{\\pi}{120} x \\right) + \\frac{240}{\\pi^2} cos \\left( \\frac{\\pi}{120} x \\right) \\right\\rvert_0^{120}\\] <p>Ta s\u1ebd t\u00ednh ra \u0111\u01b0\u1ee3c:</p> \\[E[X] = 120 - \\frac{480}{\\pi^2} \\approx 71.366\\] <p>Nh\u01b0 v\u1eady \\(\\lfloor E[X] \\rfloor = 71\\).</p>"},{"location":"misc/probability/expected-value/#ky-vong-co-ieu-kien","title":"K\u1ef3 v\u1ecdng c\u00f3 \u0111i\u1ec1u ki\u1ec7n","text":"<p>\u0110\u1ecbnh ngh\u0129a</p> <p>G\u1ecdi \\(X\\) v\u00e0 \\(Y\\) l\u00e0 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c. Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\) bi\u1ebft bi\u1ebfn c\u1ed1 \\(Y = y\\), k\u00fd hi\u1ec7u l\u00e0 \\(E[X | Y = y]\\) l\u00e0</p> \\[E[X | Y = y] = \\sum_x xP(X = x | Y = y)\\] <p>V\u00ed d\u1ee5</p> <p>K\u1ef3 v\u1ecdng s\u1ed1 m\u1eb7t ng\u1eeda trong 5 l\u1ea7n tung \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng l\u00e0 bao nhi\u00eau, v\u1edbi \u0111i\u1ec1u ki\u1ec7n l\u00e0 s\u1ed1 l\u1ea7n tung m\u1eb7t ng\u1eeda l\u1edbn h\u01a1n 2?</p> L\u1eddi gi\u1ea3i <p>Trong v\u00ed d\u1ee5 n\u00e0y, \\(X\\) l\u00e0 s\u1ed1 m\u1eb7t ng\u1eeda trong 5 l\u1ea7n tung \u0111\u1ed3ng xu, c\u00f2n \\(Y = y\\) l\u00e0 bi\u1ebfn c\u1ed1 \\(X &gt; 2\\).</p> <p>Nh\u1edb l\u1ea1i c\u00f4ng th\u1ee9c x\u00e1c su\u1ea5t c\u00f3 \u0111i\u1ec1u ki\u1ec7n: \\(P(X = x | Y = y) = \\frac{P(X = x \\cap Y = y)}{P(Y = y)}\\)</p> <p>N\u00ean k\u1ebft qu\u1ea3 s\u1ebd l\u00e0</p> \\[E[X | Y] = 3 \\cdot \\frac{P(X = 3)}{P(X &gt; 2)} + 4 \\cdot \\frac{P(X = 4)}{P(X &gt; 2)} + 5 \\cdot \\frac{P(X = 5)}{P(X &gt; 2)}\\] <p>C\u00e1c x\u00e1c su\u1ea5t n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh theo ph\u00e2n ph\u1ed1i nh\u1ecb th\u1ee9c:</p> \\[\\begin{align} P(X = 3) &amp;= \\binom{5}{3} \\cdot \\left(\\frac{1}{2}\\right)^5 = \\frac{5}{16} \\\\ P(X = 4) &amp;= \\binom{5}{4} \\cdot \\left(\\frac{1}{2}\\right)^5 = \\frac{5}{32} \\\\ P(X = 5) &amp;= \\binom{5}{5} \\cdot \\left(\\frac{1}{2}\\right)^5 = \\frac{1}{32} \\\\ \\Rightarrow P(X &gt; 2) &amp;= P(X = 3) + P(X = 4) + P(X = 5) = \\frac{1}{2}\\\\ \\end{align}\\] <p>Thay c\u00e1c gi\u00e1 tr\u1ecb v\u00e0o th\u00ec ta c\u00f3,</p> \\[E[X | Y] = 3 \\cdot \\frac{\\frac{5}{16}}{\\frac{1}{2}} + 4 \\cdot \\frac{\\frac{5}{32}}{\\frac{1}{2}} + 5 \\cdot \\frac{\\frac{1}{32}}{\\frac{1}{2}} = \\frac{55}{16}\\] <p>Nh\u01b0 v\u1eady k\u1ef3 v\u1ecdng s\u1ed1 m\u1eb7t ng\u1eeda tung \u0111\u01b0\u1ee3c khi c\u00f3 nhi\u1ec1u h\u01a1n 2 l\u1ea7n tung m\u1eb7t ng\u1eeda l\u00e0 \\(\\frac{55}{16} = 3.4375\\).</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>G\u1ecdi \\(X\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c, v\u00e0 \\(f(x)\\) l\u00e0 h\u00e0m m\u1eadt \u0111\u1ed9 x\u00e1c su\u1ea5t c\u1ee7a n\u00f3. G\u1ecdi \\(Y = y\\) l\u00e0 m\u1ed9t bi\u1ebfn c\u1ed1, v\u00e0 \\(\\chi\\) l\u00e0 ph\u1ea1m vi c\u1ee7a \\(X\\) v\u1edbi \\(Y = y\\) cho tr\u01b0\u1edbc. Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\) v\u1edbi \\(Y = y\\) cho tr\u01b0\u1edbc, k\u00fd hi\u1ec7u l\u00e0 \\(E[X | Y = y]\\), l\u00e0</p> \\[E[X | Y = y] = \\frac{\\int_{x \\in \\chi} xf(x) dx}{P(Y=y)}\\] <p>V\u00ed d\u1ee5</p> <p>G\u1ecdi \\(X\\) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c v\u1edbi h\u00e0m m\u1eadt \u0111\u1ed9 \\(f(x) = 2x, 0 &lt; x &lt; 1\\). \\(E[X | X &lt; \\frac{1}{2}]\\) l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Trong v\u00ed d\u1ee5 n\u00e0y, \u0111i\u1ec1u ki\u1ec7n \\(X &lt; \\frac{1}{2}\\) \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng v\u00e0o bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\). Ph\u1ea1m vi c\u1ee7a \\(X\\) l\u00e0 \\(0 &lt; x &lt; \\frac{1}{2}\\) theo \u0111i\u1ec1u ki\u1ec7n \u0111\u00f3.</p> <p>X\u00e1c su\u1ea5t \\(P(X &lt; \\frac{1}{2})\\) c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c t\u00ednh v\u1edbi ph\u1ea1m vi nh\u01b0 v\u1eady.</p> \\[\\begin{align} P(X &lt; \\frac{1}{2}) &amp;= \\int_0^{\\frac{1}{2}} 2x dx \\\\ &amp;= \\left. x^2 \\right\\rvert_0^{1/2} \\\\ &amp;= \\frac{1}{4} \\\\ \\end{align}\\] <p>Th\u00ec k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\) v\u1edbi \\(X &lt; \\frac{1}{2}\\) cho tr\u01b0\u1edbc \u0111\u01b0\u1ee3c t\u00ednh theo c\u00f4ng th\u1ee9c tr\u00ean</p> \\[\\begin{align} P(X = 3) &amp;= \\frac{\\int_0^{1/2} 2x^2 dx}{P(X &lt; \\frac{1}{2})} \\\\ &amp;= \\frac{\\left. \\frac{2}{3} x^3 \\right\\rvert_0^{1/2}}{\\frac{1}{4}} \\\\ &amp;= \\frac{\\frac{1}{12} - 0}{\\frac{1}{4}} \\\\ &amp;= \\frac{1}{3}\\\\ \\end{align}\\] <p>V\u1eady k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\) v\u1edbi \\(X &lt; \\frac{1}{2}\\) cho tr\u01b0\u1edbc l\u00e0 \\(\\frac{1}{3}\\)</p>"},{"location":"misc/probability/expected-value/#cac-vi-du","title":"C\u00e1c v\u00ed d\u1ee5","text":""},{"location":"misc/probability/expected-value/#vi-du-1","title":"V\u00ed d\u1ee5 1","text":"<p>Cho 2 t\u00fai b\u00f3ng, m\u1ed7i t\u00fai c\u00f3 5 tr\u00e1i b\u00f3ng \u0111\u01b0\u1ee3c \u0111\u00e1nh s\u1ed1 t\u1eeb 1 \u0111\u1ebfn 5. L\u1ea5y m\u1ed7i t\u00fai 1 tr\u00e1i b\u00f3ng. K\u1ef3 v\u1ecdng t\u1ed5ng hai s\u1ed1 tr\u00ean 2 b\u00f3ng l\u1ea5y ra \u0111\u01b0\u1ee3c l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 tr\u00ean tr\u00e1i b\u00f3ng \u0111\u01b0\u1ee3c l\u1ea5y ra t\u1eeb t\u00fai 1, \\(Y\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 tr\u00ean tr\u00e1i b\u00f3ng l\u1ea5y ra t\u1eeb t\u00fai 2. K\u1ef3 v\u1ecdng t\u1ed5ng hai s\u1ed1 s\u1ebd l\u00e0 \\(E[X + Y] = E[X] + E[Y]\\), theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh.</p> <p>V\u00ec hai t\u00fai nh\u01b0 nhau n\u00ean hai bi\u1ebfn ng\u1eabu nhi\u00ean n\u00e0y nh\u01b0 nhau, ngh\u0129a l\u00e0 k\u1ef3 v\u1ecdng c\u1ee7a ch\u00fang c\u0169ng nh\u01b0 nhau, nh\u01b0 v\u1eady \\(E[X + Y] = E[X] + E[Y] = 2 \\cdot E[X]\\).</p> <p>V\u1edbi m\u1ed9t t\u00fai th\u00ec ta c\u00f3 th\u1ec3 t\u00ednh \u0111\u01a1n gi\u1ea3n v\u1edbi c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng, \\(E[X] = 1 \\cdot \\frac{1}{5} + 2 \\cdot \\frac{1}{5} + 3 \\cdot \\frac{1}{5} + 4 \\cdot \\frac{1}{5} + 5 \\cdot \\frac{1}{5} = 3\\).</p> <p>V\u1eady k\u1ebft qu\u1ea3 l\u00e0 \\(E[X + Y] = E[X] + E[Y] = 2 \\cdot E[X] = 2 \\cdot 3 = 6\\).</p> <p>Ngo\u00e0i c\u00e1ch n\u00e0y, ta c\u0169ng c\u00f3 th\u1ec3 t\u00ednh t\u1ea5t c\u1ea3 t\u1ed5ng c\u00f3 th\u1ec3 x\u1ea3y ra v\u00e0 x\u00e1c su\u1ea5t \u0111\u1ec3 x\u1ea3y ra m\u1ed7i tr\u01b0\u1eddng h\u1ee3p, sau \u0111\u00f3 d\u00f9ng c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng \u0111\u1ec3 t\u00ednh, c\u0169ng cho ra k\u1ebft qu\u1ea3 nh\u01b0 v\u1eady. C\u00e1ch n\u00e0y c\u00f3 trong b\u00e0i vi\u1ebft g\u1ed1c, c\u00e1c b\u1ea1n c\u00f3 th\u1ec3 t\u00ecm \u0111\u1ecdc.</p>"},{"location":"misc/probability/expected-value/#vi-du-2","title":"V\u00ed d\u1ee5 2","text":"<p>Tung \\(n\\) con x\u00fac x\u1eafc 6 m\u1eb7t. K\u1ef3 v\u1ecdng s\u1ed1 s\u1ed1 5 trong k\u1ebft qu\u1ea3 l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>\u0110\u1ec3 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c k\u1ef3 v\u1ecdng s\u1ed1 s\u1ed1 5 sau khi tung, ta c\u00f3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a \\(Y\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 s\u1ed1 5 tung ra \u0111\u01b0\u1ee3c, v\u00e0 \\(Y_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean con x\u00fac x\u1eafc th\u1ee9 \\(i\\) ra \\(5\\). D\u1ec5 th\u1ea5y r\u1eb1ng \\(E[Y_i] = \\frac{1}{6} \\cdot 1 + \\frac{5}{6} \\cdot 0 = \\frac{1}{6}\\). Ta c\u00f3 \\(Y = \\sum_{i=1}^n Y_i\\), n\u00ean theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, \\(E(Y) = \\sum_{i=1}^n E(Y_i)\\). V\u1eady \\(E(Y) = \\frac{n}{6}\\).</p> <p>L\u01b0u \u00fd, ta c\u0169ng c\u00f3 th\u1ec3 gi\u1ea3i b\u1eb1ng c\u00e1ch \u0111\u1ec3 \u00fd r\u1eb1ng v\u00ec x\u00e1c su\u1ea5t ra m\u1ed7i s\u1ed1 l\u00e0 nh\u01b0 nhau, n\u00ean k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n ta c\u00f3 m\u1ed7i s\u1ed1 l\u00e0 nh\u01b0 nhau, v\u00e0 t\u1ed5ng c\u00e1c k\u1ef3 v\u1ecdng n\u00e0y s\u1ebd l\u00e0 \\(n\\), n\u00ean v\u1edbi m\u1ed7i s\u1ed1, k\u1ef3 v\u1ecdng c\u00f3 s\u1ed1 \u0111\u00f3 l\u00e0 \\(\\frac{n}{6}\\).</p> <p>N\u00f3i m\u1ed9t c\u00e1ch to\u00e1n h\u1ecdc, g\u1ecdi \\(Z_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 l\u1ea7n \\(i\\) \u0111\u01b0\u1ee3c tung ra sau \\(n\\) l\u1ea7n tung. Do t\u00ednh c\u00e2n \u0111\u1ed1i, ta bi\u1ebft r\u1eb1ng \\(E[Z_i]\\) l\u00e0 m\u1ed9t h\u1eb1ng s\u1ed1. V\u00ec c\u00f3 t\u1ea5t c\u1ea3 \\(n\\) k\u1ebft qu\u1ea3, \\(n = Z_1 + Z_2 + Z_3 + Z_4 + Z_5 + Z_6\\). \u0110i\u1ec1u n\u00e0y cho ta</p> \\[\\begin{align} n &amp;= E[ Z_1 + Z_2 + Z_3 + Z_4 + Z_5 + Z_6 ] \\\\ &amp;= E[Z_1] + E[Z_2]+ E[Z_3]+E[Z_4]+E[Z_5]+E[Z_6] \\\\ &amp;= 6 E[Z_i] \\end{align}\\]"},{"location":"misc/probability/expected-value/#vi-du-3","title":"V\u00ed d\u1ee5 3","text":"<p>X\u00e9t m\u1ed9t quy tr\u00ecnh Bernoulli c\u1ee7a m\u1ed9t d\u00e3y c\u00e1c l\u1ea7n tung \u0111\u1ed3ng xu \u0111\u1ed9c l\u1eadp v\u1edbi x\u00e1c su\u1ea5t m\u1eb7t ng\u1eeda l\u00e0 \\(p\\). G\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean v\u1edbi \\(X_i = 1\\) n\u1ebfu l\u1ea7n tung th\u1ee9 \\(i\\) l\u00e0 m\u1eb7t ng\u1eeda v\u00e0 \\(X_i = 0\\) n\u1ebfu l\u1ea7n tung th\u1ee9 \\(i\\) l\u00e0 m\u1eb7t s\u1ea5p. G\u1ecdi \\(Y\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean th\u1ec3 hi\u1ec7n s\u1ed1 l\u1ea7n tung cho \u0111\u1ebfn khi ra \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda. K\u1ef3 v\u1ecdng c\u1ee7a \\(Y\\) l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>C\u00e1c gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 c\u1ee7a s\u1ed1 l\u1ea7n tung \u0111\u1ed3ng xu cho \u0111\u1ebfn khi ra \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda l\u00e0 \\(1, 2, 3, \\ldots\\), n\u00ean \u0111\u00e2y l\u00e0 c\u00e1c gi\u00e1 tr\u1ecb c\u00f3 th\u1ec3 c\u00f3 c\u1ee7a bi\u1ebfn ng\u1eabu nhi\u00ean \\(Y\\). V\u1edbi \\(i = 1,2,3,\\ldots\\), x\u00e1c su\u1ea5t \\(Y = i\\) l\u00e0 x\u00e1c su\u1ea5t \\(i-1\\) l\u1ea7n tung \u0111\u1ea7u l\u00e0 m\u1eb7t s\u1ea5p, v\u00e0 l\u1ea7n \\(i\\) l\u00e0 m\u1eb7t ng\u1eeda. \u0110i\u1ec1u n\u00e0y cho ta ph\u00e2n ph\u1ed1i \\(p(Y = i) = (1-p)^{i-1} p\\), \u0111\u00e2y l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ph\u00e2n ph\u1ed1i h\u00ecnh h\u1ecdc. V\u1eady th\u00ec</p> \\[\\begin{align} E(Y) &amp;= \\sum_{i=1}^{\\infty} i(1-p)^{i-1} p\\\\ &amp;= p (1 + 2(1-p) + 3(1-p)^2 + 4(1-p)^3 + \\ldots) \\end{align}\\] <p>Gi\u1edd v\u1edbi \\(|x| &lt; 1\\), ta c\u00f3</p> \\[1 + x + x^2 + x^3 + \\ldots = \\frac{1}{1-x}\\] <p>\u0110\u1ea1o h\u00e0m hai v\u1ebf ta c\u00f3</p> \\[1 + 2x + 3x^2 + \\ldots = \\frac{1}{(1-x)^2}\\] <p>V\u1eady</p> \\[\\begin{align} E(Y) &amp;= p (1 + 2(1-p) + 3(1-p)^2 + 4(1-p)^3 + \\ldots) \\\\ &amp;= \\frac{p}{(1 - (1-p))^2} = \\frac{p}{p^2} = \\frac{1}{p}  \\end{align}\\]"},{"location":"misc/probability/expected-value/#vi-du-4","title":"V\u00ed d\u1ee5 4","text":"<p>T\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a s\u1ed1 tr\u1ea3 v\u1ec1 khi tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t \u0111\u1ec1u.</p> L\u1eddi gi\u1ea3i <p>M\u1ed9t ph\u00e9p th\u1eed tung x\u00fac x\u1eafc s\u1ebd c\u00f3 c\u00e1c k\u1ebft qu\u1ea3 trong t\u1eadp \\(\\{1,2,3,4,5,6\\}\\). N\u00ean bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) (l\u00e0 s\u1ed1 tr\u1ea3 v\u1ec1 khi tung m\u1ed9t con x\u00fac x\u1eafc 6 m\u1eb7t) c\u00f3 th\u1ec3 c\u00f3 6 gi\u00e1 tr\u1ecb nh\u01b0 sau</p> \\[x_1 = 1, x_2 = 2, x_3 = 3, x_4 = 4, x_5 = 5, x_6 = 6\\] <p>V\u1edbi m\u1ed9t con x\u00fac x\u1eafc \u0111\u1ec1u, \\(P(x_1) = P(x_2) = P(x_3) = P(x_4) = P(x_5) = P(x_6) = \\frac{1}{6}\\), ngh\u00eda l\u00e0</p> \\[\\begin{align} E(X) &amp;= x_1 P(x_1) + x_2 P(x_2) + x_3 P(x_3) + x_4 P(x_4) + x_5 P(x_5) + x_6 P(x_6) \\\\ &amp;= \\frac{1}{6} \\cdot (1 + 2 + 3 + 4 + 5 + 6) \\\\ &amp;= 3.5 \\end{align}\\] <p>L\u01b0u \u00fd, ta th\u1ea5y r\u1eb1ng gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a bi\u1ebfn \\(X\\) kh\u00f4ng nh\u1ea5t thi\u1ebft ph\u1ea3i l\u00e0 m\u1ed9t trong c\u00e1c gi\u00e1 tr\u1ecb m\u00e0 \\(X\\) th\u1ef1c s\u1ef1 c\u00f3 khi tung.</p>"},{"location":"misc/probability/expected-value/#vi-du-5","title":"V\u00ed d\u1ee5 5","text":"<p>T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung m\u1ed9t \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng cho \u0111\u1ebfn khi c\u00f3 m\u1eb7t ng\u1eeda.</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda. Theo c\u00f4ng th\u1ee9c x\u00e1c su\u1ea5t ta c\u00f3 \\(E(X) = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E(X))\\). Chuy\u1ec3n v\u1ebf ta c\u00f3 \\(E(X) = 2\\).</p> <p>Ngo\u00e0i ra ta c\u00f2n c\u00f3 c\u00e1ch gi\u1ea3i nh\u01b0 sau, ta c\u00f3 c\u00e1c bi\u1ebfn c\u1ed1 l\u00e0 \\({N, SN, SSN, SSSN, SSSSN, \\ldots}\\), trong \u0111\u00f3 N l\u00e0 ng\u1eeda, S l\u00e0 s\u1ea5p. Th\u00ec ta c\u00f3:</p> \\[\\begin{align} X &amp;= \\{1, 2, 3, 4, 5, \\ldots\\}\\\\ P(X) &amp;= \\left\\{\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{8}, \\frac{1}{16}, \\frac{1}{32}, \\ldots\\right\\} \\end{align}\\] <p>\u0110\u1ebfn \u0111\u00e2y ta c\u00f3</p> \\[E(X) = 1 \\cdot \\frac{1}{2} + 2 \\cdot \\frac{1}{4} + 3 \\cdot \\frac{1}{8} + 4 \\cdot \\frac{1}{16} + 5 \\cdot \\frac{1}{32} + \\ldots \\text{   (1)}\\] <p>Chia hai v\u1ebf cho \\(2\\), ta c\u00f3</p> \\[\\frac{1}{2} E(X) = \\frac{1}{4} + 2 \\cdot \\frac{1}{8} + 3 \\cdot \\frac{1}{16} + 4 \\cdot \\frac{1}{32} + 5 \\cdot \\frac{1}{64} + \\ldots \\text{   (2)}\\] <p>L\u1ea5y \\((1) - (2)\\) ta c\u00f3</p> \\[\\begin{align} \\frac{1}{2} E(X) &amp;= \\frac{1}{2} + \\frac{1}{4} + \\frac{1}{8} + \\frac{1}{16} + \\frac{1}{32} + \\frac{1}{64} + \\ldots \\\\ &amp;= \\frac{\\frac{1}{2}}{1 - \\frac{1}{2}}\\\\ &amp;= 1 \\\\  \\Rightarrow E(X) &amp;= 2 \\end{align}\\]"},{"location":"misc/probability/expected-value/#bai-tap","title":"B\u00e0i t\u1eadp","text":""},{"location":"misc/probability/expected-value/#bai-1","title":"B\u00e0i 1","text":"<p>M\u1ed9t casino c\u00f3 m\u1ed9t tr\u00f2 ch\u01a1i c\u00e1 c\u01b0\u1ee3c nh\u01b0 sau: ng\u01b0\u1eddi ch\u01a1i c\u01b0\u1ee3c m\u1ed9t s\u1ed1 ti\u1ec1n (\\(A\\) \u0111\u00f4 ch\u1eb3ng h\u1ea1n), c\u00f3 50% c\u01a1 h\u1ed9i ng\u01b0\u1eddi \u0111\u00f3 s\u1ebd c\u00f3 th\u00eam \\(A\\) \u0111\u00f4 n\u1eefa, nh\u01b0ng 50% c\u00f2n l\u1ea1i ng\u01b0\u1eddi ch\u01a1i s\u1ebd m\u1ea5t \u0111i \\(A\\) \u0111\u00f4. Ng\u01b0\u1eddi ch\u01a1i c\u1ea3m th\u1ea5y r\u1eb1ng k\u1ef3 v\u1ecdng m\u1ed7i l\u1ea7n ch\u01a1i l\u00e0 0, khi ch\u01a1i l\u00e2u d\u00e0i s\u1ebd kh\u00f4ng l\u1eddi v\u00e0 kh\u00f4ng l\u1ed7.</p> <p>M\u1ed9t thanh ni\u00ean quy\u1ebft \u0111\u1ecbnh th\u1eed ch\u01a1i. Anh ta c\u00f3 v\u00f4 s\u1ed1 ti\u1ec1n, v\u00e0 ch\u01a1i ki\u1ec3u nh\u01b0 sau:</p> <ul> <li>\u0110\u1ea7u ti\u00ean anh ta c\u01b0\u1ee3c 10 \u0111\u00f4.</li> <li>N\u1ebfu th\u1eafng, anh ta l\u1ea5y ti\u1ec1n th\u1eafng v\u00e0 ngh\u1ec9</li> <li>N\u1ebfu thua, anh ta g\u1ea5p \u0111\u00f4i s\u1ed1 ti\u1ec1n c\u01b0\u1ee3c v\u00e0 ch\u01a1i ti\u1ebfp</li> </ul> <p>V\u1eady k\u1ef3 v\u1ecdng t\u1ed5ng s\u1ed1 ti\u1ec1n th\u1eafng t\u1eeb khi b\u1eaft \u0111\u1ea7u ch\u01a1i \u0111\u1ebfn khi ngh\u1ec9 l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(E\\) l\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n th\u1eafng \u0111\u01b0\u1ee3c. Ta c\u00f3</p> \\[E = \\frac{1}{2} \\cdot 10 + \\frac{1}{4} \\cdot ((-10) + 20) + \\frac{1}{8} \\cdot ((-10) + (-20) + 40) + \\frac{1}{16} \\cdot ((-10) + (-20) + (-40) + 80) + \\ldots\\] <p>Suy ra</p> \\[\\begin{align} E &amp;= \\frac{1}{2} \\cdot 10 + \\frac{1}{4} \\cdot 10 + \\frac{1}{8} \\cdot 10 + \\frac{1}{16} \\cdot 10 + \\ldots \\\\ &amp;= 10 \\cdot (\\frac{1}{2} + \\frac{1}{4} + \\frac{1}{8} + \\frac{1}{16} + \\ldots) \\\\ &amp;= 10 \\cdot 1 \\\\ &amp;= 10 \\end{align}\\]"},{"location":"misc/probability/expected-value/#bai-2","title":"B\u00e0i 2","text":"<p>M\u1ed9t con b\u1ecd \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh A c\u1ee7a m\u1ed9t h\u00ecnh kh\u1ed1i c\u00f3 12 m\u1eb7t, 20 \u0111\u1ec9nh, m\u1ed7i m\u1eb7t l\u00e0 m\u1ed9t ng\u0169 gi\u00e1c \u0111\u1ec1u (dodecahedron). G\u1ecdi m\u1ed9t \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh A l\u00e0 \u0111\u1ec9nh B.</p> <p>M\u1ed7i gi\u00e2y n\u00f3 \u0111i ng\u1eabu nhi\u00ean d\u1ecdc theo m\u1ed9t c\u1ea1nh \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh kh\u00e1c, kh\u00f4ng quan t\u00e2m n\u00f3 c\u00f3 t\u1eebng \u0111i c\u1ea1nh \u0111\u00f3 hay ch\u01b0a. K\u1ef3 v\u1ecdng s\u1ed1 gi\u00e2y c\u1ea7n \u0111\u1ec3 n\u00f3 \u0111\u1ebfn \u0111\u1ec9nh B l\u00e0 bao nhi\u00eau? L\u01b0u \u00fd \u1edf \u0111\u00e2y m\u1ed7i \u0111\u1ec9nh s\u1ebd k\u1ec1 v\u1edbi 3 \u0111\u1ec9nh kh\u00e1c.</p> L\u1eddi gi\u1ea3i <p>H\u00ecnh kh\u1ed1i n\u00e0y c\u00f3 12 m\u1eb7t, 20 \u0111\u1ec9nh, v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chia ra th\u00e0nh 6 nh\u00f3m</p> <ol> <li>\u0110\u1ec9nh \u0111\u1ed1i di\u1ec7n \u0111\u1ec9nh B</li> <li>3 \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh nh\u00f3m 1</li> <li>6 \u0111\u1ec9nh k\u1ec1 v\u1edbi c\u00e1c \u0111\u1ec9nh nh\u00f3m 2</li> <li>6 \u0111\u1ec9nh k\u1ec1 v\u1edbi c\u00e1c \u0111\u1ec9nh nh\u00f3m 3</li> <li>3 \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh B (trong \u0111\u00f3 c\u00f3 \u0111\u1ec9nh A)</li> <li>\u0110\u1ec9nh B</li> </ol> <p>G\u1ecdi \\(E_i\\) l\u00e0 k\u00ec v\u1ecdng s\u1ed1 b\u01b0\u1edbc \u0111\u1ec3 \u0111i t\u1eeb \u0111\u1ec9nh nh\u00f3m \\(i\\) \u0111\u1ebfn B, ta s\u1ebd c\u00f3 c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh sau:</p> <ul> <li>\\(E_1 = E_2 + 1\\)</li> <li>\\(E_2 = \\frac{2}{3} \\cdot (1 + E_3) + \\frac{1}{3} \\cdot (1 + E_1) = 1 + \\frac{2}{3} \\cdot E_2 + \\frac{1}{3} \\cdot E_1\\)</li> <li>\\(E_3 = \\frac{1}{3} \\cdot (1 + E_2) + \\frac{1}{3} \\cdot (1 + E_3) + \\frac{1}{3} \\cdot (1 + E_4) = 1 + \\frac{1}{3} \\cdot E_2 + \\frac{1}{3} \\cdot E_3 + \\frac{1}{3} \\cdot E_4\\)</li> <li>\\(E_4 = \\frac{1}{3} \\cdot (1 + E_3) + \\frac{1}{3} \\cdot (1 + E_4) + \\frac{1}{3} \\cdot (1 + E_5) = 1 + \\frac{1}{3} \\cdot E_3 + \\frac{1}{3} \\cdot E_4 + \\frac{1}{3} \\cdot E_5\\)</li> <li>\\(E_5 = \\frac{2}{3} \\cdot (1 + E_4) + \\frac{1}{3} \\cdot 1 = 1 + \\frac{2}{3} \\cdot E_4\\)</li> </ul> <p>V\u00ec \u0111\u1ec9nh A n\u1eb1m trong nh\u00f3m 5 n\u00ean ta c\u1ea7n t\u00ednh \\(E_5\\). Thay \\(E_4, E_3, E_2, E_1\\) v\u00e0o ph\u01b0\u01a1ng tr\u00ecnh cu\u1ed1i th\u00ec ta t\u00ednh \u0111\u01b0\u1ee3c \\(E_5 = 19\\).</p>"},{"location":"misc/probability/expected-value/#bai-3","title":"B\u00e0i 3","text":"<p>C\u00f3 hai h\u1ed9p b\u00f3ng, h\u1ed9p b\u00ean tr\u00e1i ch\u1ee9a 1 b\u00f3ng \u0111\u1ecf v\u00e0 2 b\u00f3ng xanh, h\u1ed9p b\u00ean ph\u1ea3i ch\u1ee9a 2 b\u00f3ng xanh v\u00e0 3 b\u00f3ng \u0111\u1ecf. Trong m\u1ed9t tr\u00f2 ch\u01a1i, b\u1ea1n ph\u1ea3i ch\u1ecdn ng\u1eabu nhi\u00ean v\u00e0 \u0111\u1ed3ng th\u1eddi m\u1ed9t b\u00f3ng m\u1ed7i h\u1ed9p v\u1edbi c\u1ea3 hai tay.</p> <p>N\u1ebfu l\u1ea5y \u0111\u01b0\u1ee3c b\u00f3ng xanh t\u1eeb h\u1ed9p b\u00ean tr\u00e1i, b\u1ea1n s\u1ebd \u0111\u01b0\u1ee3c th\u01b0\u1edfng 4 \u0111\u00f4, nh\u01b0ng s\u1ebd b\u1ecb m\u1ea5t 5 \u0111\u00f4 n\u1ebfu b\u1ed1c ra b\u00f3ng \u0111\u1ecf. Trong khi \u0111\u00f3, l\u1ea5y \u0111\u01b0\u1ee3c b\u00f3ng \u0111\u1ecf \u1edf h\u1ed9p b\u00ean ph\u1ea3i s\u1ebd l\u00e0m cho b\u1ea1n m\u1ea5t 7 \u0111\u00f4, nh\u01b0ng l\u1ea5y ra \u0111\u01b0\u1ee3c b\u00f3ng xanh s\u1ebd cho b\u1ea1n th\u00eam 8 \u0111\u00f4.</p> <p>K\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n ki\u1ebfm \u0111\u01b0\u1ee3c l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ti\u1ec1n th\u01b0\u1edfng t\u1eeb h\u1ed9p b\u00ean tr\u00e1i, \\(Y\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ti\u1ec1n th\u01b0\u1edfng t\u1eeb h\u1ed9p b\u00ean ph\u1ea3i. K\u1ef3 v\u1ecdng t\u1ed5ng ti\u1ec1n th\u01b0\u1edfng l\u00e0 \\(E(X + Y) = E(X) + E(Y)\\), theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh.</p> <p>Theo c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng,</p> \\[E(X) = \\frac{2}{3} \\cdot 4 + \\frac{1}{3} \\cdot (-5) = 1\\] \\[E(Y) = \\frac{2}{5} \\cdot 8 + \\frac{3}{5} \\cdot (-7) = -1\\] <p>V\u1eady \\(E(X + Y) = E(X) + E(Y) = 1 + (-1) = 0\\). K\u1ef3 v\u1ecdng ti\u1ec1n th\u01b0\u1edfng l\u00e0 \\(0\\).</p>"},{"location":"misc/probability/expected-value/#bai-4","title":"B\u00e0i 4","text":"<p>B\u1ea1n tung m\u1ed9t \u0111\u1ed3ng xu c\u00f4ng b\u1eb1ng v\u00e0i l\u1ea7n. T\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ra \u0111\u01b0\u1ee3c SNS ho\u1eb7c SSS. N\u1ebfu k\u1ef3 v\u1ecdng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n l\u00e0 \\(\\frac{a}{b}\\) (ph\u00e2n s\u1ed1 t\u1ed1i gi\u1ea3n), t\u00ecm \\(a + b\\).</p> L\u1eddi gi\u1ea3i <p>B\u00e0i n\u00e0y ho\u00e0n to\u00e0n kh\u00f4ng gi\u1ed1ng b\u00e0i tung ra 3 s\u1ed1 6 li\u00ean ti\u1ebfp \u1edf tr\u00ean, c\u00f3 m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 l\u00e0m b\u00e0i n\u00e0y ph\u1ee9c t\u1ea1p h\u01a1n, v\u00ed d\u1ee5 khi tung \u0111\u01b0\u1ee3c SS, b\u1ea1n tung ra N th\u00ec tr\u1ea1ng th\u00e1i b\u00e2y gi\u1edd l\u00e0 SN ch\u1ee9 kh\u00f4ng quay v\u1ec1 tr\u1ea1ng th\u00e1i ch\u01b0a c\u00f3 g\u00ec, l\u00e0m cho vi\u1ec7c t\u00ednh k\u1ef3 v\u1ecdng nh\u01b0 b\u00e0i \u0111\u00f3 kh\u00f3 kh\u0103n h\u01a1n.</p> <p>G\u1ecdi \\(E\\) l\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i mong mu\u1ed1n, \\(E_1\\) l\u00e0 s\u1ed1 l\u1ea7n tung \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i mong mu\u1ed1n khi \u0111\u00e3 c\u00f3 S \u1edf cu\u1ed1i (nh\u01b0ng ngay tr\u01b0\u1edbc n\u00f3 kh\u00f4ng c\u00f3 S), \\(E_2\\) l\u00e0 s\u1ed1 l\u1ea7n tung \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i mong mu\u1ed1n khi \u0111\u00e3 c\u00f3 SS \u1edf cu\u1ed1i (nh\u01b0ng ch\u01b0a th\u1ea5y SNS hay SSS), \\(E_3\\) l\u00e0 s\u1ed1 l\u1ea7n tung \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c tr\u1ea1ng th\u00e1i mong mu\u1ed1n khi \u0111\u00e3 c\u00f3 SN \u1edf cu\u1ed1i (nh\u01b0ng ch\u01b0a th\u1ea5y SNS hay SSS).</p> <p>Theo c\u00f4ng th\u1ee9c x\u00e1c su\u1ea5t, ta c\u00f3</p> \\[E = \\frac{1}{2} \\cdot (1 + E_1) + \\frac{1}{2} \\cdot (1 + E) = 1 + \\frac{1}{2} \\cdot E_1 + \\frac{1}{2} \\cdot E \\text{    (1)}\\] \\[E_1 = \\frac{1}{2} \\cdot (1 + E_2) + \\frac{1}{2} \\cdot (1 + E_3) = 1 + \\frac{1}{2} \\cdot E_2 + \\frac{1}{2} \\cdot E_3 \\text{    (2)}\\] \\[E_2 = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E_3) = 1 + \\frac{1}{2} \\cdot E_3 \\text{    (3)}\\] \\[E_3 = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E) = 1 + \\frac{1}{2} \\cdot E \\text{    (4)}\\] <p>Gi\u1ea3i l\u1ea7n l\u01b0\u1ee3t hai ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea7u ta c\u00f3</p> \\[E = E_1 + 2\\] \\[E_1 = 1 + \\frac{1}{2} \\cdot E_2 + \\frac{1}{2} \\cdot E_3\\] <p>Suy ra</p> \\[E = 3 + \\frac{1}{2} \\cdot E_2 + \\frac{1}{2} \\cdot E_3 \\text{    (5)}\\] <p>Thay (4) v\u00e0o (3) ta c\u00f3</p> \\[E_2 = 1 + \\frac{1}{2} \\cdot (1 + \\frac{1}{2} \\cdot E) = \\frac{3}{2} + \\frac{1}{4} \\cdot E \\text{    (6)}\\] <p>Thay (4) v\u00e0 (6) v\u00e0o (5) ta c\u00f3</p> \\[E = 3 + \\frac{1}{2} \\cdot (\\frac{3}{2} + \\frac{1}{4} \\cdot E) + \\frac{1}{2} \\cdot (1 + \\frac{1}{2} \\cdot E) = 3 + \\frac{3}{4} + \\frac{1}{8} \\cdot E + \\frac{1}{2} + \\frac{1}{4} \\cdot E = \\frac{17}{4} + \\frac{3}{8} \\cdot E\\] <p>Chuy\u1ec3n v\u1ebf ta c\u00f3 \\(E = \\frac{34}{5}\\). Suy ra \\(a + b = 34 + 5 = 39\\).</p>"},{"location":"misc/probability/expected-value/#bai-5","title":"B\u00e0i 5","text":"<p>M\u1ed9t con b\u1ecd \u0111i t\u1eeb m\u1ed9t \u0111\u1ec9nh c\u1ee7a m\u1ed9t h\u00ecnh kh\u1ed1i c\u00f3 20 m\u1eb7t, m\u1ed7i m\u1eb7t l\u00e0 m\u1ed9t tam gi\u00e1c \u0111\u1ec1u (icosahedron). </p> <p>M\u1ed7i gi\u00e2y n\u00f3 \u0111i ng\u1eabu nhi\u00ean d\u1ecdc theo m\u1ed9t c\u1ea1nh \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh kh\u00e1c, kh\u00f4ng quan t\u00e2m n\u00f3 c\u00f3 t\u1eebng \u0111i c\u1ea1nh \u0111\u00f3 hay ch\u01b0a. K\u1ef3 v\u1ecdng s\u1ed1 gi\u00e2y c\u1ea7n \u0111\u1ec3 n\u00f3 \u0111\u1ebfn \u0111\u1ec9nh \u0111\u1ed1i di\u1ec7n \u0111\u1ec9nh ban \u0111\u1ea7u l\u00e0 bao nhi\u00eau? L\u01b0u \u00fd \u1edf \u0111\u00e2y m\u1ed7i \u0111\u1ec9nh s\u1ebd k\u1ec1 v\u1edbi 5 \u0111\u1ec9nh kh\u00e1c.</p> L\u1eddi gi\u1ea3i <p>H\u00ecnh kh\u1ed1i n\u00e0y c\u00f3 12 \u0111\u1ec9nh, 20 m\u1eb7t, v\u00e0 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chia ra th\u00e0nh 4 nh\u00f3m</p> <ol> <li>\u0110\u1ec9nh ban \u0111\u1ea7u</li> <li>C\u00e1c \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh ban \u0111\u1ea7u (5 \u0111\u1ec9nh), c\u00e1ch \u0111\u1ec9nh \u0111\u1ea7u \u00edt nh\u1ea5t 1 b\u01b0\u1edbc</li> <li>C\u00e1c \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh \u0111\u00edch (5 \u0111\u1ec9nh), c\u00e1ch \u0111\u1ec9nh \u0111\u1ea7u \u00edt nh\u1ea5t 2 b\u01b0\u1edbc</li> <li>\u0110\u1ec9nh \u0111\u00edch, c\u00e1ch \u0111\u1ec9nh \u0111\u1ea7u \u00edt nh\u1ea5t 3 b\u01b0\u1edbc</li> </ol> <p>Ta s\u1ebd gi\u1ea3i b\u00e0i n\u00e0y kh\u00e1c v\u1edbi b\u00e0i 2 m\u1ed9t ch\u00fat \u0111\u1ec3 thay \u0111\u1ed5i kh\u00f4ng kh\u00ed.</p> <p>G\u1ecdi \\(E_i\\) l\u00e0 k\u00ec v\u1ecdng s\u1ed1 b\u01b0\u1edbc \u0111\u1ec3 \u0111i t\u1eeb \u0111\u1ec9nh nh\u00f3m \\(i\\) \u0111\u1ebfn nh\u00f3m \\(i+1\\). K\u1ebft qu\u1ea3 c\u1ee7a ch\u00fang ta s\u1ebd l\u00e0 \\(E = E_1 + E_2 + E_3\\). H\u00e3y \u0111i gi\u1ea3i quy\u1ebft t\u1eebng k\u1ef3 v\u1ecdng m\u1ed9t.</p> <p>Ta c\u00f3 \\(E_1 = 1\\) v\u00ec \u0111i ki\u1ec3u g\u00ec c\u0169ng s\u1ebd \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh ban \u0111\u1ea7u.</p> <p>\u0110\u1ebfn nh\u00f3m 2, theo c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng ta c\u00f3 \\(E_2 = \\frac{1}{5} \\cdot (1 + E_1 + E_2) + \\frac{2}{5} \\cdot (1 + E_2) + \\frac{2}{5} \\cdot 1\\). C\u1ee5 th\u1ec3 l\u00e0 v\u00ec</p> <ul> <li>C\u00f3 \\(\\frac{1}{5}\\) kh\u1ea3 n\u0103ng \u0111i v\u1ec1 nh\u00f3m 1, sau \u0111\u00f3 con b\u1ecd c\u1ea7n \\(E_1\\) b\u01b0\u1edbc \u0111\u1ec3 l\u00ean nh\u00f3m 2, v\u00e0 \\(E_2\\) b\u01b0\u1edbc \u0111\u1ec3 l\u00ean nh\u00f3m 3.</li> <li>C\u00f3 \\(\\frac{2}{5}\\) kh\u1ea3 n\u0103ng gi\u1eef nguy\u00ean nh\u00f3m, sau \u0111\u00f3 con b\u1ecd c\u1ea7n \\(E_2\\) b\u01b0\u1edbc \u0111\u1ec3 l\u00ean nh\u00f3m 3.</li> <li>C\u00f3 \\(\\frac{2}{5}\\) kh\u1ea3 n\u0103ng l\u00ean nh\u00f3m 3 lu\u00f4n.</li> </ul> <p>\u0110\u1ebfn \u0111\u00e2y t\u00ednh ra \u0111\u01b0\u1ee3c \\(E_2 = 3\\)</p> <p>\u0110\u1ebfn nh\u00f3m 3, theo c\u00f4ng th\u1ee9c k\u1ef3 v\u1ecdng ta c\u00f3 \\(E_3 = \\frac{2}{5} \\cdot (1 + E_2 + E_3) + \\frac{2}{5} \\cdot (1 + E_3) + \\frac{1}{5} \\cdot 1\\). C\u1ee5 th\u1ec3 l\u00e0 v\u00ec</p> <ul> <li>C\u00f3 \\(\\frac{2}{5}\\) kh\u1ea3 n\u0103ng \u0111i v\u1ec1 nh\u00f3m 2, sau \u0111\u00f3 con b\u1ecd c\u1ea7n \\(E_2\\) b\u01b0\u1edbc \u0111\u1ec3 l\u00ean nh\u00f3m 3, v\u00e0 \\(E_3\\) b\u01b0\u1edbc \u0111\u1ec3 l\u00ean nh\u00f3m 4.</li> <li>C\u00f3 \\(\\frac{2}{5}\\) kh\u1ea3 n\u0103ng gi\u1eef nguy\u00ean nh\u00f3m, sau \u0111\u00f3 con b\u1ecd c\u1ea7n \\(E_3\\) b\u01b0\u1edbc \u0111\u1ec3 l\u00ean nh\u00f3m 4.</li> <li>C\u00f3 \\(\\frac{1}{5}\\) kh\u1ea3 n\u0103ng l\u00ean nh\u00f3m 4 lu\u00f4n.</li> </ul> <p>\u0110\u1ebfn \u0111\u00e2y t\u00ednh ra \u0111\u01b0\u1ee3c \\(E_3 = 11\\).</p> <p>Nh\u01b0 v\u1eady \\(E = E_1 + E_2 + E_3 = 1 + 3 + 11 = 15\\).</p>"},{"location":"misc/probability/expected-value/#bai-6","title":"B\u00e0i 6","text":"<p>G\u1ecdi c\u00e1c \u0111\u1ec9nh c\u1ee7a m\u1ed9t t\u1ee9 di\u1ec7n l\u00e0 A, B, C v\u00e0 D.</p> <p>M\u1ed9t con b\u1ecd b\u1eaft \u0111\u1ea7u \u1edf \u0111\u1ec9nh A. M\u1ed7i gi\u00e2y n\u00f3 \u0111i ng\u1eabu nhi\u00ean d\u1ecdc theo m\u1ed9t c\u1ea1nh \u0111\u1ebfn m\u1ed9t \u0111\u1ec9nh kh\u00e1c, kh\u00f4ng quan t\u00e2m n\u00f3 c\u00f3 t\u1eebng \u0111i c\u1ea1nh \u0111\u00f3 hay ch\u01b0a. K\u1ef3 v\u1ecdng s\u1ed1 gi\u00e2y c\u1ea7n \u0111\u1ec3 n\u00f3 \u0111\u1ebfn \u0111\u1ec9nh D l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>M\u1ed7i gi\u00e2y con b\u1ecd c\u00f3 x\u00e1c su\u1ea5t \\(\\frac{1}{3}\\) \u0111\u1ec3 \u0111\u1ebfn \u0111\u1ec9nh D, v\u00e0 \\(\\frac{2}{3}\\) \u0111\u1ec3 \u0111\u1ebfn c\u00e1c \u0111\u1ec9nh kh\u00e1c, nh\u01b0ng kho\u1ea3ng c\u00e1ch t\u1eeb c\u00e1c \u0111\u1ec9nh kh\u00e1c \u0111\u1ebfn \u0111\u1ec9nh D v\u1eabn nh\u01b0 th\u1ebf, n\u00f3i chung tr\u1ea1ng th\u00e1i v\u1ea5n nh\u01b0 v\u1eady, do c\u00e2n \u0111\u1ed1i. N\u00ean</p> \\[E = 1 \\cdot \\frac{1}{3} + (1 + E) \\cdot \\frac{2}{3}\\] <p>Gi\u1ea3i ra \u0111\u01b0\u1ee3c \\(E = 3\\).</p>"},{"location":"misc/probability/linearity-of-expectation/","title":"K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh","text":""},{"location":"misc/probability/linearity-of-expectation/#ky-vong-tuyen-tinh","title":"K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh","text":""},{"location":"misc/probability/linearity-of-expectation/#nguon","title":"Ngu\u1ed3n","text":"<p> Linearity of Expectation - Brilliant</p>"},{"location":"misc/probability/linearity-of-expectation/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh (Linearity of Expectation) l\u00e0 t\u00ednh ch\u1ea5t th\u1ec3 hi\u1ec7n r\u1eb1ng gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng (Expected Value) c\u1ee7a t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean s\u1ebd b\u1eb1ng t\u1ed5ng c\u1ee7a c\u00e1c gi\u00e1 tr\u00ec k\u1ef3 v\u1ecdng c\u1ee7a t\u1eebng bi\u1ebfn ng\u1eabu nhi\u00ean m\u00e0 kh\u00f4ng c\u1ea7n quan t\u00e2m r\u1eb1ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean c\u00f3 \u0111\u1ed9c l\u1eadp hay kh\u00f4ng.</p> <p>Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean l\u00e0 trung b\u00ecnh c\u00f3 tr\u1ecdng s\u1ed1 c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c k\u1ebft qu\u1ea3 c\u00f3 th\u1ec3 x\u1ea3y ra. Ta th\u01b0\u1eddng ch\u1ec9 quan t\u00e2m \u0111\u1ebfn gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean. V\u00ed d\u1ee5, gi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t tr\u00f2 ch\u01a1i, ta s\u1ebd l\u1ea5y t\u1ed5ng c\u00e1c s\u1ed1 khi gieo hai con x\u00fac x\u1eafc:</p> <p></p> <p>V\u1edbi ph\u01b0\u01a1ng ph\u00e1p th\u00f4ng th\u01b0\u1eddng, vi\u1ec7c t\u00ednh gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng t\u1ed5ng c\u00e1c s\u1ed1 s\u1ebd r\u1ea5t l\u00e0 ch\u00e1n. Thay v\u00e0o \u0111\u00f3, ta l\u00e0m nh\u01b0 sau: \"Gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed7i l\u1ea7n gieo x\u00fac x\u1eafc l\u00e0 \\(3.5\\), v\u00e0 hai l\u1ea7n gieo l\u00e0 hai bi\u1ebfn c\u1ed1 \u0111\u1ed9c l\u1eadp, n\u00ean k\u1ef3 v\u1ecdng c\u1ee7a t\u1ed5ng c\u1ee7a ch\u00fang s\u1ebd l\u00e0 \\(3.5 + 3.5 = 7\\)\".</p> <p>V\u00e0 \u0111i\u1ec1u n\u00e0y \u0111\u00fang - l\u1ea5y t\u1ed5ng c\u00e1c gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng. Nh\u01b0ng c\u00f2n h\u01a1n th\u1ebf n\u1eefa! T\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a k\u1ef3 v\u1ecdng r\u1ea5t m\u1ea1nh m\u1ebd v\u00ec n\u00f3 cho ta bi\u1ebft r\u1eb1ng ta c\u00f3 th\u1ec3 c\u1ed9ng gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng ngay c\u1ea3 khi c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00f4ng \u0111\u1ed9c l\u1eadp.</p> <p>Nghe c\u00f3 v\u1ebb kh\u00e1 l\u00e0 ph\u1ea3n khoa h\u1ecdc. V\u00ed d\u1ee5, \u0111i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a l\u01b0\u1ee3ng m\u01b0a v\u00e0o cu\u1ed1i tu\u1ea7n s\u1ebd l\u00e0 gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a l\u01b0\u1ee3ng m\u01b0a v\u00e0o th\u1ee9 b\u1ea3y c\u1ed9ng v\u1edbi gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a l\u01b0\u1ee3ng m\u01b0a v\u00e0o ng\u00e0y ch\u1ee7 nh\u1eadt, cho d\u00f9 ta kh\u00f4ng ngh\u0129 r\u1eb1ng l\u01b0\u1ee3ng m\u01b0a v\u00e0o ng\u00e0y th\u1ee9 b\u1ea3y \u0111\u1ed9c l\u1eadp v\u1edbi l\u01b0\u1ee3ng m\u01b0a c\u1ee7a ng\u00e0y ch\u1ee7 nh\u1eadt (m\u1ed9t ng\u00e0y th\u1ee9 b\u1ea3y m\u01b0a t\u1ea7m t\u00e3 c\u00f3 th\u1ec3 t\u0103ng kh\u1ea3 n\u0103ng m\u01b0a v\u00e0o ng\u00e0y ch\u1ee7 nh\u1eadt ch\u1eb3ng h\u1ea1n).</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd t\u00ecm hi\u1ec3u t\u00ednh ch\u1ea5t n\u00e0y c\u1ee7a gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng. Ta s\u1ebd gi\u1ea3i v\u00e0i b\u00e0i c\u01a1 b\u1ea3n, r\u1ed3i \u0111i s\u00e2u v\u00e0o c\u00e1c k\u1ef9 thu\u1eadt n\u00e2ng cao \u0111\u1ec3 gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p, t\u1eeb \u0111\u01a1n gi\u1ea3n \u0111\u1ebfn ph\u1ee9c t\u1ea1p. Cu\u1ed1i c\u00f9ng, ta s\u1ebd t\u00ecm hi\u1ec3u c\u00e1c \u1ee9ng d\u1ee5ng c\u1ee7a n\u00f3 trong c\u00e1c l\u0129nh v\u1ef1c kh\u00e1c nh\u01b0 khoa h\u1ecdc m\u00e1y t\u00ednh hay h\u00ecnh h\u1ecdc.</p>"},{"location":"misc/probability/linearity-of-expectation/#inh-nghia-va-chung-minh","title":"\u0110\u1ecbnh ngh\u0129a v\u00e0 ch\u1ee9ng minh","text":"<p>\u0110\u1ea7u ti\u00ean, ta s\u1ebd \u0111i v\u00e0o l\u00e0m r\u00f5 t\u00ednh tuy\u1ebfn t\u00ednh c\u1ee7a h\u00e0m gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng (th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi \u0111\u01a1n gi\u1ea3n l\u00e0 \"tuy\u1ebfn t\u00ednh c\u1ee7a k\u1ef3 v\u1ecdng\", hay \"k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh\"):</p> <p>\u0110\u1ecbnh l\u00fd</p> <p>V\u1edbi c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \\(X\\) v\u00e0 \\(Y\\) (c\u00f3 th\u1ec3 ph\u1ee5 thu\u1ed9c),</p> \\[ E[X + Y] = E[X] + E[Y] \\] <p>T\u1ed5ng qu\u00e1t h\u01a1n, v\u1edbi c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \\(X_1, X_2, \\ldots, X_n\\) v\u00e0 c\u00e1c h\u1eb1ng s\u1ed1 \\(c_1, c_2, \\ldots, c_n,\\)</p> \\[E[\\sum_{i=1}^n c_i X_i] = \\sum_{i=1}^n (c_i \\cdot E[X_i])\\] Ch\u1ee9ng minh <p>Ta s\u1ebd \u0111i v\u00e0o ch\u1ee9ng minh \u0111\u1ecbnh l\u00fd n\u00e0y v\u1edbi c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean r\u1eddi r\u1ea1c \\(X\\) v\u00e0 \\(Y\\). Theo \u0111\u1ecbnh ngh\u0129a c\u01a1 b\u1ea3n c\u1ee7a gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng,</p> \\[\\begin{align} E[X + Y] &amp;= \\sum_{x} \\sum_{y} [(x + y) \\cdot P(X = x, Y = y)]\\\\ &amp;= \\sum_{x} \\sum_{y} [x \\cdot P(X = x, Y = y)] + \\sum_{x} \\sum_{y} [y \\cdot P(X = x, Y = y)] \\\\ &amp;= \\sum_{x} x \\underbrace{\\sum_{y} P(X = x, Y = y)}_\\textrm{P(X = x)} + \\sum_{y} y \\underbrace{\\sum_{x} P(X = x, Y = y)}_\\textrm{P(Y = y)} \\\\ &amp;= \\sum_{x} x \\cdot P(X = x) + \\sum_{y} y \\cdot P(Y = y) \\\\ &amp;= E[X] + E[Y] \\\\ \\end{align}\\] <p>K\u1ebft qu\u1ea3 n\u00e0y c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng v\u1edbi \\(n\\) bi\u1ebfn b\u1eb1ng quy n\u1ea1p.</p> <p>L\u01b0u \u00fd r\u1eb1ng ta kh\u00f4ng s\u1eed d\u1ee5ng b\u1ea5t c\u1ee9 t\u00ednh ch\u1ea5t \u0111\u1ed9c l\u1eadp n\u00e0o n\u00ean k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh v\u1eabn \u0111\u00fang v\u1edbi t\u1ea5t c\u1ea3 c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean!</p> <p>V\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean li\u00ean t\u1ee5c, ch\u1ee9ng minh tr\u00ean v\u1eabn nh\u01b0 v\u1eady, ch\u1ec9 kh\u00e1c l\u00e0 ph\u00e9p c\u1ed9ng \u0111\u01b0\u1ee3c thay b\u1eb1ng t\u00edch ph\u00e2n. Ngo\u00e0i ra, c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng m\u1edf r\u1ed9ng ch\u1ee9ng minh cho hai bi\u1ebfn ng\u1eabu nhi\u00ean sang tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t h\u01a1n b\u1eb1ng c\u00e1c s\u1eed d\u1ee5ng c\u00e1c t\u00ednh ch\u1ea5t c\u1ee7a gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng.</p> <p>Hi v\u1ecdng r\u1eb1ng ch\u1ee9ng minh tr\u00ean l\u00e0 \u0111\u1ee7 \u0111\u1ec3 ta hi\u1ec3u t\u1ea1i sao c\u00f3 t\u00ednh ch\u1ea5t nh\u01b0 v\u1eady, m\u00e0 kh\u00f4ng quan t\u00e2m \u0111\u1ebfn vi\u1ec7c c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean c\u00f3 \u0111\u1ed9c l\u1eadp hay kh\u00f4ng. \u0110\u00e2y l\u00e0 m\u1ea5u ch\u1ed1t c\u1ee7a k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, n\u00ean l\u00e0 h\u00e3y \u0111\u1ecdc k\u1ef9 ch\u1ee9ng minh n\u1ebfu b\u1ea1n ch\u01b0a r\u00f5.</p>"},{"location":"misc/probability/linearity-of-expectation/#cac-vi-du-co-ban","title":"C\u00e1c v\u00ed d\u1ee5 c\u01a1 b\u1ea3n","text":"<p>Tr\u01b0\u1edbc khi \u0111i v\u00e0o c\u00e1c k\u1ef9 thu\u1eadt problem-solving, ta s\u1ebd xem l\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 tr\u1ef1c ti\u1ebfp \u00e1p d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh. V\u00ed d\u1ee5, tung hai con x\u00fac x\u1eafc. Ta \u0111\u00e3 t\u00ecm \u0111\u01b0\u1ee3c ra gi\u00e1 tr\u1ecb k\u1ef3 v\u1ecdng c\u1ee7a t\u1ed5ng l\u00e0 \\(7\\), v\u00ec k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed7i con x\u00fac x\u1eafc l\u00e0 \\(3.5\\).</p> <p>Tuy nhi\u00ean, nh\u1edb r\u1eb1ng ta c\u00f3 m\u1ed9t trong nh\u1eefng t\u00ednh ch\u1ea5t quan tr\u1ecdng nh\u1ea5t c\u1ee7a k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh l\u00e0 n\u00f3 c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng cho bi\u1ebfn ng\u1eabu nhi\u00ean ph\u1ee5 thu\u1ed9c. H\u00e3y th\u1eed v\u1edbi m\u1ed9t v\u00ed d\u1ee5 kh\u00e1c.</p> <p>V\u00ed d\u1ee5 1</p> <p>V\u1eabn l\u00e0 hai con x\u00fac x\u1eafc \u0111\u00f3. N\u1ebfu t\u1ed5ng c\u00e1c s\u1ed1 tung ra \u0111\u01b0\u1ee3c l\u00e0 \\(A\\), v\u00e0 t\u00edch c\u00e1c s\u1ed1 tung ra \u0111\u01b0\u1ee3c l\u00e0 \\(B\\), t\u00ednh \\(E[A + B]\\).</p> L\u1eddi gi\u1ea3i <p>Ta bi\u1ebft r\u1eb1ng \\(E[A] = 7\\), v\u00e0 hai s\u1ed1 \u0111\u1ed9c l\u1eadp, ta c\u00f3 \\(E[B] = 3.5 \\cdot 3.5 = 12.25\\). V\u00ec v\u1eady, ngay c\u1ea3 khi \\(A\\) v\u00e0 \\(B\\) ph\u1ee5 thu\u1ed9c l\u1eabn nhau, k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh cho ta k\u1ebft qu\u1ea3</p> \\[E[A + B] = E[A] + E[B] = 7 + 12.25 = 19.25\\] <p>Gi\u1edd th\u1eed v\u1edbi b\u00e0i n\u00e0y xem sao</p> <p>V\u00ed d\u1ee5 2</p> <p>K\u1ef3 v\u1ecdng l\u01b0\u1ee3ng m\u01b0a trong ng\u00e0y th\u1ee9 b\u1ea3y v\u00e0 ch\u1ee7 nh\u1eadt l\u1ea7n l\u01b0\u1ee3t l\u00e0 2 inch v\u00e0 3 inch. C\u00f3 50% kh\u1ea3 n\u0103ng m\u01b0a trong ng\u00e0y th\u1ee9 b\u00e0y. N\u1ebfu tr\u1eddi m\u01b0a v\u00e0o ng\u00e0y th\u1ee9 b\u1ea3y, c\u00f3 75% kh\u1ea3 n\u0103ng ch\u1ee7 nh\u1eadt c\u0169ng m\u01b0a, nh\u01b0ng n\u1ebfu th\u1ee9 b\u1ea3y kh\u00f4ng m\u01b0a, kh\u1ea3 n\u0103ng ch\u1ee7 nh\u1eadt m\u01b0a ch\u1ec9 c\u00f2n 50%.</p> <p>V\u1eady th\u00ec cu\u1ed1i tu\u1ea7n k\u1ef3 v\u1ecdng l\u01b0\u1ee3ng m\u01b0a (t\u00ednh theo inch) l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>K\u1ef3 v\u1ecdng l\u01b0\u1ee3ng m\u01b0a v\u00e0o cu\u1ed1i tu\u1ea7n s\u1ebd b\u1eb1ng t\u1ed5ng k\u1ef3 v\u1ecdng l\u01b0\u1ee3ng m\u01b0a ng\u00e0y th\u1ee9 b\u1ea3y v\u00e0 k\u1ef3 v\u1ecdng l\u01b0\u1ee3ng m\u01b0a ng\u00e0y ch\u1ee7 nh\u1eadt. N\u1ebfu \u0111\u1ec3 \u00fd, b\u1ea1n s\u1ebd th\u1ea5y n\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c cho ngay trong c\u00e2u \u0111\u1ea7u ti\u00ean, c\u00e1c chi ti\u1ebft c\u00f2n l\u1ea1i ch\u1ec9 \u0111\u1ec3 \u0111\u00e1nh l\u1ea1c h\u01b0\u1edbng. Nh\u01b0 v\u1eady k\u1ebft qu\u1ea3 s\u1ebd l\u00e0 \\(5\\).</p> <p>Gi\u1edd ta \u0111\u00e3 th\u1ea5y m\u1ed9t s\u1ed1 \u1ee9ng d\u1ee5ng tr\u1ef1c ti\u1ebfp c\u1ee7a k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, ta s\u1ebd \u0111\u1ebfn v\u1edbi m\u1ed9t s\u1ed1 k\u1ef9 thu\u1eadt nh\u00e9!</p>"},{"location":"misc/probability/linearity-of-expectation/#gioi-thieu-problem-solving","title":"Gi\u1edbi thi\u1ec7u Problem-solving","text":"<p>M\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng ph\u1ed5 bi\u1ebfn nh\u1ea5t c\u1ee7a k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh trong problem-solving l\u00e0 khi n\u00e0o n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u00e1p d\u1ee5ng \u0111\u1ec3 t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean. B\u1ea1n c\u00f3 th\u1ec3 \u0111ang t\u1ef1 h\u1ecfi r\u1eb1ng \"L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 \u00e1p d\u1ee5ng m\u1ed9t c\u00f4ng c\u1ee5 n\u00f3i v\u1ec1 t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean cho m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean?\".</p> <p>Trong c\u00e1c tr\u01b0\u1eddng h\u1ee3p k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh h\u1eefu \u00edch nh\u1ea5t, b\u1ea1n th\u01b0\u1eddng s\u1ebd kh\u00f4ng th\u1ec3 th\u1ea5y ngay r\u1eb1ng b\u1ea1n n\u00ean d\u00f9ng n\u00f3. Thay v\u00e0o \u0111\u00f3, ta ph\u1ea3i s\u1eed d\u1ee5ng k\u1ef9 n\u0103ng gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 \u0111\u1ec3 \u0111i\u1ec1u ch\u1ec9nh l\u1ea1i bi\u1ebfn ng\u1eabu nhi\u00ean duy nh\u1ea5t c\u1ee7a ch\u00fang ta th\u00e0nh t\u1ed5ng m\u1ed9t s\u1ed1 bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00e1c.</p> <p>\u0110\u1ea7u ti\u00ean, l\u01b0u \u00fd hai d\u1ea5u hi\u1ec7u quan tr\u1ecdng cho vi\u1ec7c ta c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh \u0111\u1ec3 gi\u1ea3i quy\u1ebft m\u1ed9t b\u00e0i to\u00e1n k\u1ef3 v\u1ecdng:</p> <ol> <li>Vi\u1ec7c t\u00ednh k\u1ef3 v\u1ecdng theo c\u00f4ng th\u1ee9c trung b\u00ecnh tr\u1ecdng s\u1ed1 l\u00e0 r\u1ea5t kh\u00f3 / t\u1ed1n th\u1eddi gian v\u00ec x\u00e1c su\u1ea5t c\u1ee7a c\u00e1c kh\u1ea3 n\u0103ng c\u0169ng kh\u00f3 t\u00ednh ra.</li> <li>Bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01b0\u1ee3c cho c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c vi\u1ebft th\u00e0nh t\u1ed5ng m\u1ed9t s\u1ed1 bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00e1c.</li> </ol> <p>C\u00f9ng xem m\u1ed9t v\u00ed d\u1ee5 nh\u00e9:</p> <p>V\u00ed d\u1ee5 1</p> <p>Caroline mu\u1ed1n tung 10 \u0111\u1ed3ng xu. N\u1ebfu ch\u1ecb tung ra \u0111\u01b0\u1ee3c \\(n\\) m\u1eb7t ng\u1eeda, ch\u1ecb s\u1ebd \u0111\u01b0\u1ee3c tr\u1ea3 \\(n\\) \u0111\u00f4. K\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n \u0111\u01b0\u1ee3c tr\u1ea3 l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi s\u1ed1 ti\u1ec1n Caroline \u0111\u01b0\u1ee3c tr\u1ea3 l\u00e0 \\(X\\) \u0111\u00f4. Th\u00f4ng th\u01b0\u1eddng \u0111i\u1ec1u \u0111\u1ea7u ti\u00ean m\u00e0 ta l\u00e0m l\u00e0 t\u00ecm x\u00e1c su\u1ea5t khi \\(X = 0, 1, 2, \\ldots\\) v\u00e0 l\u1ea5y trung b\u00ecnh, nh\u01b0ng t\u00ednh to\u00e1n x\u00e1c su\u1ea5t \u0111\u1ec3 l\u1ea5y k\u1ef3 v\u1ecdng \u1edf \u0111\u00e2y kh\u00e1 l\u00e0 m\u1ec7t - d\u1ea5u hi\u1ec7u \u0111\u1ea7u ti\u00ean \u0111\u1ec3 c\u00e2n nh\u1eafc s\u1eed d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh! Nh\u01b0ng l\u00e0m th\u1ebf n\u00e0o ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n \\(X\\) th\u00e0nh t\u1ed5ng c\u1ee7a c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean con?</p> <p>L\u01b0u \u00fd r\u1eb1ng \u0111\u01b0\u1ee3c tr\u1ea3 \\(n\\) \u0111\u00f4 cho \\(n\\) m\u1eb7t ng\u1eeda \u0111\u1ed3ng xu ngh\u0129a l\u00e0 Caroline nh\u1eadn \\(1\\) \u0111\u00f4 v\u1edbi m\u1ed7i m\u1eb7t ng\u1eeda, n\u00ean ta c\u00f3 th\u1ec3 xem t\u1ed5ng ti\u1ec1n nh\u1eadn \u0111\u01b0\u1ee3c l\u00e0 t\u1ed5ng s\u1ed1 l\u1ea7n nh\u1eadn \u0111\u01b0\u1ee3c ti\u1ec1n cho m\u1ed7i \u0111\u1ed3ng xu. V\u00ec v\u1eady, n\u1ebfu ta cho \\(X_i = 1\\) n\u1ebfu \u0111\u1ed3ng xu th\u1ee9 \\(i\\) l\u00e0 m\u1eb7t ng\u1eeda, v\u00e0 \\(X_i = 0\\) khi g\u1eb7p m\u1eb7t s\u1ea5p, ta c\u00f3 th\u1ec3 t\u00ednh t\u1ed5ng ti\u1ec1n l\u00e0</p> \\[X = X_1 + X_2 + \\ldots + X_{10}\\] <p>\u0110\u1ec3 t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a \\(X\\), ta c\u1ea7n t\u00ecm k\u1ef3 v\u1ecdng c\u1ee7a \\(\\(X_1 + X_2 + \\ldots + X_{10}\\)\\). Gi\u1edd n\u00f3 tr\u00f4ng gi\u1ed1ng m\u1ed9t b\u00e0i to\u00e1n k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh r\u1ed3i!</p> <p>D\u0129 nhi\u00ean, v\u00ec x\u00e1c su\u1ea5t c\u00f3 m\u1eb7t ng\u1eeda l\u00e0 \\(\\frac{1}{2}\\), \\(E[X_i] = 1 \\cdot \\frac{1}{2} + 0 \\cdot \\frac{1}{2} = \\frac{1}{2}\\) v\u1edbi m\u1ecdi \\(i\\). V\u00ec v\u1eady,</p> \\[E[X] = E[X_1 + X_2 + \\ldots + X_{10}] = 10 \\cdot \\frac{1}{2} = 5\\] <p>suy ra k\u1ef3 v\u1ecdng s\u1ed1 ti\u1ec1n nh\u1eadn \u0111\u01b0\u1ee3c l\u00e0 \\(5\\) \u0111\u00f4.</p> <p>Ta th\u1ea5y r\u1eb1ng, k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh c\u00f3 th\u1ec3 \u0111\u01a1n gi\u1ea3n ho\u00e1 r\u1ea5t nhi\u1ec1u vi\u1ec7c t\u00ednh to\u00e1n k\u1ef3 v\u1ecdng. H\u00e3y \u0111\u1ec3 \u00fd c\u00e1ch ta th\u1ea5y vi\u1ec7c t\u00ednh k\u1ef3 v\u1ecdng theo c\u00e1ch th\u00f4ng th\u01b0\u1eddng kh\u00e1 l\u00e0 ph\u1ee9c t\u1ea1p \u0111\u1ec3 c\u00e2n nh\u1eafc vi\u1ec7c d\u00f9ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, sau \u0111\u00f3 bi\u1ebfn \u0111\u1ed5i bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01b0\u1ee3c cho th\u00e0nh t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n h\u01a1n. Ti\u1ebfp t\u1ee5c th\u1eed c\u00e1c b\u00e0i sau nh\u00e9:</p> <p>V\u00ed d\u1ee5 2</p> <p>Sammy b\u1ecb l\u1ea1c v\u00e0 m\u1ea5t ph\u01b0\u01a1ng h\u01b0\u1edbng. V\u1edbi m\u1ed7i ph\u00fat, c\u1eadu \u1ea5y ti\u1ebfn v\u1ec1 ph\u00eda tr\u01b0\u1edbc \\(1\\) m\u00e9t v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{2}\\), \u0111\u1ee9ng y\u00ean v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{3}\\), v\u00e0 \u0111i l\u00f9i \\(1\\) m\u00e9t v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{6}\\).</p> <p>Sau m\u1ed9t gi\u1edd, k\u1ef3 v\u1ecdng qu\u00e3ng \u0111\u01b0\u1eddng di chuy\u1ec3n v\u1ec1 ph\u00eda tr\u01b0\u1edbc (t\u00ednh theo m\u00e9t) c\u1ee7a Sammy l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_i\\) l\u00e0 qu\u00e3ng \u0111\u01b0\u1eddng di chuy\u1ec3n v\u1ec1 ph\u00eda tr\u01b0\u1edbc c\u1ee7a Sammy trong ph\u00fat th\u1ee9 \\(i\\) v\u00e0 \u0111\u1ec3 \u00fd r\u1eb1ng:</p> \\[E[X_i] = \\frac{1}{2} \\cdot (1) + \\frac{1}{3} \\cdot (0) + \\frac{1}{6} \\cdot (-1) = \\frac{1}{3}\\] <p>v\u1edbi m\u1ecdi \\(i\\). V\u00ec v\u1eady, qu\u00e3ng \u0111\u01b0\u1eddng di chuy\u1ec3n v\u1ec1 ph\u00eda tr\u01b0\u1edbc sau m\u1ed9t gi\u1edd l\u00e0 \\(X_1 + X_2 + \\ldots + X_{60}\\). D\u00f9ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh,</p> \\[E[\\sum_{i=1}^{60} X_i] = \\sum_{i=1}^{60} E[X_i] = 60 \\cdot \\frac{1}{3} = 20\\] <p>Trong hai v\u00ed d\u1ee5 tr\u00ean, ta \u0111\u00e3 \u00e1p d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh \u0111\u1ec3 l\u1ea5y t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u1ed9c l\u1eadp. Tuy nhi\u00ean h\u00e3y nh\u1edb r\u1eb1ng kh\u1ea3 n\u0103ng m\u1ea1nh nh\u1ea5t c\u1ee7a k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh l\u00e0 n\u00f3 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c d\u00f9ng cho bi\u1ebfn ng\u1eabu nhi\u00ean ph\u1ee5 thu\u1ed9c! H\u00e3y xem x\u00e9t v\u00ed d\u1ee5 c\u00f3 t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean ph\u1ee5 thu\u1ed9c sau</p> <p>V\u00ed d\u1ee5 3</p> <p>C\u00e1c ch\u1eef s\u1ed1 \\(1\\), \\(2\\), \\(3\\) v\u00e0 \\(4\\) \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 t\u1ea1o ng\u1eabu nhi\u00ean hai s\u1ed1 c\u00f3 hai ch\u1eef s\u1ed1, \\(\\overline{AB}\\) v\u00e0 \\(\\overline{CD}\\). V\u00ed d\u1ee5 ta c\u00f3 th\u1ec3 c\u00f3 \\(\\overline{AB} = 42\\) v\u00e0 \\(\\overline{CD} = 13\\). K\u1ef3 v\u1ecdng c\u1ee7a \\(\\overline{AB} \\cdot \\overline{CD}\\) l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Th\u00f4ng th\u01b0\u1eddng ta s\u1ebd \u0111i t\u00ednh \\(E[\\overline{AB}]\\) v\u00e0 \\(E[\\overline{CD}]\\) v\u00e0 l\u1ea5y t\u00edch. Tuy nhi\u00ean nh\u1edb r\u1eb1ng \\(E[xy] = E[x] \\times E[y]\\) ch\u1ec9 \u0111\u00fang khi c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u1ed9c l\u1eadp. R\u00f5 r\u00e0ng l\u00e0 \\(\\overline{AB}\\) v\u00e0 \\(\\overline{CD}\\) kh\u00f4ng \u0111\u1ed9c l\u1eadp v\u00ec c\u00e1c ch\u1eef s\u1ed1 ch\u1ec9 \u0111\u01b0\u1ee3c d\u00f9ng m\u1ed9t l\u1ea7n. V\u00ed d\u1ee5 \\(\\overline{AB} = 13\\) th\u00ec \\(\\overline{CD}\\) ch\u1ec9 c\u00f3 th\u1ec3 l\u00e0 \\(24\\) ho\u1eb7c \\(42\\). Tuy nhi\u00ean ta c\u00f3 th\u1ec3 th\u1eed bi\u1ebfn n\u00f3 th\u00e0nh t\u1ed5ng g\u00ec \u0111\u00f3.</p> <p>V\u00ec c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n \u1edf \u0111\u00e2y l\u00e0 c\u00e1c ch\u1eef s\u1ed1, ta c\u00f3 th\u1ec3 vi\u1ebft n\u00f3 th\u00e0nh</p> \\[(10A + B) \\cdot (10C + D) = 100 \\cdot AC + 10 \\cdot AD + 10 \\cdot BC + BD\\] <p>Tuy nhi\u00ean, r\u00f5 r\u00e0ng l\u00e0 k\u1ef3 v\u1ecdng c\u1ee7a b\u1ea5t c\u1eef t\u00edch n\u00e0o c\u00f3 d\u1ea1ng \\(AC\\) l\u00e0 nh\u01b0 nhau v\u00ec c\u00f3 s\u1ef1 \u0111\u1ed1i x\u1ee9ng gi\u1eefa \\(A\\), \\(B\\), \\(C\\), \\(D\\). Ta c\u00f3 th\u1ec3 t\u00ednh</p> \\[E[AC] = \\frac{1 \\cdot 2 + 1 \\cdot 3 + 1 \\cdot 4 + 2 \\cdot 3 + 2 \\cdot 4 + 3 \\cdot 4}{6} = \\frac{35}{6}\\] <p>V\u00ec v\u1eady, theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh,</p> \\[E[\\overline{AB} \\cdot \\overline{CD}] = E[100 \\cdot AC] + E[10 \\cdot AD] + E[10 \\cdot BC] + E[BD] = 121 \\cdot E[AC] = \\frac{4235}{6} = 705.83\\] <p>Ta \u0111\u00e3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e1c ki\u1ebfn th\u1ee9c n\u1ec1n. Gi\u1edd h\u00e3y \u0111i v\u00e0o c\u00e1c k\u1ef9 thu\u1eadt problem-solving ph\u1ee9c t\u1ea1p h\u01a1n nh\u00e9.</p>"},{"location":"misc/probability/linearity-of-expectation/#su-dung-bien-chi-bao","title":"S\u1eed d\u1ee5ng bi\u1ebfn ch\u1ec9 b\u00e1o","text":"<p>Trong ph\u1ea7n n\u00e0y, ta s\u1ebd ti\u1ebfp t\u1ee5c kh\u00e1m ph\u00e1 c\u00e1c k\u1ef9 thu\u1eadt gi\u00fap gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, c\u00f9ng v\u1edbi vi\u1ec7c gi\u1edbi thi\u1ec7u m\u1ed9t c\u00f4ng c\u1ee5 m\u1edbi \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 c\u00e1c bi\u1ebfn ch\u1ec9 b\u00e1o. K\u1ef9 thu\u1eadt n\u00e0y r\u1ea5t h\u1eefu \u00edch khi bi\u1ebfn ng\u1eabu nhi\u00ean \u0111ang \u0111\u1ebfm s\u1ed1 l\u1ea7n xu\u1ea5t hi\u1ec7n c\u1ee7a c\u00e1c s\u1ef1 ki\u1ec7n \u0111\u01a1n gi\u1ea3n.</p> <p>V\u1edbi c\u00e1c d\u1ea1ng b\u00e0i n\u00e0y, vi\u1ec7c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111ang x\u00e9t c\u00f3 th\u1ec3 vi\u1ebft d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u1ee7a c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00e1c s\u1ebd \u00edt r\u00f5 r\u00e0ng h\u01a1n so v\u1edbi ph\u1ea7n tr\u01b0\u1edbc. Nh\u01b0ng v\u1edbi nh\u1eefng ki\u1ebfn th\u1ee9c \u0111\u00e3 h\u1ecdc, ta c\u00f3 th\u1ec3 gi\u1ea3i ch\u00fang trong nh\u00e1y m\u1eaft.</p> <p>Ta c\u00f9ng \u0111i v\u00e0o m\u1ed9t v\u00ed d\u1ee5 v\u1ec1 nh\u1eefng c\u00e1ch th\u00f4ng minh \u0111\u1ec3 vi\u1ebft bi\u1ebfn ng\u1eabu nhi\u00ean d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n h\u01a1n:</p> <p>V\u00ed d\u1ee5 1</p> <p>Cho m\u1ed9t c\u00e1i h\u1ed9p ch\u1ee9a m\u1ed9t qu\u1ea3 b\u00f3ng v\u00e0ng, m\u1ed9t b\u00f3ng cam, m\u1ed9t b\u00f3ng xanh l\u00e1 v\u00e0 m\u1ed9t b\u00f3ng xanh da tr\u1eddi. Billy ch\u1ecdn ng\u1eabu nhi\u00ean 4 b\u00f3ng trong h\u1ed9p (c\u00f3 thay th\u1ebf). K\u1ef3 v\u1ecdng s\u1ed1 m\u00e0u kh\u00e1c nhau l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>Ta mu\u1ed1n t\u00ecm k\u1ef3 v\u1ecdng s\u1ed1 m\u00e0u kh\u00e1c nhau. Ta c\u00f3 th\u1ec3 t\u00ednh tr\u1ef1c ti\u1ebfp x\u00e1c su\u1ea5t Billy chonk \\(k = 1, 2, 3, 4\\) m\u00e0u kh\u00e1c nhau, nh\u01b0ng tr\u00f4ng kh\u00e1 l\u00e0 m\u1ec7t (v\u00e0 c\u00f2n m\u1ec7t h\u01a1n khi c\u00f3 nhi\u1ec1u h\u01a1n 4 b\u00f3ng). \u0110\u00e2y l\u00e0 m\u1ed9t g\u1ee3i \u00fd cho vi\u1ec7c d\u00f9ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh.</p> <p>Gi\u1edd ta c\u1ea7n ngh\u0129 xem l\u00e0m sao \u0111\u1ec3 vi\u1ebft s\u1ed1 m\u00e0u kh\u00e1c nhau d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00e1c. \u0110\u1ec3 b\u1eaft \u0111\u1ea7u, gi\u1ea3 s\u1eed 4 l\u1ef1a ch\u1ecdn c\u1ee7a Billy l\u1ea7n l\u01b0\u1ee3t l\u00e0: cam, xanh l\u00e0, cam, xanh da tr\u1eddi.</p> <p>L\u00e0m sao b\u1ea1n c\u00f3 th\u1ec3 x\u00e1c \u0111\u1ecbnh s\u1ed1 m\u00e0u kh\u00e1c nhau? Ta th\u1ea5y r\u1eb1ng c\u00f3 3 m\u00e0u kh\u00e1c nhau. B\u1ea1n c\u00f3 th\u1ec3 ngh\u0129 l\u00e0 \"\u1edc t\u00f4i bi\u1ebft \u0111\u1ebfm r\u1ed3i m\u00e0\". Tuy nhi\u00ean, \u0111\u00e2y l\u00e0 l\u00fac \u0111i\u1ec1u k\u1ef3 di\u1ec7u x\u1ea3y ra.</p> <p>V\u00ec bi\u1ebfn ng\u1eabu nhi\u00ean c\u1ee7a ch\u00fang ta l\u00e0 \u0111\u1ebfm s\u1ed1 m\u00e0u \u0111\u01b0\u1ee3c ch\u1ecdn, ta c\u00f3 th\u1ec3 bi\u1ebfn n\u00f3 th\u00e0nh t\u1ed5ng c\u1ee7a 4 bi\u1ebfn ng\u1eabu nhi\u00ean: m\u1ed7i bi\u1ebfn cho m\u1ed9t m\u00e0u, b\u1eb1ng 1 khi c\u00f3 m\u00e0u \u0111\u00f3 v\u00e0 b\u1eb1ng 0 khi kh\u00f4ng c\u00f3. V\u00ec v\u1eady, trong v\u00ed d\u1ee5 tr\u00ean, bi\u1ebfn ng\u1eabu nhi\u00ean cho m\u00e0u cam, xanh l\u00e1 v\u00e0 xanh da tr\u1eddi s\u1ebd l\u00e0 1, cho m\u00e0u v\u00e0ng th\u00ec s\u1ebd l\u00e0 0. T\u1ed5ng ch\u00fang l\u1ea1i s\u1ebd l\u00e0 3.</p> <p>Th\u00eam v\u00e0o \u0111\u00f3, k\u1ef3 v\u1ecdng c\u1ee7a c\u00e1c bi\u1ebfn n\u00e0y c\u0169ng d\u1ec5 t\u00ednh. Trong th\u1ef1c t\u1ebf, v\u1edbi \u0111\u1ecbnh ngh\u0129a c\u1ee7a k\u1ef3 v\u1ecdng, ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng k\u1ef3 v\u1ecdng c\u1ee7a n\u00f3 b\u1eb1ng v\u1edbi x\u00e1c su\u1ea5t m\u00e0u \u0111\u00f3 \u0111\u01b0\u1ee3c ch\u1ecdn. S\u1eed d\u1ee5ng k\u1ef9 thu\u1eadt x\u00e1c su\u1ea5t b\u00f9, ta th\u1ea5y r\u1eb1ng x\u00e1c su\u1ea5t c\u1ee7a m\u1ed9t m\u00e0u n\u00e0o \u0111\u00f3 (v\u00ed d\u1ee5 nh\u01b0 v\u00e0ng) l\u00e0</p> \\[ 1 - P(\\text{v\u00e0ng d\u01b0\u1ee3c ch\u1ecdn}) = 1 - (\\frac{3}{4})^4 = \\frac{175}{256}\\] <p>Cu\u1ed1i c\u00f9ng, v\u1edbi k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, k\u1ef3 v\u1ecdng s\u1ed1 m\u00e0u kh\u00e1c nhau l\u00e0</p> \\[4 \\cdot \\frac{175}{256} = \\frac{175}{64} \\approx 2.73\\] <p>V\u1edbi v\u00ed d\u1ee5 tr\u00ean, ta ch\u1ed1t \u0111\u01b0\u1ee3c c\u00e1c \u00fd t\u01b0\u1edfng sau:</p> <ul> <li>K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh gi\u00fap ta t\u00ednh m\u1ed9t k\u1ef3 v\u1ecdng c\u00f3 v\u1ebb ph\u1ee9c t\u1ea1p theo m\u1ed9t c\u00e1ch c\u1ef1c k\u1ef3 \u0111\u01a1n gi\u1ea3n (d\u00f9 ph\u1ea3i d\u00f9ng c\u00e1ch th\u00f4ng minh - nh\u01b0ng b\u1ea1n s\u1ebd s\u1edbm \u0111\u1ea1t \u0111\u01b0\u1ee3c khi luy\u1ec7n nhi\u1ec1u)</li> <li>K\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh cho ph\u00e9p ta kh\u00f4ng ph\u1ea3i lo v\u1ec1 vi\u1ec7c c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n c\u00f3 ph\u1ee5 thu\u1ed9c nhau hay kh\u00f4ng. R\u00f5 r\u00e0ng l\u00e0 ch\u00fang ph\u1ee5 thu\u1ed9c r\u1ed3i: v\u00ed d\u1ee5, n\u1ebfu c\u00f3 3 bi\u1ebfn l\u00e0 0 th\u00ec bi\u1ebfn th\u1ee9 4 ph\u1ea3i l\u00e0 1 (v\u00ec c\u00f3 \u00edt nh\u1ea5t 1 m\u00e0u \u0111\u01b0\u1ee3c ch\u1ecdn). Tuy nhi\u00ean, ta \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh \u0111\u00fang v\u1edbi m\u1ecdi bi\u1ebfn ng\u1eabu nhi\u00ean, kh\u00f4ng quan tr\u1ecdng c\u00f3 ph\u1ee5 thu\u1ed9c hay kh\u00f4ng.</li> <li>V\u00ec bi\u1ebfn ng\u1eabu nhi\u00ean c\u1ee7a ta \u0111\u1ebfm c\u00e1i g\u00ec \u0111\u00f3 (nh\u01b0 s\u1ed1 m\u00e0u kh\u00e1c nhau), ta c\u00f3 th\u1ec3 vi\u1ebft n\u00f3 th\u00e0nh t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean cho bi\u1ebft nh\u1eefng th\u1ee9 g\u00ec s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ebfm (nh\u01b0 1 cho m\u1ed7i m\u00e0u \u0111\u01b0\u1ee3c ch\u1ecdn).</li> </ul> <p>V\u1edbi \u0111i\u1ec3m cu\u1ed1i c\u00f9ng, n\u00f3 th\u1ef1c s\u1ef1 kh\u00e1 g\u1ee3i nh\u1edb \u0111\u1ebfn c\u00e1ch ta x\u1eed l\u00fd v\u00ed d\u1ee5 tung \u0111\u1ed3ng xu c\u1ee7a Caroline khi \u0111\u1ebfn s\u1ed1 m\u1eb7t ng\u1eeda b\u1eb1ng c\u00e1ch t\u00ednh t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean cho bi\u1ebft r\u1eb1ng n\u00f3 c\u00f3 ph\u1ea3i m\u1eb7t ng\u1eeda kh\u00f4ng. Tr\u00ean th\u1ef1c t\u1ebf, c\u00f3 m\u1ed9t thu\u1eadt ng\u1eef ch\u00ednh th\u1ee9c cho m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean nh\u01b0 v\u1eady:</p> <p>\u0110\u1ecbnh ngh\u0129a</p> <p>M\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o cho m\u1ed9t bi\u1ebfn c\u1ed1 \\(t\\), th\u01b0\u1eddng \u0111\u1eb7t l\u00e0 \\(1_t\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean b\u1eb1ng \\(1\\) n\u1ebfu \\(t\\) x\u1ea3y ra, v\u00e0 b\u1eb1ng \\(0\\) n\u1ebfu \\(t\\) kh\u00f4ng x\u1ea3y ra. Theo \u0111\u1ecbnh ngh\u0129a k\u1ef3 v\u1ecdng,</p> \\[E[1_t] = P(\\text{t x\u1ea3y ra}) \\cdot 1 + P(\\text{t kh\u00f4ng x\u1ea3y ra}) \\cdot 0 = P(\\text{t x\u1ea3y ra})\\] <p>C\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o n\u00e0y r\u1ea5t h\u1eefu d\u1ee5ng \u0111\u1ec3 gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, \u0111\u1eb7c bi\u1ec7t l\u00e0 khi t\u00ednh k\u1ef3 v\u1ecdng (c\u0169ng l\u00e0 x\u00e1c su\u1ea5t bi\u1ebfn c\u1ed1 x\u1ea3y ra). V\u1edbi \u00fd t\u01b0\u1edfng n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3 gi\u1ea3i c\u00e1c b\u00e0i t\u1eadp m\u00e0 n\u1ebfu kh\u00f4ng d\u00f9ng c\u00e1ch n\u00e0y th\u00ec s\u1ebd r\u1ea5t kh\u00f3 \u0111\u1ec3 gi\u1ea3i.</p> <p>V\u00ed d\u1ee5 2</p> <p>Tung 25 \u0111\u1ed3ng xu l\u1ea7n l\u01b0\u1ee3t. K\u1ef3 v\u1ecdng s\u1ed1 c\u1eb7p ng\u1eeda ng\u1eeda li\u00ean ti\u1ebfp nhau l\u00e0 bao nhi\u00eau? V\u00ed d\u1ee5, n\u1ebfu 6 \u0111\u1ed3ng xu \u0111\u01b0\u1ee3c tung cho ra NNSNNN (ng\u1eeda-ng\u1eeda-s\u1ea5p-ng\u1eeda-ng\u1eeda-ng\u1eeda), s\u1ed1 c\u1eb7p ng\u1eeda-ng\u1eeda l\u00e0 3.</p> L\u1eddi gi\u1ea3i <p>Ta s\u1ebd c\u00f3 \\(24\\) c\u1eb7p \u0111\u1ed3ng xu \\([1,2], [2,3], \\ldots, [24,25]\\). \u0110\u00e1nh d\u1ea5u ch\u00fang l\u00e0 \\(X_1, X_2, \\ldots, X_{24}\\).</p> <p>G\u1ecdi \\(x_i (1 \\le i \\le 24)\\) l\u00e0 m\u1ed9t bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a nh\u01b0 sau</p> \\[x_i = \\begin{cases} 1 &amp;\\text{n\u1ebfu } P_i \\text{ l\u00e0 c\u1eb7p NN} \\\\ 0 &amp;\\text{n\u1ebfu } P_i \\text{ kh\u00f4ng l\u00e0 c\u1eb7p NN} \\end{cases}\\] <p>Ta s\u1ebd c\u00f3 </p> \\[\\begin{align} E[x_i] &amp;= 1 \\cdot P(X_i \\text{ l\u00e0 c\u1eb7p NN}) + 0 \\cdot P(X_i \\text{ kh\u00f4ng l\u00e0 c\u1eb7p NN})\\\\ &amp;= 1 \\cdot (\\frac{1}{2})(\\frac{1}{2}) + 0\\\\ &amp;= \\frac{1}{4}\\\\ \\end{align}\\] <p>V\u1eady k\u1ef3 v\u1ecdng s\u1ed1 c\u1eb7p ng\u1eeda ng\u1eeda l\u00e0</p> \\[E\\left[\\sum_{i=1}^{24} x_i \\right] = \\sum_{i=1}^{24} E[x_i] = 24 \\cdot \\frac{1}{4} = 6\\] <p>T\u1ed5ng k\u1ebft l\u1ea1i, vi\u1ec7c s\u1eed d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh v\u1edbi bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o s\u1ebd c\u00f3 \u00edch khi:</p> <ul> <li>b\u00e0i to\u00e1n tr\u00f4ng c\u00f3 v\u1ebb gi\u1ea3i \u0111\u01b0\u1ee3c b\u1eb1ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh;</li> <li>kh\u00f4ng c\u00f3 c\u00e1ch r\u00f5 r\u00e0ng n\u00e0o \u0111\u1ec3 vi\u1ebft bi\u1ebfn ng\u1eabu nhi\u00ean \u0111ang x\u00e9t d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01a1n gi\u1ea3n h\u01a1n;</li> <li>bi\u1ebfn ng\u1eabu nhi\u00ean \u0111ang x\u00e9t \u0111ang \u0111\u1ebfn s\u1ed1 l\u1ea7n x\u1ea3y ra c\u1ee7a m\u1ed9t s\u1ed1 cho tr\u01b0\u1edbc c\u00e1c bi\u1ebfn c\u1ed1 \u0111\u01a1n gi\u1ea3n.</li> </ul>"},{"location":"misc/probability/linearity-of-expectation/#su-dung-trang-thai","title":"S\u1eed d\u1ee5ng tr\u1ea1ng th\u00e1i","text":"<p>Trong ph\u1ea7n n\u00e0y, ta s\u1ebd gi\u1edbi thi\u1ec7u m\u1ed9t k\u1ef9 thu\u1eadt \u00e1p d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh khi bi\u1ebfn ng\u1eabu nhi\u00ean \u0111ang x\u00e9t t\u00ednh to\u00e1n th\u1eddi gian ho\u1eb7c s\u1ed1 b\u01b0\u1edbc c\u1ea7n \u0111\u1ec3 ho\u00e0n t\u1ea5t m\u1ed9t qu\u00e1 tr\u00ecnh n\u00e0o \u0111\u00f3. N\u1ebfu nghe c\u00f3 v\u1ebb m\u00f9 m\u1edd, ta s\u1ebd \u0111i v\u00e0o m\u1ed9t v\u00ed d\u1ee5 \u0111\u1ec3 xem \"tr\u1ea1ng th\u00e1i\" c\u00f3 ngh\u0129a l\u00e0 g\u00ec:</p> <p>V\u00ed d\u1ee5 1</p> <p>Allison c\u00f3 m\u1ed9t d\u1ed3ng xu kh\u00f4ng c\u00f4ng b\u1eb1ng v\u1edbi x\u00e1c su\u1ea5t tung \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda l\u00e0 \\(p\\). K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 c\u00f3 m\u1eb7t ng\u1eeda l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>M\u1edbi nh\u00ecn qua th\u00ec bi\u1ebfn ng\u1eabu nhi\u00ean l\u00e0 \u0111\u1ebfm m\u1ed9t s\u1ed1 bi\u1ebfn c\u1ed1 \u0111\u01a1n gi\u1ea3n, n\u00ean c\u00f3 v\u1ebb l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o s\u1ebd c\u00f3 \u00edch. Ta ch\u1ec9 c\u1ea7n \u0111\u1ebfm s\u1ed1 m\u1eb7t s\u1ea5p khi tung, v\u00e0 m\u1ed7i l\u1ea7n tung m\u1eb7t s\u1ea5p s\u1ebd c\u00f3 x\u00e1c su\u1ea5t \\(1-p\\). Nh\u01b0ng v\u1ea5n \u0111\u1ec1 \u1edf \u0111\u00e2y l\u00e0 ta kh\u00f4ng bi\u1ebft s\u1ebd tung bao nhi\u00eau l\u1ea7n \u0111\u1ec3 t\u00ednh t\u1ed5ng. Tr\u00ean th\u1ef1c t\u1ebf, \u0111\u00f3 g\u1ea7n nh\u01b0 ch\u00ednh x\u00e1c l\u00e0 c\u00e2u h\u1ecfi \u0111\u01b0\u1ee3c \u0111\u1eb7t ra.</p> <p>Thay v\u00e0o \u0111\u00f3, ta coi b\u00e0i to\u00e1n nh\u01b0 l\u00e0 vi\u1ec7c \"ho\u00e0n th\u00e0nh m\u1ed9t quy tr\u00ecnh\", trong \u0111\u00f3 ta c\u00f3 nhi\u1ec1u tr\u1ea1ng th\u00e1i. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, tr\u1ea1ng th\u00e1i kh\u00e1 \u0111\u01a1n gi\u1ea3n: ta ch\u01b0a tung ra \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda (g\u1ecdi tr\u1ea1ng th\u00e1i n\u00e0y l\u00e0 \\(0\\)), ho\u1eb7c ta tung \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda (tr\u1ea1ng th\u00e1i n\u00e0y g\u1ecdi l\u00e0 \\(1\\)).</p> <p>G\u1ecdi \\(E[X_i]\\) l\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 ho\u00e0n th\u00e0nh quy tr\u00ecnh (ra \u0111\u01b0\u1ee3c m\u1eb7t ng\u1eeda) khi \u0111ang \u1edf tr\u1ea1ng th\u00e1i \\(i\\). R\u00f5 r\u00e0ng l\u00e0 \\(E[X_1] = 0\\), v\u00ec tr\u1ea1ng th\u00e1i \\(1\\) ngh\u0129a l\u00e0 ta \u0111\u00e3 c\u00f3 m\u1eb7t ng\u1eeda n\u00ean quy tr\u00ecnh ho\u00e0n t\u1ea5t. Ng\u01b0\u1ee3c l\u1ea1i, khi ta tung \u0111\u1ed3ng xu trong tr\u1ea1ng th\u00e1i \\(0\\), ta s\u1ebd \u1edf l\u1ea1i tr\u1ea1ng th\u00e1i n\u00e0y v\u1edbi x\u00e1c su\u1ea5t \\(1-p\\), v\u00e0 s\u1ebd sang tr\u1ea1ng th\u00e1i \\(1\\) v\u1edbi x\u00e1c su\u1ea5t l\u00e0 \\(p\\). V\u00ec v\u1eady, x\u00e9t tr\u1ea1ng th\u00e1i sau khi ta tung \u1edf tr\u1ea1ng th\u00e1i \\(0\\), ta c\u00f3</p> \\[E[X_0] = 1 + (1 - p) \\cdot E[X_0] + p \\cdot \\underbrace{E[X_1]}_\\textrm{0}\\] <p>n\u00ean \\(p \\cdot E[X_0] = 1\\), suy ra \\(E[X_0] = \\frac{1}{p}\\)</p> <p>\u0110\u00e2y l\u00e0 m\u1ed9t c\u00e1ch \u0111\u1ec3 t\u00ednh k\u1ef3 v\u1ecdng c\u1ee7a ph\u00e2n ph\u1ed1i Bernoulli.</p> <p>Sang m\u1ed9t v\u00ed d\u1ee5 ph\u1ee9c t\u1ea1p h\u01a1n v\u1edbi tr\u1ea1ng th\u00e1i, \u1edf \u0111\u00e2y ta s\u1ebd \u00e1p d\u1ee5ng tr\u1ef1c ti\u1ebfp k\u1ebft qu\u1ea3 ta v\u1eeba t\u00ecm \u0111\u01b0\u1ee3c.</p> <p>V\u00ed d\u1ee5 2</p> <p>V\u1edbi m\u1ed7i l\u1ea7n mua s\u1eafm \u1edf SlurpeeShack, ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t m\u1ea3nh ng\u1eabu nhi\u00ean c\u1ee7a h\u00ecnh d\u01b0\u1edbi (12 m\u1ea3nh). Khi ta c\u00f3 t\u1ea5t c\u1ea3 12 m\u1ea3nh, ta s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t ly n\u01b0\u1edbc mi\u1ec5n ph\u00ed. K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n mua h\u00e0ng \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c t\u1ea5t c\u1ea3 c\u00e1c m\u1ea3nh l\u00e0 bao nhi\u00eau?</p> <p></p> L\u1eddi gi\u1ea3i <p>\u1ede \u0111\u00e2y, c\u00e1c tr\u1ea1ng th\u00e1i c\u1ee7a ch\u00fang ta l\u00e0 s\u1ed1 m\u1ea3nh kh\u00e1c nhau m\u00e0 ta c\u00f3. G\u1ecdi \\(X_i\\) l\u00e0 s\u1ed1 l\u1ea7n mua h\u00e0ng \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c m\u1ea3nh th\u1ee9 \\(i\\), n\u00ean bi\u1ebfn ng\u1eabu nhi\u00ean \u0111\u01b0\u1ee3c x\u00e9t l\u00e0 \\(\\sum_{i=1}^{12} X_i\\).</p> <p>Khi c\u00f3 \u0111\u01b0\u1ee3c \\(i-1\\) m\u1ea3nh kh\u00e1c nhau, x\u00e1c su\u1ea5t c\u00f3 \u0111\u01b0\u1ee3c m\u1ea3nh ti\u1ebfp theo l\u00e0 \\(\\frac{12-(i-1)}{12}\\). V\u1edbi v\u00ed d\u1ee5 tr\u01b0\u1edbc, k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n mua h\u00e0ng s\u1ebd l\u00e0 \\(E[X_i] = \\frac{12}{12 - (i-1)}\\). N\u00ean theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh</p> \\[E\\left[\\sum_{i=1}^{12} X_i \\right] = \\sum_{i=1}^{12} E[X_i] = \\sum_{i=1}^{12} \\frac{12}{12 - (i-1)} = \\frac{12}{12} + \\frac{12}{11} + \\ldots + \\frac{12}{1} = \\frac{86021}{2310} \\approx 37\\] <p>Bonus: \u0110\u00e2y l\u00e0 b\u00e0i to\u00e1n kh\u00e1 n\u1ed5i ti\u1ebfng, th\u01b0\u1eddng \u0111\u01b0\u1ee3c nh\u1eafc \u0111\u1ebfn v\u1edbi t\u00ean l\u00e0 b\u00e0i to\u00e1n thu gom coupon. T\u1ed5ng qu\u00e1t th\u00ec v\u1edbi \\(n\\) coupon, k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n mua h\u00e0ng s\u1ebd l\u00e0 \\(nH_n\\), v\u1edbi \\(H_n = \\sum_{i=1}^{n} \\frac{1}{i}\\) l\u00e0 s\u1ed1 h\u00e0i ho\u00e0 th\u1ee9 \\(n\\). V\u1edbi vi t\u00edch ph\u00e2n th\u00ec ta c\u00f3, v\u1edbi \\(n\\) l\u1edbn, \\(H_n \\approx \\ln n\\), n\u00ean k\u1ef3 v\u1ecdng s\u1ebd x\u1ea5p x\u1ec9 \\(n \\ln n\\)</p> <p>Ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng, tr\u1ea1ng th\u00e1i s\u1ebd h\u1eefu \u00edch khi ta c\u00f3 th\u1ec3 vi\u1ebft c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean th\u00e0nh t\u1ed5ng c\u00e1c bi\u1ebfn ng\u1eabu nhi\u00ean kh\u00e1c c\u00f3 th\u1ec3 t\u00ednh th\u1eddi gian / s\u1ed1 b\u01b0\u1edbc c\u1ea7n \u0111\u1ec3 \u0111i t\u1eeb tr\u1ea1ng th\u00e1i n\u00e0y sang tr\u1ea1ng th\u00e1i ti\u1ebfp theo. Ta s\u1ebd c\u00f3 c\u00e1c v\u00ed d\u1ee5 nh\u01b0 sau:</p> <p>V\u00ed d\u1ee5 3</p> <p>S\u00f3c Sarah \u0111ang t\u00ecm qu\u1ea3 s\u1ed3i nh\u01b0ng kh\u00f4ng nh\u1edb \u0111\u00e3 \u0111\u1ec3 n\u00f3 \u1edf \u0111\u00e2u.</p> <p></p> <p>Sarah b\u1eaft \u0111\u1ea7u t\u1eeb g\u00f3c tr\u00e1i d\u01b0\u1edbi c\u1ee7a l\u01b0\u1edbi \\(2 \\times 2\\), v\u00e0 \u1edf m\u1ed7i \u0111\u1ec9nh, n\u00f3 \u0111i \u0111\u1ebfn \u0111\u1ec9nh k\u1ec1 v\u1edbi \u0111\u1ec9nh hi\u1ec7n t\u1ea1i (n\u00ean c\u00f3 th\u1ec3 s\u1ebd \u0111i qua m\u1ed9t c\u1ea1nh nhi\u1ec1u l\u1ea7n).</p> <p>H\u1ecfi r\u1eb1ng k\u1ef3 v\u1ecdng s\u1ed1 b\u01b0\u1edbc \u0111\u1ec3 \u0111i \u0111\u1ebfn g\u00f3c ph\u1ea3i tr\u00ean, n\u01a1i ch\u1ee9a qu\u1ea3 s\u1ed3i l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p></p> <p>G\u1ecdi \\(E_i\\) l\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 b\u01b0\u1edbc c\u1ea7n \u0111i \u0111\u1ec3 \u0111i t\u1eeb tr\u1ea1ng th\u00e1i \\(i\\) \u0111\u1ebfn tr\u1ea1ng th\u00e1i \\(i+1\\), v\u1edbi \\(1 \\le i \\le 4\\), tr\u1ea1ng th\u00e1i 5 l\u00e0 tr\u1ea1ng th\u00e1i k\u1ebft th\u00fac.</p> <p>Ta c\u00f3 th\u1ec3 th\u1ea5y r\u1eb1ng x\u00e1c su\u1ea5t \u0111\u1ec3 \u0111i t\u1eeb tr\u1ea1ng th\u00e1i \\(i\\) \u0111\u1ebfn tr\u1ea1ng th\u00e1i \\(i+1\\) hay \\(i-1\\) \u0111\u1ec1u nh\u1ea5t qu\u00e1n, v\u00ed d\u1ee5, tr\u1ea1ng th\u00e1i 1 ch\u1eafc ch\u1eafn \u0111i \u0111\u1ebfn tr\u1ea1ng th\u00e1i 2 (x\u00e1c su\u1ea5t b\u1eb1ng 1), tr\u1ea1ng th\u00e1i 2 c\u00f3 x\u00e1c su\u1ea5t \\(\\frac{2}{3}\\) \u0111i \u0111\u1ebfn tr\u1ea1ng th\u00e1i 3 v\u00e0 x\u00e1c su\u1ea5t \\(\\frac{1}{3}\\) \u0111i v\u1ec1 tr\u1ea1ng th\u00e1i 1 (d\u00f9 ta c\u00f3 2 ch\u1ed7 c\u00f3 tr\u1ea1ng th\u00e1i 2 nh\u01b0ng x\u00e1c su\u1ea5t c\u1ee7a ch\u00fang nh\u01b0 nhau), t\u01b0\u01a1ng t\u1ef1 v\u1edbi tr\u1ea1ng th\u00e1i 3 (\\(\\frac{1}{2}\\) kh\u1ea3 n\u0103ng \u0111i t\u1edbi, \\(\\frac{1}{2}\\) kh\u1ea3 n\u0103ng \u0111i l\u00f9i) v\u00e0 4 (\\(\\frac{1}{3}\\) kh\u1ea3 n\u0103ng \u0111i t\u1edbi, \\(\\frac{2}{3}\\) kh\u1ea3 n\u0103ng \u0111i l\u00f9i).</p> <p>Nh\u01b0 v\u1eady, t\u1eeb tr\u1ea1ng th\u00e1i 1, ta c\u1ea7n \u0111\u00fang 1 b\u01b0\u1edbc \u0111\u1ec3 \u0111\u1ebfn tr\u1ea1ng th\u00e1i 2, v\u1eady \\(E_1 = 1\\).</p> <p>T\u1eeb tr\u1ea1ng th\u00e1i 2, v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{2}{3}\\), ta c\u00f3 th\u1ec3 \u0111i t\u1edbi tr\u1ea1ng th\u00e1i 3 trong 1 b\u01b0\u1edbc, v\u00e0 v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{3}\\), ta c\u00f3 th\u1ec3 \u0111i v\u1ec1 tr\u1ea1ng th\u00e1i 1, sau \u0111\u00f3 c\u1ea7n \\(E_1\\) b\u01b0\u1edbc \u0111\u1ec3 \u0111\u1ebfn l\u1ea1i tr\u1ea1ng th\u00e1i 2, v\u00e0 \\(E_2\\) b\u01b0\u1edbc \u0111\u1ec3 \u0111\u1ebfn tr\u1ea1ng th\u00e1i 3. V\u00ec v\u1eady:</p> \\[E_2 = \\frac{2}{3} \\cdot 1 + \\frac{1}{3} \\cdot (1 + E_1 + E_2)\\] <p>Gi\u1ea3i ra ta c\u00f3 \\(E_2 = 2\\).</p> <p>T\u01b0\u01a1ng t\u1ef1:</p> \\[E_3 = \\frac{1}{2} \\cdot 1 + \\frac{1}{2} \\cdot (1 + E_2 + E_3)\\] \\[E_4 = \\frac{1}{3} \\cdot 1 + \\frac{2}{3} \\cdot (1 + E_3 + E_4)\\] <p>Gi\u1ea3i l\u1ea7n l\u01b0\u1ee3t ra th\u00ec ta c\u00f3 \\(E_3 = 4\\) v\u00e0 \\(E_4 = 11\\).</p> <p>K\u1ebft qu\u1ea3 s\u1ebd l\u00e0 t\u1ed5ng k\u1ef3 v\u1ecdng s\u1ed1 b\u01b0\u1edbc \u0111\u1ec3 \u0111i t\u1eeb tr\u1ea1ng th\u00e1i 1 l\u00ean 2, 2 l\u00ean 3, 3 l\u00ean 4 v\u00e0 4 l\u00ean 5, ngh\u0129a l\u00e0 \\(E_1 + E_2 + E_3 + E_4 = 18\\).</p> <p>V\u00ed d\u1ee5 4</p> <p>Jorge c\u00f3 m\u1ed9t con x\u00fac x\u1eafc c\u00f4ng b\u1eb1ng \\(N\\) m\u1eb7t, c\u00e1c m\u1eb7t l\u00e0 c\u00e1c s\u1ed1 kh\u00e1c nhau t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\) v\u00e0 \u0111ang mu\u1ed1n xem ph\u1ea3i tung n\u00f3 bao nhi\u00eau l\u1ea7n \u0111\u1ec3 c\u00f3 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 t\u1eeb \\(1\\) \u0111\u1ebfn \\(N\\) (theo b\u1ea5t k\u1ef3 th\u1ee9 t\u1ef1 n\u00e0o). Jorge t\u00ednh nhanh v\u00e0 t\u00ecm ra k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung l\u00e0 91 khi l\u00e0m tr\u00f2n v\u1ec1 s\u1ed1 nguy\u00ean g\u1ea7n nh\u1ea5t. </p> <p>V\u1eady con x\u00fac x\u1eafc c\u00f3 bao nhi\u00eau m\u1eb7t nh\u1ec9?</p> L\u1eddi gi\u1ea3i <p>Gi\u1ed1ng v\u1edbi b\u00e0i coupon ta s\u1ebd c\u00f3 k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n tung \u0111\u1ec3 c\u00f3 t\u1ea5t c\u1ea3 c\u00e1c s\u1ed1 l\u00e0:</p> \\[E\\left[\\sum_{i=1}^{N} X_i \\right] = \\sum_{i=1}^{N} E[X_i] = \\sum_{i=1}^{N} \\frac{N}{N - (i-1)} = \\frac{N}{N} + \\frac{N}{N} + \\ldots + \\frac{N}{1} \\] <p>\u0110\u00e2y l\u00e0 h\u00e0m t\u0103ng, n\u00ean ta c\u00f3 th\u1ec3 d\u00f9ng t\u00ecm ki\u1ebfm nh\u1ecb ph\u00e2n \u0111\u1ec3 t\u00ecm ra \u0111\u00e1p \u00e1n. \u0110\u00f3 l\u00e0 \\(24\\) l\u1ea7n tung.</p> <p>V\u00ed d\u1ee5 5</p> <p>M\u1ed9t h\u00e0ng c\u00e1c c\u1ee5c \u0111\u00e1 n\u1eb1m tr\u00ean m\u1ed9t c\u00e1i h\u1ed3 to v\u00f4 h\u1ea1n.</p> <p>M\u1ed9t con \u1ebfch kh\u1edfi \u0111\u1ea7u t\u1eeb h\u00f2n \u0111\u00e1 th\u1ee9 2 t\u1eeb b\u1edd.</p> <p>M\u1ed7i gi\u00e2y, n\u00f3 nh\u1ea3y \u0111\u1ebfn h\u00f2n \u0111\u00e1 b\u00ean c\u1ea1nh, v\u1edbi x\u00e1c su\u1ea5t 60% l\u00e0 h\u01b0\u1edbng v\u1ec1 b\u1edd, v\u00e0 40% h\u01b0\u1edbng xa b\u1edd.</p> <p>K\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n nh\u1ea3y \u0111\u1ec3 quay l\u1ea1i h\u00f2n \u0111\u00e1 \u0111\u1ea7u ti\u00ean (h\u00f2n \u0111\u00e1 g\u1ea7n b\u1edd nh\u1ea5t) l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(E_n\\) l\u00e0 k\u1ef3 v\u1ecdng s\u1ed1 b\u01b0\u1edbc nh\u1ea3y \u0111\u1ec3 \u0111\u1ebfn h\u00f2n \u0111\u00e1 \u0111\u1ea7u ti\u00ean t\u1eeb h\u00f2n \u0111\u00e1 th\u1ee9 \\(n\\).</p> <p>T\u1eeb h\u00f2n \u0111\u00e1 th\u1ee9 hai, con \u1ebfch c\u00f3 x\u00e1c su\u1ea5t \\(0.6\\) nh\u1ea3y v\u1ec1 h\u00f2n \u0111\u00e1 th\u1ee9 nh\u1ea5t, v\u00e0 \\(0.4\\) nh\u1ea3y \u0111\u1ebfn h\u00f2n \u0111\u00e1 ti\u1ebfp theo. V\u00ec v\u1eady,</p> \\[E_2 = 0.6 \\cdot (1 + E_1) + 0.4 \\cdot (1 + E_3) = 1 + 0.6 \\cdot E_1 + 0.4 \\cdot E_3\\] <p>V\u00ec \\(E_1 = 0\\), n\u00f3 tr\u1edf th\u00e0nh</p> \\[E_2 = 1 + 0.4 \\cdot E_3\\] <p>Tuy nhi\u00ean, v\u00ec x\u00e1c su\u1ea5t \u1edf m\u1ed7i h\u00f2n \u0111\u00e1 l\u00e0 nh\u01b0 nhau, n\u00ean k\u1ef3 v\u1ecdng s\u1ed1 b\u01b0\u1edbc \u0111\u1ec3 \u0111i t\u1eeb h\u00f2n \u0111\u00e1 \\(i\\) \u0111\u1ebfn h\u00f2n \u0111\u00e1 \\(i-1\\) l\u00e0 nh\u01b0 nhau v\u1edbi m\u1ecdi \\(i\\). Ngh\u0129a l\u00e0 \\(E_2\\) b\u1eb1ng v\u1edbi k\u1ef3 v\u1ecdng \u0111i t\u1eeb h\u00f2n \u0111\u00e1 th\u1ee9 3 \u0111\u1ebfn h\u00f2n \u0111\u00e1 th\u1ee9 2. M\u00e0 \\(E_3\\) l\u1ea1i b\u1eb1ng k\u1ef3 v\u1ecdng \u0111i t\u1eeb h\u00f2n \u0111\u00e1 th\u1ee9 3 v\u1ec1 h\u00f2n \u0111\u00e1 \u0111\u1ea7u ti\u00ean, ngh\u0129a l\u00e0 t\u1eeb 3 v\u1ec1 2 xong t\u1eeb 2 v\u1ec1 1. Suy ra \\(E_3 = 2 \\cdot E_2\\).</p> <p>Nh\u01b0 v\u1eady \\(E_2 = 1 + 0.4 \\cdot 2 \\cdot E_2\\). Suy ra \\(E_2 = 5\\).</p>"},{"location":"misc/probability/linearity-of-expectation/#ung-dung","title":"\u1ee8ng d\u1ee5ng","text":"<p>Ta \u0111\u00e3 xem c\u00e1ch \u0111\u1ec3 gi\u1ea3i c\u00e1c b\u00e0i to\u00e1n t\u1ed5 h\u1ee3p v\u1edbi k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh. Tuy nhi\u00ean, v\u1eabn c\u00f2n r\u1ea5t nhi\u1ec1u \u1ee9ng d\u1ee5ng th\u1ef1c t\u1ebf c\u1ee7a k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, h\u00e3y c\u00f9ng xem x\u00e9t m\u1ed9t v\u00e0i v\u00ed d\u1ee5 nh\u00e9.</p> <p>\u0110\u1ea7u ti\u00ean l\u00e0 tr\u00f2 x\u1ed5 s\u1ed1.</p> <p>V\u00ed d\u1ee5 1</p> <p>C\u00f3 m\u1ed9t cu\u1ed9c thi x\u1ed5 s\u1ed1. Ng\u01b0\u1eddi ch\u01a1i tr\u1ea3 1 \u0111\u00f4 \u0111\u1ec3 ch\u1ecdn 5 s\u1ed1 kh\u00e1c nhau t\u1eeb 1 \u0111\u1ebfn 50. C\u00f4ng ty x\u1ed5 s\u1ed1 s\u1ebd tr\u1ea3 2.5 tri\u1ec7u \u0111\u00f4 ti\u1ec1n th\u01b0\u1eddng n\u1ebfu ai \u0111o\u00e1n tr\u00fang c\u1ea3 5 s\u1ed1 (v\u00e0 ti\u1ec1n gi\u1ea3i s\u1ebd chia \u0111\u1ec1u ra cho t\u1ea5t c\u1ea3 nh\u1eefng ng\u01b0\u1eddi \u0111o\u00e1n tr\u00fang).</p> <p>V\u1edbi t\u1ed5 h\u1ee3p th\u00ec ta bi\u1ebft r\u1eb1ng c\u00f3 \\(\\binom{50}{5} = 2118760\\) c\u00e1ch ch\u1ecdn. Nh\u01b0ng v\u1edbi nguy\u00ean t\u1eafc chu\u1ed3ng chim, n\u1ebfu ta c\u00f3 ch\u1eebng \u0111\u00f3 ng\u01b0\u1eddi, m\u1ed7i ng\u01b0\u1eddi \u0111o\u00e1n m\u1ed9t b\u1ed9 s\u1ed1 kh\u00e1c nhau, ta c\u00f3 th\u1ec3 l\u1eddi ti\u1ec1n!</p> <p>\u0110i\u1ec1u \u0111\u00f3 \u0111\u00fang, tuy nhi\u00ean, c\u00e1c c\u00f4ng ty x\u1ed5 s\u1ed1 bi\u1ebft r\u1eb1ng ng\u01b0\u1eddi ch\u01a1i kh\u00f4ng c\u00f3 \u0111\u1ee7 t\u00e0i nguy\u00ean \u0111\u1ec3 ch\u01a1i ki\u1ec3u \u0111\u00f3. Thay v\u00e0o \u0111\u00f3, h\u1ecd s\u1ebd gi\u1ea3 d\u1ee5 r\u1eb1ng m\u1ed7i ng\u01b0\u1eddi s\u1ebd ch\u1ecdn c\u00e1c s\u1ed1 m\u1ed9t c\u00e1ch ng\u1eabu nhi\u00eau. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, \\(n\\) ng\u01b0\u1eddi tham gia ch\u01a1i v\u1edbi \\(m\\) c\u00e1ch ch\u1ecdn, x\u00e1c su\u1ea5t \u0111\u1ec3 ai \u0111\u00f3 th\u1eafng l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o cho bi\u1ebfn c\u1ed1 t\u1ed5 h\u1ee3p x\u1ed5 s\u1ed1 \\(1 \\le i \\le m\\) kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ecdn b\u1edfi b\u1ea5t k\u1ef3 ng\u01b0\u1eddi ch\u01a1i n\u00e0o. V\u00ec ai c\u0169ng ch\u1ecdn ng\u1eabu nhi\u00ean,</p> \\[E[X_i] = (1 - \\frac{1}{m}) ^ n\\] <p>v\u1edbi m\u1ecdi \\(i\\). D\u00f9ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, k\u1ef3 v\u1ecdng s\u1ed1 t\u1ed5 h\u1ee3p kh\u00f4ng \u0111\u01b0\u1ee3c ch\u1ecdn l\u00e0</p> \\[E[\\sum_{i=1}^{m} X_i] = \\sum_{i=1}^{m} E[X_i] = m \\cdot (1 - \\frac{1}{m})^n\\] <p>V\u00ec t\u1ed5 h\u1ee3p th\u1eafng cu\u1ed9c \u0111\u01b0\u1ee3c ch\u1ecdn ng\u1eabu nhi\u00ean n\u00ean,</p> \\[1 - \\frac{m \\cdot (1-\\frac{1}{m})^n}{m} = 1 - (1 - \\frac{1}{m})^n\\] <p>V\u00ed d\u1ee5, n\u1ebfu x\u1ed5 s\u1ed1 c\u00f3 \\(2118760\\) t\u1ed5 h\u1ee3p v\u00e0 \\(2118760\\) ng\u01b0\u1eddi ch\u01a1i (ch\u1ecdn t\u1ed5 h\u1ee3p ng\u1eabu nhi\u00ean), x\u00e1c su\u1ea5t ai \u0111\u00f3 th\u1eafng l\u00e0 kho\u1ea3ng 63%.</p> <p>Bonus: \u0110i\u1ec1u g\u00ec x\u1ea3y ra khi \\(m\\) qu\u00e1 l\u1edbn? L\u00e0m th\u1ebf n\u00e0o c\u00f4ng ty x\u1ed5 s\u1ed1 \u0111\u1ed1i ph\u00f3 khi s\u1ed1 ng\u01b0\u1eddi tham gia t\u0103ng l\u00ean? G\u1ee3i \u00fd: K\u1ebft qu\u1ea3 n\u00e0y li\u00ean quan \u0111\u1ebfn m\u1ed9t gi\u1edbi h\u1ea1n d\u00e3y n\u1ed5i ti\u1ebfng li\u00ean quan \u0111\u1ebfn h\u1eb1ng s\u1ed1 \\(e\\). Ngo\u00e0i ra, \u0111\u1ecdc \u0111\u00e1p \u00e1n n\u00e0y \u0111\u1ec3 th\u1ea5y \u0111\u01b0\u1ee3c s\u1ef1 li\u00ean quan gi\u1eefa \\(e\\) v\u00e0 t\u1ed5 h\u1ee3p.</p> <p>Th\u1eadt th\u00fa v\u1ecb khi th\u1ea5y c\u00e1ch \u0111\u1ec3 \u00e1p d\u1ee5ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh \u0111\u1ec3 kh\u00e1m ph\u00e1 m\u1ed9t s\u1ef1 th\u1eadt th\u00fa v\u1ecb v\u1ec1 x\u1ed5 s\u1ed1. Gi\u1edd ta h\u00e3y sang m\u1ed9t ch\u1ee7 \u0111\u1ec1 kh\u00e1c: m\u1ed9t b\u00e0i to\u00e1n x\u00e1c su\u1ea5t h\u00ecnh h\u1ecdc n\u1ed5i ti\u1ebfng:</p> <p>V\u00ed d\u1ee5 2</p> <p>Gi\u1ea3 s\u1eed m\u1ed9t c\u00e2y kim \u0111\u1ed9 d\u00e0i 1 \u0111\u01a1n v\u1ecb b\u1ecb r\u01a1i xu\u1ed1ng s\u00e0n nh\u00e0, s\u00e0n nh\u00e0 n\u00e0y c\u00f3 c\u00e1c d\u1ea3i g\u1ed7 c\u00e1ch nhau 1 \u0111\u01a1n v\u1ecb. X\u00e1c su\u1ea5t c\u00e2y kim n\u1eb1m tr\u00ean hai d\u1ea3i g\u1ed7 l\u00e0 bao nhi\u00eau?</p> <p></p> <p>B\u00e0i n\u00e0y th\u01b0\u1eddng \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng vi t\u00edch ph\u00e2n, nh\u01b0ng ta s\u1ebd d\u00f9ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh \u0111\u1ec3 gi\u1ea3i n\u00f3.</p> L\u1eddi gi\u1ea3i <p>\u0110\u1ea7u ti\u00ean, ta s\u1ebd th\u1ea3o lu\u1eadn r\u1eb1ng k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n c\u00e2y kim n\u1eb1m tr\u00ean hai d\u1ea3i g\u1ed7 t\u1ec9 l\u1ec7 tr\u1ef1c ti\u1ebfp v\u1edbi \u0111\u1ed9 d\u00e0i \\(l\\) c\u1ee7a c\u00e2y kim. Gi\u1ea3 s\u1eed r\u1eb1ng c\u00e2y kim \u0111\u01b0\u1ee3c l\u00e0m t\u1eeb \\(n\\) m\u1ea3nh c\u00f3 \u0111\u1ed9 d\u00e0i b\u1eb1ng nhau. v\u00e0 g\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ch\u1ec9 b\u00e1o cho bi\u1ebfn c\u1ed1 m\u1ea3nh th\u1ee9 \\(i\\) ch\u1ea1m hai d\u1ea3i g\u1ed7. Th\u00ec k\u1ef3 v\u1ecdng t\u1ea5t c\u1ea3 c\u00e1c l\u1ea7n ch\u1ea1m v\u1ea1ch, theo k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh, l\u00e0</p> \\[E\\left[\\sum_{i=1}^{n} X_i \\right] = \\sum_{i=1}^{n} E[X_i] = n \\cdot E[X_1]\\] <p>Gi\u1eef chi\u1ec1u d\u00e0i c\u00e1c m\u1ea3nh nh\u1ecf n\u00e0y kh\u00f4ng \u0111\u1ed5i, ta th\u1ea5y r\u1eb1ng k\u1ef3 v\u1ecdng s\u1ebd t\u1ec9 l\u1ec7 thu\u1eadn v\u1edbi chi\u1ec1u d\u00e0i kim.</p> <p>V\u1eady n\u00ean, v\u1edbi h\u00e0m c\u1ee7a \u0111\u1ed9 d\u00e0i \\(l\\), k\u1ef3 v\u1ecdng s\u1ed1 l\u1ea7n ch\u1ea1m v\u1ea1ch s\u1ebd l\u00e0 \\(cl\\) v\u1edbi h\u1eb1ng s\u1ed1 \\(c\\) n\u00e0o \u0111\u00f3. Tuy nhi\u00ean, x\u00e9t m\u1ed9t h\u00ecnh tr\u00f2n \u0111\u01b0\u1eddng k\u00ednh l\u00e0 \\(1\\) (chu vi s\u1ebd l\u00e0 \\(\\pi\\)); v\u1edbi x\u00e1c su\u1ea5t \\(1\\), h\u00ecnh tr\u00f2n n\u00e0y s\u1ebd giao v\u1edbi \u0111\u00fang hai d\u1ea3i g\u1ed7. V\u00ec th\u1ebf \\(c\\pi = 2\\), n\u00ean \\(c = \\frac{2}{\\pi}\\). N\u1ebfu b\u1ea1n kh\u00f4ng tho\u1ea3i m\u00e1i v\u1edbi \u00fd t\u01b0\u1edfng h\u00ecnh tr\u00f2n, x\u00e9t h\u00ecnh ki\u1ec3u tr\u00f2n v\u1edbi r\u1ea5t nhi\u1ec1u c\u00e1c m\u1ea3nh nh\u1ecf l\u00e0 \u0111o\u1ea1n th\u1eb3ng.</p> <p>V\u1edbi b\u1ea5t k\u1ef3 c\u00e2y kim n\u00e0o giao nhi\u1ec1u nh\u1ea5t m\u1ed9t d\u1ea3i g\u1ed7, \\(\\sum_{i=1}^{n}\\) th\u1ef1c ra l\u00e0 m\u1ed9t bi\u1ebfn ch\u1ec9 b\u00e1o cho bi\u1ebfn c\u1ed1 c\u00e2y kim n\u1eb1m tr\u00ean hai d\u1ea3i g\u1ed7, n\u00ean k\u1ef3 v\u1ecdng s\u1ebd l\u00e0 x\u00e1c su\u1ea5t vi\u1ec7c n\u00e0y x\u1ea3y ra. V\u1eady x\u00e1c su\u1ea5t \u0111\u1ec3 ch\u1ea1m v\u1ea1ch v\u1edbi kim \u0111\u1ed9 d\u00e0i \\(1\\) l\u00e0 \\(\\frac{2}{\\pi} \\approx 64%\\).</p> <p>Bonus: B\u1ea1n c\u00f3 th\u1ec3 ngh\u0129 xem l\u00e0m sao ta c\u00f3 th\u1ec3 d\u00f9ng k\u1ebft qu\u1ea3 n\u00e0y \u0111\u1ec3 \u01b0\u1edbc l\u01b0\u1ee3ng gi\u00e1 tr\u1ecb c\u1ee7a \\(\\pi\\) th\u00f4ng qua m\u00f4 ph\u1ecfng Monte-Carlo kh\u00f4ng?</p> <p>Sau \u0111\u00e2y l\u00e0 m\u1ed9t s\u1ed1 v\u00ed d\u1ee5 kh\u00e1c c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh:</p> <p>V\u00ed d\u1ee5 3</p> <p>Nhi\u1ec1u b\u00e0i to\u00e1n v\u1ec1 k\u1ef3 v\u1ecdng trong \u0111\u1ed3 th\u1ecb ng\u1eabu nhi\u00ean c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i b\u1eb1ng k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh. V\u00ed d\u1ee5, gi\u1ea3 s\u1eed c\u00f3 m\u1ed9t nh\u00f3m \\(n\\) ng\u01b0\u1eddi c\u00f3 kh\u1ea3 n\u0103ng tr\u1edf th\u00e0nh b\u1ea1n, v\u00e0 m\u1ed7i c\u1eb7p c\u00f3 kh\u1ea3 n\u0103ng tr\u1edf th\u00e0nh b\u1ea1n v\u1edbi x\u00e1c su\u1ea5t \\(\\frac{1}{2}\\). V\u1eady th\u00ec k\u1ef3 v\u1ecdng s\u1ed1 b\u1ed9 ba b\u1ea1n b\u00e8 l\u00e0 bao nhi\u00eau (nh\u00f3m 3 ng\u01b0\u1eddi c\u00f3 kh\u1ea3 n\u0103ng tr\u1edf th\u00e0nh b\u1ea1n c\u1ee7a nhau)?</p> L\u1eddi gi\u1ea3i <p>C\u00f3 \\(\\binom{n}{3}\\) b\u1ed9 ba, m\u1ed7i b\u1ed9 ba l\u00e0 b\u1ed9 ba b\u1ea1n b\u00e8 v\u1edbi x\u00e1c su\u1ea5t \\((\\frac{1}{2})^3 = \\frac{1}{8}\\). N\u1ebfu g\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o cho bi\u1ebfn c\u1ed1 b\u1ed9 ba th\u1ee9 \\(i\\) l\u00e0 b\u1ed9 ba b\u1ea1n b\u00e8, th\u00ec k\u1ef3 v\u1ecdng s\u1ed1 b\u1ed9 ba b\u1ea1n b\u00e8 l\u00e0</p> \\[E\\left[\\sum_{i=1}^{\\binom{n}{3}} X_i \\right] = \\sum_{i=1}^{\\binom{n}{3}} E[X_i] = \\frac{\\binom{n}{3}}{8}\\] <p>V\u00ed d\u1ee5 4</p> <p>C\u00f3 \\(n\\) ng\u01b0\u1eddi trong m\u1ed9t ph\u00f2ng, k\u1ef3 v\u1ecdng s\u1ed1 ng\u00e0y sinh nh\u1eadt kh\u00e1c nhau l\u00e0 bao nhi\u00eau? Gi\u1ea3 s\u1eed n\u0103m n\u00e0o c\u0169ng c\u00f3 365 ng\u00e0y. Vi\u1ec7c n\u00e0y li\u00ean quan g\u00ec \u0111\u1ebfn b\u00e0i to\u00e1n ngh\u1ecbch l\u00fd ng\u00e0y sinh nh\u1eadt?</p> L\u1eddi gi\u1ea3i <p>G\u1ecdi \\(X_i\\) l\u00e0 bi\u1ebfn ng\u1eabu nhi\u00ean ch\u1ec9 b\u00e1o cho ng\u00e0y th\u1ee9 \\(i\\) (trong 365 ng\u00e0y) l\u00e0 ng\u00e0y sinh nh\u1eadt c\u1ee7a m\u1ed9t ng\u01b0\u1eddi n\u00e0o \u0111\u00f3. Gi\u1ea3 s\u1eed ng\u00e0y sinh nh\u1eadt c\u1ee7a m\u1ed9t ng\u01b0\u1eddi l\u00e0 ng\u1eabu nhi\u00ean, ta c\u00f3,</p> \\[E[X_i] = 1 - (1 - \\frac{1}{365})^n = 1 - (\\frac{364}{365})^n\\] <p>Nh\u01b0 v\u1eady s\u1ed1 ng\u00e0y sinh nh\u1eadt kh\u00e1c nhau s\u1ebd l\u00e0 t\u1ed5ng k\u1ef3 v\u1ecdng m\u1ed7i ng\u00e0y trong 365 ng\u00e0y, t\u1ee9c l\u00e0</p> \\[E[X] = 365 \\cdot (1 - (\\frac{364}{365})^n)\\] <p>L\u1ea5y v\u00ed d\u1ee5 \\(n = 30\\) th\u00ec s\u1ed1 \\(E[X] \\approx 28.83\\), ngh\u0129a l\u00e0 c\u00f3 t\u1ed3n t\u1ea1i 1 ng\u00e0y sinh nh\u1eadt b\u1ecb tr\u00f9ng c\u1ee7a hai ng\u01b0\u1eddi n\u00e0o \u0111\u00f3, trong khi \\(n\\) kh\u00f4ng qu\u00e1 l\u1edbn.</p> <p>V\u00ed d\u1ee5 5</p> <p>Trong khoa h\u1ecdc m\u00e1y t\u00ednh, thu\u1eadt to\u00e1n ng\u1eabu nhi\u00ean quicksort c\u00f3 th\u1eddi gian ch\u1ea1y k\u1ef3 v\u1ecdng l\u00e0 \\(O(n \\log n)\\). L\u00e0m sao \u0111\u1ec3 ch\u1ee9ng minh v\u1edbi k\u1ef3 v\u1ecdng tuy\u1ebfn t\u00ednh?</p> L\u1eddi gi\u1ea3i <p>Xem ph\u1ea7n Theorem 3.3 c\u1ee7a b\u00e0i gi\u1ea3ng n\u00e0y, n\u00f3 c\u00f3 li\u00ean quan \u0111\u1ebfn s\u1ed1 h\u00e0i ho\u00e0 m\u00e0 ta c\u00f3 \u0111\u1ec1 c\u1eadp \u1edf tr\u00ean.</p>"},{"location":"misc/probability/probability/","title":"X\u00e1c su\u1ea5t","text":""},{"location":"misc/probability/probability/#xac-suat","title":"X\u00e1c su\u1ea5t","text":""},{"location":"misc/probability/probability/#nguon","title":"Ngu\u1ed3n","text":"<p> Probability - Brilliant</p>"},{"location":"misc/probability/probability/#loi-tua","title":"L\u1eddi t\u1ef1a","text":"<p>M\u1ed9t x\u00e1c su\u1ea5t l\u00e0 m\u1ed9t con s\u1ed1 bi\u1ec3u di\u1ec5n kh\u1ea3 n\u0103ng x\u1ea3y ra c\u1ee7a m\u1ed9t bi\u1ebfn c\u1ed1 kh\u00f4ng ch\u1eafc ch\u1eafn. X\u00e1c su\u1ea5t th\u01b0\u1eddng c\u00f3 gi\u00e1 tr\u1ecb n\u1eb1m trong \u0111o\u1ea1n \\([0, 1]\\). X\u00e1c su\u1ea5t c\u00e0ng cao th\u00ec bi\u1ebfn c\u1ed1 c\u00e0ng c\u00f3 kh\u1ea3 n\u0103ng x\u1ea3y ra. X\u00e1c su\u1ea5t b\u1eb1ng \\(0\\) ngh\u0129a l\u00e0 bi\u1ebfn c\u1ed1 s\u1ebd kh\u00f4ng x\u1ea3y ra. X\u00e1c su\u1ea5t b\u1eb1ng \\(1\\) ngh\u0129a l\u00e0 bi\u1ebfn c\u1ed1 lu\u00f4n x\u1ea3y ra. T\u1ea5t c\u1ea3 c\u00e1c gi\u00e1 tr\u1ecb c\u00f2n l\u1ea1i n\u1eb1m gi\u1eefa \\(0\\) v\u00e0 \\(1\\) th\u1ec3 hi\u1ec7n nhi\u1ec1u c\u1ea5p \u0111\u1ed9 c\u1ee7a kh\u1ea3 n\u0103ng x\u1ea3y ra c\u1ee7a bi\u1ebfn c\u1ed1.</p> <p>Nghi\u00ean c\u1ee9u v\u1ec1 x\u00e1c su\u1ea5t r\u1ea5t quan tr\u1ecdng v\u00ec n\u00f3 gi\u1ea3i quy\u1ebft c\u00e1c v\u1ea5n \u0111\u1ec1 \u0111\u1ecbnh l\u01b0\u1ee3ng v\u1edbi k\u1ebft qu\u1ea3 kh\u00f4ng ch\u1eafc ch\u1eafn. V\u00ed d\u1ee5, trong s\u1ea3n xu\u1ea5t, ta kh\u00f4ng th\u1ec3 ch\u1eafc ch\u1eafn \u0111\u01b0\u1ee3c r\u1eb1ng quy tr\u00ecnh s\u1ea3n xu\u1ea5t s\u1ebd kh\u00f4ng t\u1ea1o ra c\u00e1c s\u1ea3n ph\u1ea9m l\u1ed7i. S\u1ebd c\u1ef1c k\u1ef3 t\u1ed1n k\u00e9m v\u00e0 m\u1ea5t th\u00ec gi\u1edd \u0111\u1ec3 ki\u1ec3m tra t\u1eebng s\u1ea3n ph\u1ea9m khi xu\u1ea5t x\u01b0\u1edfng. Hi\u1ec3u \u0111\u01b0\u1ee3c x\u00e1c su\u1ea5t l\u1ed7i n\u00e0y s\u1ebd gi\u00fap c\u00f4ng ty x\u1eed l\u00fd l\u1ed7i th\u00f4ng minh h\u01a1n nhi\u1ec1u.</p> <p>C\u00e1c \u1ee9ng d\u1ee5ng c\u1ee7a x\u00e1c su\u1ea5t g\u1ea7n nh\u01b0 l\u00e0 v\u00f4 h\u1ea1n, nh\u01b0ng ta s\u1ebd ch\u1ec9 \u0111\u1ec1 c\u1eadp \u0111\u1ebfn m\u1ed9t v\u00e0i trong s\u1ed1 \u0111\u00f3.</p>"},{"location":"misc/probability/probability/#giai-thich-xac-suat","title":"Gi\u1ea3i th\u00edch x\u00e1c su\u1ea5t","text":"<p>C\u00f3 hai c\u00e1ch hi\u1ec3u ch\u00ednh v\u1ec1 x\u00e1c su\u1ea5t: x\u00e1c su\u1ea5t theo ch\u1ee7 ngh\u0129a kh\u00e1ch quan (objectivist probability) v\u00e0 x\u00e1c su\u1ea5t theo ch\u1ee7 ngh\u0129a ch\u1ee7 quan (subjectivist probability).</p> <p>X\u00e1c su\u1ea5t kh\u00e1ch quan \u0111\u1ec1 c\u1eadp \u0111\u1ebfn c\u00e1c ph\u00e9p th\u1eed c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c l\u1eb7p l\u1ea1i nhi\u1ec1u l\u1ea7n \u0111\u1ec3 ph\u00e2n t\u00edch k\u1ebft qu\u1ea3, v\u00ed d\u1ee5 nh\u01b0 vi\u1ec7c ph\u00e2n t\u00edch c\u00e1c th\u1eed nghi\u1ec7m thu\u1ed1c l\u00e2m s\u00e0ng. C\u00e1c nh\u00e0 khoa h\u1ecdc v\u00e0 b\u00e1c s\u0129 s\u1ebd \u0111\u01b0a cho nh\u1eefng ng\u01b0\u1eddi tham gia th\u1eed nghi\u1ec7m m\u1ed9t lo\u1ea1i thu\u1ed1c m\u1edbi, v\u00e0 trong su\u1ed1t qu\u00e1 tr\u00ecnh th\u1eed nghi\u1ec7m, h\u1ecd s\u1ebd ph\u00e2n t\u00edch hi\u1ec7u qu\u1ea3 c\u1ee7a lo\u1ea1i thu\u1ed1c \u0111\u00f3. V\u00ec c\u00f3 nhi\u1ec1u ng\u01b0\u1eddi tham gia th\u1eed nghi\u1ec7m thu\u1ed1c n\u00ean m\u1ed9t th\u00ed nghi\u1ec7m hi\u1ec7u qu\u1ea3 s\u1ebd cho ph\u00e9p c\u00e1c b\u00e1c s\u0129 v\u00e0 nh\u00e0 khoa h\u1ecdc ch\u1ec9 \u0111\u1ecbnh x\u00e1c su\u1ea5t hi\u1ec7u qu\u1ea3 c\u1ee7a lo\u1ea1i thu\u1ed1c \u0111\u00f3. X\u00e1c su\u1ea5t n\u00e0y s\u1ebd \u0111\u1ea1i di\u1ec7n cho t\u1ec9 l\u1ec7 ng\u01b0\u1eddi tham gia nh\u1eadn \u0111\u01b0\u1ee3c t\u00e1c d\u1ee5ng c\u00f3 l\u1ee3i t\u1eeb thu\u1ed1c.</p> <p>M\u1ed9t s\u1ed1 bi\u1ebfn c\u1ed1 kh\u00f4ng ch\u1eafc ch\u1eafn kh\u00e1c kh\u00f4ng c\u00f3 c\u01a1 h\u1ed9i \u0111\u01b0\u1ee3c ki\u1ec3m tra qua nhi\u1ec1u l\u1ea7n th\u1eed, nh\u01b0ng v\u1eabn mong mu\u1ed1n c\u00f3 m\u1ed9t x\u00e1c su\u1ea5t n\u00e0o \u0111\u00f3. Trong tr\u01b0\u1eddng h\u1ee3p n\u00e0y, c\u00e1c nh\u00e0 to\u00e1n h\u1ecdc s\u1ebd coi x\u00e1c su\u1ea5t l\u00e0 m\u1ed9t th\u01b0\u1edbc \u0111o m\u1ee9c \u0111\u1ed9 tin t\u01b0\u1edfng r\u1eb1ng bi\u1ebfn c\u1ed1 n\u00e0o \u0111\u00f3 s\u1ebd x\u1ea3y ra. \u0110i\u1ec1u n\u00e0y \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 x\u00e1c su\u1ea5t ch\u1ee7 quan, ch\u1eb3ng h\u1ea1n nh\u01b0 vi\u1ec7c d\u1ef1 b\u00e1o th\u1eddi ti\u1ebft. C\u00e1c nh\u00e0 kh\u00ed t\u01b0\u1ee3ng h\u1ecdc s\u1ebd g\u00e1n x\u00e1c su\u1ea5t cho m\u1ed9t s\u1ed1 s\u1ef1 ki\u1ec7n th\u1eddi ti\u1ebft x\u1ea3y ra, nh\u01b0 kh\u1ea3 n\u0103ng c\u00f3 m\u01b0a \u1edf m\u1ed9t khu v\u1ef1c nh\u1ea5t \u0111\u1ecbnh. X\u00e1c x\u00e1c su\u1ea5t n\u00e0y \u0111\u01b0\u1ee3c t\u00ednh b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng d\u1eef li\u1ec7u thu th\u1eadp t\u1eeb v\u1ec7 tinh c\u0169ng nh\u01b0 d\u1eef li\u1ec7u l\u1ecbch s\u1eed. Kh\u00f4ng gi\u1ed1ng nh\u01b0 x\u00e1c su\u1ea5t kh\u00e1ch quan, x\u00e1c su\u1ea5t n\u00e0y kh\u00f4ng th\u1ec3 \u0111\u01b0\u1ee3c ki\u1ec3m tra qua nhi\u1ec1u th\u1eed nghi\u1ec7m v\u00ec c\u00e1c t\u00ecnh hu\u1ed1ng ch\u00ednh x\u00e1c d\u1eabn \u0111\u1ebfn d\u1ef1 \u0111o\u00e1n s\u1ebd kh\u00f4ng bao gi\u1edd l\u1eb7p l\u1ea1i n\u1eefa.</p>"},{"location":"misc/probability/probability/#xac-suat-trong-tai-chinh-va-kinh-te","title":"X\u00e1c su\u1ea5t trong t\u00e0i ch\u00ednh v\u00e0 kinh t\u1ebf","text":"<p>M\u1ed7i khi m\u1ed9t ng\u01b0\u1eddi \u0111i \u0111\u1ea7u t\u01b0, ng\u01b0\u1eddi \u0111\u00f3 \u0111ang tham gia v\u00e0o ph\u00e2n t\u00edch x\u00e1c su\u1ea5t, d\u00f9 ng\u01b0\u1eddi \u0111\u00f3 c\u00f3 nh\u1eadn ra hay kh\u00f4ng. M\u1ed7i kho\u1ea3n \u0111\u1ea7u t\u1eed \u0111\u1ec1u c\u00f3 m\u1ed9t s\u1ed1 m\u1ee9c \u0111\u1ed9 kh\u00f4ng ch\u1eafc ch\u1eafn. Kh\u00f4ng ai c\u00f3 th\u1ec3 ch\u1eafc ch\u1eafn gi\u00e1 tr\u1ecb c\u1ee7a kho\u1ea3n \u0111\u1ea7u t\u01b0 \u0111\u00f3 s\u1ebd nh\u01b0 th\u1ebf n\u00e0o trong t\u01b0\u01a1ng lai. B\u1eb1ng c\u00e1ch chi ti\u1ec1n cho m\u1ed9t kho\u1ea3n \u0111\u1ea7u t\u01b0, v\u1ec1 c\u01a1 b\u1ea3n, b\u1ea1n \u0111ang n\u00f3i r\u1eb1ng c\u00f3 kh\u1ea3 n\u0103ng cao l\u00e0 kho\u1ea3n \u0111\u1ea7u t\u01b0 \u0111\u00f3 s\u1ebd t\u1eb1ng gi\u00e1 tr\u1ecb.</p> <p>C\u00e1c nh\u00e0 ph\u00e2n t\u00edch t\u00e0i ch\u00ednh chuy\u00ean nghi\u1ec7p c\u00f3 xu h\u01b0\u1edbng nh\u1ea5n m\u1ea1nh r\u00f5 r\u00e0ng h\u01a1n v\u1ec1 x\u00e1c su\u1ea5t khi th\u1ef1c hi\u1ec7n ph\u00e2n t\u00edch c\u00e1c kho\u1ea3n \u0111\u1ea7u t\u01b0. H\u1ecd s\u1ebd d\u00f9ng c\u00e1c d\u1eef li\u1ec7u l\u1ecbch s\u1eed v\u00e0 lu\u1ed3ng th\u00f4ng tin h\u00e0ng ng\u00e0y \u0111\u1ec3 \u1ea5n \u0111\u1ecbnh x\u00e1c su\u1ea5t m\u00e0 m\u1ed9t kho\u1ea3n \u0111\u1ea7u t\u01b0 s\u1ebd t\u0103ng ho\u1eb7c gi\u1ea3m gi\u00e1 tr\u1ecb. C\u00e1c ph\u00e2n t\u00edch n\u00e0y s\u1ebd \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o th\u1ecb tr\u01b0\u1eddng v\u00e0 \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn gi\u00e1 c\u1ea3 h\u00e0ng ho\u00e1.</p> <p>V\u00ed d\u1ee5: M\u1ed9t nh\u00e0 ph\u00e2n t\u00edch t\u00e0i ch\u00ednh \u0111\u00e3 ph\u00e2n t\u00edch m\u1ed9t c\u00f4ng ty m\u1edbi v\u00e0 \u01b0\u1edbc t\u00ednh c\u00e1c th\u00f4ng tin sau v\u1ec1 n\u00f3:</p> <p>Gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a c\u00f4ng ty l\u00e0 1,1 tri\u1ec7u USD.</p> <p>C\u00f3 m\u1ed9t x\u00e1c su\u1ea5t 0,8 r\u1eb1ng c\u00f4ng ty s\u1ebd tr\u1ecb gi\u00e1 0,9 tri\u1ec7u USD trong m\u1ed9t n\u0103m.</p> <p>C\u00f3 m\u1ed9t x\u00e1c su\u1ea5t 0,15 r\u1eb1ng c\u00f4ng ty s\u1ebd tr\u1ecb gi\u00e1 1,3 tri\u1ec7u USD trong m\u1ed9t n\u0103m.</p> <p>C\u00f3 m\u1ed9t x\u00e1c su\u1ea5t 0,05 r\u1eb1ng c\u00f4ng ty s\u1ebd tr\u1ecb gi\u00e1 2,0 tri\u1ec7u USD trong m\u1ed9t n\u0103m.</p> <p>N\u1ebfu tri\u1ec3n v\u1ecdng \u0111\u1ea7u t\u01b0 d\u1ef1a tr\u00ean gi\u00e1 tr\u1ecb d\u1ef1 ki\u1ebfn trong t\u01b0\u01a1ng lai c\u1ee7a c\u00f4ng ty, th\u00ec tri\u1ec3n v\u1ecdng \u0111\u1ea7u t\u01b0 hi\u1ec7n t\u1ea1i v\u00e0o c\u00f4ng ty l\u00e0 g\u00ec?</p> L\u1eddi gi\u1ea3i <p>C\u00f3 v\u00e0i k\u1ebft qu\u1ea3 kh\u00e1c nhau v\u1ec1 c\u00e1ch th\u1ee9c ho\u1ea1t \u0111\u1ed9ng c\u1ee7a c\u00f4ng ty n\u00e0y nh\u01b0ng ch\u00fang ta c\u00f3 th\u1ec3 \u01b0\u1edbc t\u00ednh gi\u00e1 tr\u1ecb t\u01b0\u01a1ng lai c\u1ee7a c\u00f4ng ty b\u1eb1ng c\u00e1ch d\u00f9ng x\u00e1c su\u1ea5t.</p> <p>Gi\u00e1 tr\u1ecb t\u01b0\u01a1ng lai \u01b0\u1edbc t\u00ednh c\u1ee7a c\u00f4ng ty t\u00ednh b\u1eb1ng tri\u1ec7u USD l\u00e0:</p> \\[(0.8 \\times 0.9) + (0.15 \\times 1.3) + (0.05 \\times 2.0) = 1.015\\] <p>Con s\u1ed1 n\u00e0y th\u1ea5p h\u01a1n gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i c\u1ee7a c\u00f4ng ty, v\u00ec v\u1eady m\u1ed9t nh\u00e0 \u0111\u1ea7u t\u01b0 th\u00f4ng minh s\u1ebd b\u00e1n c\u1ed5 ph\u1ea7n c\u1ee7a h\u1ecd trong c\u00f4ng ty.</p> <p>Trong v\u00ed d\u1ee5 n\u00e0y, n\u1ebfu nhi\u1ec1u nh\u00e0 ph\u00e2n t\u00edch t\u00e0i ch\u00ednh thu \u0111\u01b0\u1ee3c c\u00f9ng m\u1ed9t k\u1ebft qu\u1ea3 khi h\u1ecd t\u00ednh to\u00e1n gi\u00e1 tr\u1ecb t\u01b0\u01a1ng lai c\u1ee7a c\u00f4ng ty, th\u00ec th\u1ecb tr\u01b0\u1eddng s\u1ebd \u0111i\u1ec1u ch\u1ec9nh v\u00e0 gi\u00e1 tr\u1ecb c\u1ee7a c\u00f4ng ty s\u1ebd thay \u0111\u1ed5i.</p>"},{"location":"misc/probability/probability/#xac-suat-trong-duoc-hoc","title":"X\u00e1c su\u1ea5t trong d\u01b0\u1ee3c h\u1ecdc","text":"<p>X\u00e1c su\u1ea5t \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong nghi\u00ean c\u1ee9u y h\u1ecdc \u0111\u1ec3 \u0111\u1ecbnh l\u01b0\u1ee3ng hi\u1ec7u qu\u1ea3 c\u1ee7a thu\u1ed1c v\u00e0 c\u00e1c th\u1ee7 thu\u1eadt y t\u1ebf. Tr\u01b0\u1edbc khi m\u1ed9t lo\u1ea1i thu\u1ed1c c\u00f3 th\u1ec3 \u0111\u01b0a ra th\u1ecb tr\u01b0\u1eddng, n\u00f3 ph\u1ea3i v\u01b0\u1ee3t qua c\u00e1c th\u1eed nghi\u1ec7m l\u00e2m s\u00e0ng. Trong m\u1ed9t th\u1eed nghi\u1ec7m l\u00e2m s\u00e0ng, nhi\u1ec1u ng\u01b0\u1eddi tham gia \u0111\u01b0\u1ee3c cho d\u00f9ng m\u1ed9t lo\u1ea1i thu\u1ed1c v\u00e0 hi\u1ec7u qu\u1ea3 c\u1ee7a lo\u1ea1i thu\u1ed1c \u0111\u00f3 \u0111\u01b0\u1ee3c \u0111o l\u01b0\u1eddng theo th\u1eddi gian. Ngo\u00e0i ra c\u00f2n c\u00f3 m\u1ed9t nh\u00f3m ng\u01b0\u1eddi tham gia \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 \"nh\u00f3m \u0111\u1ed1i ch\u1ee9ng\". Trong nh\u00f3m n\u00e0y, nh\u1eefng ng\u01b0\u1eddi tham gia \u0111\u01b0\u1ee3c l\u00e0m cho tin r\u1eb1ng h\u1ecd \u0111\u01b0\u1ee3c cho d\u00f9ng thu\u1ed1c, nh\u01b0ng th\u1ef1c t\u1ebf h\u1ecd \u0111\u01b0\u1ee3c cho d\u00f9ng gi\u1ea3 d\u01b0\u1ee3c (m\u1ed9t vi\u00ean \u0111\u01b0\u1eddng ch\u1eb3ng h\u1ea1n).</p> <p>C\u00e1c nh\u00e0 khoa h\u1ecdc \u0111o l\u01b0\u1eddng hi\u1ec7u qu\u1ea3 c\u1ee7a nh\u00f3m thu\u1ed1c so v\u1edbi hi\u1ec7u qu\u1ea3 c\u1ee7a nh\u00f3m \u0111\u1ed1i ch\u1ee9ng. R\u1ea5t nhi\u1ec1u ph\u00e2n t\u00edch \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o r\u1eb1ng thu\u1ed1c kh\u00f4ng ch\u1ec9 hi\u1ec7u qu\u1ea3 m\u00e0 c\u00f2n t\u1ed1t h\u01a1n l\u00e0 kh\u00f4ng l\u00e0m g\u00ec c\u1ea3 (nh\u00f3m \u0111\u1ed1i ch\u1ee9ng). Vi\u1ec7c m\u1ed9t lo\u1ea1i thu\u1ed1c c\u00f3 th\u1ef1c s\u1ef1 hi\u1ec7u qu\u1ea3 hay kh\u00f4ng c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t ngu\u1ed3n g\u00e2y tranh c\u00e3i l\u1edbn trong c\u1ed9ng \u0111\u1ed3ng nghi\u00ean c\u1ee9u y h\u1ecdc.</p> <p>V\u00ed d\u1ee5:</p> <p>C\u00e1c nh\u00e0 khoa h\u1ecdc d\u01b0\u1ee3c ph\u1ea9m v\u1eeba ph\u00e1t tri\u1ec3n m\u1ed9t lo\u1ea1i thu\u1ed1c c\u1ea3m m\u1edbi, \u0111\u01b0\u1ee3c \u0111\u1eb7t t\u00ean l\u00e0 MiraQuil.</p> <p>C\u00e1c nh\u00e0 khoa h\u1ecdc \u0111\u00e3 \u0111\u01b0a lo\u1ea1i thu\u1ed1c n\u00e0y qua nhi\u1ec1u th\u1eed nghi\u1ec7m l\u00e2m s\u00e0ng. H\u1ecd ph\u00e1t hi\u1ec7n ra r\u1eb1ng trong s\u1ed1 nh\u1eefng ng\u01b0\u1eddi tham gia (b\u1ecb c\u1ea3m v\u00e0 sau \u0111\u00f3 \u0111\u01b0\u1ee3c d\u00f9ng thu\u1ed1c), 98% trong s\u1ed1 h\u1ecd kh\u00f4ng c\u00f3 tri\u1ec7u ch\u1ee9ng c\u1ea3m sau m\u1ed9t tu\u1ea7n!</p> <p>C\u00e1c nh\u00e0 khoa h\u1ecdc \u0111\u00e3 ch\u1ee9ng minh r\u1eb1ng thu\u1ed1c c\u1ee7a h\u1ecd c\u00f3 hi\u1ec7u qu\u1ea3 ch\u01b0a? H\u1ecd c\u00f3 n\u00ean b\u1eaft \u0111\u1ea7u b\u00e1n thu\u1ed1c hay kh\u00f4ng?</p> L\u1eddi gi\u1ea3i <p>Ph\u1ea7n th\u00f4ng tin quan tr\u1ecdng nh\u1ea5t c\u00f2n thi\u1ebfu trong c\u00e1c th\u1eed nghi\u1ec7m l\u00e2m s\u00e0ng l\u00e0 hi\u1ec7u su\u1ea5t c\u1ee7a nh\u00f3m \u0111\u1ed1i ch\u1ee9ng. N\u1ebfu kh\u00f4ng bi\u1ebft nh\u1eefng ng\u01b0\u1eddi b\u1ecb c\u1ea3m l\u1ea1nh s\u1ebd nh\u01b0 th\u1ebf n\u00e0o khi h\u1ecd kh\u00f4ng d\u00f9ng thu\u1ed1c, th\u00ec kh\u00f4ng th\u1ec3 bi\u1ebft hi\u1ec7u qu\u1ea3 c\u1ee7a thu\u1ed1c.</p> <p>Kh\u00e1 h\u1ee3p l\u00fd khi cho r\u1eb1ng nhi\u1ec1u tri\u1ec7u ch\u1ee9ng c\u1ea3m l\u1ea1nh s\u1ebd bi\u1ebfn m\u1ea5t sau m\u1ed9t tu\u1ea7n, ngay c\u1ea3 khi kh\u00f4ng d\u00f9ng b\u1ea5t k\u1ef3 lo\u1ea1i thu\u1ed1c n\u00e0o. R\u1ea5t c\u00f3 th\u1ec3 nh\u00f3m \u0111\u1ed1i ch\u1ee9ng c\u0169ng c\u00f3 k\u1ebft qu\u1ea3 \"th\u1ea7n k\u1ef3\" kh\u00f4ng k\u00e9m. Tuy nhi\u00ean, kh\u00f4ng xem s\u1ed1 li\u1ec7u th\u00ec kh\u00f4ng th\u1ec3 bi\u1ebft \u0111\u01b0\u1ee3c.</p> <p>C\u00e2u tr\u1ea3 l\u1eddi l\u00e0 KH\u00d4NG.</p>"},{"location":"misc/probability/probability/#xac-suat-trong-san-xuat","title":"X\u00e1c su\u1ea5t trong s\u1ea3n xu\u1ea5t","text":"<p>Nghi\u00ean c\u1ee9u v\u1ec1 x\u00e1c su\u1ea5t cho ph\u00e9p \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh th\u00f4ng minh trong s\u1ea3n xu\u1ea5t. \u0110\u1eb7c bi\u1ec7t, n\u00f3 cho ph\u00e9p c\u00e1c nh\u00e0 qu\u1ea3n l\u00fd nh\u00e0 m\u00e1y \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh hi\u1ec7u qu\u1ea3 v\u1ec1 chi ph\u00ed khi ki\u1ec3m so\u00e1t ch\u1ea5t l\u01b0\u1ee3ng. B\u1eb1ng c\u00e1ch ph\u00e2n t\u00edch x\u00e1c su\u1ea5t c\u1ee7a m\u1ed9t s\u1ea3n ph\u1ea9m b\u1ecb l\u1ed7i v\u00e0 h\u1eadu qu\u1ea3 t\u00e0i ch\u00ednh c\u1ee7a m\u1ed9t s\u1ea3n ph\u1ea9m b\u1ecb l\u1ed7i, c\u00e1c nh\u00e0 qu\u1ea3n l\u00fd nh\u00e0 m\u00e1y c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ti\u1ec1n v\u00e0 ngu\u1ed3n l\u1ef1c c\u1ee7a h\u1ecd m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 nh\u1ea5t \u0111\u1ec3 gi\u00fap s\u1ea3n xu\u1ea5t c\u00e1c s\u1ea3n ph\u1ea9m c\u00f3 ch\u1ea5t l\u01b0\u1ee3ng.</p> <p>V\u00ed d\u1ee5:</p> <p>M\u1ed9t nh\u00e0 m\u00e1y s\u1ea3n xu\u1ea5t b\u00e0n ch\u1ea3i \u0111\u00e1nh r\u0103ng s\u1ea3n xu\u1ea5t \\(200000\\) b\u00e0n ch\u1ea3i \u0111\u00e1nh r\u0103ng m\u1ed7i ng\u00e0y. Quy tr\u00ecnh s\u1ea3n xu\u1ea5t kh\u00f4ng ho\u00e0n h\u1ea3o v\u00e0 \u0111\u00f4i khi c\u00f3 nh\u1eefng b\u00e0n ch\u1ea3i \u0111\u00e1nh r\u0103ng b\u1ecb l\u1ed7i.</p> <p>M\u1ed9t nh\u00e0 ph\u00e2n t\u00edch \u0111\u00e3 t\u00ednh to\u00e1n r\u1eb1ng m\u1ed7i b\u00e0n ch\u1ea3i \u0111\u00e1nh r\u0103ng c\u00f3 x\u00e1c su\u1ea5t b\u1ecb l\u1ed7i l\u00e0 0,004. N\u1ebfu m\u1ed9t kh\u00e1ch h\u00e0ng nh\u1eadn \u0111\u01b0\u1ee3c m\u1ed9t s\u1ea3n ph\u1ea9m b\u1ecb l\u1ed7i, th\u00ec c\u00f4ng ty s\u1ebd ph\u1ea3i tr\u1ea3 5 \u0111\u00f4 la \u0111\u1ec3 thay th\u1ebf s\u1ea3n ph\u1ea9m v\u00e0 l\u00e0m h\u00e0i l\u00f2ng kh\u00e1ch h\u00e0ng.</p> <p>Gi\u00e1m \u0111\u1ed1c nh\u00e0 m\u00e1y c\u00f3 th\u1ec3 ch\u1ecdn thu\u00ea m\u1ed9t nh\u00f3m \u0110\u1ea3m b\u1ea3o Ch\u1ea5t l\u01b0\u1ee3ng \u0111\u1ec3 t\u00ecm v\u00e0 s\u1eeda ch\u1eefa t\u1ea5t c\u1ea3 c\u00e1c b\u00e0n ch\u1ea3i \u0111\u00e1nh r\u0103ng b\u1ecb l\u1ed7i khi ch\u00fang \u0111\u01b0\u1ee3c s\u1ea3n xu\u1ea5t. S\u1ed1 ti\u1ec1n t\u1ed1i \u0111a m\u00e0 gi\u00e1m \u0111\u1ed1c nh\u00e0 m\u00e1y s\u1eb5n s\u00e0ng chi cho \u0111\u1ed9i n\u00e0y m\u1ed7i ng\u00e0y l\u00e0 bao nhi\u00eau?</p> L\u1eddi gi\u1ea3i <p>N\u1ebfu nh\u00e0 m\u00e1y s\u1ea3n xu\u1ea5t \\(200000\\) b\u00e0n ch\u1ea3i m\u1ed7i ng\u00e0y, m\u1ed7i b\u00e0n ch\u1ea3i c\u00f3 x\u00e1c su\u1ea5t l\u1ed7i l\u00e0 \\(0.004\\), ta c\u00f3 th\u1ec3 \u01b0\u1edbc l\u01b0\u1ee3ng r\u1eb1ng nh\u00e0 m\u00e1y s\u1ea3n xu\u1ea5t \\(200000 \\times 0.004 = 800\\) b\u1ea3n ch\u1ea3i l\u1ed7i m\u1ed7i ng\u00e0y.</p> <p>M\u1ed7i b\u00e0n ch\u1ea3i l\u1ed7i l\u00e0m c\u00f4ng ty m\u1ea5t \\(\\$5\\) \u0111\u00f4, th\u00ec t\u1ed5ng thi\u1ec7t h\u1ea1i m\u1ed9t ng\u00e0y l\u00e0 \\(\\$5 \\times 800 = \\$4000\\).</p> <p>N\u1ebfu \u0111\u1ed9i \u0111\u1ea3m b\u1ea3o ch\u1ea5t l\u01b0\u1ee3ng c\u00f3 th\u1ec3 t\u00ecm ra t\u1ea5t c\u1ea3 s\u1ea3n ph\u1ea9m l\u1ed7i, th\u00ec chi ph\u00ed cho \u0111\u1ed9i n\u00e0y ph\u1ea3i \u00edt h\u01a1n chi ph\u00ed cho c\u00e1c s\u1ea3n ph\u1ea9m l\u1ed7i. V\u00ec v\u1eady, ng\u01b0\u1eddi qu\u1ea3n l\u00fd s\u1ebd ph\u1ea3i tr\u1ea3 t\u1ed1i \u0111a \\(\\$4000\\) m\u1ed7i ng\u00e0y cho \u0111\u1ed9i n\u00e0y.</p>"}]}