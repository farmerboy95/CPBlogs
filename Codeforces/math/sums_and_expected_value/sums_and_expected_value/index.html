
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://farmerboy95.github.io/CPBlogs/Codeforces/math/sums_and_expected_value/sums_and_expected_value/">
      
      
      
      
      <link rel="icon" href="../../../../img/logo.jpg">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>Tổng và Giá trị kỳ vọng - farmerboy's CP Blogs</title>
      
    
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    <link rel="stylesheet" href="../../../../css/lightgallery.min.css">

    
    
      
    
    <script src="../../../../js/lightgallery.min.js"></script>

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-W9EFM7GCX7"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-W9EFM7GCX7",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-W9EFM7GCX7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tong-va-gia-tri-ky-vong" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="farmerboy&#39;s CP Blogs" class="md-header__button md-logo" aria-label="farmerboy's CP Blogs" data-md-component="logo">
      
  <img src="../../../../img/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            farmerboy's CP Blogs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tổng và Giá trị kỳ vọng
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/farmerboy95/CPBlogs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    farmerboy95/CPBlogs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  Trang chủ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../graph/dfs_tree/dfs_tree/" class="md-tabs__link">
          
  
  Codeforces

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../cp-algorithms/algebra/binary_exponentiation/binary_exponentiation/" class="md-tabs__link">
          
  
  cp-algorithms

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Codechef/data_structures/disjoint_sparse_table/disjoint_sparse_table/" class="md-tabs__link">
          
  
  Codechef

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../LeetCode/reservoir_sampling/reservoir_sampling/" class="md-tabs__link">
          
  
  LeetCode

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Misc/complexity_analysis/asymptotic_notations/asymptotic_notations/" class="md-tabs__link">
          
  
  Nguồn khác

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="farmerboy&#39;s CP Blogs" class="md-nav__button md-logo" aria-label="farmerboy's CP Blogs" data-md-component="logo">
      
  <img src="../../../../img/logo.jpg" alt="logo">

    </a>
    farmerboy's CP Blogs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/farmerboy95/CPBlogs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    farmerboy95/CPBlogs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trang chủ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Trang chủ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lời chào
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../navigation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các tài liệu
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codeforces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Codeforces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Đồ thị
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Đồ thị
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../graph/dfs_tree/dfs_tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cây DFS và ứng dụng
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xử lý bit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Xử lý bit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../bit_manipulation/xor_basis/xor_basis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kĩ thuật Vector cơ sở cho các bài toán XOR
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Toán học
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Toán học
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../floors_ceilings_inequalities/floors_ceilings_inequalities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Floor, ceiling và bất đẳng thức cho người mới học
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hashing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Hashing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../hashing/blowing_up_unordered_map/blowing_up_unordered_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giải mã và chống hack cho unordered_map trong C++
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    C++
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            C++
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../c%2B%2B/no_rand/no_rand/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ngưng xài rand() - Tổng quan về các trình sinh số ngẫu nhiên trong C++
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Các thuật toán ngẫu nhiên và gần đúng
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Các thuật toán ngẫu nhiên và gần đúng
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../randomized_algorithms/hacking_randomized_solutions/hacking_randomized_solutions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Làm sao hack các solution ngẫu nhiên và cách ngăn chặn nó
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cp-algorithms
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            cp-algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Đại số
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Đại số
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cp-algorithms/algebra/binary_exponentiation/binary_exponentiation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Luỹ thừa nhị phân
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cơ bản
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            Cơ bản
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cp-algorithms/data_structures/fundamentals/min_stack_min_queue/min_stack_min_queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minimum Stack / Minimum Queue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cp-algorithms/data_structures/fundamentals/sparse_table/sparse_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sparse Table
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cây
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Cây
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cp-algorithms/data_structures/trees/sqrt_tree/sqrt_tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sqrt Tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cp-algorithms/data_structures/trees/dsu/dsu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoint Set Union
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Codechef
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Codechef
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Codechef/data_structures/disjoint_sparse_table/disjoint_sparse_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disjoint Sparse Table
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    LeetCode
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            LeetCode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LeetCode/reservoir_sampling/reservoir_sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lấy mẫu hồ chứa (Reservoir Sampling)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LeetCode/search_in_rotated_sorted_array/search_in_rotated_sorted_array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tìm kiếm trên mảng đã sắp xếp nhưng đã xoay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LeetCode/basic_calculator/basic_calculator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tính toán biểu thức từ xâu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../LeetCode/sorting/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các thuật toán sắp xếp - Sắp ra mắt
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nguồn khác
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Nguồn khác
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Phân tích Độ phức tạp
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Phân tích Độ phức tạp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/complexity_analysis/asymptotic_notations/asymptotic_notations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Các ký hiệu tiệm cận
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/complexity_analysis/potential_method/potential_method/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phương pháp Tiềm năng
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cấu trúc dữ liệu
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Cấu trúc dữ liệu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/data_structures/splay_tree/splay_tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Splay Tree: Một mình anh chấp hết
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Xác suất
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Xác suất
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/probability/probability/probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xác suất
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/probability/expected_value/expected_value/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Giá trị kỳ vọng
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/probability/linearity_of_expectation/linearity_of_expectation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kỳ vọng tuyến tính
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Kinh nghiệm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Kinh nghiệm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/experience/being_better/being_better/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Làm thế nào để giỏi hơn trong lập trình thi đấu?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Misc/experience/icpc_strategy/icpc_strategy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chiến thuật khi thi ICPC
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nguon" class="md-nav__link">
    Nguồn
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mo-au" class="md-nav__link">
    Mở đầu
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#so-bo-ve-gia-tri-ky-vong" class="md-nav__link">
    Sơ bộ về giá trị kỳ vọng
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ky-thuat-gop-vao-tong" class="md-nav__link">
    Kỹ thuật "góp vào tổng"
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cac-bai-ev-on-gian" class="md-nav__link">
    Các bài EV đơn giản
  </a>
  
    <nav class="md-nav" aria-label="Các bài EV đơn giản">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-1" class="md-nav__link">
    Bài 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-2" class="md-nav__link">
    Bài 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-3" class="md-nav__link">
    Bài 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-4" class="md-nav__link">
    Bài 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-5" class="md-nav__link">
    Bài 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-6" class="md-nav__link">
    Bài 6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-7" class="md-nav__link">
    Bài 7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-8" class="md-nav__link">
    Bài 8
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-9" class="md-nav__link">
    Bài 9
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cac-bai-tap-cho-ky-thuat-gop-vao-tong" class="md-nav__link">
    Các bài tập cho kỹ thuật "góp vào tổng"
  </a>
  
    <nav class="md-nav" aria-label="Các bài tập cho kỹ thuật "góp vào tổng"">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-1_1" class="md-nav__link">
    Bài 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-2_1" class="md-nav__link">
    Bài 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-3_1" class="md-nav__link">
    Bài 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-4_1" class="md-nav__link">
    Bài 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-5_1" class="md-nav__link">
    Bài 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-6_1" class="md-nav__link">
    Bài 6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-7_1" class="md-nav__link">
    Bài 7
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-8_1" class="md-nav__link">
    Bài 8
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ly-thuyet-ky-vong-phan-2" class="md-nav__link">
    Lý thuyết kỳ vọng, phần 2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ordered-pairs-giai-thich-binh-phuong" class="md-nav__link">
    Ordered pairs (giải thích bình phương)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ky-thuat-mu" class="md-nav__link">
    Kỹ thuật mũ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cac-bai-tap" class="md-nav__link">
    Các bài tập
  </a>
  
    <nav class="md-nav" aria-label="Các bài tập">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bai-1_2" class="md-nav__link">
    Bài 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-2_2" class="md-nav__link">
    Bài 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-3_2" class="md-nav__link">
    Bài 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-4_2" class="md-nav__link">
    Bài 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-5_2" class="md-nav__link">
    Bài 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-6_2" class="md-nav__link">
    Bài 6
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bai-7_2" class="md-nav__link">
    Bài 7
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#luyen-tap" class="md-nav__link">
    Luyện tập
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
                  

  
  


<h1 id="tong-va-gia-tri-ky-vong">Tổng và Giá trị kỳ vọng</h1>
<h2 id="nguon">Nguồn</h2>
<p><a class="glightbox" href="/CPBlogs/img/codeforces.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img src="/CPBlogs/img/codeforces.png" width="16" height="16"/></a> <a href="https://codeforces.com/blog/entry/62690">Sums and Expected Value - part 1</a></p>
<p><a class="glightbox" href="/CPBlogs/img/codeforces.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img src="/CPBlogs/img/codeforces.png" width="16" height="16"/></a> <a href="https://codeforces.com/blog/entry/62792">Sums and Expected Value - part 2</a></p>
<h2 id="mo-au">Mở đầu</h2>
<p>Đầu tiên thì bạn cần biết về xác suất và một chút về giá trị kỳ vọng. Về kỳ vọng tuyến tính thì mình có một bài dịch khá dễ hiểu ở <a href="../../../../Misc/probability/expected_value/expected_value/">đây</a>, các bạn có thể tìm đọc.</p>
<h2 id="so-bo-ve-gia-tri-ky-vong">Sơ bộ về giá trị kỳ vọng</h2>
<p>Ví dụ ta mua một vé số giá 2 đô. Ta thắng giải 10 đô với xác suất là 10%, thắng giải 20 đô với xác suất 2%. Trung bình, nó sẽ cho ta <span class="arithmatex">\(0.1 \cdot 10 + 0.02 \cdot 20 = 1.4\)</span>, nên ta sẽ mất nhiều hơn là được khi mua vé số. Giá trị trung bình vừa tính chính là giá trị kỳ vọng.</p>
<p><strong>Giá trị kỳ vọng (Expected Value - EV, có thể gọi tắt là kỳ vọng)</strong> là giá trị trung bình của một biến cố / phép thử. Ví dụ, EV của số chấm khi ta tung một con xúc xắc 6 mặt là <span class="arithmatex">\(3.5\)</span>:</p>
<div class="arithmatex">\[E(X) = \sum_{\omega \in \Omega} P(\omega) \cdot X(\omega) = \frac{1}{6} \cdot 1 + \frac{1}{6} \cdot 2 + \ldots + \frac{1}{6} \cdot 6 = 3.5\]</div>
<p>Kỳ vọng tuyến tính (rất quan trọng):</p>
<div class="arithmatex">\[E(X + Y) = E(X) + E(Y)\]</div>
<h2 id="ky-thuat-gop-vao-tong">Kỹ thuật "góp vào tổng"</h2>
<p>Nếu ta muốn tính một tổng nào đó của nhiều cách / khả năng, ta có thể xem xét một phần tử (hay một số, một cạnh, một cặp gì đó) và đếm xem có bao nhiêu lần phần tử đó nằm trong kết quả cuối cùng.</p>
<h2 id="cac-bai-ev-on-gian">Các bài EV đơn giản</h2>
<h3 id="bai-1">Bài 1</h3>
<p>Chọn 10 lá bài ngẫu nhiên trong một bộ bài 52 lá tiêu chuẩn. Tìm kỳ vọng số con át (ace) trong đó.</p>
<details class="tip">
<summary>Lời giải 1</summary>
<p>Đây là cách của mình (farmerboy). Nếu bạn đã đọc bài viết kỳ vọng tuyến tính trên trang này thì bạn hẳn sẽ quen với cách giải sau đây.</p>
<p>Gọi <span class="arithmatex">\(E_i\)</span> là kỳ vọng con át thứ <span class="arithmatex">\(i\)</span> được bốc ra khi kết thúc việc chọn 10 lá bài. Như vậy kết quả sẽ là <span class="arithmatex">\(E_1 + E_2 + E_3 + E_4\)</span>, theo kỳ vọng tuyến tính, vì ta có 4 con át. Ta dễ dàng thấy được <span class="arithmatex">\(E_i = 1 \cdot P_i + 0 \cdot (1 - P_i) = P_i\)</span>, hay là kỳ vọng bốc ra được con át thứ <span class="arithmatex">\(i\)</span> cũng là xác suất bốc ra được con át đó (sử dụng công thức kỳ vọng thì ta suy ra được nó).</p>
<p>Thế thì số cách chọn ra một con át nào đó, ví dụ át cơ là bao nhiêu (và cũng áp dụng với các con át còn lại). Thì ta có</p>
<div class="arithmatex">\[E_i = P_i = \frac{1 \cdot \binom{51}{9}}{\binom{52}{10}} = \frac{10}{52} = \frac{5}{26}\]</div>
<p>Như vậy kết quả sẽ là <span class="arithmatex">\(E = E_1 + E_2 + E_3 + E_4 = 4 \cdot E_1 = 4 * \frac{5}{26} = \frac{10}{13}\)</span>.</p>
</details>
<details class="tip">
<summary>Lời giải 2</summary>
<p>Đây là cách giải của Errichto.</p>
<p>Ta có xác suất để bốc ra được một con át là <span class="arithmatex">\(P = \frac{4}{52} = \frac{1}{13}\)</span>.</p>
<p>Gọi <span class="arithmatex">\(E_i\)</span> là kỳ vọng bốc ra được con át trong lần bốc thứ <span class="arithmatex">\(i\)</span>. Như vậy, theo kỳ vọng tuyến tính <span class="arithmatex">\(E = \sum_{i=1}^{10} E_i\)</span>.</p>
<p>Ở đây dễ thấy rằng <span class="arithmatex">\(E_i = P_i\)</span> (lý do tương tự lời giải 1), như vậy <span class="arithmatex">\(E = \sum_{i=1}^{10} E_i = \sum_{i=1}^{10} P_i = 10 \cdot \frac{1}{13} = \frac{10}{13}\)</span>.</p>
<p>Lưu ý là dù cho ở các lần bốc sau, xác suất bốc ra át có thể thay đổi nhưng ta vẫn có thể tính được như vậy dựa vào kỳ vọng tuyến tính.</p>
<p>Nếu vẫn thấy khó hiểu vì sao xác suất ở sau vẫn là <span class="arithmatex">\(\frac{1}{13}\)</span>, bạn có thể tưởng tượng rằng nếu mình lấy 10 lá bài lần lượt và mình không nói cho bạn biết 9 lá đầu tiên là gì, thì bạn có nghĩ xác suất lá thứ 10 là con át không phải <span class="arithmatex">\(\frac{1}{13}\)</span> hay không? Đây là lúc bạn nhận ra vấn đề.</p>
</details>
<h3 id="bai-2">Bài 2</h3>
<p>Giá của một chiếc TV là 1000 đô. Trong <span class="arithmatex">\(N\)</span> ngày tiếp theo, mỗi ngày giá của TV tăng 5 đô hoặc 10 đô (xác suất như nhau là 50%). Tính kỳ vọng giá TV sau <span class="arithmatex">\(N\)</span> ngày.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Gọi <span class="arithmatex">\(E_i\)</span> là kỳ vọng giá tăng trong ở ngày thứ <span class="arithmatex">\(i\)</span>, như vậy ta sẽ có kết quả là <span class="arithmatex">\(E = \sum_{i=1}^{N} E_i\)</span>. Ta có mỗi ngày giá tăng như đề bài nên <span class="arithmatex">\(E_i = 5 \cdot 0.5 + 10 \cdot 0.5 = 7.5\)</span>.</p>
<p>Theo đề bài thì ngày nào giá cũng tăng như vậy nên các <span class="arithmatex">\(E_i\)</span> bằng nhau. Như vậy <span class="arithmatex">\(E = \sum_{i=1}^{N} E_i = N \cdot E_1 = 7.5 \cdot N\)</span>.</p>
<p>Lưu ý <span class="arithmatex">\(E\)</span> là giá tăng chứ không phải tổng giá, tổng giá thì đơn giản sẽ là <span class="arithmatex">\(1000 + N \cdot 7.5\)</span>.</p>
</details>
<h3 id="bai-3">Bài 3</h3>
<p>Tung một con xúc xắc 6 mặt hai lần. Tìm kỳ vọng số lớn hơn trong hai lần tung đó.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Bạn có thể vẽ ra một bảng cho ra số lớn hơn trong hai số kiểu như sau:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>  | 1 2 3 4 5 6
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>---------------
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>1 | 1 2 3 4 5 6
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>2 | 2 2 3 4 5 6
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>3 | 3 3 3 4 5 6
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>4 | 4 4 4 4 5 6
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>5 | 5 5 5 5 5 6
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>6 | 6 6 6 6 6 6
</code></pre></div></p>
<p>Mỗi trường hợp trong đây có xác suất là <span class="arithmatex">\(\frac{1}{36}\)</span>. Như vậy theo công thức kỳ vọng <span class="arithmatex">\(E(X) = \sum_{\omega \in \Omega} P(\omega) \cdot X(\omega)\)</span>, ta chỉ cần tính lần lượt tất cả các trường hợp trên rồi cộng lại với nhau là ra đáp án. Nhưng có vẻ hơi dài.</p>
<p>Vậy ta có thể tính trong 36 trường hợp này thì có bao nhiêu số 1, 2, 3, ..., 6 không? Ví dụ tính số số 5 đi. Số cách chọn hai số không lớn hơn 5 là <span class="arithmatex">\(5 \cdot 5 = 25\)</span> cách. Nhưng đó là số cách chọn hai số không lớn hơn 5, có phải chắc chắn có 5 trong đó đâu? Ở đây, ta phải trừ số cách chọn hai số không lớn hơn 4 nữa là có đáp án, như vậy số cách chọn hai số có max là 5 là <span class="arithmatex">\(5 \cdot 5 - 4 \cdot 4 = 5^2 - 4^2 = 9\)</span>. Tương tự ta có thể tính được đáp án của tất cả các số còn lại.</p>
<p>Như vậy kết quả sẽ là</p>
<div class="arithmatex">\[E = \sum_{i=1}^6 i \cdot \frac{i^2 - (i-1)^2}{6^2} = \frac{\sum_{i=1}^6 i \cdot (i^2 - (i-1)^2)}{36} = \frac{161}{36} = 4.4722 \ldots\]</div>
</details>
<h3 id="bai-4">Bài 4</h3>
<p>Tung một con xúc xắc 6 mặt <span class="arithmatex">\(N\)</span> lần. Tìm kỳ vọng số lớn nhất trong <span class="arithmatex">\(N\)</span> lần tung đó.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Tương tự bài trước, số cách chọn N số có max là <span class="arithmatex">\(i\)</span> sẽ là <span class="arithmatex">\(i^N - (i-1)^N\)</span>. Không gian mẫu là <span class="arithmatex">\(6^N\)</span></p>
<p>Như vậy kết quả là</p>
<div class="arithmatex">\[E = \sum_{i=1}^6 i \cdot \frac{i^N - (i-1)^N}{6^N} = \frac{\sum_{i=1}^6 i \cdot (i^N - (i-1)^N)}{6^N}\]</div>
<p>Đây cũng là bài 454C trên Codeforces. Code sẽ ở phần Luyện tập nhé.</p>
</details>
<h3 id="bai-5">Bài 5</h3>
<p>Bạn dạy trong một lớp 20 người. Khi ai đó có sinh nhật, bạn phải cho cả lớp chơi game thay vì học bài mới ngày hôm đó. Có thể một số học sinh có ngày sinh nhật trùng nhau, nên sẽ có ít hơn 20 ngày bị lãng phí trong một năm phải không? Tìm kỳ vọng số ngày lãng phí trong năm.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ta gọi <span class="arithmatex">\(E_i\)</span> là kì vọng một ngày thứ <span class="arithmatex">\(i\)</span> là ngày sinh nhật của bất kỳ học sinh nào trong lớp. Như vậy kỳ vọng số ngày lãng phí trong năm sẽ là <span class="arithmatex">\(E = \sum_{i=1}^{365} E_i\)</span>. Vì kì vọng các ngày bằng nhau nên <span class="arithmatex">\(E = \sum_{i=1}^{365} E_i = 365 \cdot E_1\)</span>.</p>
<p>Vì <span class="arithmatex">\(E_i\)</span> là kỳ vọng ngày thứ <span class="arithmatex">\(i\)</span> là sinh nhật ai đó, nên nó chỉ có đúng hoặc sai (1 hoặc 0), nên <span class="arithmatex">\(E_i = P_i\)</span>, cũng là xác suất ngày thứ <span class="arithmatex">\(i\)</span> là sinh nhật ai đó. Tính <span class="arithmatex">\(P_i\)</span> như thế nào?</p>
<p>Tính thẳng <span class="arithmatex">\(P_i\)</span> có vẻ khó, giờ ta thử tính <span class="arithmatex">\(1 - P_i\)</span>, hay còn gọi là xác suất để ngày thứ <span class="arithmatex">\(i\)</span> không phải sinh nhật ai cả, xem sao. Xác suất đó sẽ là <span class="arithmatex">\((1 - \frac{1}{365})^{20}\)</span>, vì với mỗi học sinh, ta chỉ cần chọn ngày khác với ngày <span class="arithmatex">\(i\)</span> là xong. Vậy <span class="arithmatex">\(1 - P_i = (1 - \frac{1}{365})^{20} = (\frac{364}{365})^{20}\)</span>. Suy ra <span class="arithmatex">\(P_i = 1 - (\frac{364}{365})^{20} \approx 0.05339\)</span></p>
<p>Như vậy <span class="arithmatex">\(E = \sum_{i=1}^{365} E_i = 365 \cdot E_1 = 365 \cdot (1 - (\frac{364}{365})^{20}) \approx 19.4879\)</span> ngày.</p>
</details>
<h3 id="bai-6">Bài 6</h3>
<p>Cho một đồng xu công bằng (xác suất tung ra mặt ngửa bằng xác suất tung ra mặt sấp). Tìm kỳ vọng số lần tung để ra mặt ngửa.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Gọi <span class="arithmatex">\(E_i\)</span> là số lần tung đồng xu để ra mặt ngửa sau khi đã tung <span class="arithmatex">\(i\)</span> lần. <span class="arithmatex">\(E_0\)</span> là đáp án của chúng ta. Ta thấy rằng nếu tung lần đầu được mặt sấp, thì kỳ vọng sau đó vẫn sẽ bằng kỳ vọng khi chưa tung lần nào, nghĩa là <span class="arithmatex">\(E_1 = E_0\)</span>.</p>
<p>Theo công thức kỳ vọng, ta có <span class="arithmatex">\(E_0 = \frac{1}{2} \cdot 1 + \frac{1}{2} \cdot (1 + E_0)\)</span>. Nghĩa là, khi tung được mặt ngửa ở lần đầu, ta đã có mặt ngửa rồi nên không tung nữa, số lần tung là 1, còn khi tung ra mặt sấp, ta mất một lần tung và phải tung tiếp. Chuyển <span class="arithmatex">\(E_0\)</span> về 1 vế và tính, ta sẽ có <span class="arithmatex">\(E_0 = 2\)</span>.</p>
</details>
<h3 id="bai-7">Bài 7</h3>
<p>Cho một đồng xu công bằng. Tìm kỳ vọng số lần tung để ra tổng cộng hai lần mặt ngửa.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Sau khi tung ra được 1 lần mặt ngửa, kỳ vọng số lần tung để ra mặt ngửa thứ hai là bao nhiêu? Chính xác, là 2 lần, như bài trước. Thế thì kỳ vọng số lần tung để ra lần mặt ngửa đầu tiên là bao nhiêu? Vẫn là 2.</p>
<p>Như vậy <span class="arithmatex">\(E(\text{2 ngửa}) = E(\text{1 ngửa} + \text{1 ngửa}) = E(\text{1 ngửa}) + E(\text{1 ngửa}) = 2 + 2 = 4\)</span>, theo kỳ vọng tuyến tính.</p>
</details>
<h3 id="bai-8">Bài 8</h3>
<p>Cho một đồng xu công bằng. Tìm kỳ vọng số lần tung để ra tổng cộng hai lần mặt ngửa liên tiếp.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Gọi <span class="arithmatex">\(E_i\)</span> kỳ vọng số lần tung để từ <span class="arithmatex">\(i\)</span> măt ngửa sau cùng ta có <span class="arithmatex">\(i+1\)</span> mặt ngửa sau cùng. <span class="arithmatex">\(E_0 + E_1\)</span> là đáp án của chúng ta. Rõ ràng ta có <span class="arithmatex">\(E_2 = 0\)</span>, vì lúc này ta đã có 2 mặt ngửa liên tiếp.</p>
<p>Ta có <span class="arithmatex">\(E_0 = \frac{1}{2} \cdot 1 + \frac{1}{2} \cdot (1 + E_0)\)</span>. Giải ra ta sẽ có <span class="arithmatex">\(E_0 = 2\)</span>.</p>
<p>Lại có <span class="arithmatex">\(E_1 = \frac{1}{2} \cdot 1 + \frac{1}{2} \cdot (1 + E_0 + E_1)\)</span>. Ở đây nghĩa là nếu tung ra mặt ngửa tiếp thì ta đến trạng thái 2 mặt ngửa liên tiếp, ngược lại ta tốn một lượt tung và phải cần <span class="arithmatex">\(E_0\)</span> lần tung để quay lại trạng thái 1 mặt ngửa, sau đó tung <span class="arithmatex">\(E_1\)</span> lần để đến trạng thái 2 mặt ngửa. Giải cái này ra ta sẽ có <span class="arithmatex">\(E_1 = 4\)</span>.</p>
<p>Như vậy kết quả là <span class="arithmatex">\(E_0 + E_1 = 2 + 4 = 6\)</span>.</p>
</details>
<h3 id="bai-9">Bài 9</h3>
<p>12 đội, trong đó có đội của bạn, chơi trong một giải bóng chuyền. Các đội được chia ra làm 4 bảng, mỗi bảng 3 đội. Trong mỗi bảng, các đội đấu vòng tròn một lượt và hai đội đầu bảng sẽ vào vòng knockout. Nếu có các đội bằng điểm và bằng tất cả các chỉ số khác, hai đội ngẫu nhiên sẽ đi tiếp. Vòng knockout có tứ kết, bán kết và chung kết. Trong mỗi trận, xác suất một đội thắng là 50%, không có kết quả hoà.</p>
<p>Tìm xác suất đội của bạn thắng giải này. Tìm kỳ vọng số trận thắng của đội bạn. Tìm kỳ vọng số trận thắng của đội bạn, với điều kiện đội bạn thắng giải (nghĩa là tìm kỳ vọng số trận thắng của đội thắng cuộc).</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Do các đội là như nhau trong một bảng (symmetry - cân đối) nên xác suất để một đội vượt qua vòng bảng là <span class="arithmatex">\(\frac{2}{3}\)</span> (tương tự xác suất bị loại là <span class="arithmatex">\(\frac{1}{3}\)</span>). Đội của bạn cần thắng tứ kết, bán kết và chung kết để vô địch, với xác suất là 50% mỗi trận, nên xác suất thắng giải là</p>
<div class="arithmatex">\[P(\text{thắng giải}) = \frac{2}{3} \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot \frac{1}{2} = \frac{1}{12}\]</div>
<p>Kỳ vọng số trận đấu của đội bạn sẽ bằng tổng các tích số trận được thi đấu với xác suất của mỗi trường hợp, theo công thức kỳ vọng, như vậy</p>
<div class="arithmatex">\[\begin{align}
E(\text{số trận của đội}) &amp;= P(\text{đội bị loại sau vòng bảng}) \cdot 2 + P(\text{đội thua tứ kết}) \cdot 3 + P(\text{đội thua bán kết}) \cdot 4 + P(\text{đội thua chung kết}) \cdot 5 + P(\text{đội thắng chung kết}) \cdot 5\\
&amp;= \frac{1}{3} \cdot 2 + \frac{2}{3} \cdot \frac{1}{2} \cdot 3 + \frac{2}{3} \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot 4 + \frac{2}{3} \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot 5 + \frac{2}{3} \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot 5\\
&amp;= \frac{19}{6}\\
\end{align}\]</div>
<p>Vậy còn kỳ vọng số trận thắng của đội vô địch? Ta có</p>
<div class="arithmatex">\[E(\text{số trận thắng của đội vô địch}) = E(\text{số trận thắng sau vòng bảng}) + E(\text{số trận thắng vòng knockout})\]</div>
<p>Số trận thắng vòng knockout thì rõ ràng là 3 vì cần phải thắng hết các trận đó mới vô địch.</p>
<p>Giờ ta chỉ cần tìm kỳ vọng số trận thắng vòng bảng với <strong>điều kiện</strong> là đội này vượt qua vòng bảng, gọi giá trị này là <span class="arithmatex">\(E_2\)</span>, thì <span class="arithmatex">\(E = 3 + E_2\)</span>. Ta có</p>
<div class="arithmatex">\[E_2 = 0 \cdot P(0|\text{đi tiếp}) + 1 \cdot P(1|\text{đi tiếp}) + 2 \cdot P(2|\text{đi tiếp})\]</div>
<p>Không có đội nào có thể đi tiếp khi không thắng trận nào ở vòng bảng, nên <span class="arithmatex">\(P(0|\text{đi tiếp}) = 0\)</span>. Suy ra <span class="arithmatex">\(P(1|\text{đi tiếp}) + P(2|\text{đi tiếp}) = 1\)</span>.</p>
<p>Theo định lý Bayes,</p>
<div class="arithmatex">\[P(2|\text{đi tiếp}) = \frac{P(\text{đi tiếp}|2) \cdot P(2)}{P(\text{đi tiếp})}\]</div>
<p>Ta biết rằng <span class="arithmatex">\(P(2) = \frac{1}{4}\)</span> và <span class="arithmatex">\(P(\text{đi tiếp}) = \frac{2}{3}\)</span>. Ta cũng biết rằng nếu thắng 2 trận thì sẽ chắc chắn đi tiếp, nên <span class="arithmatex">\(P(\text{đi tiếp}|2) = 1\)</span>. Vậy</p>
<div class="arithmatex">\[P(2|\text{đi tiếp}) = \frac{P(\text{đi tiếp}|2) \cdot P(2)}{P(\text{đi tiếp})} = \frac{1 \cdot \frac{1}{4} }{\frac{2}{3} } = \frac{3}{8}\]</div>
<p>Nên <span class="arithmatex">\(P(1|\text{đi tiếp}) = 1 - P(2|\text{đi tiếp}) = 1 - \frac{3}{8} = \frac{5}{8}\)</span>.</p>
<p>Vậy <span class="arithmatex">\(E_2 = 1 \cdot \frac{5}{8} + 2 \cdot \frac{3}{8} = \frac{11}{8}\)</span></p>
<p>Suy ra <span class="arithmatex">\(E = E_2 + 3 = \frac{11}{8} + 3 = \frac{35}{8}\)</span>.</p>
<p>Lưu ý rằng đây là kỳ vọng có điều kiên, điều kiện ở đây là đội phải qua vòng bảng, nó khác với kỳ vọng bình thường, nơi bạn có thể tính tất cả các trường hợp. Ở đây ta không thể đặt được biến ngẫu nhiên nào mà không có điều kiện qua vòng bảng.</p>
</details>
<h2 id="cac-bai-tap-cho-ky-thuat-gop-vao-tong">Các bài tập cho kỹ thuật "góp vào tổng"</h2>
<h3 id="bai-1_1">Bài 1</h3>
<p>Cho dãy số độ dài <span class="arithmatex">\(N\)</span> (<span class="arithmatex">\(N \le 10^5\)</span>), đếm các bộ ba <span class="arithmatex">\(i &lt; j &lt; k\)</span> sao cho <span class="arithmatex">\(a_i &lt; a_j &gt; a_k\)</span>.</p>
<p><strong>Bonus</strong>: Đếm các đoạn zig-zag độ dài <span class="arithmatex">\(10\)</span>, nghĩa là <span class="arithmatex">\(i_1 &lt; i_2 &lt; \ldots &lt; i_{10}\)</span> sao cho <span class="arithmatex">\(a[i_1] &lt; a[i_2] &gt; a[i_3] &lt; a[i_4] &gt; \ldots &lt; a[i_{10}]\)</span>.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ở đây thì bạn có thể duyệt <span class="arithmatex">\(j\)</span>. Sau đó tìm số các bộ ba chứa <span class="arithmatex">\(a_j\)</span> (phần tử ở giữa). Số bộ ba chứa <span class="arithmatex">\(a_j\)</span> ở giữa sẽ là số các số nhỏ hơn <span class="arithmatex">\(a_j\)</span> nằm bên trái nó và số các số nhỏ hơn <span class="arithmatex">\(a_j\)</span> nằm bên phải nó. Ta có thể tìm số các số nhỏ hơn này với BIT (Binary Indexed Tree - cây chỉ số nhị phân) trong <span class="arithmatex">\(O(\log n)\)</span>.</p>
<p><strong>Bonus</strong>: Nó sẽ phức tạp hơn một chút. Về cơ bản, bạn định nghĩa <span class="arithmatex">\(dp[i][j]\)</span> là số các bộ zig-zag độ dài <span class="arithmatex">\(j\)</span> khi xét trong đoạn <span class="arithmatex">\([1..i]\)</span> với <span class="arithmatex">\(a_i\)</span> là phần tử cuối cùng của bộ đó. Với mỗi <span class="arithmatex">\(j\)</span> ta sẽ tính hết <span class="arithmatex">\(dp[i][j]\)</span>. Ví dụ <span class="arithmatex">\(j\)</span> là <span class="arithmatex">\(4\)</span>, tại <span class="arithmatex">\(dp[i][j]\)</span> ta cần tổng các <span class="arithmatex">\(dp[k][j-1]\)</span>, với <span class="arithmatex">\(k &lt; i\)</span> và <span class="arithmatex">\(a[k] &lt; a[i]\)</span>, để tổng này thì một lần nữa ta lại dùng BIT, với giá trị tại node <span class="arithmatex">\(k\)</span> sẽ là <span class="arithmatex">\(dp[k][j-1]\)</span>. Lưu ý là qua mỗi <span class="arithmatex">\(j\)</span> thì dấu so sánh lại đảo nên cũng cần thay đổi một chút trong BIT. Độ phức tạp sẽ là <span class="arithmatex">\(O(n \log n)\)</span></p>
</details>
<h3 id="bai-2_1">Bài 2</h3>
<p>Cho một cây có <span class="arithmatex">\(N\)</span> đỉnh (<span class="arithmatex">\(N \le 10^5\)</span>), tìm tổng tất cả các độ dài các đường đi (Giải không dùng DP phức tạp hoặc centroid).</p>
<p><strong>Bonus</strong>: Tính tổng bình phương độ dài các đường đi.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Xét một cạnh <span class="arithmatex">\(E(u, v)\)</span> trên cây, gọi độ dài của nó là <span class="arithmatex">\(e\)</span>. Vậy <span class="arithmatex">\(e\)</span> sẽ đóng góp bao nhiêu trong kết quả? <span class="arithmatex">\(e\)</span> đóng góp vào kết quả khi có đường đi chứa cạnh <span class="arithmatex">\(E\)</span>. Vậy có bao nhiêu đường đi đi qua cạnh <span class="arithmatex">\(E\)</span>? Đó sẽ là số đỉnh bên phía <span class="arithmatex">\(u\)</span> trên cây nhân với số đỉnh bên phía <span class="arithmatex">\(v\)</span> trên cây. "Bên phía" <span class="arithmatex">\(u\)</span> nghĩa là đỉnh có đường đi ngắn nhất đến <span class="arithmatex">\(u\)</span> không qua cạnh <span class="arithmatex">\(E\)</span>.</p>
<p>Gọi <span class="arithmatex">\(num[u]\)</span> là số đỉnh trong cây con gốc <span class="arithmatex">\(u\)</span>. Với một cạnh <span class="arithmatex">\(E(u, v)\)</span> (<span class="arithmatex">\(u\)</span> là đỉnh cha của <span class="arithmatex">\(v\)</span>). Số đỉnh bên phía <span class="arithmatex">\(v\)</span> rõ ràng là <span class="arithmatex">\(num[v]\)</span>. Còn số đỉnh bên phía <span class="arithmatex">\(u\)</span> sẽ là các đỉnh còn lại, nghĩa là <span class="arithmatex">\(N - num[v]\)</span>. Như vậy <span class="arithmatex">\(e\)</span> đóng góp vào kết quả là <span class="arithmatex">\(e \cdot num[v] \cdot (N - num[u])\)</span>. Xét tất cả các cạnh, lấy tổng là sẽ có được đáp án.</p>
<p><strong>Bonus</strong>: Đầu tiên ta tính tổng bình phương tất cả các đường đi từ gốc của cây, gọi nó là <span class="arithmatex">\(S\)</span>. Ta DFS từ gốc, và khi di chuyển, ta sẽ duy trì <span class="arithmatex">\(S\)</span> sao cho khi đến đỉnh <span class="arithmatex">\(u\)</span> nào đó, <span class="arithmatex">\(S\)</span> sẽ là tổng bình phương tất cả các đường đi từ đỉnh <span class="arithmatex">\(u\)</span>. Sau đó thêm <span class="arithmatex">\(S\)</span> vào đáp án cuối cùng với mỗi đỉnh <span class="arithmatex">\(u\)</span>.</p>
<p>Lý thuyết là như vậy, còn làm sao để duy trì? Khi đi từ một đỉnh cha <span class="arithmatex">\(u\)</span> xuống đỉnh con <span class="arithmatex">\(v\)</span>, các đỉnh nằm trong cây con gốc <span class="arithmatex">\(v\)</span> sẽ bị giảm giá trị bình phương đường đi từ <span class="arithmatex">\(v\)</span> đến chúng, còn các đỉnh còn lại sẽ tăng giá trị, mà cụ thể là tăng bao nhiêu?</p>
<p>Xét giá trị bị giảm đi, giả sử một đường đi từ <span class="arithmatex">\(u\)</span> đến một đỉnh nào đó trong cây con gốc <span class="arithmatex">\(v\)</span> có tổng (không bình phương) là <span class="arithmatex">\(x\)</span>, như vậy tổng bình phương là <span class="arithmatex">\(x^2\)</span>. Gọi giá trị cạnh <span class="arithmatex">\(E(u, v)\)</span> là <span class="arithmatex">\(e\)</span>. Khi đến đỉnh <span class="arithmatex">\(v\)</span>, độ dài đường đi này sẽ là <span class="arithmatex">\(x - e\)</span>, và bình phương của nó là <span class="arithmatex">\((x - e)^2\)</span>. Bình phương độ dài đường đi sẽ giảm đi <span class="arithmatex">\(x^2 - (x - e)^2 = 2ex - e^2\)</span>. Vậy ta cần bớt đi <span class="arithmatex">\(2ex - e^2\)</span> từ <span class="arithmatex">\(x^2\)</span> để có <span class="arithmatex">\((x - e)^2\)</span>. Ta gọi <span class="arithmatex">\(numEdges[u]\)</span> là số cạnh trong cây con gốc <span class="arithmatex">\(u\)</span>, và <span class="arithmatex">\(sum[u]\)</span> là tổng tất cả các cạnh trong cây con gốc <span class="arithmatex">\(u\)</span>. Như vậy tổng giá trị cần bớt từ <span class="arithmatex">\(S\)</span> sẽ là: <span class="arithmatex">\(2e \cdot sum[v] - numEdges[v] \cdot e^2\)</span>.</p>
<p>Xét giá trị được tăng lên, tương tự như trên, bình phương độ dài tăng lên là <span class="arithmatex">\((x + e)^2 - x^2 = e^2 + 2ex\)</span>. Vậy ta cần tăng <span class="arithmatex">\(e^2 + 2ex\)</span> từ <span class="arithmatex">\(x^2\)</span> để có <span class="arithmatex">\((x + e)^2\)</span>. Tuy nhiên ở đây không phải cây con nên sẽ hơi khác một chút. Cụ thể, đây là cây ban đầu không chứa cây con gốc <span class="arithmatex">\(v\)</span>. Tổng giá trị cần tăng lên từ <span class="arithmatex">\(S\)</span> sẽ là <span class="arithmatex">\(2e \cdot (sum[root] - sum[v]) + (numEdges[root] - numEdges[v]) \cdot e^2\)</span>.</p>
<p>Sau khi có kết quả là <span class="arithmatex">\(S\)</span> thì cần lưu ý là một đường đi ở đây đã được tính 2 lần, lần đầu từ 1 đầu của đường đi, lần hai là từ đầu còn lại. Nên ta chia kết quả cho 2 để có được đáp án cuối cùng.</p>
</details>
<h3 id="bai-3_1">Bài 3</h3>
<p>Có <span class="arithmatex">\(N\)</span> cuộc thi, cuộc thi thứ <span class="arithmatex">\(i\)</span> có giải thưởng là <span class="arithmatex">\(a_i\)</span>. Bạn có thể thắng một cuộc thi với xác suất 50%. Tìm kỳ vọng số tiền thắng được.</p>
<p>Bài toán tương đương: Tìm tổng giải trên <span class="arithmatex">\(2^N\)</span> khả năng có thể xảy ra, in đáp án lấy dư với <span class="arithmatex">\(10^9 + 7\)</span>. (Đáp án ở đây chia <span class="arithmatex">\(2^N\)</span> sẽ ra đáp án câu trên).</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Với bài toán kỳ vọng, ta dễ dàng tính được kỳ vọng tổng số tiền thắng được sẽ bằng tổng kỳ vọng số tiền thắng được ở mỗi cuộc thi, theo kỳ vọng tuyến tính. Mà kỳ vọng số tiền thắng được ở cuộc thi <span class="arithmatex">\(i\)</span> sẽ là <span class="arithmatex">\(\frac{1}{2} \cdot a_i\)</span>, nên kết quả sẽ là <span class="arithmatex">\(E = \sum_{i = 1}^N E_i = \frac{1}{2} \cdot \sum_{i=1}^N a_i\)</span>.</p>
<p>Tuy nhiên, khi đọc vào bài toán tương đương, ta cần tìm xem với mỗi giải thưởng <span class="arithmatex">\(a_i\)</span>, nó sẽ đóng góp vào kết quả cuối cùng là bao nhiêu. Đó sẽ là tích của <span class="arithmatex">\(a_i\)</span> với số lần xuất hiện của <span class="arithmatex">\(a_i\)</span> trong <span class="arithmatex">\(2^N\)</span> khả năng có thể xảy ra. Mà ta biết là <span class="arithmatex">\(a_i\)</span> sẽ xuất hiện trong <span class="arithmatex">\(2^{N-1}\)</span> lần trong <span class="arithmatex">\(2^N\)</span> khả năng. Như vậy giải thưởng <span class="arithmatex">\(a_i\)</span> sẽ đóng góp <span class="arithmatex">\(2^{N-1} \cdot a_i\)</span> vào kết quả cuối cùng. Tương tự với các giải thưởng khác, ta sẽ có tổng giải là <span class="arithmatex">\(2^{N-1} \cdot \sum_{i=1}^N a_i\)</span>. Đáp án ở đây chia <span class="arithmatex">\(2^N\)</span> sẽ ra đáp án câu trên, theo định nghĩa kỳ vọng.</p>
</details>
<h3 id="bai-4_1">Bài 4</h3>
<p>Đây là bài Math Encoder của Google Kickstart 2017 Round B</p>
<p>Cho dãy độ dài <span class="arithmatex">\(N\)</span> (<span class="arithmatex">\(N \le 2000\)</span> hay <span class="arithmatex">\(N \le 10^5\)</span>). Chọn ngẫu nhiên một trong <span class="arithmatex">\(2^N-1\)</span> tập con không rỗng. Tìm kỳ vọng chênh lệch số lớn nhất và số bé nhất trong tập được chọn.</p>
<p>Bài toán tương đương: Tìm tổng chênh lệch của tất cả các tập con không rỗng, tính kết quả lấy dư với <span class="arithmatex">\(10^9+7\)</span>.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Đầu tiên, vì thứ tự ở đây không quan trọng lắm, vì ta chọn tất cả các tập con, nên ta có thể sắp xếp tăng dần dãy ban đầu.</p>
<p>Với bài tính kì vọng, ta cần tìm <span class="arithmatex">\(E(max - min)\)</span>, mà theo kì vọng tuyến tính, <span class="arithmatex">\(E(max - min) = E(max) - E(min)\)</span>. Tính 2 kỳ vọng này thì tương tự nhau. Ví dụ với tính <span class="arithmatex">\(E(max)\)</span>, làm sao để tính xác suất của một số <span class="arithmatex">\(x\)</span> nào đó là giá trị lớn nhất? Do đã sắp xếp nên <span class="arithmatex">\(x\)</span> sẽ là một nhóm kề nhau trên dãy. Ta sẽ không chọn các phần tử lớn hơn <span class="arithmatex">\(x\)</span>, gọi số phần tử lớn hơn <span class="arithmatex">\(x\)</span> là <span class="arithmatex">\(M\)</span> thì xác suất ở đây sẽ là <span class="arithmatex">\(\frac{1}{2^M}\)</span>. Với các phần tử nhỏ hơn <span class="arithmatex">\(x\)</span>, ta không có yêu cầu gì. Giờ đến việc chọn <span class="arithmatex">\(x\)</span>, ta cần ít nhất một <span class="arithmatex">\(x\)</span> trong dãy đã chọn, với số phần tử bằng <span class="arithmatex">\(x\)</span> là <span class="arithmatex">\(K\)</span> thì xác suất chọn ra được ít nhất một <span class="arithmatex">\(x\)</span> là <span class="arithmatex">\(\frac{2^K-1}{2^K}\)</span>. Như vậy xác suất để <span class="arithmatex">\(x\)</span> là số lớn nhất là <span class="arithmatex">\(\frac{1}{2^M} \cdot \frac{2^K-1}{2^K}\)</span>. Tuy nhiên, ta đang giả sử là xác suất chọn một phần tử là <span class="arithmatex">\(\frac{1}{2}\)</span>, khác với việc chọn một <span class="arithmatex">\(2^N - 1\)</span> tập con. Cái ta giả sử là tương đương với việc chọn <span class="arithmatex">\(2^N\)</span> tập con. Như vậy xác suất này cần nhân với <span class="arithmatex">\(2^N\)</span> rồi chia <span class="arithmatex">\(2^N-1\)</span> mới chính xác. Tính tổng tất cả các <span class="arithmatex">\(x\)</span> khác nhau trong dãy sẽ ra được <span class="arithmatex">\(E(max)\)</span>. Tương tự ta tính được <span class="arithmatex">\(E(min)\)</span> và cuối cùng là đáp án.</p>
<p>Với bài tương đương, ta có thể chọn ra 2 phần tử bất kỳ trong dãy đã sắp xếp, thì sẽ có bao nhiêu lần chênh lệch giữa chúng được đưa vào đáp án. Giả sử có <span class="arithmatex">\(P\)</span> phần tử nằm giữa hai phần tử đã chọn, thì chênh lệch giữa chúng sẽ đóng góp <span class="arithmatex">\(2^P\)</span> lần vào đáp án. Như vậy ta sẽ có được một lời giải <span class="arithmatex">\(O(N^2)\)</span> ở đây. Nếu <span class="arithmatex">\(N \le 10^5\)</span> thì sao? Để ý rằng đáp án sẽ tăng lên <span class="arithmatex">\(2^P \cdot (a_r - a_l) = 2^P \cdot a_r - 2^P \cdot a_l\)</span>. Ta có thể tách riêng để tính số lần cộng <span class="arithmatex">\(a_i\)</span> và số lần trừ <span class="arithmatex">\(a_i\)</span>. Cụ thể, ta sẽ cộng <span class="arithmatex">\(a_i\)</span> được <span class="arithmatex">\(2^{i-1} - 1\)</span> lần, và trừ <span class="arithmatex">\(a_i\)</span> đi <span class="arithmatex">\(2^{n-i} - 1\)</span> lần. Ta có thể giải bài này trong <span class="arithmatex">\(O(N)\)</span>.</p>
</details>
<h3 id="bai-5_1">Bài 5</h3>
<p>Đây là bài Imbalanced Array của Codeforces Educational Round 23</p>
<p>Tương tự bài trước, nhưng chọn ngẫu nhiên trong <span class="arithmatex">\(\frac{N \cdot (N+1)}{2}\)</span> đoạn con.</p>
<p>Bonus: Làm trong <span class="arithmatex">\(O(N)\)</span> nếu input chứa hoán vị các số từ <span class="arithmatex">\(1\)</span> đến <span class="arithmatex">\(N\)</span>.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ta có thể giải cả hai trong <span class="arithmatex">\(O(N)\)</span>.</p>
<p>Với mỗi đoạn, ta muốn biết giá trị lớn nhất <span class="arithmatex">\(Max\)</span> và giá trị nhỏ nhất <span class="arithmatex">\(Min\)</span>. Sau đó ta thêm <span class="arithmatex">\(Max - Min\)</span> vào đáp án cuối cùng. Làm tương tự với tất cả các đoạn thì ta sẽ có kết quả cuối cùng. Ta có thể làm trâu như vậy trong <span class="arithmatex">\(O(N^3)\)</span> hoặc <span class="arithmatex">\(O(N^2)\)</span> với RMQ.</p>
<p>Nhưng thế thì chậm quá. Giờ ta sẽ đi một hướng khác. Câu hỏi sẽ là: Với một vị trí <span class="arithmatex">\(i\)</span> nào đó, <span class="arithmatex">\(a[i]\)</span> sẽ là <span class="arithmatex">\(Max\)</span> bao nhiêu lần. Hay chính xác hơn là, có bao nhiêu đoạn con nhận phần tử thứ <span class="arithmatex">\(i\)</span> là <span class="arithmatex">\(Max\)</span>? Nếu ta giải được bài này, thì cũng có thể làm tương tự với <span class="arithmatex">\(Min\)</span>.</p>
<p>Giả sử các phần tử đều khác nhau đôi một (bài bonus). Để phần tử thứ <span class="arithmatex">\(i\)</span> là giá trị lớn nhất trong đoạn, ta cần xem rằng ta có thể mở rộng đoạn (ban đầu chỉ chứa <span class="arithmatex">\(a[i]\)</span>) về bên trái bao xa, và về bên phải bao xa, mà <span class="arithmatex">\(a[i]\)</span> vẫn là giá trị lớn nhất. Bên trái thì ta có thể đi cho đến khi gặp một phần tử lớn hơn hoặc đến hết dãy. Bên phải thì ta có thể đi cho đến khi gặp một phần tử lớn hơn hoặc đến hết dãy. Gọi các vị trí này là <span class="arithmatex">\(l\)</span> và <span class="arithmatex">\(r\)</span>. Như vậy, <span class="arithmatex">\(a[i]\)</span> có thể đóng góp <span class="arithmatex">\((r - i) * (i - l) * a[i]\)</span> vào kết quả cuối cùng. Tương tự với giá trị <span class="arithmatex">\(Min\)</span>, sự khác nhau chỉ là đi đến khi gặp phần tử nhỏ hơn. Ở đây <span class="arithmatex">\(a[i]\)</span> có thể đóng góp <span class="arithmatex">\(-(r - i) * (i - l) * a[i]\)</span> vào kết quả cuối cùng.</p>
<p>Việc tìm giá trị gần nhất lớn / nhỏ hơn bên trái / phải phần tử thứ <span class="arithmatex">\(i\)</span> có thể được giải bằng kỹ thuật Sliding Window trong <span class="arithmatex">\(O(N)\)</span>, sau đó lưu các vị trí này vào 4 mảng khác nhau.</p>
<p>Nếu các phần tử không khác nhau thì sao? Nếu làm như trên ta có thể đếm phải những kết quả trùng nhau. Cách tốt nhất để làm ở đây là:</p>
<ul>
<li>Tìm vị trí gần nhất bên trái sao cho giá trị ở đó lớn hơn hoặc BẰNG <span class="arithmatex">\(a[i]\)</span>.</li>
<li>Tìm vị trí gần nhất bên phải sao cho giá trị ở đó lớn hơn <span class="arithmatex">\(a[i]\)</span> (như ở bài khác nhau).</li>
<li>Tìm vị trí gần nhất bên trái sao cho giá trị ở đó lớn hơn hoặc BẰNG <span class="arithmatex">\(a[i]\)</span>.</li>
<li>Tìm vị trí gần nhất bên phải sao cho giá trị ở đó lớn hơn <span class="arithmatex">\(a[i]\)</span> (như ở bài khác nhau).</li>
</ul>
<p>Làm vậy sẽ loại bỏ được các giá trị trùng nhau. Kết lại, ta có thể giải bài này trong <span class="arithmatex">\(O(N)\)</span>.</p>
</details>
<h3 id="bai-6_1">Bài 6</h3>
<p>Cho một đa giác lồi <span class="arithmatex">\(N\)</span> đỉnh (<span class="arithmatex">\(N \le 2000\)</span> hay <span class="arithmatex">\(N \le 10^5\)</span>). Chọn một tập con ngẫu nhiên các đỉnh, nó sẽ tạo thành một đa giác lồi nhỏ hơn. Tính kỳ vọng chu vi của đa giác mới này.</p>
<p>Đây là một phiên bản dễ hơn của bài Randomizer của Codeforces Round 313 Div 1 D. Về bài này, ta được cho một đa giác lồi không có 3 đỉnh nào thẳng hàng. Ta phải chọn một tập con ngẫu nhiên có diện tích khác 0 (nghĩa là ít nhất 3 đỉnh). Tính kỳ vọng số toạ độ nguyên nằm hẳn bên trong đa giác mới.</p>
<details class="tip">
<summary>Lời giải</summary>
<p><strong>Với bài đầu tiên</strong>, ta cần tính kỳ vọng chu vi (perimeter) của đa giác mới, hay <span class="arithmatex">\(E(perimeter)\)</span>. Mà ta biết rằng chu vi bằng tổng độ dài các cạnh của đa giác, nghĩa là <span class="arithmatex">\(E(perimeter) = E(\sum L_i) = \sum E(L_i)\)</span>, trong đó <span class="arithmatex">\(L_i\)</span> là độ dài một cạnh thứ <span class="arithmatex">\(i\)</span> nào đó trong đa giác. Như vậy có nghĩa là, với mọi cạnh, nếu nó xuất hiện trong đa giác, độ dài của nó sẽ được thêm vào trong kết quả. Việc ta cần làm là duyệt các cạnh có thể có, kỳ vọng độ dài của nó trong đáp án là tích của độ dài cạnh với xác suất nó nằm trong đáp án. </p>
<p>Xét hai đỉnh thứ <span class="arithmatex">\(i\)</span> và <span class="arithmatex">\(j\)</span> trong input, xác suất chọn ra được cả hai đỉnh là <span class="arithmatex">\(\frac{1}{4}\)</span>. Ta có thể thấy cạnh này (nối hai đỉnh thứ <span class="arithmatex">\(i\)</span> và <span class="arithmatex">\(j\)</span> trong input) sẽ chia đa giác ra làm hai phần, thì ở đây, để chọn ra được một đa giác nào đó, ta cần chọn thêm (ít nhất một) đỉnh ở một trong hai phần, và hoàn toàn bỏ qua phần còn lại. Ta sẽ xem một phần có <span class="arithmatex">\(j - i - 1\)</span> đỉnh (<span class="arithmatex">\(j &gt; i\)</span>) và phần còn lại có <span class="arithmatex">\(n - (j - i + 1)\)</span> đỉnh. Vây xác suất để cạnh này nằm trong đa giác là</p>
<div class="arithmatex">\[P = \frac{1}{4} \cdot \left( \left(\frac{1}{2}\right)^{j-i+1} \cdot \frac{2^{n-(j-i+1)} - 1}{ 2^{n-(j-i+1)} } + \left(\frac{1}{2}\right)^{n-(j-i+1)} \cdot \frac{2^{j-i+1} - 1 }{2^{j-i+1} } \right)\]</div>
<p>Ok, ta đã giải được nhưng cách này tốn <span class="arithmatex">\(O(N^2)\)</span>. Với <span class="arithmatex">\(N\)</span> lớn, ta cần để ý rằng với <span class="arithmatex">\(i\)</span> và <span class="arithmatex">\(j\)</span> nằm quá xa nhau (<span class="arithmatex">\(j - i + 1 &gt; 60\)</span>), <span class="arithmatex">\(\left(\frac{1}{2}\right)^{j-i+1}\)</span> sẽ rất rất nhỏ. Cho nên ở đây, với mỗi <span class="arithmatex">\(i\)</span>, <strong>ta chỉ cần duyệt các <span class="arithmatex">\(j\)</span> cách nó trong tầm <span class="arithmatex">\(60\)</span> đơn vị là được</strong>. Cho nên ta có thể giải như cách trên nhưng bỏ qua các xác suất quá nhỏ, trong <span class="arithmatex">\(O(N)\)</span>. Thêm một điểm nữa, ta không xét lại các cặp <span class="arithmatex">\((i, j)\)</span> đã xét nhé, khi <span class="arithmatex">\(N\)</span> nhỏ rất có thể ta sẽ xét các cặp trùng nhau.</p>
<p><strong>Với bài Randomizer</strong>, đầu tiên ta cần biết chút về <a href="https://en.wikipedia.org/wiki/Pick%27s_theorem"><strong>định lý Pick</strong></a>. Giả sử ta có một đa giác trên hệ toạ độ <span class="arithmatex">\(Oxy\)</span>, với các đỉnh của nó có hoành độ và tung độ là số nguyên. Gọi <span class="arithmatex">\(i\)</span> là số các đỉnh có toạ độ nguyên nằm hoàn toàn trong đa giác, gọi <span class="arithmatex">\(b\)</span> là số đỉnh có toạ độ nguyên nằm trên đa giác (nằm trên cả đỉnh và cạnh). Định lý Pick cho ta công thức tính diện tích <span class="arithmatex">\(A\)</span> của đa giác là</p>
<div class="arithmatex">\[A = i + \frac{b}{2} - 1\]</div>
<p>Từ đó ta sẽ có:</p>
<div class="arithmatex">\[i = A - \frac{b}{2} + 1\]</div>
<p>Rõ ràng ta cần tính <span class="arithmatex">\(E(i)\)</span>. Theo kỳ vọng tuyến tính, ta sẽ có như sau:</p>
<div class="arithmatex">\[\begin{align}
E(i) &amp;= E(A - \frac{b}{2} + 1)\\
&amp;= E(A) - \frac{E(b)}{2} + 1\\
\end{align}\]</div>
<p>Ta cùng tính kỳ vọng các đỉnh trên cạnh trước. Với một cạnh nối đỉnh <span class="arithmatex">\((0, 0)\)</span> và đỉnh <span class="arithmatex">\((x, y)\)</span>, ta có thể tính số đỉnh nguyên trên cạnh là <span class="arithmatex">\(GCD(x, y) + 1\)</span>. Nhưng để cho đơn giản, ta sẽ không tính một trong hai đầu mút của cạnh. Lý do ở đây là khi tạo thành một đa giác, số đỉnh nằm trên các cạnh
chính là tổng trên các cạnh riêng lẻ nhưng không tính một trong hai đầu mút. Bạn có thể vẽ ra để thấy. Ở đây, vì tổng các đỉnh nằm trên cạnh sẽ bằng tổng trên các cạnh riêng lẻ, nên theo kỳ vọng tuyến tính, ta có thể tính kỳ vọng số đỉnh nằm trên mỗi cạnh có thể tạo thành. </p>
<p>Xét cạnh nối hai đỉnh <span class="arithmatex">\(i\)</span> và <span class="arithmatex">\(j\)</span> (<span class="arithmatex">\(i &lt; j\)</span>), ta cần tính xác suất cạnh này xuất hiện trong một đa giác nào đó. Không gian mẫu của việc chọn một đa giác ít nhất 3 đỉnh là sẽ là <span class="arithmatex">\(2^n - 1 - n - \frac{n(n-1)}{2}\)</span>. Điều này là vì ta cần chọn ít nhất 3 đỉnh nên phải loại các trường hợp chọn 0, 1 và 2 đỉnh ra. Để hai đỉnh được chọn trở thành cạnh thì một trong hai phía phải không có đỉnh nào, ta chọn xoá phía có <span class="arithmatex">\(j - i - 1\)</span> đỉnh, số cách chọn sẽ là <span class="arithmatex">\(2^{n - (j - i - 1 + 2)} - 1 = 2^{n - (j - i) + 1} - 1\)</span>. Ta xoá một phía để không phải xử lý phía còn lại nếu chọn phải cặp <span class="arithmatex">\((j, i)\)</span> về sau.
Tuy nhiên, tương tự bài trên, khi <span class="arithmatex">\(j - i &gt; 60\)</span> thì xác suất này sẽ trở nên rất nhỏ, nên ta chỉ cần xét các cặp cách nhau không quá 60 là được.</p>
<p>Như vậy xác suất để chọn ra một cạnh chứa hai đỉnh, đỉnh thứ <span class="arithmatex">\(i\)</span> và đỉnh thứ <span class="arithmatex">\(i + k\)</span> là:</p>
<div class="arithmatex">\[\frac{2^{n-k-1} - 1 }{2^n - 1 - n - \frac{n(n-1)}{2} } = \frac{1 - \frac{1}{2^{n - k - 1} } }{2^{k+1} - (n^2 + n + 2) \cdot \frac{1}{2^{n-k} } }\]</div>
<p>Lưu ý, biểu thức phía sau là để dễ tính hơn khi code.</p>
<p>Thế còn diện tích thì sao? Khi các đỉnh <span class="arithmatex">\((x_i, y_i)\)</span> được sắp xếp theo chiều ngược chiều kim đồng hồ, ta tính được diện tích của đa giác tạo bởi nó như sau:</p>
<div class="arithmatex">\[S = \frac{1}{2} \cdot (x_1y_2 - x_2y_1 + x_2y_3 - x_3y_2 + \ldots + x_{n-1}y_{n} - x_{n}y_{n-1} + x_{n}y_{1} - x_{1}y_{n})\]</div>
<p>Đây là công thức tính diện tích dựa trên tích có hướng. Vì sao nó đúng thì bạn có thể xem ở <a href="https://math.stackexchange.com/questions/492407/area-of-an-irregular-polygon">đây</a>. Về cơ bản, với cạnh <span class="arithmatex">\((i, j)\)</span> (<span class="arithmatex">\(j\)</span> nằm sau <span class="arithmatex">\(i\)</span> theo chiều kim đồng hồ), nó sẽ thêm vào đáp án (không tính phần chia 2), một khoảng là <span class="arithmatex">\(x_iy_j - x_jy_i\)</span>. Đến đây thì theo kỳ vọng tuyến tính thì bạn cũng có thể làm tương tự như trên với cùng xác suất.</p>
</details>
<h3 id="bai-7_1">Bài 7</h3>
<p>Cho <span class="arithmatex">\(N\)</span> điểm (<span class="arithmatex">\(B \le 200\)</span> hay <span class="arithmatex">\(N \le 2000\)</span>), không có 3 điểm thẳng hàng. Mỗi điểm biến mất với xác suất 50%. Tìm kỳ vọng kích thước bao lồi của các điểm còn lại (Kích thước bao lồi là số đỉnh của bao lồi).</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Tình cờ là trong một đa giác lồi, số đỉnh bằng số cạnh của đa giác đó (không tính trường hợp có một hoặc hai đỉnh được chọn, bạn có thể xử lý riêng hai trường hợp này). Nên kỳ vọng số đỉnh của bao lồi cũng sẽ là kỳ vọng số cạnh của bao lồi. Mà như bài 6 thì với mỗi cạnh, đường thẳng ứng với cạnh sẽ chia mặt phẳng ra làm 2 phần, trái (<span class="arithmatex">\(L\)</span>) và phải (<span class="arithmatex">\(R\)</span>). Xác suất để cạnh <span class="arithmatex">\(ij\)</span> đó nằm trong bao lồi (có ít nhất 3 đỉnh là):</p>
<div class="arithmatex">\[P_{ij} = \frac{1}{4} \cdot \left( (\frac{1}{2})^L \cdot \frac{2^R-1}{2^R} + (\frac{1}{2})^R \cdot \frac{2^L-1}{2^L} \right)\]</div>
<p>Để tính <span class="arithmatex">\(L\)</span> và <span class="arithmatex">\(R\)</span> thì bạn có thể làm cách trâu với <span class="arithmatex">\(O(N^3)\)</span>, hoặc với <span class="arithmatex">\(O(N^2 \log N)\)</span> bằng cách sau, với mỗi đỉnh <span class="arithmatex">\(i\)</span>, sắp xếp các đỉnh còn lại theo góc và duyệt <span class="arithmatex">\(j\)</span> theo góc, như vậy <span class="arithmatex">\(L\)</span> và <span class="arithmatex">\(R\)</span> sẽ không cần phải tính lại.</p>
<p>Một cách giải khác cho bài này là với mỗi đỉnh, ta tính xác suất của đỉnh đó trở thành một đỉnh trên bao lồi (cũng là kỳ vọng luôn), mà cách này thì hơi khó một tí, ta sẽ không bàn đến ở đây.</p>
</details>
<h3 id="bai-8_1">Bài 8</h3>
<p>Cho dãy độ dài <span class="arithmatex">\(N\)</span> (<span class="arithmatex">\(N \le 2000\)</span> hay <span class="arithmatex">\(N \le 10^5\)</span>). Ta sẽ thực hiện thao tác sau <span class="arithmatex">\(N-1\)</span> lần: xoá phần tử đầu hoặc cuối, xác suất 50% đầu và 50% cuối. Tìm kỳ vọng giá trị của số còn lại.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Dễ thấy kỳ vọng giá trị của số còn lại bằng tổng kỳ vọng từng số xuất hiện trong đáp án. Hay nói cách khác, <span class="arithmatex">\(E = \sum_{i} P_i \cdot a_i\)</span>. Trong đó <span class="arithmatex">\(P_i\)</span> là xác suất mà số thứ <span class="arithmatex">\(i\)</span> được chọn. Vậy làm sao tính được số này, gọi <span class="arithmatex">\(L\)</span> là số số bên trái <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(R\)</span> là số số bên phải <span class="arithmatex">\(i\)</span>. Thì số cách xoá để sau cùng có được <span class="arithmatex">\(i\)</span> là <span class="arithmatex">\(\binom{L+R}{L}\)</span>, nghía là ta tiến hành xoá <span class="arithmatex">\(L + R\)</span> lần, trong đó có <span class="arithmatex">\(L\)</span> lần xoá bên trái. Với <span class="arithmatex">\(i\)</span> thì ta đã biết <span class="arithmatex">\(L\)</span> và <span class="arithmatex">\(R\)</span> là bao nhiêu rồi, nên <span class="arithmatex">\(P_i = \frac{\binom{N-1}{i-1}}{2^{N-1}}\)</span>. Xác suất này có phần tử số hơi lớn nên bạn cần cẩn thận khi code.</p>
</details>
<h2 id="ly-thuyet-ky-vong-phan-2">Lý thuyết kỳ vọng, phần 2</h2>
<p>Tung một con xúc xắc 6 mặt. Nhớ rằng, kỳ vọng bình phương của số trên xúc xắc khác bới bình phương của kỳ vọng:</p>
<div class="arithmatex">\[E(X^2) = \frac{1 + 4 + 9 + 16 + 25 + 36}{6} = 15.1666...\]</div>
<div class="arithmatex">\[E(X)^2 = (\frac{1 + 2 + 3 + 4 + 5 + 6}{6})^2 = 3.5^2 = 12.25\]</div>
<p>Hai biến cố gọi là <em>độc lập</em> khi kết quả của một biến cố không ảnh hưởng đến phân bố xác suất của biến cố còn lại. Kết quả tung hai xúc xắc (hoặc tung một xúc xắc hai lần) là độc lập, nhưng lượng mưa và sức gió thì phụ thuộc nhau. Tuy nhiên, tính tuyến tính thì luôn đúng:</p>
<div class="arithmatex">\[E(X + Y) = E(X) + E(Y)\]</div>
<p>Công thức quan trọng khác là <span class="arithmatex">\(E(X \cdot Y) = E(X) \cdot E(Y)\)</span> chỉ đúng với biến cố <strong>độc lập</strong>. Nên kỳ vọng của tích các số sau hai lần tung xúc xắc là <span class="arithmatex">\(3.5^2\)</span>, nhưng không thể sử dụng <span class="arithmatex">\(E(X \cdot X) = E(X) \cdot E(X)\)</span>, vì <span class="arithmatex">\(X\)</span> và <span class="arithmatex">\(X\)</span> không độc lập.</p>
<h2 id="ordered-pairs-giai-thich-binh-phuong">Ordered pairs (giải thích bình phương)</h2>
<p>Bình phương kích thước của một tập bằng với số <strong>ordered pairs</strong> của các phần tử trong tập. Nên ta có thể duyệt các cặp và với mỗi cặp ta tính góp của nó vào kết quả.</p>
<p>Cụ thể, gọi <span class="arithmatex">\(X_i\)</span> là biến ngẫu nhiên nào đó cho một biến cố <span class="arithmatex">\(i\)</span> nào đó. Ta muốn tìm kỳ vọng của bình phương của tổng tất cả các biến ngẫu nhiên này, hay nói cách khác, ta cần tính <span class="arithmatex">\(E[(X_1 + X_2 + X_3 + \ldots + X_N)^2]\)</span>.</p>
<p>Theo kỳ vọng tuyến tính, ta lại có:</p>
<div class="arithmatex">\[\begin{align}
E[(X_1 + X_2 + X_3 + \ldots + X_N)^2] &amp;= E[(X_1 + X_2 + X_3 + \ldots + X_N) \cdot (X_1 + X_2 + X_3 + \ldots + X_N)]\\
&amp;= E[X_1 \cdot X_1 + \ldots + X_1 \cdot X_N + X_2 \cdot X_1 + \ldots + X_2 \cdot X_N + \ldots + X_N \cdot X_1 + \ldots + X_N \cdot X_N]\\
&amp;= E[X_1 \cdot X_1] + \ldots + E[X_1 \cdot X_N] + E[X_2 \cdot X_1] + \ldots + E[X_2 \cdot X_N] + \ldots + E[X_N \cdot X_1] + \ldots + E[X_N \cdot X_N]\\
\end{align}\]</div>
<p>Như vậy ta có thể tính kỳ vọng của mỗi cặp và góp vào kết quả.</p>
<p>Tương tự, mũ <span class="arithmatex">\(k\)</span> thì bằng số dãy độ dài <span class="arithmatex">\(k\)</span>, ta có thể làm giống như trên là tính kỳ vọng của mỗi bộ tích <span class="arithmatex">\(k\)</span> phần tử và góp nó vào kết quả.</p>
<h2 id="ky-thuat-mu">Kỹ thuật mũ</h2>
<p>Nếu muốn duy trì tổng các số mũ <span class="arithmatex">\(k\)</span>, ta cần duy trì tổng các số mũ nhỏ hơn. Ví dụ, tổng của các mũ <span class="arithmatex">\(0\)</span>, mũ <span class="arithmatex">\(1\)</span> và mũ <span class="arithmatex">\(2\)</span> lần lượt là <span class="arithmatex">\(S_0\)</span>, <span class="arithmatex">\(S_1\)</span> và <span class="arithmatex">\(S_2\)</span>, và nếu tăng mỗi phần tử lên <span class="arithmatex">\(x\)</span>. Các tổng mới sẽ là <span class="arithmatex">\(S_0\)</span>, <span class="arithmatex">\(S_1 + S_0 \cdot x\)</span> và <span class="arithmatex">\(S_2 + 2 \cdot x \cdot S_1 + x^2 \cdot S_0\)</span>. Ta sẽ tập trung vào kỹ thuật "ordered pairs".</p>
<h2 id="cac-bai-tap">Các bài tập</h2>
<h3 id="bai-1_2">Bài 1</h3>
<p>Giá của một chiếc TV là 1000 đô. Trong <span class="arithmatex">\(N\)</span> ngày tiếp theo, mỗi ngày giá của TV tăng 1% hoặc 2% (xác suất như nhau là 50%). Tính kỳ vọng giá TV sau <span class="arithmatex">\(N\)</span> ngày.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ta có công thức tính giá TV sẽ là <span class="arithmatex">\(1000 \cdot (1 + \Delta_1) \cdot (1 + \Delta_2) \cdot (1 + \Delta_3) \ldots\)</span>. Với <span class="arithmatex">\(\Delta_i\)</span> là phần trăm giá tăng vào ngày thứ <span class="arithmatex">\(i\)</span></p>
<p>Nếu tính theo giá, ta thấy số tiền tăng lên sẽ phụ thuộc vào giá hiện tại của chiếc TV. Tuy nhiên, nếu xét việc tăng của giá TV, thì biến cố này cho các ngày khác nhau lại độc lập với nhau. Ta dễ dàng tính được kỳ vọng phần trăm giá tăng của TV là <span class="arithmatex">\(0.01 \cdot 0.5 + 0.02 \cdot 0.5 = 0.015\)</span> hay 1.5%.</p>
<p>Như vậy, sau <span class="arithmatex">\(N\)</span> ngày, kỳ vọng giá của TV sẽ là <span class="arithmatex">\(E = 1000 \cdot (1 + 0.015)^N\)</span>.</p>
</details>
<h3 id="bai-2_2">Bài 2</h3>
<p>Bạn mua <span class="arithmatex">\(N\)</span> (<span class="arithmatex">\(N \le 10^5\)</span>) vé số. Cái thứ <span class="arithmatex">\(i\)</span> có xác suất trúng là <span class="arithmatex">\(p_i\)</span>. Biến cố độc lập (quan trọng!). Tìm kỳ vọng bình phương số vé thắng.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Gọi <span class="arithmatex">\(X_i\)</span> là biến ngẫu nhiên cho biến cố vé số thứ <span class="arithmatex">\(i\)</span> trúng thưởng. Như vậy <span class="arithmatex">\(E[X_i]\)</span> sẽ là kỳ vọng vé số <span class="arithmatex">\(i\)</span> trúng thưởng. Do đây là biến ngẫu nhiên chỉ báo nên <span class="arithmatex">\(E[X_i] = p_i\)</span> tức là kỳ vọng cũng là xác suất vé <span class="arithmatex">\(i\)</span> trúng thưởng.</p>
<p>Ta có kết quả cần tìm sẽ là <span class="arithmatex">\(E[(X_1 + X_2 + X_3 + \ldots + X_N)^2]\)</span>. Khai triển ra như trong phần giải thích Ordered pairs thì ta sẽ cần phải tính tổng tất cả các <span class="arithmatex">\(E[X_i \cdot X_j]\)</span> với mọi <span class="arithmatex">\(i\)</span> và <span class="arithmatex">\(j\)</span>. Có 2 trường hợp xảy ra:</p>
<ol>
<li>Khi <span class="arithmatex">\(i \ne j\)</span>, ta cũng biết rằng các biến cố <span class="arithmatex">\(X_i\)</span> và <span class="arithmatex">\(X_j\)</span> độc lập với nhau, nên <span class="arithmatex">\(E[X_i \cdot X_j] = E[X_i] \cdot E[X_j] = p_i \cdot p_j\)</span>.</li>
<li>Khi <span class="arithmatex">\(i = j\)</span>, ta biết rằng <span class="arithmatex">\(X_i\)</span> và <span class="arithmatex">\(X_i\)</span> không độc lập với nhau, ở đây đơn giản là <span class="arithmatex">\(E[X_i \cdot X_i] = p_i\)</span>. Vì kỳ vọng cho vé <span class="arithmatex">\(i\)</span> trúng và vé <span class="arithmatex">\(i\)</span> cũng trúng đều quy về một khả năng.</li>
</ol>
<p>Nói thêm một chút để đỡ nhầm lẫn, ta thấy rằng <span class="arithmatex">\(E[X_i \cdot X_i] = E[X_i^2] = p_i * 1^2\)</span>, nghĩa là xác suất có được biến cố vẫn là <span class="arithmatex">\(p_i\)</span>, và giá trị nhận được là <span class="arithmatex">\(1^2 = 1\)</span>. Bạn sẽ hiểu rõ vấn đề khi giải bài <a href="https://codeforces.com/gym/100371/problem/H">Codeforces - A granite of science</a>.</p>
<p>Gọi <span class="arithmatex">\(S = p_1 + p_2 + \ldots + p_N\)</span>. Như vậy <span class="arithmatex">\(E[(X_1 + X_2 + X_3 + \ldots + X_N)^2] = \sum_i (p_i \cdot S - p_i^2 + p_i)\)</span>. Ta có thể tính kết quả này trong <span class="arithmatex">\(O(N)\)</span>.</p>
<p>Nếu bạn muốn gọn hơn, ta gọi thêm <span class="arithmatex">\(S_2 = p_1^2 + p_2^2 + \ldots + p_N^2\)</span>. Ta sẽ được <span class="arithmatex">\(E = S^2 - S_2 + S\)</span>. Kết quả này cũng có thể được tính trong <span class="arithmatex">\(O(N)\)</span>.</p>
</details>
<h3 id="bai-3_2">Bài 3</h3>
<p>Tương tự bài 2 nhưng tìm kỳ vọng của mũ 3 hoặc 4.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Tuơng tự bài trên, việc của ta sẽ làm là với mỗi bộ 3 <span class="arithmatex">\(\{i, j, k\}\)</span>, ta góp <span class="arithmatex">\(p_i \cdot p_j \cdot p_k\)</span> vào kết quả, ta có các trường hợp đặc biệt sau:</p>
<ul>
<li>Nếu <span class="arithmatex">\(i = j = k\)</span>, ta chỉ góp <span class="arithmatex">\(p_i\)</span> vào kết quả.</li>
<li>Nếu <span class="arithmatex">\(i = j \ne k\)</span>, ta góp <span class="arithmatex">\(p_i \cdot p_k\)</span> vào kết quả.</li>
<li>Nếu <span class="arithmatex">\(i = k \ne j\)</span>, ta góp <span class="arithmatex">\(p_i \cdot p_j\)</span> vào kết quả.</li>
<li>Nếu <span class="arithmatex">\(k = j \ne i\)</span>, ta góp <span class="arithmatex">\(p_i \cdot p_k\)</span> vào kết quả.</li>
<li>Tổng quát thì nếu có nhiều phần tử giống nhau (về vị trí), ta chỉ dùng 1 lần phần tử đó.</li>
</ul>
<p>Bây giờ gọi lần lượt:</p>
<ul>
<li><span class="arithmatex">\(S = p_1 + p_2 + \ldots + p_N\)</span></li>
<li><span class="arithmatex">\(S_2 = p_1^2 + p_2^2 + \ldots + p_N^2\)</span></li>
<li><span class="arithmatex">\(S_3 = p_1^3 + p_2^3 + \ldots + p_N^3\)</span>.</li>
</ul>
<p>Giờ ta sẽ duyệt <span class="arithmatex">\(i\)</span> và <span class="arithmatex">\(j\)</span>, ta có hai trường hợp sau:</p>
<ul>
<li>Nếu <span class="arithmatex">\(i = j\)</span>, ta sẽ góp vào tổng là <span class="arithmatex">\(p_i \cdot (S - p_i) + p_i\)</span> <strong>(1)</strong>. Lý do là vì sẽ có trường hợp <span class="arithmatex">\(k = i\)</span>, khi đó <span class="arithmatex">\(i = j = k\)</span>, nên ta chỉ thêm <span class="arithmatex">\(p_i\)</span>, còn lại <span class="arithmatex">\(i = j \ne k\)</span>, nên ta thêm <span class="arithmatex">\(p_i \cdot (S - p_i)\)</span> vào tổng.</li>
<li>Nếu <span class="arithmatex">\(i \ne j\)</span>, ta sẽ góp vào tổng là <span class="arithmatex">\(p_i \cdot p_j \cdot (S - p_i - p_j) + 2 \cdot p_i \cdot p_j\)</span> <strong>(2)</strong>. Giải thích thì cũng tương tự như trên nhưng ở đây <span class="arithmatex">\(k\)</span> có thể bằng <span class="arithmatex">\(i\)</span> hoặc <span class="arithmatex">\(j\)</span> nên ta có <span class="arithmatex">\(2 \cdot p_i \cdot p_j\)</span>.</li>
</ul>
<p>Đến đây thì ta sẽ có kết quả là:</p>
<div class="arithmatex">\[p_i \cdot p_j \cdot (S - p_i - p_j) + 2 \cdot p_i \cdot p_j + p_i \cdot (S - p_i) + p_i\]</div>
<p>Ta có thể tính tổng này trong <span class="arithmatex">\(O(N^2)\)</span>. Tuy nhiên như thế vẫn chưa đủ.</p>
<p>Xét phần <strong>(1)</strong>: <span class="arithmatex">\(p_i \cdot (S - p_i) + p_i\)</span>. Phần này không phụ thuộc <span class="arithmatex">\(j\)</span> nên ta có thể tính thẳng ra tổng sau cùng, nó sẽ giống như bài 2 ở trên và tổng đó sẽ là <span class="arithmatex">\(S^2 + S - S_2\)</span>.</p>
<p>Xét phần <strong>(2)</strong>: <span class="arithmatex">\(p_i \cdot p_j \cdot (S - p_i - p_j) + 2 \cdot p_i \cdot p_j\)</span>. Bỏ hết ngoặc đi thì ta sẽ được</p>
<div class="arithmatex">\[p_i \cdot p_j \cdot S - p_i^2 \cdot p_j - p_i \cdot p_j^2 + 2 \cdot p_i \cdot p_j\]</div>
<p>Tính tổng hết các <span class="arithmatex">\(p_j\)</span> để loại bỏ biến này thì ta có, lưu ý thêm là <span class="arithmatex">\(i \ne j\)</span> trong trường hợp này:</p>
<div class="arithmatex">\[S \cdot p_i \cdot (S - p_i) - p_i^2 \cdot (S - p_i) - p_i \cdot (S_2 - p_i^2) + 2 \cdot p_i \cdot (S - p_i)\]</div>
<p>Mở ngoặc ra thì ta có:</p>
<div class="arithmatex">\[S^2 \cdot p_i - S \cdot p_i^2 - S \cdot p_i^2 + p_i^3 - S_2 \cdot p_i + p_i^3 + 2 \cdot S \cdot p_i - 2 \cdot p_i^2\]</div>
<p>Thu gọn lại thì ta có:</p>
<div class="arithmatex">\[2 \cdot p_i^3 - (2S + 2) \cdot p_i^2 + (S^2 + 2S - S_2) \cdot p_i\]</div>
<p>Tính tổng hết các <span class="arithmatex">\(p_i\)</span> để loại bỏ biến này thì ta được:</p>
<div class="arithmatex">\[2S_3 - (2S + 2) \cdot S_2 + (S^2 + 2S - S_2) \cdot S\]</div>
<p>Như vậy kết quả tổng cộng sẽ là</p>
<div class="arithmatex">\[S^2 + S - S_2 + 2S_3 - (2S + 2) \cdot S_2 + (S^2 + 2S - S_2) \cdot S\]</div>
<p>Và bạn có thể tính cái này trong <span class="arithmatex">\(O(N)\)</span>.</p>
<p>Việc giải sẽ phức tạp hơn khi ta cần tính mũ 4, hay thậm chí đến mũ <span class="arithmatex">\(k\)</span>, nhưng vẫn có thể giải được.</p>
</details>
<h3 id="bai-4_2">Bài 4</h3>
<p>Có <span class="arithmatex">\(N\)</span> (<span class="arithmatex">\(N \le 50\)</span>) bóng đèn và <span class="arithmatex">\(M\)</span> (<span class="arithmatex">\(M \le 50\)</span>) công tắc. Với mỗi công tắc, ta biết các bóng đèn kết nối với nó (nghĩa là khi gạt công tắc, các bóng đèn sáng thì tắt, tắt thì sáng). Tất cả các bóng đều đang tắt, và ta gạt các công tắc với xác suất 50%. Tìm kỳ vọng của mũ 3 số các bóng đèn bật.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Gọi <span class="arithmatex">\(X_i\)</span> là biến cố bóng đèn thứ <span class="arithmatex">\(i\)</span> sáng. Như vậy kỳ vọng số bóng đèn sáng sau cùng sẽ là <span class="arithmatex">\(E[X_1 + X_2 + \ldots + X_N]\)</span>. Tuy nhiên ở đây ta cần tìm kỳ vọng của mũ 3, nghĩa là <span class="arithmatex">\(E[(X_1 + X_2 + \ldots + X_N)^3]\)</span>.</p>
<p>Như trong bài trên thì ta đã biết là kỳ vọng ở trên sẽ là tổng các <span class="arithmatex">\(E[X_i \cdot X_j \cdot X_k]\)</span>, nghĩa là kỳ vọng bóng đèn <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(j\)</span> và <span class="arithmatex">\(k\)</span> đều sáng, cũng là xác suất các bóng đèn này đều sáng (do là biến ngẫu nhiên chỉ báo). Ta duyệt mỗi bộ ba này trong <span class="arithmatex">\(O(N^3)\)</span>.</p>
<p>Với mỗi bộ ba, ta cần tính xác suất các bóng đèn trong bộ ba này đều sáng. Ta gọi <span class="arithmatex">\(dp[x][y][z]\)</span> là xác suất để đạt được trạng thái <span class="arithmatex">\((x, y, z)\)</span> với <span class="arithmatex">\(0 \le x, y, z \le 1\)</span>, ứng lần lượt với bóng đèn thứ <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(j\)</span> và <span class="arithmatex">\(k\)</span>, trong đó <span class="arithmatex">\(0\)</span> là trạng thái tắt, <span class="arithmatex">\(1\)</span> là trạng thái sáng. Ban đầu ta có <span class="arithmatex">\(dp[0][0][0] = 1\)</span>, do cả ba bóng đèn ban đầu đều tắt. Với mỗi công tắc, ta sẽ cập nhật mảng <span class="arithmatex">\(dp\)</span> này (lưu ý là từ mảng <span class="arithmatex">\(dp\)</span> cũ bạn phải tính vào một mảng <span class="arithmatex">\(dp\)</span> mới nhé, vì trước khi xử lý công tắc và sau khi xử lý công tắc là hai trạng thái khác nhau). Ta duyệt hết <span class="arithmatex">\(M\)</span> công tắc và tính toán trong <span class="arithmatex">\(O(M)\)</span>.</p>
<p>Cuối cùng <span class="arithmatex">\(E[X_i \cdot X_j \cdot X_k] = dp[1][1][1]\)</span>. Ta giải được bài này trong <span class="arithmatex">\(O(N^3 \cdot M)\)</span>.</p>
</details>
<h3 id="bai-5_2">Bài 5</h3>
<p>Cho dãy số <span class="arithmatex">\(a\)</span> độ dài <span class="arithmatex">\(N\)</span> (<span class="arithmatex">\(N \le 10^5\)</span>), tính tổng <span class="arithmatex">\(sum \cdot len^3\)</span> trên tất cả các đoạn con. In ra đáp án lấy dư với <span class="arithmatex">\(10^9 + 7\)</span>.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ta có thể sử dụng kỹ thuật "góp vào tổng" cho bài này. Nghĩa là, với mỗi độ dài <span class="arithmatex">\(len\)</span>, ta tính tổng <span class="arithmatex">\(sum\)</span> của tất cả các đoạn con độ dài như thế, rồi lấy tích <span class="arithmatex">\(sum \cdot len^3\)</span>, thêm vào kết quả.</p>
<p>Đầu tiên <span class="arithmatex">\(len = 1\)</span>, <span class="arithmatex">\(sum_1\)</span> ở đây sẽ là <span class="arithmatex">\(\sum_{i=1}^N a_i\)</span>.</p>
<p>Tiếp theo <span class="arithmatex">\(len = 2\)</span>, ta thấy mỗi đoạn con trước đó cần thêm giá trị phía bên phải của đoạn, trừ đoạn con cuối cùng (đoạn chứa <span class="arithmatex">\(a_N\)</span>, vì không thể kéo dài đoạn này, ta phải bỏ nó đi), vậy <span class="arithmatex">\(sum_2 = sum_1 + \sum_{i=2}^N a_i - \sum_{i=N}^N a_i\)</span>.</p>
<p>Tiếp theo <span class="arithmatex">\(len = 3\)</span>, ta thấy mỗi đoạn con trước đó cần thêm giá trị phía bên phải của đoạn, trừ đoạn con cuối cùng (đoạn chứa <span class="arithmatex">\(a_{N-1} và a_N\)</span>, vì không thể kéo dài đoạn này, ta phải bỏ nó đi), vậy <span class="arithmatex">\(sum_3 = sum_2 + \sum_{i=3}^N a_i - \sum_{i=N-1}^N a_i\)</span>.</p>
<p>Và cứ như thế, tổng quát thì <span class="arithmatex">\(sum_j = sum_{j-1} + \sum_{i=j}^N a_i - \sum_{i=N-j+2}^N a_i\)</span>.</p>
<p>Ta có thể tính các tổng tiền tố và hậu tố trong <span class="arithmatex">\(O(N)\)</span>.</p>
<p>Vậy ta có thể tính bài này trong <span class="arithmatex">\(O(N)\)</span>.</p>
</details>
<h3 id="bai-6_2">Bài 6</h3>
<p>Cho một cây <span class="arithmatex">\(N\)</span> đỉnh (<span class="arithmatex">\(N \le 10^5\)</span>) và số nguyên <span class="arithmatex">\(k\)</span> (<span class="arithmatex">\(k \le 10\)</span>). Tìm tổng của <span class="arithmatex">\(\text{kích thước}^k\)</span> của tất cả các đồ thị con liên thông. In đáp án lấy dư với <span class="arithmatex">\(10^9+7\)</span>.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ta bắt đầu với hướng là với mỗi kích thước đồ thị con liên thông, tìm số các đồ thị con có kích thước như vậy. Tuy nhiên làm thế rất là khó và ta sẽ không đi theo hướng này.</p>
<p>Cái ta cần là <span class="arithmatex">\(size^k\)</span>, ví dụ <span class="arithmatex">\(size = 3\)</span>, <span class="arithmatex">\(k = 5\)</span> và ta có 3 node trong đồ thị con liên thông là A, B, C. Thì với hiểu biết ở trên về mũ, ta cần thêm số đồ thị con liên thông chứa AAAAA, AAAAB, AAAAC, AAABA, ...., CCCCC. Vì vậy nên ta có thể đổi bài toán này thành, tìm số cách chọn một đồ thị con liên thông và chọn <span class="arithmatex">\(k\)</span> node trong cái đồ thị con liên thông này, vì mỗi dãy <span class="arithmatex">\(k\)</span> phần tử sẽ góp <span class="arithmatex">\(1\)</span> vào đáp án.</p>
<p>Ta sẽ cần duy trì một mảng <span class="arithmatex">\(dp[v][i]\)</span>, trong đó <span class="arithmatex">\(v\)</span> là gốc của cây con đang xét, <span class="arithmatex">\(i\)</span> là số node được chọn trong cây con này (không cần phải là <span class="arithmatex">\(i\)</span> node khác nhau). Mảng này có nghĩa là số cách chọn ra <span class="arithmatex">\(i\)</span> node (không cần phân biệt) trong một đồ thị con liên thông nào đó trong cây con gốc <span class="arithmatex">\(v\)</span>.</p>
<p>Xét node cha <span class="arithmatex">\(u\)</span> của <span class="arithmatex">\(v\)</span>, giả sử <span class="arithmatex">\(v\)</span> là node con đầu tiên của <span class="arithmatex">\(u\)</span> theo thứ tự các node con của <span class="arithmatex">\(u\)</span> khi DFS, và ta đã có các <span class="arithmatex">\(dp[v][i]\)</span>, việc ta cần làm là thêm node <span class="arithmatex">\(u\)</span> vào đây, hoặc không thêm. Nếu thêm, ta có thể thêm nhiều node <span class="arithmatex">\(u\)</span> chứ không phải chỉ một lần, vì thế với mỗi <span class="arithmatex">\(dp[v][i]\)</span> ta có thể thêm kết quả cho <span class="arithmatex">\(dp[u][i]\)</span>, dp[u][i+1], dp[u][i+2], \ldots$. Nếu thêm <span class="arithmatex">\(j\)</span> node <span class="arithmatex">\(u\)</span>, ta sẽ có <span class="arithmatex">\(\binom{i+j}{j}\)</span> cách thêm, vì ta có thể thêm vào bất kỳ vị trí nào.</p>
<p>Nếu <span class="arithmatex">\(v\)</span> không phải là node con đầu tiên, ta cần một cách để chập 2 kết quả lại với nhau, ở đây là <span class="arithmatex">\(dp[u]\)</span> hiện tại và <span class="arithmatex">\(dp[v]\)</span>. Ta xét <span class="arithmatex">\(i\)</span> node được chọn trong cây gốc <span class="arithmatex">\(u\)</span> hiện tại, và <span class="arithmatex">\(j\)</span> node được chọn trong cây gốc <span class="arithmatex">\(v\)</span>, ta sẽ thêm vào <span class="arithmatex">\(\binom{i+j}{j}\)</span> tương tự như trên để tính <span class="arithmatex">\(dp[u]\)</span> mới.</p>
<p>Kết quả của bài này sẽ là <span class="arithmatex">\(dp[root][k]\)</span>, trong đó <span class="arithmatex">\(root\)</span> là node gốc của cây. Độ phức tạp của bài này sẽ tầm khoảng <span class="arithmatex">\(O(nk^2)\)</span>.</p>
</details>
<h3 id="bai-7_2">Bài 7</h3>
<p>Bài này là bài DoubleLive của TopCoder SRM 727.</p>
<p>Cho một đội quân gồm <span class="arithmatex">\(B\)</span> gấu và <span class="arithmatex">\(H\)</span> người (<span class="arithmatex">\(B, H \le 2000\)</span>). Gấu thì có 2 máu, người thì 1 máu. Đội cung thủ của địch có <span class="arithmatex">\(T\)</span> mũi tên (<span class="arithmatex">\(T \le 2 \cdot B + H\)</span>). Mỗi mũi tên tiếp theo sẽ đâm vào một trong số quân của bạn một cách ngẫu nhiên, giảm 1 máu của đối tượng đó. Nếu đối tượng còn 0 máu, đối tượng đó chết.</p>
<p>Sức mạnh đội quân được định nghĩa là <span class="arithmatex">\(\text{số gấu} \cdot \text{số người} \cdot \text{tổng số}\)</span>, ví dụ <span class="arithmatex">\(3 \cdot 7 \cdot 10 = 210\)</span> với một đội quân 3 gấu 7 người. Không quan trọng một số gấu chỉ còn 1 máu trong trường hợp này.</p>
<p>Tính kỳ vọng sức mạnh đội quân sau khi đội cung thủ địch dùng hết mũi tên của chúng.</p>
<details class="tip">
<summary>Lời giải</summary>
<p>Ta sẽ cần tính <span class="arithmatex">\(E[B \cdot H \cdot (B + H)]\)</span>, trong đó <span class="arithmatex">\(B\)</span> là số gấu sau cuộc tấn công và <span class="arithmatex">\(H\)</span> là số người sau cuộc tấn công. Ta có thể thấy rằng ta kì vọng cần tìm là tổng kì vọng khi ta chọn 1 gấu, 1 người và một trong các chiến binh còn lại (sau khi kết thúc cuộc tấn công), ở đây nó cũng là xác suất chọn ra.</p>
<p>Thử gọi <span class="arithmatex">\(dp[one][two]\)</span> là xác suất để có được <span class="arithmatex">\(one\)</span> chiến binh 1 máu (không quan tâm nó là gấu hay người), <span class="arithmatex">\(two\)</span> là số chiến binh 2 máu. Với cách này, ta có thể đi tiếp đến <span class="arithmatex">\(dp[one-1][two]\)</span> với xác suất <span class="arithmatex">\(\frac{one}{one+two}\)</span>, và đến <span class="arithmatex">\(dp[one+1][two-1]\)</span> với xác suất <span class="arithmatex">\(\frac{two}{one+two}\)</span>. Tuy nhiên, đến cuối cùng ta lại không thể phân biệt được số người và số gấu.</p>
<p>Xét một cặp người - gấu nào đó, làm sao để tính được xác suất chúng đều còn sống sau cuộc tấn công? Ta gọi <span class="arithmatex">\(dp[one][two][hp1][hp2]\)</span> là xác suất để sau cuộc tấn công, ta có <span class="arithmatex">\(one\)</span> chiến binh 1 máu, <span class="arithmatex">\(two\)</span> chiến binh 2 máu, với cặp người - gấu có số máu lần lượt là <span class="arithmatex">\(hp1\)</span> (<span class="arithmatex">\(0 \le hp1 \le 1\)</span>) và <span class="arithmatex">\(hp2\)</span> (<span class="arithmatex">\(0 \le hp2 \le 2\)</span>). Cách tính cũng tương tự như trên. Kết quả ta cần là <span class="arithmatex">\(X = dp[one][two][1][1] + dp[one][two][1][2]\)</span>, với <span class="arithmatex">\(one\)</span> và <span class="arithmatex">\(two\)</span> lúc này là sau cuộc tấn công. Do các con gấu là như nhau và người cũng như nhau, việc tính lại cho các cặp người - gấu khác là không cần thiết, vì vậy xác suất chọn ra được 1 người 1 gấu là <span class="arithmatex">\(X \cdot B \cdot H\)</span> với <span class="arithmatex">\(B\)</span>, <span class="arithmatex">\(H\)</span> là số gấu và số người ban đầu.</p>
<p>Nhưng còn tổng số chiến binh thì sao? Ta biết rằng tổng số chiến binh sẽ là <span class="arithmatex">\(one + two\)</span> sau cuộc tấn công, như vậy đáp án sẽ cần nhân thêm với <span class="arithmatex">\(one + two\)</span>. Giải thích thêm là bởi vì bạn đã đến được trạng thái với <span class="arithmatex">\(one\)</span> chiến binh 1 máu và <span class="arithmatex">\(two\)</span> chiến binh 2 máu, nên xác suất chọn ra được một trong các chiến binh còn lại sẽ là <span class="arithmatex">\(1\)</span>. Ta muốn chọn hết chúng, nên ta cần <span class="arithmatex">\(one + two\)</span> lần.</p>
<p>Độ phức tạp của bài này là <span class="arithmatex">\(O((B+H)^2)\)</span>.</p>
</details>
<h2 id="luyen-tap">Luyện tập</h2>
<table>
<thead>
<tr>
<th style="text-align: center;">Problem</th>
<th style="text-align: center;">Status</th>
<th style="text-align: center;">Submission</th>
<th style="text-align: center;">Code</th>
<th style="text-align: center;">Date</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/454/problem/C">Codeforces - Little Pony and Expected Maximum</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/454/submission/206315938">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF454-D2-C.cpp">Code</a></td>
<td style="text-align: center;">18/05/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codingcompetitions.withgoogle.com/kickstart/round/0000000000201d27/0000000000201b7b">Google Kickstart 2017 Round B - Math Encoder</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Google%20Kickstart/Kickstart%2017-RB-A.cpp">Code</a></td>
<td style="text-align: center;">30/05/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/817/problem/D">Codeforces - Imbalanced Array</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/817/submission/206312731">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF817-D12-D.cpp">Code</a></td>
<td style="text-align: center;">18/05/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/problemset/problem/559/D">Codeforces - Randomizer</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/559/submission/207844971">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF559-D1-D.cpp">Code</a></td>
<td style="text-align: center;">30/05/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/problemset/problem/442/B">Codeforces - Andrey and Problem</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/442/submission/215303463">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF442-D1-B.cpp">Code</a></td>
<td style="text-align: center;">24/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codingcompetitions.withgoogle.com/kickstart/round/000000000019ff08/0000000000386edd">Google Kickstart 2020 Round D — Beauty of Tree</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Google%20Kickstart/Kickstart%2020-RD-C.cpp">Code</a></td>
<td style="text-align: center;">24/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/1777/problem/D">Codeforces - Score of a Tree</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/1777/submission/215479909">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF1777-D2-D.cpp">Code</a></td>
<td style="text-align: center;">25/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/1165/problem/E">Codeforces - Two Arrays and Sum of Functions</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/1165/submission/215677750">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF1165-D3-E.cpp">Code</a></td>
<td style="text-align: center;">26/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codedrills.io/contests/amrita-icpc-practice-session-6/problems/bob-and-random-exploration">Codedrills - Bob and Random Exploration</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codedrills/bob-and-random-exploration.cpp">Code</a></td>
<td style="text-align: center;">28/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://atcoder.jp/contests/abc189/tasks/abc189_f">Atcoder ABC 189 F - Sugoroku2</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://atcoder.jp/contests/abc189/submissions/44016725">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/AtCoder/AtCoder189-ABC-F.cpp">Code</a></td>
<td style="text-align: center;">29/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.codechef.com/problems/KALADIN">Codechef - KALADIN</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://www.codechef.com/viewsolution/1011485661">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codechef/CODECHEF%20KALADIN.cpp">Code</a></td>
<td style="text-align: center;">31/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/280/problem/C">Codeforces - Game on Tree</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/280/submission/216661891">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF280-D1-C.cpp">Code</a></td>
<td style="text-align: center;">01/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.e-olymp.com/en/problems/7261">E-Olymp - Difficult path</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/E-Olymp/EOLYMP%207261.cpp">Code</a></td>
<td style="text-align: center;">01/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.e-olymp.com/en/problems/7262">E-Olymp - A coincidence</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/E-Olymp/EOLYMP%207262.cpp">Code</a></td>
<td style="text-align: center;">06/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.e-olymp.com/en/problems/7263">E-Olymp - A full set</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/E-Olymp/EOLYMP%207263.cpp">Code</a></td>
<td style="text-align: center;">04/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/D">Codeforces - A fish lunch </a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-D.cpp">Code</a></td>
<td style="text-align: center;">03/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/E">Codeforces - The secret code</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-E.cpp">Code</a></td>
<td style="text-align: center;">07/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/F">Codeforces - Dura Lex</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-F.cpp">Code</a></td>
<td style="text-align: center;">11/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/G">Codeforces - A path to knowledge</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-G.cpp">Code</a></td>
<td style="text-align: center;">08/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/H">Codeforces - A granite of science</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-H.cpp">Code</a></td>
<td style="text-align: center;">10/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/I">Codeforces - Probable diagnosis</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-I.cpp">Code</a></td>
<td style="text-align: center;">11/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/J">Codeforces - Zoological experiment</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-J.cpp">Code</a></td>
<td style="text-align: center;">14/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/K">Codeforces - A game (High)</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-K.cpp">Code</a></td>
<td style="text-align: center;">08/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/L">Codeforces - A dangerous game (High)</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF100371-Gym-L.cpp">Code</a></td>
<td style="text-align: center;">21/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/100371/problem/M">Codeforces - Hash-table (High)</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.codechef.com/problems/MARTING1">Codechef - MARTING1</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://www.codechef.com/viewsolution/1019608588">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codechef/CODECHEF%20MARTING1.cpp">Code</a></td>
<td style="text-align: center;">10/09/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/602/problem/D">Codeforces - Lipshitz Sequence</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/601/submission/220110119">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF602-D2-D.cpp">Code</a></td>
<td style="text-align: center;">24/08/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://community.topcoder.com/stat?c=problem_statement&amp;pm=14723">Topcoder SRM 727 - DoubleLive</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/TopCoder/SRM727-D1-1500.cpp">Code</a></td>
<td style="text-align: center;">20/07/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.codechef.com/problems/CUTTREE">Codechef - CUTTREE</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/gym/102012/problem/D">Codeforces - Rikka with Subsequences</a></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://www.codechef.com/problems/FSSYNC">Codechef - FSSYNC</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://www.codechef.com/viewsolution/1018924523">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codechef/CODECHEF%20FSSYNC.cpp">Code</a></td>
<td style="text-align: center;">07/09/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://community.topcoder.com/stat?c=problem_statement&amp;pm=11541&amp;rd=15585&amp;rm=316561&amp;cr=23003389">Topcoder TCO Algorithm Round 1C 2013 - TheKnights</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;">Unavailable public link</td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/TopCoder/TCOA2013R1-D1-1500.cpp">Code</a></td>
<td style="text-align: center;">12/09/2023</td>
</tr>
<tr>
<td style="text-align: center;"><a href="https://codeforces.com/contest/235/problem/D">Codeforces - Graph Game</a></td>
<td style="text-align: center;"><img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/svg/2705.svg" title=":white_check_mark:" /></td>
<td style="text-align: center;"><a href="https://codeforces.com/contest/235/submission/223444065">Submission</a></td>
<td style="text-align: center;"><a href="https://github.com/farmerboy95/CompetitiveProgramming/blob/master/Codeforces/CF235-D1-D.cpp">Code</a></td>
<td style="text-align: center;">15/09/2023</td>
</tr>
</tbody>
</table>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-custom">16/09/2023 (GMT+07)</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-custom">06/09/2023 (GMT+07)</span>
      
    
  </small>
</div>


  







  <h2 id="__comments">Comments</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
    data-repo="farmerboy95/CPBlogs"
    data-repo-id="R_kgDOIA7h_g"
    data-category="General"
    data-category-id="DIC_kwDOIA7h_s4CVvKI"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                

  
    <div class="md-source-date">
      <small>
          Authors: <span class='git-page-authors git-authors'><a href='mailto:jerry.stone.manutd@gmail.com'>farmerboy95</a></span>
      </small>
    </div>
  

              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 farmerboy
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/farmerboy95" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.top"], "search": "../../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
    
      <script src="../../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    <script>
    var elements = document.getElementsByClassName("lightgallery");
    for(var i=0; i<elements.length; i++) {
       lightGallery(elements[i]);
    }
    </script>

  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>